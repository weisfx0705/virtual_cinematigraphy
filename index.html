<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Virtual Cinematographer</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
      body { margin: 0; background: #0a0a0a; color: white; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; }
      canvas { display: block; }
      
      /* Markdown 渲染樣式 */
      .prose-custom {
        line-height: 1.6;
        color: rgba(219, 234, 254, 0.8);
      }
      .prose-custom strong {
        color: #3b82f6;
        font-weight: 800;
      }
      .prose-custom h1, .prose-custom h2, .prose-custom h3 {
        color: white;
        margin-top: 1rem;
        margin-bottom: 0.5rem;
        font-weight: 900;
        text-transform: uppercase;
        letter-spacing: 0.05em;
      }
      .prose-custom ul {
        list-style-type: none;
        padding-left: 0;
      }
      .prose-custom li {
        margin-bottom: 0.25rem;
        position: relative;
        padding-left: 1.25rem;
      }
      .prose-custom li::before {
        content: "•";
        position: absolute;
        left: 0;
        color: #3b82f6;
      }
      .prose-custom code {
        background: rgba(59, 130, 246, 0.1);
        padding: 0.2rem 0.4rem;
        border-radius: 4px;
        font-family: monospace;
        font-size: 0.9em;
      }
    </style>
  <script type="module" crossorigin>var KN=Object.defineProperty;var qT=i=>{throw TypeError(i)};var QN=(i,e,t)=>e in i?KN(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var un=(i,e,t)=>QN(i,typeof e!="symbol"?e+"":e,t),jN=(i,e,t)=>e.has(i)||qT("Cannot "+t);var WT=(i,e,t)=>e.has(i)?qT("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(i):e.set(i,t);var Ov=(i,e,t)=>(jN(i,e,"access private method"),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function t(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(r){if(r.ep)return;r.ep=!0;const s=t(r);fetch(r.href,s)}})();function nx(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var DS={exports:{}},Pm={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var XT;function eD(){if(XT)return Pm;XT=1;var i=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(n,r,s){var a=null;if(s!==void 0&&(a=""+s),r.key!==void 0&&(a=""+r.key),"key"in r){s={};for(var c in r)c!=="key"&&(s[c]=r[c])}else s=r;return r=s.ref,{$$typeof:i,type:n,key:a,ref:r!==void 0?r:null,props:s}}return Pm.Fragment=e,Pm.jsx=t,Pm.jsxs=t,Pm}var YT;function tD(){return YT||(YT=1,DS.exports=eD()),DS.exports}var ue=tD(),US={exports:{}},gn={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var JT;function nD(){if(JT)return gn;JT=1;var i=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),s=Symbol.for("react.consumer"),a=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),p=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),v=Symbol.for("react.activity"),_=Symbol.iterator;function b($){return $===null||typeof $!="object"?null:($=_&&$[_]||$["@@iterator"],typeof $=="function"?$:null)}var T={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},I=Object.assign,C={};function A($,ce,Ee){this.props=$,this.context=ce,this.refs=C,this.updater=Ee||T}A.prototype.isReactComponent={},A.prototype.setState=function($,ce){if(typeof $!="object"&&typeof $!="function"&&$!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,$,ce,"setState")},A.prototype.forceUpdate=function($){this.updater.enqueueForceUpdate(this,$,"forceUpdate")};function D(){}D.prototype=A.prototype;function U($,ce,Ee){this.props=$,this.context=ce,this.refs=C,this.updater=Ee||T}var L=U.prototype=new D;L.constructor=U,I(L,A.prototype),L.isPureReactComponent=!0;var z=Array.isArray;function B(){}var k={H:null,A:null,T:null,S:null},G=Object.prototype.hasOwnProperty;function P($,ce,Ee){var Be=Ee.ref;return{$$typeof:i,type:$,key:ce,ref:Be!==void 0?Be:null,props:Ee}}function O($,ce){return P($.type,ce,$.props)}function Z($){return typeof $=="object"&&$!==null&&$.$$typeof===i}function ie($){var ce={"=":"=0",":":"=2"};return"$"+$.replace(/[=:]/g,function(Ee){return ce[Ee]})}var ee=/\/+/g;function re($,ce){return typeof $=="object"&&$!==null&&$.key!=null?ie(""+$.key):ce.toString(36)}function de($){switch($.status){case"fulfilled":return $.value;case"rejected":throw $.reason;default:switch(typeof $.status=="string"?$.then(B,B):($.status="pending",$.then(function(ce){$.status==="pending"&&($.status="fulfilled",$.value=ce)},function(ce){$.status==="pending"&&($.status="rejected",$.reason=ce)})),$.status){case"fulfilled":return $.value;case"rejected":throw $.reason}}throw $}function J($,ce,Ee,Be,St){var ve=typeof $;(ve==="undefined"||ve==="boolean")&&($=null);var Re=!1;if($===null)Re=!0;else switch(ve){case"bigint":case"string":case"number":Re=!0;break;case"object":switch($.$$typeof){case i:case e:Re=!0;break;case m:return Re=$._init,J(Re($._payload),ce,Ee,Be,St)}}if(Re)return St=St($),Re=Be===""?"."+re($,0):Be,z(St)?(Ee="",Re!=null&&(Ee=Re.replace(ee,"$&/")+"/"),J(St,ce,Ee,"",function(Dt){return Dt})):St!=null&&(Z(St)&&(St=O(St,Ee+(St.key==null||$&&$.key===St.key?"":(""+St.key).replace(ee,"$&/")+"/")+Re)),ce.push(St)),1;Re=0;var ot=Be===""?".":Be+":";if(z($))for(var bt=0;bt<$.length;bt++)Be=$[bt],ve=ot+re(Be,bt),Re+=J(Be,ce,Ee,ve,St);else if(bt=b($),typeof bt=="function")for($=bt.call($),bt=0;!(Be=$.next()).done;)Be=Be.value,ve=ot+re(Be,bt++),Re+=J(Be,ce,Ee,ve,St);else if(ve==="object"){if(typeof $.then=="function")return J(de($),ce,Ee,Be,St);throw ce=String($),Error("Objects are not valid as a React child (found: "+(ce==="[object Object]"?"object with keys {"+Object.keys($).join(", ")+"}":ce)+"). If you meant to render a collection of children, use an array instead.")}return Re}function te($,ce,Ee){if($==null)return $;var Be=[],St=0;return J($,Be,"","",function(ve){return ce.call(Ee,ve,St++)}),Be}function ye($){if($._status===-1){var ce=$._result;ce=ce(),ce.then(function(Ee){($._status===0||$._status===-1)&&($._status=1,$._result=Ee)},function(Ee){($._status===0||$._status===-1)&&($._status=2,$._result=Ee)}),$._status===-1&&($._status=0,$._result=ce)}if($._status===1)return $._result.default;throw $._result}var Ue=typeof reportError=="function"?reportError:function($){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var ce=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof $=="object"&&$!==null&&typeof $.message=="string"?String($.message):String($),error:$});if(!window.dispatchEvent(ce))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",$);return}console.error($)},we={map:te,forEach:function($,ce,Ee){te($,function(){ce.apply(this,arguments)},Ee)},count:function($){var ce=0;return te($,function(){ce++}),ce},toArray:function($){return te($,function(ce){return ce})||[]},only:function($){if(!Z($))throw Error("React.Children.only expected to receive a single React element child.");return $}};return gn.Activity=v,gn.Children=we,gn.Component=A,gn.Fragment=t,gn.Profiler=r,gn.PureComponent=U,gn.StrictMode=n,gn.Suspense=d,gn.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=k,gn.__COMPILER_RUNTIME={__proto__:null,c:function($){return k.H.useMemoCache($)}},gn.cache=function($){return function(){return $.apply(null,arguments)}},gn.cacheSignal=function(){return null},gn.cloneElement=function($,ce,Ee){if($==null)throw Error("The argument must be a React element, but you passed "+$+".");var Be=I({},$.props),St=$.key;if(ce!=null)for(ve in ce.key!==void 0&&(St=""+ce.key),ce)!G.call(ce,ve)||ve==="key"||ve==="__self"||ve==="__source"||ve==="ref"&&ce.ref===void 0||(Be[ve]=ce[ve]);var ve=arguments.length-2;if(ve===1)Be.children=Ee;else if(1<ve){for(var Re=Array(ve),ot=0;ot<ve;ot++)Re[ot]=arguments[ot+2];Be.children=Re}return P($.type,St,Be)},gn.createContext=function($){return $={$$typeof:a,_currentValue:$,_currentValue2:$,_threadCount:0,Provider:null,Consumer:null},$.Provider=$,$.Consumer={$$typeof:s,_context:$},$},gn.createElement=function($,ce,Ee){var Be,St={},ve=null;if(ce!=null)for(Be in ce.key!==void 0&&(ve=""+ce.key),ce)G.call(ce,Be)&&Be!=="key"&&Be!=="__self"&&Be!=="__source"&&(St[Be]=ce[Be]);var Re=arguments.length-2;if(Re===1)St.children=Ee;else if(1<Re){for(var ot=Array(Re),bt=0;bt<Re;bt++)ot[bt]=arguments[bt+2];St.children=ot}if($&&$.defaultProps)for(Be in Re=$.defaultProps,Re)St[Be]===void 0&&(St[Be]=Re[Be]);return P($,ve,St)},gn.createRef=function(){return{current:null}},gn.forwardRef=function($){return{$$typeof:c,render:$}},gn.isValidElement=Z,gn.lazy=function($){return{$$typeof:m,_payload:{_status:-1,_result:$},_init:ye}},gn.memo=function($,ce){return{$$typeof:p,type:$,compare:ce===void 0?null:ce}},gn.startTransition=function($){var ce=k.T,Ee={};k.T=Ee;try{var Be=$(),St=k.S;St!==null&&St(Ee,Be),typeof Be=="object"&&Be!==null&&typeof Be.then=="function"&&Be.then(B,Ue)}catch(ve){Ue(ve)}finally{ce!==null&&Ee.types!==null&&(ce.types=Ee.types),k.T=ce}},gn.unstable_useCacheRefresh=function(){return k.H.useCacheRefresh()},gn.use=function($){return k.H.use($)},gn.useActionState=function($,ce,Ee){return k.H.useActionState($,ce,Ee)},gn.useCallback=function($,ce){return k.H.useCallback($,ce)},gn.useContext=function($){return k.H.useContext($)},gn.useDebugValue=function(){},gn.useDeferredValue=function($,ce){return k.H.useDeferredValue($,ce)},gn.useEffect=function($,ce){return k.H.useEffect($,ce)},gn.useEffectEvent=function($){return k.H.useEffectEvent($)},gn.useId=function(){return k.H.useId()},gn.useImperativeHandle=function($,ce,Ee){return k.H.useImperativeHandle($,ce,Ee)},gn.useInsertionEffect=function($,ce){return k.H.useInsertionEffect($,ce)},gn.useLayoutEffect=function($,ce){return k.H.useLayoutEffect($,ce)},gn.useMemo=function($,ce){return k.H.useMemo($,ce)},gn.useOptimistic=function($,ce){return k.H.useOptimistic($,ce)},gn.useReducer=function($,ce,Ee){return k.H.useReducer($,ce,Ee)},gn.useRef=function($){return k.H.useRef($)},gn.useState=function($){return k.H.useState($)},gn.useSyncExternalStore=function($,ce,Ee){return k.H.useSyncExternalStore($,ce,Ee)},gn.useTransition=function(){return k.H.useTransition()},gn.version="19.2.3",gn}var ZT;function Fg(){return ZT||(ZT=1,US.exports=nD()),US.exports}var Oe=Fg();const FM=nx(Oe);var PS={exports:{}},Lm={},LS={exports:{}},FS={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $T;function iD(){return $T||($T=1,(function(i){function e(J,te){var ye=J.length;J.push(te);e:for(;0<ye;){var Ue=ye-1>>>1,we=J[Ue];if(0<r(we,te))J[Ue]=te,J[ye]=we,ye=Ue;else break e}}function t(J){return J.length===0?null:J[0]}function n(J){if(J.length===0)return null;var te=J[0],ye=J.pop();if(ye!==te){J[0]=ye;e:for(var Ue=0,we=J.length,$=we>>>1;Ue<$;){var ce=2*(Ue+1)-1,Ee=J[ce],Be=ce+1,St=J[Be];if(0>r(Ee,ye))Be<we&&0>r(St,Ee)?(J[Ue]=St,J[Be]=ye,Ue=Be):(J[Ue]=Ee,J[ce]=ye,Ue=ce);else if(Be<we&&0>r(St,ye))J[Ue]=St,J[Be]=ye,Ue=Be;else break e}}return te}function r(J,te){var ye=J.sortIndex-te.sortIndex;return ye!==0?ye:J.id-te.id}if(i.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var s=performance;i.unstable_now=function(){return s.now()}}else{var a=Date,c=a.now();i.unstable_now=function(){return a.now()-c}}var d=[],p=[],m=1,v=null,_=3,b=!1,T=!1,I=!1,C=!1,A=typeof setTimeout=="function"?setTimeout:null,D=typeof clearTimeout=="function"?clearTimeout:null,U=typeof setImmediate<"u"?setImmediate:null;function L(J){for(var te=t(p);te!==null;){if(te.callback===null)n(p);else if(te.startTime<=J)n(p),te.sortIndex=te.expirationTime,e(d,te);else break;te=t(p)}}function z(J){if(I=!1,L(J),!T)if(t(d)!==null)T=!0,B||(B=!0,ie());else{var te=t(p);te!==null&&de(z,te.startTime-J)}}var B=!1,k=-1,G=5,P=-1;function O(){return C?!0:!(i.unstable_now()-P<G)}function Z(){if(C=!1,B){var J=i.unstable_now();P=J;var te=!0;try{e:{T=!1,I&&(I=!1,D(k),k=-1),b=!0;var ye=_;try{t:{for(L(J),v=t(d);v!==null&&!(v.expirationTime>J&&O());){var Ue=v.callback;if(typeof Ue=="function"){v.callback=null,_=v.priorityLevel;var we=Ue(v.expirationTime<=J);if(J=i.unstable_now(),typeof we=="function"){v.callback=we,L(J),te=!0;break t}v===t(d)&&n(d),L(J)}else n(d);v=t(d)}if(v!==null)te=!0;else{var $=t(p);$!==null&&de(z,$.startTime-J),te=!1}}break e}finally{v=null,_=ye,b=!1}te=void 0}}finally{te?ie():B=!1}}}var ie;if(typeof U=="function")ie=function(){U(Z)};else if(typeof MessageChannel<"u"){var ee=new MessageChannel,re=ee.port2;ee.port1.onmessage=Z,ie=function(){re.postMessage(null)}}else ie=function(){A(Z,0)};function de(J,te){k=A(function(){J(i.unstable_now())},te)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function(J){J.callback=null},i.unstable_forceFrameRate=function(J){0>J||125<J?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):G=0<J?Math.floor(1e3/J):5},i.unstable_getCurrentPriorityLevel=function(){return _},i.unstable_next=function(J){switch(_){case 1:case 2:case 3:var te=3;break;default:te=_}var ye=_;_=te;try{return J()}finally{_=ye}},i.unstable_requestPaint=function(){C=!0},i.unstable_runWithPriority=function(J,te){switch(J){case 1:case 2:case 3:case 4:case 5:break;default:J=3}var ye=_;_=J;try{return te()}finally{_=ye}},i.unstable_scheduleCallback=function(J,te,ye){var Ue=i.unstable_now();switch(typeof ye=="object"&&ye!==null?(ye=ye.delay,ye=typeof ye=="number"&&0<ye?Ue+ye:Ue):ye=Ue,J){case 1:var we=-1;break;case 2:we=250;break;case 5:we=1073741823;break;case 4:we=1e4;break;default:we=5e3}return we=ye+we,J={id:m++,callback:te,priorityLevel:J,startTime:ye,expirationTime:we,sortIndex:-1},ye>Ue?(J.sortIndex=ye,e(p,J),t(d)===null&&J===t(p)&&(I?(D(k),k=-1):I=!0,de(z,ye-Ue))):(J.sortIndex=we,e(d,J),T||b||(T=!0,B||(B=!0,ie()))),J},i.unstable_shouldYield=O,i.unstable_wrapCallback=function(J){var te=_;return function(){var ye=_;_=te;try{return J.apply(this,arguments)}finally{_=ye}}}})(FS)),FS}var KT;function HC(){return KT||(KT=1,LS.exports=iD()),LS.exports}var kS={exports:{}},fs={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var QT;function rD(){if(QT)return fs;QT=1;var i=Fg();function e(d){var p="https://react.dev/errors/"+d;if(1<arguments.length){p+="?args[]="+encodeURIComponent(arguments[1]);for(var m=2;m<arguments.length;m++)p+="&args[]="+encodeURIComponent(arguments[m])}return"Minified React error #"+d+"; visit "+p+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var n={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},r=Symbol.for("react.portal");function s(d,p,m){var v=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:r,key:v==null?null:""+v,children:d,containerInfo:p,implementation:m}}var a=i.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(d,p){if(d==="font")return"";if(typeof p=="string")return p==="use-credentials"?p:""}return fs.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,fs.createPortal=function(d,p){var m=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!p||p.nodeType!==1&&p.nodeType!==9&&p.nodeType!==11)throw Error(e(299));return s(d,p,null,m)},fs.flushSync=function(d){var p=a.T,m=n.p;try{if(a.T=null,n.p=2,d)return d()}finally{a.T=p,n.p=m,n.d.f()}},fs.preconnect=function(d,p){typeof d=="string"&&(p?(p=p.crossOrigin,p=typeof p=="string"?p==="use-credentials"?p:"":void 0):p=null,n.d.C(d,p))},fs.prefetchDNS=function(d){typeof d=="string"&&n.d.D(d)},fs.preinit=function(d,p){if(typeof d=="string"&&p&&typeof p.as=="string"){var m=p.as,v=c(m,p.crossOrigin),_=typeof p.integrity=="string"?p.integrity:void 0,b=typeof p.fetchPriority=="string"?p.fetchPriority:void 0;m==="style"?n.d.S(d,typeof p.precedence=="string"?p.precedence:void 0,{crossOrigin:v,integrity:_,fetchPriority:b}):m==="script"&&n.d.X(d,{crossOrigin:v,integrity:_,fetchPriority:b,nonce:typeof p.nonce=="string"?p.nonce:void 0})}},fs.preinitModule=function(d,p){if(typeof d=="string")if(typeof p=="object"&&p!==null){if(p.as==null||p.as==="script"){var m=c(p.as,p.crossOrigin);n.d.M(d,{crossOrigin:m,integrity:typeof p.integrity=="string"?p.integrity:void 0,nonce:typeof p.nonce=="string"?p.nonce:void 0})}}else p==null&&n.d.M(d)},fs.preload=function(d,p){if(typeof d=="string"&&typeof p=="object"&&p!==null&&typeof p.as=="string"){var m=p.as,v=c(m,p.crossOrigin);n.d.L(d,m,{crossOrigin:v,integrity:typeof p.integrity=="string"?p.integrity:void 0,nonce:typeof p.nonce=="string"?p.nonce:void 0,type:typeof p.type=="string"?p.type:void 0,fetchPriority:typeof p.fetchPriority=="string"?p.fetchPriority:void 0,referrerPolicy:typeof p.referrerPolicy=="string"?p.referrerPolicy:void 0,imageSrcSet:typeof p.imageSrcSet=="string"?p.imageSrcSet:void 0,imageSizes:typeof p.imageSizes=="string"?p.imageSizes:void 0,media:typeof p.media=="string"?p.media:void 0})}},fs.preloadModule=function(d,p){if(typeof d=="string")if(p){var m=c(p.as,p.crossOrigin);n.d.m(d,{as:typeof p.as=="string"&&p.as!=="script"?p.as:void 0,crossOrigin:m,integrity:typeof p.integrity=="string"?p.integrity:void 0})}else n.d.m(d)},fs.requestFormReset=function(d){n.d.r(d)},fs.unstable_batchedUpdates=function(d,p){return d(p)},fs.useFormState=function(d,p,m){return a.H.useFormState(d,p,m)},fs.useFormStatus=function(){return a.H.useHostTransitionStatus()},fs.version="19.2.3",fs}var jT;function sD(){if(jT)return kS.exports;jT=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(e){console.error(e)}}return i(),kS.exports=rD(),kS.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var e1;function oD(){if(e1)return Lm;e1=1;var i=HC(),e=Fg(),t=sD();function n(o){var l="https://react.dev/errors/"+o;if(1<arguments.length){l+="?args[]="+encodeURIComponent(arguments[1]);for(var h=2;h<arguments.length;h++)l+="&args[]="+encodeURIComponent(arguments[h])}return"Minified React error #"+o+"; visit "+l+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(o){return!(!o||o.nodeType!==1&&o.nodeType!==9&&o.nodeType!==11)}function s(o){var l=o,h=o;if(o.alternate)for(;l.return;)l=l.return;else{o=l;do l=o,(l.flags&4098)!==0&&(h=l.return),o=l.return;while(o)}return l.tag===3?h:null}function a(o){if(o.tag===13){var l=o.memoizedState;if(l===null&&(o=o.alternate,o!==null&&(l=o.memoizedState)),l!==null)return l.dehydrated}return null}function c(o){if(o.tag===31){var l=o.memoizedState;if(l===null&&(o=o.alternate,o!==null&&(l=o.memoizedState)),l!==null)return l.dehydrated}return null}function d(o){if(s(o)!==o)throw Error(n(188))}function p(o){var l=o.alternate;if(!l){if(l=s(o),l===null)throw Error(n(188));return l!==o?null:o}for(var h=o,g=l;;){var E=h.return;if(E===null)break;var w=E.alternate;if(w===null){if(g=E.return,g!==null){h=g;continue}break}if(E.child===w.child){for(w=E.child;w;){if(w===h)return d(E),o;if(w===g)return d(E),l;w=w.sibling}throw Error(n(188))}if(h.return!==g.return)h=E,g=w;else{for(var F=!1,X=E.child;X;){if(X===h){F=!0,h=E,g=w;break}if(X===g){F=!0,g=E,h=w;break}X=X.sibling}if(!F){for(X=w.child;X;){if(X===h){F=!0,h=w,g=E;break}if(X===g){F=!0,g=w,h=E;break}X=X.sibling}if(!F)throw Error(n(189))}}if(h.alternate!==g)throw Error(n(190))}if(h.tag!==3)throw Error(n(188));return h.stateNode.current===h?o:l}function m(o){var l=o.tag;if(l===5||l===26||l===27||l===6)return o;for(o=o.child;o!==null;){if(l=m(o),l!==null)return l;o=o.sibling}return null}var v=Object.assign,_=Symbol.for("react.element"),b=Symbol.for("react.transitional.element"),T=Symbol.for("react.portal"),I=Symbol.for("react.fragment"),C=Symbol.for("react.strict_mode"),A=Symbol.for("react.profiler"),D=Symbol.for("react.consumer"),U=Symbol.for("react.context"),L=Symbol.for("react.forward_ref"),z=Symbol.for("react.suspense"),B=Symbol.for("react.suspense_list"),k=Symbol.for("react.memo"),G=Symbol.for("react.lazy"),P=Symbol.for("react.activity"),O=Symbol.for("react.memo_cache_sentinel"),Z=Symbol.iterator;function ie(o){return o===null||typeof o!="object"?null:(o=Z&&o[Z]||o["@@iterator"],typeof o=="function"?o:null)}var ee=Symbol.for("react.client.reference");function re(o){if(o==null)return null;if(typeof o=="function")return o.$$typeof===ee?null:o.displayName||o.name||null;if(typeof o=="string")return o;switch(o){case I:return"Fragment";case A:return"Profiler";case C:return"StrictMode";case z:return"Suspense";case B:return"SuspenseList";case P:return"Activity"}if(typeof o=="object")switch(o.$$typeof){case T:return"Portal";case U:return o.displayName||"Context";case D:return(o._context.displayName||"Context")+".Consumer";case L:var l=o.render;return o=o.displayName,o||(o=l.displayName||l.name||"",o=o!==""?"ForwardRef("+o+")":"ForwardRef"),o;case k:return l=o.displayName||null,l!==null?l:re(o.type)||"Memo";case G:l=o._payload,o=o._init;try{return re(o(l))}catch{}}return null}var de=Array.isArray,J=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,te=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ye={pending:!1,data:null,method:null,action:null},Ue=[],we=-1;function $(o){return{current:o}}function ce(o){0>we||(o.current=Ue[we],Ue[we]=null,we--)}function Ee(o,l){we++,Ue[we]=o.current,o.current=l}var Be=$(null),St=$(null),ve=$(null),Re=$(null);function ot(o,l){switch(Ee(ve,l),Ee(St,o),Ee(Be,null),l.nodeType){case 9:case 11:o=(o=l.documentElement)&&(o=o.namespaceURI)?hT(o):0;break;default:if(o=l.tagName,l=l.namespaceURI)l=hT(l),o=pT(l,o);else switch(o){case"svg":o=1;break;case"math":o=2;break;default:o=0}}ce(Be),Ee(Be,o)}function bt(){ce(Be),ce(St),ce(ve)}function Dt(o){o.memoizedState!==null&&Ee(Re,o);var l=Be.current,h=pT(l,o.type);l!==h&&(Ee(St,o),Ee(Be,h))}function cn(o){St.current===o&&(ce(Be),ce(St)),Re.current===o&&(ce(Re),Im._currentValue=ye)}var Tn,Zt;function Ve(o){if(Tn===void 0)try{throw Error()}catch(h){var l=h.stack.trim().match(/\n( *(at )?)/);Tn=l&&l[1]||"",Zt=-1<h.stack.indexOf(`
    at`)?" (<anonymous>)":-1<h.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Tn+o+Zt}var et=!1;function qe(o,l){if(!o||et)return"";et=!0;var h=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var g={DetermineComponentFrameRoot:function(){try{if(l){var Je=function(){throw Error()};if(Object.defineProperty(Je.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Je,[])}catch(Fe){var Ae=Fe}Reflect.construct(o,[],Je)}else{try{Je.call()}catch(Fe){Ae=Fe}o.call(Je.prototype)}}else{try{throw Error()}catch(Fe){Ae=Fe}(Je=o())&&typeof Je.catch=="function"&&Je.catch(function(){})}}catch(Fe){if(Fe&&Ae&&typeof Fe.stack=="string")return[Fe.stack,Ae.stack]}return[null,null]}};g.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var E=Object.getOwnPropertyDescriptor(g.DetermineComponentFrameRoot,"name");E&&E.configurable&&Object.defineProperty(g.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var w=g.DetermineComponentFrameRoot(),F=w[0],X=w[1];if(F&&X){var se=F.split(`
`),Me=X.split(`
`);for(E=g=0;g<se.length&&!se[g].includes("DetermineComponentFrameRoot");)g++;for(;E<Me.length&&!Me[E].includes("DetermineComponentFrameRoot");)E++;if(g===se.length||E===Me.length)for(g=se.length-1,E=Me.length-1;1<=g&&0<=E&&se[g]!==Me[E];)E--;for(;1<=g&&0<=E;g--,E--)if(se[g]!==Me[E]){if(g!==1||E!==1)do if(g--,E--,0>E||se[g]!==Me[E]){var ze=`
`+se[g].replace(" at new "," at ");return o.displayName&&ze.includes("<anonymous>")&&(ze=ze.replace("<anonymous>",o.displayName)),ze}while(1<=g&&0<=E);break}}}finally{et=!1,Error.prepareStackTrace=h}return(h=o?o.displayName||o.name:"")?Ve(h):""}function _t(o,l){switch(o.tag){case 26:case 27:case 5:return Ve(o.type);case 16:return Ve("Lazy");case 13:return o.child!==l&&l!==null?Ve("Suspense Fallback"):Ve("Suspense");case 19:return Ve("SuspenseList");case 0:case 15:return qe(o.type,!1);case 11:return qe(o.type.render,!1);case 1:return qe(o.type,!0);case 31:return Ve("Activity");default:return""}}function j(o){try{var l="",h=null;do l+=_t(o,h),h=o,o=o.return;while(o);return l}catch(g){return`
Error generating stack: `+g.message+`
`+g.stack}}var Ht=Object.prototype.hasOwnProperty,Et=i.unstable_scheduleCallback,Gt=i.unstable_cancelCallback,ut=i.unstable_shouldYield,K=i.unstable_requestPaint,V=i.unstable_now,pe=i.unstable_getCurrentPriorityLevel,De=i.unstable_ImmediatePriority,We=i.unstable_UserBlockingPriority,Ne=i.unstable_NormalPriority,Ct=i.unstable_LowPriority,ht=i.unstable_IdlePriority,Ot=i.log,$t=i.unstable_setDisableYieldValue,Ze=null,Ke=null;function Nt(o){if(typeof Ot=="function"&&$t(o),Ke&&typeof Ke.setStrictMode=="function")try{Ke.setStrictMode(Ze,o)}catch{}}var Tt=Math.clz32?Math.clz32:me,at=Math.log,Xt=Math.LN2;function me(o){return o>>>=0,o===0?32:31-(at(o)/Xt|0)|0}var Ce=256,nt=262144,wt=4194304;function tt(o){var l=o&42;if(l!==0)return l;switch(o&-o){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return o&261888;case 262144:case 524288:case 1048576:case 2097152:return o&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return o&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return o}}function He(o,l,h){var g=o.pendingLanes;if(g===0)return 0;var E=0,w=o.suspendedLanes,F=o.pingedLanes;o=o.warmLanes;var X=g&134217727;return X!==0?(g=X&~w,g!==0?E=tt(g):(F&=X,F!==0?E=tt(F):h||(h=X&~o,h!==0&&(E=tt(h))))):(X=g&~w,X!==0?E=tt(X):F!==0?E=tt(F):h||(h=g&~o,h!==0&&(E=tt(h)))),E===0?0:l!==0&&l!==E&&(l&w)===0&&(w=E&-E,h=l&-l,w>=h||w===32&&(h&4194048)!==0)?l:E}function vt(o,l){return(o.pendingLanes&~(o.suspendedLanes&~o.pingedLanes)&l)===0}function nn(o,l){switch(o){case 1:case 2:case 4:case 8:case 64:return l+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Nn(){var o=wt;return wt<<=1,(wt&62914560)===0&&(wt=4194304),o}function Ln(o){for(var l=[],h=0;31>h;h++)l.push(o);return l}function ji(o,l){o.pendingLanes|=l,l!==268435456&&(o.suspendedLanes=0,o.pingedLanes=0,o.warmLanes=0)}function Rr(o,l,h,g,E,w){var F=o.pendingLanes;o.pendingLanes=h,o.suspendedLanes=0,o.pingedLanes=0,o.warmLanes=0,o.expiredLanes&=h,o.entangledLanes&=h,o.errorRecoveryDisabledLanes&=h,o.shellSuspendCounter=0;var X=o.entanglements,se=o.expirationTimes,Me=o.hiddenUpdates;for(h=F&~h;0<h;){var ze=31-Tt(h),Je=1<<ze;X[ze]=0,se[ze]=-1;var Ae=Me[ze];if(Ae!==null)for(Me[ze]=null,ze=0;ze<Ae.length;ze++){var Fe=Ae[ze];Fe!==null&&(Fe.lane&=-536870913)}h&=~Je}g!==0&&To(o,g,0),w!==0&&E===0&&o.tag!==0&&(o.suspendedLanes|=w&~(F&~l))}function To(o,l,h){o.pendingLanes|=l,o.suspendedLanes&=~l;var g=31-Tt(l);o.entangledLanes|=l,o.entanglements[g]=o.entanglements[g]|1073741824|h&261930}function Ao(o,l){var h=o.entangledLanes|=l;for(o=o.entanglements;h;){var g=31-Tt(h),E=1<<g;E&l|o[g]&l&&(o[g]|=l),h&=~E}}function Os(o,l){var h=l&-l;return h=(h&42)!==0?1:wo(h),(h&(o.suspendedLanes|l))!==0?0:h}function wo(o){switch(o){case 2:o=1;break;case 8:o=4;break;case 32:o=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:o=128;break;case 268435456:o=134217728;break;default:o=0}return o}function Br(o){return o&=-o,2<o?8<o?(o&134217727)!==0?32:268435456:8:2}function ys(){var o=te.p;return o!==0?o:(o=window.event,o===void 0?32:kT(o.type))}function jt(o,l){var h=te.p;try{return te.p=o,l()}finally{te.p=h}}var Ir=Math.random().toString(36).slice(2),gi="__reactFiber$"+Ir,H="__reactProps$"+Ir,Y="__reactContainer$"+Ir,oe="__reactEvents$"+Ir,Se="__reactListeners$"+Ir,Le="__reactHandles$"+Ir,ke="__reactResources$"+Ir,it="__reactMarker$"+Ir;function Qe(o){delete o[gi],delete o[H],delete o[oe],delete o[Se],delete o[Le]}function pt(o){var l=o[gi];if(l)return l;for(var h=o.parentNode;h;){if(l=h[Y]||h[gi]){if(h=l.alternate,l.child!==null||h!==null&&h.child!==null)for(o=ST(o);o!==null;){if(h=o[gi])return h;o=ST(o)}return l}o=h,h=o.parentNode}return null}function ft(o){if(o=o[gi]||o[Y]){var l=o.tag;if(l===5||l===6||l===13||l===31||l===26||l===27||l===3)return o}return null}function yt(o){var l=o.tag;if(l===5||l===26||l===27||l===6)return o.stateNode;throw Error(n(33))}function ct(o){var l=o[ke];return l||(l=o[ke]={hoistableStyles:new Map,hoistableScripts:new Map}),l}function q(o){o[it]=!0}var ne=new Set,he={};function ge(o,l){le(o,l),le(o+"Capture",l)}function le(o,l){for(he[o]=l,o=0;o<l.length;o++)ne.add(l[o])}var Ge=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),rt={},Xe={};function Mt(o){return Ht.call(Xe,o)?!0:Ht.call(rt,o)?!1:Ge.test(o)?Xe[o]=!0:(rt[o]=!0,!1)}function dt(o,l,h){if(Mt(l))if(h===null)o.removeAttribute(l);else{switch(typeof h){case"undefined":case"function":case"symbol":o.removeAttribute(l);return;case"boolean":var g=l.toLowerCase().slice(0,5);if(g!=="data-"&&g!=="aria-"){o.removeAttribute(l);return}}o.setAttribute(l,""+h)}}function Bt(o,l,h){if(h===null)o.removeAttribute(l);else{switch(typeof h){case"undefined":case"function":case"symbol":case"boolean":o.removeAttribute(l);return}o.setAttribute(l,""+h)}}function gt(o,l,h,g){if(g===null)o.removeAttribute(h);else{switch(typeof g){case"undefined":case"function":case"symbol":case"boolean":o.removeAttribute(h);return}o.setAttributeNS(l,h,""+g)}}function kt(o){switch(typeof o){case"bigint":case"boolean":case"number":case"string":case"undefined":return o;case"object":return o;default:return""}}function fn(o){var l=o.type;return(o=o.nodeName)&&o.toLowerCase()==="input"&&(l==="checkbox"||l==="radio")}function Xn(o,l,h){var g=Object.getOwnPropertyDescriptor(o.constructor.prototype,l);if(!o.hasOwnProperty(l)&&typeof g<"u"&&typeof g.get=="function"&&typeof g.set=="function"){var E=g.get,w=g.set;return Object.defineProperty(o,l,{configurable:!0,get:function(){return E.call(this)},set:function(F){h=""+F,w.call(this,F)}}),Object.defineProperty(o,l,{enumerable:g.enumerable}),{getValue:function(){return h},setValue:function(F){h=""+F},stopTracking:function(){o._valueTracker=null,delete o[l]}}}}function yn(o){if(!o._valueTracker){var l=fn(o)?"checked":"value";o._valueTracker=Xn(o,l,""+o[l])}}function Ut(o){if(!o)return!1;var l=o._valueTracker;if(!l)return!0;var h=l.getValue(),g="";return o&&(g=fn(o)?o.checked?"true":"false":o.value),o=g,o!==h?(l.setValue(o),!0):!1}function lt(o){if(o=o||(typeof document<"u"?document:void 0),typeof o>"u")return null;try{return o.activeElement||o.body}catch{return o.body}}var qt=/[\n"\\]/g;function At(o){return o.replace(qt,function(l){return"\\"+l.charCodeAt(0).toString(16)+" "})}function qn(o,l,h,g,E,w,F,X){o.name="",F!=null&&typeof F!="function"&&typeof F!="symbol"&&typeof F!="boolean"?o.type=F:o.removeAttribute("type"),l!=null?F==="number"?(l===0&&o.value===""||o.value!=l)&&(o.value=""+kt(l)):o.value!==""+kt(l)&&(o.value=""+kt(l)):F!=="submit"&&F!=="reset"||o.removeAttribute("value"),l!=null?An(o,F,kt(l)):h!=null?An(o,F,kt(h)):g!=null&&o.removeAttribute("value"),E==null&&w!=null&&(o.defaultChecked=!!w),E!=null&&(o.checked=E&&typeof E!="function"&&typeof E!="symbol"),X!=null&&typeof X!="function"&&typeof X!="symbol"&&typeof X!="boolean"?o.name=""+kt(X):o.removeAttribute("name")}function er(o,l,h,g,E,w,F,X){if(w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"&&(o.type=w),l!=null||h!=null){if(!(w!=="submit"&&w!=="reset"||l!=null)){yn(o);return}h=h!=null?""+kt(h):"",l=l!=null?""+kt(l):h,X||l===o.value||(o.value=l),o.defaultValue=l}g=g??E,g=typeof g!="function"&&typeof g!="symbol"&&!!g,o.checked=X?o.checked:!!g,o.defaultChecked=!!g,F!=null&&typeof F!="function"&&typeof F!="symbol"&&typeof F!="boolean"&&(o.name=F),yn(o)}function An(o,l,h){l==="number"&&lt(o.ownerDocument)===o||o.defaultValue===""+h||(o.defaultValue=""+h)}function yi(o,l,h,g){if(o=o.options,l){l={};for(var E=0;E<h.length;E++)l["$"+h[E]]=!0;for(h=0;h<o.length;h++)E=l.hasOwnProperty("$"+o[h].value),o[h].selected!==E&&(o[h].selected=E),E&&g&&(o[h].defaultSelected=!0)}else{for(h=""+kt(h),l=null,E=0;E<o.length;E++){if(o[E].value===h){o[E].selected=!0,g&&(o[E].defaultSelected=!0);return}l!==null||o[E].disabled||(l=o[E])}l!==null&&(l.selected=!0)}}function Jn(o,l,h){if(l!=null&&(l=""+kt(l),l!==o.value&&(o.value=l),h==null)){o.defaultValue!==l&&(o.defaultValue=l);return}o.defaultValue=h!=null?""+kt(h):""}function tr(o,l,h,g){if(l==null){if(g!=null){if(h!=null)throw Error(n(92));if(de(g)){if(1<g.length)throw Error(n(93));g=g[0]}h=g}h==null&&(h=""),l=h}h=kt(l),o.defaultValue=h,g=o.textContent,g===h&&g!==""&&g!==null&&(o.value=g),yn(o)}function Xi(o,l){if(l){var h=o.firstChild;if(h&&h===o.lastChild&&h.nodeType===3){h.nodeValue=l;return}}o.textContent=l}var cr=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function fr(o,l,h){var g=l.indexOf("--")===0;h==null||typeof h=="boolean"||h===""?g?o.setProperty(l,""):l==="float"?o.cssFloat="":o[l]="":g?o.setProperty(l,h):typeof h!="number"||h===0||cr.has(l)?l==="float"?o.cssFloat=h:o[l]=(""+h).trim():o[l]=h+"px"}function wl(o,l,h){if(l!=null&&typeof l!="object")throw Error(n(62));if(o=o.style,h!=null){for(var g in h)!h.hasOwnProperty(g)||l!=null&&l.hasOwnProperty(g)||(g.indexOf("--")===0?o.setProperty(g,""):g==="float"?o.cssFloat="":o[g]="");for(var E in l)g=l[E],l.hasOwnProperty(E)&&h[E]!==g&&fr(o,E,g)}else for(var w in l)l.hasOwnProperty(w)&&fr(o,w,l[w])}function zs(o){if(o.indexOf("-")===-1)return!1;switch(o){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var t0=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),cp=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Ic(o){return cp.test(""+o)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":o}function oa(){}var nd=null;function id(o){return o=o.target||o.srcElement||window,o.correspondingUseElement&&(o=o.correspondingUseElement),o.nodeType===3?o.parentNode:o}var Cl=null,Oa=null;function fp(o){var l=ft(o);if(l&&(o=l.stateNode)){var h=o[H]||null;e:switch(o=l.stateNode,l.type){case"input":if(qn(o,h.value,h.defaultValue,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name),l=h.name,h.type==="radio"&&l!=null){for(h=o;h.parentNode;)h=h.parentNode;for(h=h.querySelectorAll('input[name="'+At(""+l)+'"][type="radio"]'),l=0;l<h.length;l++){var g=h[l];if(g!==o&&g.form===o.form){var E=g[H]||null;if(!E)throw Error(n(90));qn(g,E.value,E.defaultValue,E.defaultValue,E.checked,E.defaultChecked,E.type,E.name)}}for(l=0;l<h.length;l++)g=h[l],g.form===o.form&&Ut(g)}break e;case"textarea":Jn(o,h.value,h.defaultValue);break e;case"select":l=h.value,l!=null&&yi(o,!!h.multiple,l,!1)}}}var rd=!1;function dp(o,l,h){if(rd)return o(l,h);rd=!0;try{var g=o(l);return g}finally{if(rd=!1,(Cl!==null||Oa!==null)&&(ho(),Cl&&(l=Cl,o=Oa,Oa=Cl=null,fp(l),o)))for(l=0;l<o.length;l++)fp(o[l])}}function _u(o,l){var h=o.stateNode;if(h===null)return null;var g=h[H]||null;if(g===null)return null;h=g[l];e:switch(l){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(g=!g.disabled)||(o=o.type,g=!(o==="button"||o==="input"||o==="select"||o==="textarea")),o=!g;break e;default:o=!1}if(o)return null;if(h&&typeof h!="function")throw Error(n(231,l,typeof h));return h}var Co=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),hp=!1;if(Co)try{var xu={};Object.defineProperty(xu,"passive",{get:function(){hp=!0}}),window.addEventListener("test",xu,xu),window.removeEventListener("test",xu,xu)}catch{hp=!1}var _s=null,sd=null,Rl=null;function Nc(){if(Rl)return Rl;var o,l=sd,h=l.length,g,E="value"in _s?_s.value:_s.textContent,w=E.length;for(o=0;o<h&&l[o]===E[o];o++);var F=h-o;for(g=1;g<=F&&l[h-g]===E[w-g];g++);return Rl=E.slice(o,1<g?1-g:void 0)}function Dc(o){var l=o.keyCode;return"charCode"in o?(o=o.charCode,o===0&&l===13&&(o=13)):o=l,o===10&&(o=13),32<=o||o===13?o:0}function Su(){return!0}function n0(){return!1}function Vr(o){function l(h,g,E,w,F){this._reactName=h,this._targetInst=E,this.type=g,this.nativeEvent=w,this.target=F,this.currentTarget=null;for(var X in o)o.hasOwnProperty(X)&&(h=o[X],this[X]=h?h(w):w[X]);return this.isDefaultPrevented=(w.defaultPrevented!=null?w.defaultPrevented:w.returnValue===!1)?Su:n0,this.isPropagationStopped=n0,this}return v(l.prototype,{preventDefault:function(){this.defaultPrevented=!0;var h=this.nativeEvent;h&&(h.preventDefault?h.preventDefault():typeof h.returnValue!="unknown"&&(h.returnValue=!1),this.isDefaultPrevented=Su)},stopPropagation:function(){var h=this.nativeEvent;h&&(h.stopPropagation?h.stopPropagation():typeof h.cancelBubble!="unknown"&&(h.cancelBubble=!0),this.isPropagationStopped=Su)},persist:function(){},isPersistent:Su}),l}var za={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(o){return o.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Uc=Vr(za),bu=v({},za,{view:0,detail:0}),i0=Vr(bu),Pc,od,Mu,Eu=v({},bu,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:cd,button:0,buttons:0,relatedTarget:function(o){return o.relatedTarget===void 0?o.fromElement===o.srcElement?o.toElement:o.fromElement:o.relatedTarget},movementX:function(o){return"movementX"in o?o.movementX:(o!==Mu&&(Mu&&o.type==="mousemove"?(Pc=o.screenX-Mu.screenX,od=o.screenY-Mu.screenY):od=Pc=0,Mu=o),Pc)},movementY:function(o){return"movementY"in o?o.movementY:od}}),pp=Vr(Eu),r0=v({},Eu,{dataTransfer:0}),s0=Vr(r0),mp=v({},bu,{relatedTarget:0}),ad=Vr(mp),o0=v({},za,{animationName:0,elapsedTime:0,pseudoElement:0}),Qx=Vr(o0),jx=v({},za,{clipboardData:function(o){return"clipboardData"in o?o.clipboardData:window.clipboardData}}),a0=Vr(jx),Lc=v({},za,{data:0}),ld=Vr(Lc),ud={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},l0={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},u0={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function gp(o){var l=this.nativeEvent;return l.getModifierState?l.getModifierState(o):(o=u0[o])?!!l[o]:!1}function cd(){return gp}var c0=v({},bu,{key:function(o){if(o.key){var l=ud[o.key]||o.key;if(l!=="Unidentified")return l}return o.type==="keypress"?(o=Dc(o),o===13?"Enter":String.fromCharCode(o)):o.type==="keydown"||o.type==="keyup"?l0[o.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:cd,charCode:function(o){return o.type==="keypress"?Dc(o):0},keyCode:function(o){return o.type==="keydown"||o.type==="keyup"?o.keyCode:0},which:function(o){return o.type==="keypress"?Dc(o):o.type==="keydown"||o.type==="keyup"?o.keyCode:0}}),Il=Vr(c0),fd=v({},Eu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),vp=Vr(fd),yp=v({},bu,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:cd}),f0=Vr(yp),d0=v({},za,{propertyName:0,elapsedTime:0,pseudoElement:0}),eS=Vr(d0),_r=v({},Eu,{deltaX:function(o){return"deltaX"in o?o.deltaX:"wheelDeltaX"in o?-o.wheelDeltaX:0},deltaY:function(o){return"deltaY"in o?o.deltaY:"wheelDeltaY"in o?-o.wheelDeltaY:"wheelDelta"in o?-o.wheelDelta:0},deltaZ:0,deltaMode:0}),h0=Vr(_r),p0=v({},za,{newState:0,oldState:0}),m0=Vr(p0),g0=[9,13,27,32],Nl=Co&&"CompositionEvent"in window,Tu=null;Co&&"documentMode"in document&&(Tu=document.documentMode);var dd=Co&&"TextEvent"in window&&!Tu,_p=Co&&(!Nl||Tu&&8<Tu&&11>=Tu),v0=" ",Fc=!1;function hd(o,l){switch(o){case"keyup":return g0.indexOf(l.keyCode)!==-1;case"keydown":return l.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function xp(o){return o=o.detail,typeof o=="object"&&"data"in o?o.data:null}var Dl=!1;function y0(o,l){switch(o){case"compositionend":return xp(l);case"keypress":return l.which!==32?null:(Fc=!0,v0);case"textInput":return o=l.data,o===v0&&Fc?null:o;default:return null}}function Sp(o,l){if(Dl)return o==="compositionend"||!Nl&&hd(o,l)?(o=Nc(),Rl=sd=_s=null,Dl=!1,o):null;switch(o){case"paste":return null;case"keypress":if(!(l.ctrlKey||l.altKey||l.metaKey)||l.ctrlKey&&l.altKey){if(l.char&&1<l.char.length)return l.char;if(l.which)return String.fromCharCode(l.which)}return null;case"compositionend":return _p&&l.locale!=="ko"?null:l.data;default:return null}}var bp={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Mp(o){var l=o&&o.nodeName&&o.nodeName.toLowerCase();return l==="input"?!!bp[o.type]:l==="textarea"}function pd(o,l,h,g){Cl?Oa?Oa.push(g):Oa=[g]:Cl=g,l=Mv(l,"onChange"),0<l.length&&(h=new Uc("onChange","change",null,h,g),o.push({event:h,listeners:l}))}var Ba=null,Ul=null;function _0(o){aT(o,0)}function Au(o){var l=yt(o);if(Ut(l))return o}function Ep(o,l){if(o==="change")return l}var Ro=!1;if(Co){var kc;if(Co){var Tp="oninput"in document;if(!Tp){var Ap=document.createElement("div");Ap.setAttribute("oninput","return;"),Tp=typeof Ap.oninput=="function"}kc=Tp}else kc=!1;Ro=kc&&(!document.documentMode||9<document.documentMode)}function Bs(){Ba&&(Ba.detachEvent("onpropertychange",Oc),Ul=Ba=null)}function Oc(o){if(o.propertyName==="value"&&Au(Ul)){var l=[];pd(l,Ul,o,id(o)),dp(_0,l)}}function x0(o,l,h){o==="focusin"?(Bs(),Ba=l,Ul=h,Ba.attachEvent("onpropertychange",Oc)):o==="focusout"&&Bs()}function wp(o){if(o==="selectionchange"||o==="keyup"||o==="keydown")return Au(Ul)}function S0(o,l){if(o==="click")return Au(l)}function b0(o,l){if(o==="input"||o==="change")return Au(l)}function Cp(o,l){return o===l&&(o!==0||1/o===1/l)||o!==o&&l!==l}var Hr=typeof Object.is=="function"?Object.is:Cp;function wu(o,l){if(Hr(o,l))return!0;if(typeof o!="object"||o===null||typeof l!="object"||l===null)return!1;var h=Object.keys(o),g=Object.keys(l);if(h.length!==g.length)return!1;for(g=0;g<h.length;g++){var E=h[g];if(!Ht.call(l,E)||!Hr(o[E],l[E]))return!1}return!0}function zc(o){for(;o&&o.firstChild;)o=o.firstChild;return o}function Cu(o,l){var h=zc(o);o=0;for(var g;h;){if(h.nodeType===3){if(g=o+h.textContent.length,o<=l&&g>=l)return{node:h,offset:l-o};o=g}e:{for(;h;){if(h.nextSibling){h=h.nextSibling;break e}h=h.parentNode}h=void 0}h=zc(h)}}function li(o,l){return o&&l?o===l?!0:o&&o.nodeType===3?!1:l&&l.nodeType===3?li(o,l.parentNode):"contains"in o?o.contains(l):o.compareDocumentPosition?!!(o.compareDocumentPosition(l)&16):!1:!1}function M0(o){o=o!=null&&o.ownerDocument!=null&&o.ownerDocument.defaultView!=null?o.ownerDocument.defaultView:window;for(var l=lt(o.document);l instanceof o.HTMLIFrameElement;){try{var h=typeof l.contentWindow.location.href=="string"}catch{h=!1}if(h)o=l.contentWindow;else break;l=lt(o.document)}return l}function Rp(o){var l=o&&o.nodeName&&o.nodeName.toLowerCase();return l&&(l==="input"&&(o.type==="text"||o.type==="search"||o.type==="tel"||o.type==="url"||o.type==="password")||l==="textarea"||o.contentEditable==="true")}var E0=Co&&"documentMode"in document&&11>=document.documentMode,Io=null,No=null,Ru=null,md=!1;function Iu(o,l,h){var g=h.window===h?h.document:h.nodeType===9?h:h.ownerDocument;md||Io==null||Io!==lt(g)||(g=Io,"selectionStart"in g&&Rp(g)?g={start:g.selectionStart,end:g.selectionEnd}:(g=(g.ownerDocument&&g.ownerDocument.defaultView||window).getSelection(),g={anchorNode:g.anchorNode,anchorOffset:g.anchorOffset,focusNode:g.focusNode,focusOffset:g.focusOffset}),Ru&&wu(Ru,g)||(Ru=g,g=Mv(No,"onSelect"),0<g.length&&(l=new Uc("onSelect","select",null,l,h),o.push({event:l,listeners:g}),l.target=Io)))}function Nr(o,l){var h={};return h[o.toLowerCase()]=l.toLowerCase(),h["Webkit"+o]="webkit"+l,h["Moz"+o]="moz"+l,h}var Pl={animationend:Nr("Animation","AnimationEnd"),animationiteration:Nr("Animation","AnimationIteration"),animationstart:Nr("Animation","AnimationStart"),transitionrun:Nr("Transition","TransitionRun"),transitionstart:Nr("Transition","TransitionStart"),transitioncancel:Nr("Transition","TransitionCancel"),transitionend:Nr("Transition","TransitionEnd")},Bc={},Ip={};Co&&(Ip=document.createElement("div").style,"AnimationEvent"in window||(delete Pl.animationend.animation,delete Pl.animationiteration.animation,delete Pl.animationstart.animation),"TransitionEvent"in window||delete Pl.transitionend.transition);function aa(o){if(Bc[o])return Bc[o];if(!Pl[o])return o;var l=Pl[o],h;for(h in l)if(l.hasOwnProperty(h)&&h in Ip)return Bc[o]=l[h];return o}var gd=aa("animationend"),Vc=aa("animationiteration"),Np=aa("animationstart"),T0=aa("transitionrun"),tS=aa("transitionstart"),A0=aa("transitioncancel"),Dp=aa("transitionend"),Vs=new Map,Hc="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Hc.push("scrollEnd");function Hs(o,l){Vs.set(o,l),ge(l,[o])}var Gc=typeof reportError=="function"?reportError:function(o){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var l=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof o=="object"&&o!==null&&typeof o.message=="string"?String(o.message):String(o),error:o});if(!window.dispatchEvent(l))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",o);return}console.error(o)},Gs=[],la=0,dr=0;function qc(){for(var o=la,l=dr=la=0;l<o;){var h=Gs[l];Gs[l++]=null;var g=Gs[l];Gs[l++]=null;var E=Gs[l];Gs[l++]=null;var w=Gs[l];if(Gs[l++]=null,g!==null&&E!==null){var F=g.pending;F===null?E.next=E:(E.next=F.next,F.next=E),g.pending=E}w!==0&&Va(h,E,w)}}function hr(o,l,h,g){Gs[la++]=o,Gs[la++]=l,Gs[la++]=h,Gs[la++]=g,dr|=g,o.lanes|=g,o=o.alternate,o!==null&&(o.lanes|=g)}function vd(o,l,h,g){return hr(o,l,h,g),qs(o)}function Gr(o,l){return hr(o,null,null,l),qs(o)}function Va(o,l,h){o.lanes|=h;var g=o.alternate;g!==null&&(g.lanes|=h);for(var E=!1,w=o.return;w!==null;)w.childLanes|=h,g=w.alternate,g!==null&&(g.childLanes|=h),w.tag===22&&(o=w.stateNode,o===null||o._visibility&1||(E=!0)),o=w,w=w.return;return o.tag===3?(w=o.stateNode,E&&l!==null&&(E=31-Tt(h),o=w.hiddenUpdates,g=o[E],g===null?o[E]=[l]:g.push(l),l.lane=h|536870912),w):null}function qs(o){if(50<ol)throw ol=0,jl=null,Error(n(185));for(var l=o.return;l!==null;)o=l,l=o.return;return o.tag===3?o.stateNode:null}var Ha={};function Up(o,l,h,g){this.tag=o,this.key=h,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=l,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=g,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Mi(o,l,h,g){return new Up(o,l,h,g)}function yd(o){return o=o.prototype,!(!o||!o.isReactComponent)}function ts(o,l){var h=o.alternate;return h===null?(h=Mi(o.tag,l,o.key,o.mode),h.elementType=o.elementType,h.type=o.type,h.stateNode=o.stateNode,h.alternate=o,o.alternate=h):(h.pendingProps=l,h.type=o.type,h.flags=0,h.subtreeFlags=0,h.deletions=null),h.flags=o.flags&65011712,h.childLanes=o.childLanes,h.lanes=o.lanes,h.child=o.child,h.memoizedProps=o.memoizedProps,h.memoizedState=o.memoizedState,h.updateQueue=o.updateQueue,l=o.dependencies,h.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext},h.sibling=o.sibling,h.index=o.index,h.ref=o.ref,h.refCleanup=o.refCleanup,h}function Nu(o,l){o.flags&=65011714;var h=o.alternate;return h===null?(o.childLanes=0,o.lanes=l,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=h.childLanes,o.lanes=h.lanes,o.child=h.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=h.memoizedProps,o.memoizedState=h.memoizedState,o.updateQueue=h.updateQueue,o.type=h.type,l=h.dependencies,o.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext}),o}function Do(o,l,h,g,E,w){var F=0;if(g=o,typeof o=="function")yd(o)&&(F=1);else if(typeof o=="string")F=zN(o,h,Be.current)?26:o==="html"||o==="head"||o==="body"?27:5;else e:switch(o){case P:return o=Mi(31,h,l,E),o.elementType=P,o.lanes=w,o;case I:return Ga(h.children,E,w,l);case C:F=8,E|=24;break;case A:return o=Mi(12,h,l,E|2),o.elementType=A,o.lanes=w,o;case z:return o=Mi(13,h,l,E),o.elementType=z,o.lanes=w,o;case B:return o=Mi(19,h,l,E),o.elementType=B,o.lanes=w,o;default:if(typeof o=="object"&&o!==null)switch(o.$$typeof){case U:F=10;break e;case D:F=9;break e;case L:F=11;break e;case k:F=14;break e;case G:F=16,g=null;break e}F=29,h=Error(n(130,o===null?"null":typeof o,"")),g=null}return l=Mi(F,h,l,E),l.elementType=o,l.type=g,l.lanes=w,l}function Ga(o,l,h,g){return o=Mi(7,o,g,l),o.lanes=h,o}function _d(o,l,h){return o=Mi(6,o,null,l),o.lanes=h,o}function Du(o){var l=Mi(18,null,null,0);return l.stateNode=o,l}function xd(o,l,h){return l=Mi(4,o.children!==null?o.children:[],o.key,l),l.lanes=h,l.stateNode={containerInfo:o.containerInfo,pendingChildren:null,implementation:o.implementation},l}var Wc=new WeakMap;function xs(o,l){if(typeof o=="object"&&o!==null){var h=Wc.get(o);return h!==void 0?h:(l={value:o,source:l,stack:j(l)},Wc.set(o,l),l)}return{value:o,source:l,stack:j(l)}}var qa=[],Wa=0,Uu=null,Pu=0,ns=[],_i=0,ua=null,Ei=1,lo="";function Uo(o,l){qa[Wa++]=Pu,qa[Wa++]=Uu,Uu=o,Pu=l}function w0(o,l,h){ns[_i++]=Ei,ns[_i++]=lo,ns[_i++]=ua,ua=o;var g=Ei;o=lo;var E=32-Tt(g)-1;g&=~(1<<E),h+=1;var w=32-Tt(l)+E;if(30<w){var F=E-E%5;w=(g&(1<<F)-1).toString(32),g>>=F,E-=F,Ei=1<<32-Tt(l)+E|h<<E|g,lo=w+o}else Ei=1<<w|h<<E|g,lo=o}function Po(o){o.return!==null&&(Uo(o,1),w0(o,1,0))}function Sd(o){for(;o===Uu;)Uu=qa[--Wa],qa[Wa]=null,Pu=qa[--Wa],qa[Wa]=null;for(;o===ua;)ua=ns[--_i],ns[_i]=null,lo=ns[--_i],ns[_i]=null,Ei=ns[--_i],ns[_i]=null}function bd(o,l){ns[_i++]=Ei,ns[_i++]=lo,ns[_i++]=ua,Ei=l.id,lo=l.overflow,ua=o}var Ui=null,ui=null,Fn=!1,ca=null,Ss=!1,Lu=Error(n(519));function Lo(o){var l=Error(n(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Fo(xs(l,o)),Lu}function C0(o){var l=o.stateNode,h=o.type,g=o.memoizedProps;switch(l[gi]=o,l[H]=g,h){case"dialog":zn("cancel",l),zn("close",l);break;case"iframe":case"object":case"embed":zn("load",l);break;case"video":case"audio":for(h=0;h<io.length;h++)zn(io[h],l);break;case"source":zn("error",l);break;case"img":case"image":case"link":zn("error",l),zn("load",l);break;case"details":zn("toggle",l);break;case"input":zn("invalid",l),er(l,g.value,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name,!0);break;case"select":zn("invalid",l);break;case"textarea":zn("invalid",l),tr(l,g.value,g.defaultValue,g.children)}h=g.children,typeof h!="string"&&typeof h!="number"&&typeof h!="bigint"||l.textContent===""+h||g.suppressHydrationWarning===!0||fT(l.textContent,h)?(g.popover!=null&&(zn("beforetoggle",l),zn("toggle",l)),g.onScroll!=null&&zn("scroll",l),g.onScrollEnd!=null&&zn("scrollend",l),g.onClick!=null&&(l.onclick=oa),l=!0):l=!1,l||Lo(o,!0)}function R0(o){for(Ui=o.return;Ui;)switch(Ui.tag){case 5:case 31:case 13:Ss=!1;return;case 27:case 3:Ss=!0;return;default:Ui=Ui.return}}function Fu(o){if(o!==Ui)return!1;if(!Fn)return R0(o),Fn=!0,!1;var l=o.tag,h;if((h=l!==3&&l!==27)&&((h=l===5)&&(h=o.type,h=!(h!=="form"&&h!=="button")||vS(o.type,o.memoizedProps)),h=!h),h&&ui&&Lo(o),R0(o),l===13){if(o=o.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(n(317));ui=xT(o)}else if(l===31){if(o=o.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(n(317));ui=xT(o)}else l===27?(l=ui,nc(o.type)?(o=bS,bS=null,ui=o):ui=l):ui=Ui?$o(o.stateNode.nextSibling):null;return!0}function Xa(){ui=Ui=null,Fn=!1}function Md(){var o=ca;return o!==null&&(Li===null?Li=o:Li.push.apply(Li,o),ca=null),o}function Fo(o){ca===null?ca=[o]:ca.push(o)}var ku=$(null),Ya=null,ko=null;function fa(o,l,h){Ee(ku,l._currentValue),l._currentValue=h}function Oo(o){o._currentValue=ku.current,ce(ku)}function Ed(o,l,h){for(;o!==null;){var g=o.alternate;if((o.childLanes&l)!==l?(o.childLanes|=l,g!==null&&(g.childLanes|=l)):g!==null&&(g.childLanes&l)!==l&&(g.childLanes|=l),o===h)break;o=o.return}}function Td(o,l,h,g){var E=o.child;for(E!==null&&(E.return=o);E!==null;){var w=E.dependencies;if(w!==null){var F=E.child;w=w.firstContext;e:for(;w!==null;){var X=w;w=E;for(var se=0;se<l.length;se++)if(X.context===l[se]){w.lanes|=h,X=w.alternate,X!==null&&(X.lanes|=h),Ed(w.return,h,o),g||(F=null);break e}w=X.next}}else if(E.tag===18){if(F=E.return,F===null)throw Error(n(341));F.lanes|=h,w=F.alternate,w!==null&&(w.lanes|=h),Ed(F,h,o),F=null}else F=E.child;if(F!==null)F.return=E;else for(F=E;F!==null;){if(F===o){F=null;break}if(E=F.sibling,E!==null){E.return=F.return,F=E;break}F=F.return}E=F}}function zo(o,l,h,g){o=null;for(var E=l,w=!1;E!==null;){if(!w){if((E.flags&524288)!==0)w=!0;else if((E.flags&262144)!==0)break}if(E.tag===10){var F=E.alternate;if(F===null)throw Error(n(387));if(F=F.memoizedProps,F!==null){var X=E.type;Hr(E.pendingProps.value,F.value)||(o!==null?o.push(X):o=[X])}}else if(E===Re.current){if(F=E.alternate,F===null)throw Error(n(387));F.memoizedState.memoizedState!==E.memoizedState.memoizedState&&(o!==null?o.push(Im):o=[Im])}E=E.return}o!==null&&Td(l,o,h,g),l.flags|=262144}function Xc(o){for(o=o.firstContext;o!==null;){if(!Hr(o.context._currentValue,o.memoizedValue))return!0;o=o.next}return!1}function Ja(o){Ya=o,ko=null,o=o.dependencies,o!==null&&(o.firstContext=null)}function sn(o){return I0(Ya,o)}function Ou(o,l){return Ya===null&&Ja(o),I0(o,l)}function I0(o,l){var h=l._currentValue;if(l={context:l,memoizedValue:h,next:null},ko===null){if(o===null)throw Error(n(308));ko=l,o.dependencies={lanes:0,firstContext:l},o.flags|=524288}else ko=ko.next=l;return h}var N0=typeof AbortController<"u"?AbortController:function(){var o=[],l=this.signal={aborted:!1,addEventListener:function(h,g){o.push(g)}};this.abort=function(){l.aborted=!0,o.forEach(function(h){return h()})}},nS=i.unstable_scheduleCallback,iS=i.unstable_NormalPriority,Yi={$$typeof:U,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Pp(){return{controller:new N0,data:new Map,refCount:0}}function Ll(o){o.refCount--,o.refCount===0&&nS(iS,function(){o.controller.abort()})}var bs=null,Ad=0,da=0,Ws=null;function Lp(o,l){if(bs===null){var h=bs=[];Ad=0,da=Ie(),Ws={status:"pending",value:void 0,then:function(g){h.push(g)}}}return Ad++,l.then(Fp,Fp),l}function Fp(){if(--Ad===0&&bs!==null){Ws!==null&&(Ws.status="fulfilled");var o=bs;bs=null,da=0,Ws=null;for(var l=0;l<o.length;l++)(0,o[l])()}}function kp(o,l){var h=[],g={status:"pending",value:null,reason:null,then:function(E){h.push(E)}};return o.then(function(){g.status="fulfilled",g.value=l;for(var E=0;E<h.length;E++)(0,h[E])(l)},function(E){for(g.status="rejected",g.reason=E,E=0;E<h.length;E++)(0,h[E])(void 0)}),g}var D0=J.S;J.S=function(o,l){Em=V(),typeof l=="object"&&l!==null&&typeof l.then=="function"&&Lp(o,l),D0!==null&&D0(o,l)};var Za=$(null);function wd(){var o=Za.current;return o!==null?o:ln.pooledCache}function Yc(o,l){l===null?Ee(Za,Za.current):Ee(Za,l.pool)}function Op(){var o=wd();return o===null?null:{parent:Yi._currentValue,pool:o}}var Fl=Error(n(460)),Jc=Error(n(474)),Sn=Error(n(542)),Cd={then:function(){}};function is(o){return o=o.status,o==="fulfilled"||o==="rejected"}function Rd(o,l,h){switch(h=o[h],h===void 0?o.push(l):h!==l&&(l.then(oa,oa),l=h),l.status){case"fulfilled":return l.value;case"rejected":throw o=l.reason,zl(o),o;default:if(typeof l.status=="string")l.then(oa,oa);else{if(o=ln,o!==null&&100<o.shellSuspendCounter)throw Error(n(482));o=l,o.status="pending",o.then(function(g){if(l.status==="pending"){var E=l;E.status="fulfilled",E.value=g}},function(g){if(l.status==="pending"){var E=l;E.status="rejected",E.reason=g}})}switch(l.status){case"fulfilled":return l.value;case"rejected":throw o=l.reason,zl(o),o}throw Bo=l,Fl}}function kl(o){try{var l=o._init;return l(o._payload)}catch(h){throw h!==null&&typeof h=="object"&&typeof h.then=="function"?(Bo=h,Fl):h}}var Bo=null;function Ol(){if(Bo===null)throw Error(n(459));var o=Bo;return Bo=null,o}function zl(o){if(o===Fl||o===Sn)throw Error(n(483))}var Bl=null,Vl=0;function Zc(o){var l=Vl;return Vl+=1,Bl===null&&(Bl=[]),Rd(Bl,o,l)}function Xs(o,l){l=l.props.ref,o.ref=l!==void 0?l:null}function zu(o,l){throw l.$$typeof===_?Error(n(525)):(o=Object.prototype.toString.call(l),Error(n(31,o==="[object Object]"?"object with keys {"+Object.keys(l).join(", ")+"}":o)))}function Id(o){function l(_e,fe){if(o){var be=_e.deletions;be===null?(_e.deletions=[fe],_e.flags|=16):be.push(fe)}}function h(_e,fe){if(!o)return null;for(;fe!==null;)l(_e,fe),fe=fe.sibling;return null}function g(_e){for(var fe=new Map;_e!==null;)_e.key!==null?fe.set(_e.key,_e):fe.set(_e.index,_e),_e=_e.sibling;return fe}function E(_e,fe){return _e=ts(_e,fe),_e.index=0,_e.sibling=null,_e}function w(_e,fe,be){return _e.index=be,o?(be=_e.alternate,be!==null?(be=be.index,be<fe?(_e.flags|=67108866,fe):be):(_e.flags|=67108866,fe)):(_e.flags|=1048576,fe)}function F(_e){return o&&_e.alternate===null&&(_e.flags|=67108866),_e}function X(_e,fe,be,Ye){return fe===null||fe.tag!==6?(fe=_d(be,_e.mode,Ye),fe.return=_e,fe):(fe=E(fe,be),fe.return=_e,fe)}function se(_e,fe,be,Ye){var Qt=be.type;return Qt===I?ze(_e,fe,be.props.children,Ye,be.key):fe!==null&&(fe.elementType===Qt||typeof Qt=="object"&&Qt!==null&&Qt.$$typeof===G&&kl(Qt)===fe.type)?(fe=E(fe,be.props),Xs(fe,be),fe.return=_e,fe):(fe=Do(be.type,be.key,be.props,null,_e.mode,Ye),Xs(fe,be),fe.return=_e,fe)}function Me(_e,fe,be,Ye){return fe===null||fe.tag!==4||fe.stateNode.containerInfo!==be.containerInfo||fe.stateNode.implementation!==be.implementation?(fe=xd(be,_e.mode,Ye),fe.return=_e,fe):(fe=E(fe,be.children||[]),fe.return=_e,fe)}function ze(_e,fe,be,Ye,Qt){return fe===null||fe.tag!==7?(fe=Ga(be,_e.mode,Ye,Qt),fe.return=_e,fe):(fe=E(fe,be),fe.return=_e,fe)}function Je(_e,fe,be){if(typeof fe=="string"&&fe!==""||typeof fe=="number"||typeof fe=="bigint")return fe=_d(""+fe,_e.mode,be),fe.return=_e,fe;if(typeof fe=="object"&&fe!==null){switch(fe.$$typeof){case b:return be=Do(fe.type,fe.key,fe.props,null,_e.mode,be),Xs(be,fe),be.return=_e,be;case T:return fe=xd(fe,_e.mode,be),fe.return=_e,fe;case G:return fe=kl(fe),Je(_e,fe,be)}if(de(fe)||ie(fe))return fe=Ga(fe,_e.mode,be,null),fe.return=_e,fe;if(typeof fe.then=="function")return Je(_e,Zc(fe),be);if(fe.$$typeof===U)return Je(_e,Ou(_e,fe),be);zu(_e,fe)}return null}function Ae(_e,fe,be,Ye){var Qt=fe!==null?fe.key:null;if(typeof be=="string"&&be!==""||typeof be=="number"||typeof be=="bigint")return Qt!==null?null:X(_e,fe,""+be,Ye);if(typeof be=="object"&&be!==null){switch(be.$$typeof){case b:return be.key===Qt?se(_e,fe,be,Ye):null;case T:return be.key===Qt?Me(_e,fe,be,Ye):null;case G:return be=kl(be),Ae(_e,fe,be,Ye)}if(de(be)||ie(be))return Qt!==null?null:ze(_e,fe,be,Ye,null);if(typeof be.then=="function")return Ae(_e,fe,Zc(be),Ye);if(be.$$typeof===U)return Ae(_e,fe,Ou(_e,be),Ye);zu(_e,be)}return null}function Fe(_e,fe,be,Ye,Qt){if(typeof Ye=="string"&&Ye!==""||typeof Ye=="number"||typeof Ye=="bigint")return _e=_e.get(be)||null,X(fe,_e,""+Ye,Qt);if(typeof Ye=="object"&&Ye!==null){switch(Ye.$$typeof){case b:return _e=_e.get(Ye.key===null?be:Ye.key)||null,se(fe,_e,Ye,Qt);case T:return _e=_e.get(Ye.key===null?be:Ye.key)||null,Me(fe,_e,Ye,Qt);case G:return Ye=kl(Ye),Fe(_e,fe,be,Ye,Qt)}if(de(Ye)||ie(Ye))return _e=_e.get(be)||null,ze(fe,_e,Ye,Qt,null);if(typeof Ye.then=="function")return Fe(_e,fe,be,Zc(Ye),Qt);if(Ye.$$typeof===U)return Fe(_e,fe,be,Ou(fe,Ye),Qt);zu(fe,Ye)}return null}function Vt(_e,fe,be,Ye){for(var Qt=null,Qn=null,Wt=fe,wn=fe=0,Hn=null;Wt!==null&&wn<be.length;wn++){Wt.index>wn?(Hn=Wt,Wt=null):Hn=Wt.sibling;var jn=Ae(_e,Wt,be[wn],Ye);if(jn===null){Wt===null&&(Wt=Hn);break}o&&Wt&&jn.alternate===null&&l(_e,Wt),fe=w(jn,fe,wn),Qn===null?Qt=jn:Qn.sibling=jn,Qn=jn,Wt=Hn}if(wn===be.length)return h(_e,Wt),Fn&&Uo(_e,wn),Qt;if(Wt===null){for(;wn<be.length;wn++)Wt=Je(_e,be[wn],Ye),Wt!==null&&(fe=w(Wt,fe,wn),Qn===null?Qt=Wt:Qn.sibling=Wt,Qn=Wt);return Fn&&Uo(_e,wn),Qt}for(Wt=g(Wt);wn<be.length;wn++)Hn=Fe(Wt,_e,wn,be[wn],Ye),Hn!==null&&(o&&Hn.alternate!==null&&Wt.delete(Hn.key===null?wn:Hn.key),fe=w(Hn,fe,wn),Qn===null?Qt=Hn:Qn.sibling=Hn,Qn=Hn);return o&&Wt.forEach(function(ac){return l(_e,ac)}),Fn&&Uo(_e,wn),Qt}function rn(_e,fe,be,Ye){if(be==null)throw Error(n(151));for(var Qt=null,Qn=null,Wt=fe,wn=fe=0,Hn=null,jn=be.next();Wt!==null&&!jn.done;wn++,jn=be.next()){Wt.index>wn?(Hn=Wt,Wt=null):Hn=Wt.sibling;var ac=Ae(_e,Wt,jn.value,Ye);if(ac===null){Wt===null&&(Wt=Hn);break}o&&Wt&&ac.alternate===null&&l(_e,Wt),fe=w(ac,fe,wn),Qn===null?Qt=ac:Qn.sibling=ac,Qn=ac,Wt=Hn}if(jn.done)return h(_e,Wt),Fn&&Uo(_e,wn),Qt;if(Wt===null){for(;!jn.done;wn++,jn=be.next())jn=Je(_e,jn.value,Ye),jn!==null&&(fe=w(jn,fe,wn),Qn===null?Qt=jn:Qn.sibling=jn,Qn=jn);return Fn&&Uo(_e,wn),Qt}for(Wt=g(Wt);!jn.done;wn++,jn=be.next())jn=Fe(Wt,_e,wn,jn.value,Ye),jn!==null&&(o&&jn.alternate!==null&&Wt.delete(jn.key===null?wn:jn.key),fe=w(jn,fe,wn),Qn===null?Qt=jn:Qn.sibling=jn,Qn=jn);return o&&Wt.forEach(function($N){return l(_e,$N)}),Fn&&Uo(_e,wn),Qt}function di(_e,fe,be,Ye){if(typeof be=="object"&&be!==null&&be.type===I&&be.key===null&&(be=be.props.children),typeof be=="object"&&be!==null){switch(be.$$typeof){case b:e:{for(var Qt=be.key;fe!==null;){if(fe.key===Qt){if(Qt=be.type,Qt===I){if(fe.tag===7){h(_e,fe.sibling),Ye=E(fe,be.props.children),Ye.return=_e,_e=Ye;break e}}else if(fe.elementType===Qt||typeof Qt=="object"&&Qt!==null&&Qt.$$typeof===G&&kl(Qt)===fe.type){h(_e,fe.sibling),Ye=E(fe,be.props),Xs(Ye,be),Ye.return=_e,_e=Ye;break e}h(_e,fe);break}else l(_e,fe);fe=fe.sibling}be.type===I?(Ye=Ga(be.props.children,_e.mode,Ye,be.key),Ye.return=_e,_e=Ye):(Ye=Do(be.type,be.key,be.props,null,_e.mode,Ye),Xs(Ye,be),Ye.return=_e,_e=Ye)}return F(_e);case T:e:{for(Qt=be.key;fe!==null;){if(fe.key===Qt)if(fe.tag===4&&fe.stateNode.containerInfo===be.containerInfo&&fe.stateNode.implementation===be.implementation){h(_e,fe.sibling),Ye=E(fe,be.children||[]),Ye.return=_e,_e=Ye;break e}else{h(_e,fe);break}else l(_e,fe);fe=fe.sibling}Ye=xd(be,_e.mode,Ye),Ye.return=_e,_e=Ye}return F(_e);case G:return be=kl(be),di(_e,fe,be,Ye)}if(de(be))return Vt(_e,fe,be,Ye);if(ie(be)){if(Qt=ie(be),typeof Qt!="function")throw Error(n(150));return be=Qt.call(be),rn(_e,fe,be,Ye)}if(typeof be.then=="function")return di(_e,fe,Zc(be),Ye);if(be.$$typeof===U)return di(_e,fe,Ou(_e,be),Ye);zu(_e,be)}return typeof be=="string"&&be!==""||typeof be=="number"||typeof be=="bigint"?(be=""+be,fe!==null&&fe.tag===6?(h(_e,fe.sibling),Ye=E(fe,be),Ye.return=_e,_e=Ye):(h(_e,fe),Ye=_d(be,_e.mode,Ye),Ye.return=_e,_e=Ye),F(_e)):h(_e,fe)}return function(_e,fe,be,Ye){try{Vl=0;var Qt=di(_e,fe,be,Ye);return Bl=null,Qt}catch(Wt){if(Wt===Fl||Wt===Sn)throw Wt;var Qn=Mi(29,Wt,null,_e.mode);return Qn.lanes=Ye,Qn.return=_e,Qn}finally{}}}var ha=Id(!0),Nd=Id(!1),qr=!1;function $c(o){o.updateQueue={baseState:o.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function zp(o,l){o=o.updateQueue,l.updateQueue===o&&(l.updateQueue={baseState:o.baseState,firstBaseUpdate:o.firstBaseUpdate,lastBaseUpdate:o.lastBaseUpdate,shared:o.shared,callbacks:null})}function pa(o){return{lane:o,tag:0,payload:null,callback:null,next:null}}function $a(o,l,h){var g=o.updateQueue;if(g===null)return null;if(g=g.shared,(Yt&2)!==0){var E=g.pending;return E===null?l.next=l:(l.next=E.next,E.next=l),g.pending=l,l=qs(o),Va(o,null,h),l}return hr(o,g,l,h),qs(o)}function Ka(o,l,h){if(l=l.updateQueue,l!==null&&(l=l.shared,(h&4194048)!==0)){var g=l.lanes;g&=o.pendingLanes,h|=g,l.lanes=h,Ao(o,h)}}function Kt(o,l){var h=o.updateQueue,g=o.alternate;if(g!==null&&(g=g.updateQueue,h===g)){var E=null,w=null;if(h=h.firstBaseUpdate,h!==null){do{var F={lane:h.lane,tag:h.tag,payload:h.payload,callback:null,next:null};w===null?E=w=F:w=w.next=F,h=h.next}while(h!==null);w===null?E=w=l:w=w.next=l}else E=w=l;h={baseState:g.baseState,firstBaseUpdate:E,lastBaseUpdate:w,shared:g.shared,callbacks:g.callbacks},o.updateQueue=h;return}o=h.lastBaseUpdate,o===null?h.firstBaseUpdate=l:o.next=l,h.lastBaseUpdate=l}var Bp=!1;function Kc(){if(Bp){var o=Ws;if(o!==null)throw o}}function Bu(o,l,h,g){Bp=!1;var E=o.updateQueue;qr=!1;var w=E.firstBaseUpdate,F=E.lastBaseUpdate,X=E.shared.pending;if(X!==null){E.shared.pending=null;var se=X,Me=se.next;se.next=null,F===null?w=Me:F.next=Me,F=se;var ze=o.alternate;ze!==null&&(ze=ze.updateQueue,X=ze.lastBaseUpdate,X!==F&&(X===null?ze.firstBaseUpdate=Me:X.next=Me,ze.lastBaseUpdate=se))}if(w!==null){var Je=E.baseState;F=0,ze=Me=se=null,X=w;do{var Ae=X.lane&-536870913,Fe=Ae!==X.lane;if(Fe?(_n&Ae)===Ae:(g&Ae)===Ae){Ae!==0&&Ae===da&&(Bp=!0),ze!==null&&(ze=ze.next={lane:0,tag:X.tag,payload:X.payload,callback:null,next:null});e:{var Vt=o,rn=X;Ae=l;var di=h;switch(rn.tag){case 1:if(Vt=rn.payload,typeof Vt=="function"){Je=Vt.call(di,Je,Ae);break e}Je=Vt;break e;case 3:Vt.flags=Vt.flags&-65537|128;case 0:if(Vt=rn.payload,Ae=typeof Vt=="function"?Vt.call(di,Je,Ae):Vt,Ae==null)break e;Je=v({},Je,Ae);break e;case 2:qr=!0}}Ae=X.callback,Ae!==null&&(o.flags|=64,Fe&&(o.flags|=8192),Fe=E.callbacks,Fe===null?E.callbacks=[Ae]:Fe.push(Ae))}else Fe={lane:Ae,tag:X.tag,payload:X.payload,callback:X.callback,next:null},ze===null?(Me=ze=Fe,se=Je):ze=ze.next=Fe,F|=Ae;if(X=X.next,X===null){if(X=E.shared.pending,X===null)break;Fe=X,X=Fe.next,Fe.next=null,E.lastBaseUpdate=Fe,E.shared.pending=null}}while(!0);ze===null&&(se=Je),E.baseState=se,E.firstBaseUpdate=Me,E.lastBaseUpdate=ze,w===null&&(E.shared.lanes=0),Yo|=F,o.lanes=F,o.memoizedState=Je}}function Vu(o,l){if(typeof o!="function")throw Error(n(191,o));o.call(l)}function U0(o,l){var h=o.callbacks;if(h!==null)for(o.callbacks=null,o=0;o<h.length;o++)Vu(h[o],l)}var Hu=$(null),Dd=$(0);function P0(o,l){o=As,Ee(Dd,o),Ee(Hu,l),As=o|l.baseLanes}function Vp(){Ee(Dd,As),Ee(Hu,Hu.current)}function Qc(){As=Dd.current,ce(Hu),ce(Dd)}var rs=$(null),Wr=null;function ma(o){var l=o.alternate;Ee(kn,kn.current&1),Ee(rs,o),Wr===null&&(l===null||Hu.current!==null||l.memoizedState!==null)&&(Wr=o)}function Hp(o){Ee(kn,kn.current),Ee(rs,o),Wr===null&&(Wr=o)}function L0(o){o.tag===22?(Ee(kn,kn.current),Ee(rs,o),Wr===null&&(Wr=o)):ss()}function ss(){Ee(kn,kn.current),Ee(rs,rs.current)}function Oi(o){ce(rs),Wr===o&&(Wr=null),ce(kn)}var kn=$(0);function Ms(o){for(var l=o;l!==null;){if(l.tag===13){var h=l.memoizedState;if(h!==null&&(h=h.dehydrated,h===null||xS(h)||SS(h)))return l}else if(l.tag===19&&(l.memoizedProps.revealOrder==="forwards"||l.memoizedProps.revealOrder==="backwards"||l.memoizedProps.revealOrder==="unstable_legacy-backwards"||l.memoizedProps.revealOrder==="together")){if((l.flags&128)!==0)return l}else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===o)break;for(;l.sibling===null;){if(l.return===null||l.return===o)return null;l=l.return}l.sibling.return=l.return,l=l.sibling}return null}var xi=0,pn=null,ri=null,Dn=null,Ys=!1,Gu=!1,Hl=!1,Ud=0,jc=0,qu=null,Gp=0;function Ti(){throw Error(n(321))}function qp(o,l){if(l===null)return!1;for(var h=0;h<l.length&&h<o.length;h++)if(!Hr(o[h],l[h]))return!1;return!0}function Pd(o,l,h,g,E,w){return xi=w,pn=l,l.memoizedState=null,l.updateQueue=null,l.lanes=0,J.H=o===null||o.memoizedState===null?hv:cm,Hl=!1,w=h(g,E),Hl=!1,Gu&&(w=Gl(l,h,g,E)),F0(o),w}function F0(o){J.H=Wu;var l=ri!==null&&ri.next!==null;if(xi=0,Dn=ri=pn=null,Ys=!1,jc=0,qu=null,l)throw Error(n(300));o===null||Ji||(o=o.dependencies,o!==null&&Xc(o)&&(Ji=!0))}function Gl(o,l,h,g){pn=o;var E=0;do{if(Gu&&(qu=null),jc=0,Gu=!1,25<=E)throw Error(n(301));if(E+=1,Dn=ri=null,o.updateQueue!=null){var w=o.updateQueue;w.lastEffect=null,w.events=null,w.stores=null,w.memoCache!=null&&(w.memoCache.index=0)}J.H=Js,w=l(h,g)}while(Gu);return w}function ql(){var o=J.H,l=o.useState()[0];return l=typeof l.then=="function"?ef(l):l,o=o.useState()[0],(ri!==null?ri.memoizedState:null)!==o&&(pn.flags|=1024),l}function Wp(){var o=Ud!==0;return Ud=0,o}function Xp(o,l,h){l.updateQueue=o.updateQueue,l.flags&=-2053,o.lanes&=~h}function Yp(o){if(Ys){for(o=o.memoizedState;o!==null;){var l=o.queue;l!==null&&(l.pending=null),o=o.next}Ys=!1}xi=0,Dn=ri=pn=null,Gu=!1,jc=Ud=0,qu=null}function nr(){var o={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Dn===null?pn.memoizedState=Dn=o:Dn=Dn.next=o,Dn}function zi(){if(ri===null){var o=pn.alternate;o=o!==null?o.memoizedState:null}else o=ri.next;var l=Dn===null?pn.memoizedState:Dn.next;if(l!==null)Dn=l,ri=o;else{if(o===null)throw pn.alternate===null?Error(n(467)):Error(n(310));ri=o,o={memoizedState:ri.memoizedState,baseState:ri.baseState,baseQueue:ri.baseQueue,queue:ri.queue,next:null},Dn===null?pn.memoizedState=Dn=o:Dn=Dn.next=o}return Dn}function Ld(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function ef(o){var l=jc;return jc+=1,qu===null&&(qu=[]),o=Rd(qu,o,l),l=pn,(Dn===null?l.memoizedState:Dn.next)===null&&(l=l.alternate,J.H=l===null||l.memoizedState===null?hv:cm),o}function Qa(o){if(o!==null&&typeof o=="object"){if(typeof o.then=="function")return ef(o);if(o.$$typeof===U)return sn(o)}throw Error(n(438,String(o)))}function Jp(o){var l=null,h=pn.updateQueue;if(h!==null&&(l=h.memoCache),l==null){var g=pn.alternate;g!==null&&(g=g.updateQueue,g!==null&&(g=g.memoCache,g!=null&&(l={data:g.data.map(function(E){return E.slice()}),index:0})))}if(l==null&&(l={data:[],index:0}),h===null&&(h=Ld(),pn.updateQueue=h),h.memoCache=l,h=l.data[l.index],h===void 0)for(h=l.data[l.index]=Array(o),g=0;g<o;g++)h[g]=O;return l.index++,h}function ga(o,l){return typeof l=="function"?l(o):l}function Fd(o){var l=zi();return Zp(l,ri,o)}function Zp(o,l,h){var g=o.queue;if(g===null)throw Error(n(311));g.lastRenderedReducer=h;var E=o.baseQueue,w=g.pending;if(w!==null){if(E!==null){var F=E.next;E.next=w.next,w.next=F}l.baseQueue=E=w,g.pending=null}if(w=o.baseState,E===null)o.memoizedState=w;else{l=E.next;var X=F=null,se=null,Me=l,ze=!1;do{var Je=Me.lane&-536870913;if(Je!==Me.lane?(_n&Je)===Je:(xi&Je)===Je){var Ae=Me.revertLane;if(Ae===0)se!==null&&(se=se.next={lane:0,revertLane:0,gesture:null,action:Me.action,hasEagerState:Me.hasEagerState,eagerState:Me.eagerState,next:null}),Je===da&&(ze=!0);else if((xi&Ae)===Ae){Me=Me.next,Ae===da&&(ze=!0);continue}else Je={lane:0,revertLane:Me.revertLane,gesture:null,action:Me.action,hasEagerState:Me.hasEagerState,eagerState:Me.eagerState,next:null},se===null?(X=se=Je,F=w):se=se.next=Je,pn.lanes|=Ae,Yo|=Ae;Je=Me.action,Hl&&h(w,Je),w=Me.hasEagerState?Me.eagerState:h(w,Je)}else Ae={lane:Je,revertLane:Me.revertLane,gesture:Me.gesture,action:Me.action,hasEagerState:Me.hasEagerState,eagerState:Me.eagerState,next:null},se===null?(X=se=Ae,F=w):se=se.next=Ae,pn.lanes|=Je,Yo|=Je;Me=Me.next}while(Me!==null&&Me!==l);if(se===null?F=w:se.next=X,!Hr(w,o.memoizedState)&&(Ji=!0,ze&&(h=Ws,h!==null)))throw h;o.memoizedState=w,o.baseState=F,o.baseQueue=se,g.lastRenderedState=w}return E===null&&(g.lanes=0),[o.memoizedState,g.dispatch]}function $p(o){var l=zi(),h=l.queue;if(h===null)throw Error(n(311));h.lastRenderedReducer=o;var g=h.dispatch,E=h.pending,w=l.memoizedState;if(E!==null){h.pending=null;var F=E=E.next;do w=o(w,F.action),F=F.next;while(F!==E);Hr(w,l.memoizedState)||(Ji=!0),l.memoizedState=w,l.baseQueue===null&&(l.baseState=w),h.lastRenderedState=w}return[w,g]}function k0(o,l,h){var g=pn,E=zi(),w=Fn;if(w){if(h===void 0)throw Error(n(407));h=h()}else h=l();var F=!Hr((ri||E).memoizedState,h);if(F&&(E.memoizedState=h,Ji=!0),E=E.queue,rm(B0.bind(null,g,E,o),[o]),E.getSnapshot!==l||F||Dn!==null&&Dn.memoizedState.tag&1){if(g.flags|=2048,ja(9,{destroy:void 0},z0.bind(null,g,E,h,l),null),ln===null)throw Error(n(349));w||(xi&127)!==0||O0(g,l,h)}return h}function O0(o,l,h){o.flags|=16384,o={getSnapshot:l,value:h},l=pn.updateQueue,l===null?(l=Ld(),pn.updateQueue=l,l.stores=[o]):(h=l.stores,h===null?l.stores=[o]:h.push(o))}function z0(o,l,h,g){l.value=h,l.getSnapshot=g,V0(l)&&H0(o)}function B0(o,l,h){return h(function(){V0(l)&&H0(o)})}function V0(o){var l=o.getSnapshot;o=o.value;try{var h=l();return!Hr(o,h)}catch{return!0}}function H0(o){var l=Gr(o,2);l!==null&&Mn(l,o,2)}function Kp(o){var l=nr();if(typeof o=="function"){var h=o;if(o=h(),Hl){Nt(!0);try{h()}finally{Nt(!1)}}}return l.memoizedState=l.baseState=o,l.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ga,lastRenderedState:o},l}function Qp(o,l,h,g){return o.baseState=h,Zp(o,ri,typeof g=="function"?g:ga)}function rS(o,l,h,g,E){if(Bd(o))throw Error(n(485));if(o=l.action,o!==null){var w={payload:E,action:o,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(F){w.listeners.push(F)}};J.T!==null?h(!0):w.isTransition=!1,g(w),h=l.pending,h===null?(w.next=l.pending=w,G0(l,w)):(w.next=h.next,l.pending=h.next=w)}}function G0(o,l){var h=l.action,g=l.payload,E=o.state;if(l.isTransition){var w=J.T,F={};J.T=F;try{var X=h(E,g),se=J.S;se!==null&&se(F,X),q0(o,l,X)}catch(Me){jp(o,l,Me)}finally{w!==null&&F.types!==null&&(w.types=F.types),J.T=w}}else try{w=h(E,g),q0(o,l,w)}catch(Me){jp(o,l,Me)}}function q0(o,l,h){h!==null&&typeof h=="object"&&typeof h.then=="function"?h.then(function(g){W0(o,l,g)},function(g){return jp(o,l,g)}):W0(o,l,h)}function W0(o,l,h){l.status="fulfilled",l.value=h,X0(l),o.state=h,l=o.pending,l!==null&&(h=l.next,h===l?o.pending=null:(h=h.next,l.next=h,G0(o,h)))}function jp(o,l,h){var g=o.pending;if(o.pending=null,g!==null){g=g.next;do l.status="rejected",l.reason=h,X0(l),l=l.next;while(l!==g)}o.action=null}function X0(o){o=o.listeners;for(var l=0;l<o.length;l++)(0,o[l])()}function em(o,l){return l}function tm(o,l){if(Fn){var h=ln.formState;if(h!==null){e:{var g=pn;if(Fn){if(ui){t:{for(var E=ui,w=Ss;E.nodeType!==8;){if(!w){E=null;break t}if(E=$o(E.nextSibling),E===null){E=null;break t}}w=E.data,E=w==="F!"||w==="F"?E:null}if(E){ui=$o(E.nextSibling),g=E.data==="F!";break e}}Lo(g)}g=!1}g&&(l=h[0])}}return h=nr(),h.memoizedState=h.baseState=l,g={pending:null,lanes:0,dispatch:null,lastRenderedReducer:em,lastRenderedState:l},h.queue=g,h=cv.bind(null,pn,g),g.dispatch=h,g=Kp(!1),w=um.bind(null,pn,!1,g.queue),g=nr(),E={state:l,dispatch:null,action:o,pending:null},g.queue=E,h=rS.bind(null,pn,E,w,h),E.dispatch=h,g.memoizedState=o,[l,h,!1]}function Y0(o){var l=zi();return nm(l,ri,o)}function nm(o,l,h){if(l=Zp(o,l,em)[0],o=Fd(ga)[0],typeof l=="object"&&l!==null&&typeof l.then=="function")try{var g=ef(l)}catch(F){throw F===Fl?Sn:F}else g=l;l=zi();var E=l.queue,w=E.dispatch;return h!==l.memoizedState&&(pn.flags|=2048,ja(9,{destroy:void 0},J0.bind(null,E,h),null)),[g,w,o]}function J0(o,l){o.action=l}function im(o){var l=zi(),h=ri;if(h!==null)return nm(l,h,o);zi(),l=l.memoizedState,h=zi();var g=h.queue.dispatch;return h.memoizedState=o,[l,g,!1]}function ja(o,l,h,g){return o={tag:o,create:h,deps:g,inst:l,next:null},l=pn.updateQueue,l===null&&(l=Ld(),pn.updateQueue=l),h=l.lastEffect,h===null?l.lastEffect=o.next=o:(g=h.next,h.next=o,o.next=g,l.lastEffect=o),o}function kd(){return zi().memoizedState}function Od(o,l,h,g){var E=nr();pn.flags|=o,E.memoizedState=ja(1|l,{destroy:void 0},h,g===void 0?null:g)}function zd(o,l,h,g){var E=zi();g=g===void 0?null:g;var w=E.memoizedState.inst;ri!==null&&g!==null&&qp(g,ri.memoizedState.deps)?E.memoizedState=ja(l,w,h,g):(pn.flags|=o,E.memoizedState=ja(1|l,w,h,g))}function Z0(o,l){Od(8390656,8,o,l)}function rm(o,l){zd(2048,8,o,l)}function $0(o){pn.flags|=4;var l=pn.updateQueue;if(l===null)l=Ld(),pn.updateQueue=l,l.events=[o];else{var h=l.events;h===null?l.events=[o]:h.push(o)}}function K0(o){var l=zi().memoizedState;return $0({ref:l,nextImpl:o}),function(){if((Yt&2)!==0)throw Error(n(440));return l.impl.apply(void 0,arguments)}}function Q0(o,l){return zd(4,2,o,l)}function j0(o,l){return zd(4,4,o,l)}function ev(o,l){if(typeof l=="function"){o=o();var h=l(o);return function(){typeof h=="function"?h():l(null)}}if(l!=null)return o=o(),l.current=o,function(){l.current=null}}function tv(o,l,h){h=h!=null?h.concat([o]):null,zd(4,4,ev.bind(null,l,o),h)}function sm(){}function nv(o,l){var h=zi();l=l===void 0?null:l;var g=h.memoizedState;return l!==null&&qp(l,g[1])?g[0]:(h.memoizedState=[o,l],o)}function iv(o,l){var h=zi();l=l===void 0?null:l;var g=h.memoizedState;if(l!==null&&qp(l,g[1]))return g[0];if(g=o(),Hl){Nt(!0);try{o()}finally{Nt(!1)}}return h.memoizedState=[g,l],g}function om(o,l,h){return h===void 0||(xi&1073741824)!==0&&(_n&261930)===0?o.memoizedState=l:(o.memoizedState=h,o=Rn(),pn.lanes|=o,Yo|=o,h)}function rv(o,l,h,g){return Hr(h,l)?h:Hu.current!==null?(o=om(o,h,g),Hr(o,l)||(Ji=!0),o):(xi&42)===0||(xi&1073741824)!==0&&(_n&261930)===0?(Ji=!0,o.memoizedState=h):(o=Rn(),pn.lanes|=o,Yo|=o,l)}function sv(o,l,h,g,E){var w=te.p;te.p=w!==0&&8>w?w:8;var F=J.T,X={};J.T=X,um(o,!1,l,h);try{var se=E(),Me=J.S;if(Me!==null&&Me(X,se),se!==null&&typeof se=="object"&&typeof se.then=="function"){var ze=kp(se,g);tf(o,l,ze,Cs(o))}else tf(o,l,g,Cs(o))}catch(Je){tf(o,l,{then:function(){},status:"rejected",reason:Je},Cs())}finally{te.p=w,F!==null&&X.types!==null&&(F.types=X.types),J.T=F}}function sS(){}function am(o,l,h,g){if(o.tag!==5)throw Error(n(476));var E=ov(o).queue;sv(o,E,l,ye,h===null?sS:function(){return av(o),h(g)})}function ov(o){var l=o.memoizedState;if(l!==null)return l;l={memoizedState:ye,baseState:ye,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ga,lastRenderedState:ye},next:null};var h={};return l.next={memoizedState:h,baseState:h,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ga,lastRenderedState:h},next:null},o.memoizedState=l,o=o.alternate,o!==null&&(o.memoizedState=l),l}function av(o){var l=ov(o);l.next===null&&(l=o.alternate.memoizedState),tf(o,l.next.queue,{},Cs())}function lm(){return sn(Im)}function lv(){return zi().memoizedState}function uv(){return zi().memoizedState}function oS(o){for(var l=o.return;l!==null;){switch(l.tag){case 24:case 3:var h=Cs();o=pa(h);var g=$a(l,o,h);g!==null&&(Mn(g,l,h),Ka(g,l,h)),l={cache:Pp()},o.payload=l;return}l=l.return}}function aS(o,l,h){var g=Cs();h={lane:g,revertLane:0,gesture:null,action:h,hasEagerState:!1,eagerState:null,next:null},Bd(o)?fv(l,h):(h=vd(o,l,h,g),h!==null&&(Mn(h,o,g),dv(h,l,g)))}function cv(o,l,h){var g=Cs();tf(o,l,h,g)}function tf(o,l,h,g){var E={lane:g,revertLane:0,gesture:null,action:h,hasEagerState:!1,eagerState:null,next:null};if(Bd(o))fv(l,E);else{var w=o.alternate;if(o.lanes===0&&(w===null||w.lanes===0)&&(w=l.lastRenderedReducer,w!==null))try{var F=l.lastRenderedState,X=w(F,h);if(E.hasEagerState=!0,E.eagerState=X,Hr(X,F))return hr(o,l,E,0),ln===null&&qc(),!1}catch{}finally{}if(h=vd(o,l,E,g),h!==null)return Mn(h,o,g),dv(h,l,g),!0}return!1}function um(o,l,h,g){if(g={lane:2,revertLane:Ie(),gesture:null,action:g,hasEagerState:!1,eagerState:null,next:null},Bd(o)){if(l)throw Error(n(479))}else l=vd(o,h,g,2),l!==null&&Mn(l,o,2)}function Bd(o){var l=o.alternate;return o===pn||l!==null&&l===pn}function fv(o,l){Gu=Ys=!0;var h=o.pending;h===null?l.next=l:(l.next=h.next,h.next=l),o.pending=l}function dv(o,l,h){if((h&4194048)!==0){var g=l.lanes;g&=o.pendingLanes,h|=g,l.lanes=h,Ao(o,h)}}var Wu={readContext:sn,use:Qa,useCallback:Ti,useContext:Ti,useEffect:Ti,useImperativeHandle:Ti,useLayoutEffect:Ti,useInsertionEffect:Ti,useMemo:Ti,useReducer:Ti,useRef:Ti,useState:Ti,useDebugValue:Ti,useDeferredValue:Ti,useTransition:Ti,useSyncExternalStore:Ti,useId:Ti,useHostTransitionStatus:Ti,useFormState:Ti,useActionState:Ti,useOptimistic:Ti,useMemoCache:Ti,useCacheRefresh:Ti};Wu.useEffectEvent=Ti;var hv={readContext:sn,use:Qa,useCallback:function(o,l){return nr().memoizedState=[o,l===void 0?null:l],o},useContext:sn,useEffect:Z0,useImperativeHandle:function(o,l,h){h=h!=null?h.concat([o]):null,Od(4194308,4,ev.bind(null,l,o),h)},useLayoutEffect:function(o,l){return Od(4194308,4,o,l)},useInsertionEffect:function(o,l){Od(4,2,o,l)},useMemo:function(o,l){var h=nr();l=l===void 0?null:l;var g=o();if(Hl){Nt(!0);try{o()}finally{Nt(!1)}}return h.memoizedState=[g,l],g},useReducer:function(o,l,h){var g=nr();if(h!==void 0){var E=h(l);if(Hl){Nt(!0);try{h(l)}finally{Nt(!1)}}}else E=l;return g.memoizedState=g.baseState=E,o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:o,lastRenderedState:E},g.queue=o,o=o.dispatch=aS.bind(null,pn,o),[g.memoizedState,o]},useRef:function(o){var l=nr();return o={current:o},l.memoizedState=o},useState:function(o){o=Kp(o);var l=o.queue,h=cv.bind(null,pn,l);return l.dispatch=h,[o.memoizedState,h]},useDebugValue:sm,useDeferredValue:function(o,l){var h=nr();return om(h,o,l)},useTransition:function(){var o=Kp(!1);return o=sv.bind(null,pn,o.queue,!0,!1),nr().memoizedState=o,[!1,o]},useSyncExternalStore:function(o,l,h){var g=pn,E=nr();if(Fn){if(h===void 0)throw Error(n(407));h=h()}else{if(h=l(),ln===null)throw Error(n(349));(_n&127)!==0||O0(g,l,h)}E.memoizedState=h;var w={value:h,getSnapshot:l};return E.queue=w,Z0(B0.bind(null,g,w,o),[o]),g.flags|=2048,ja(9,{destroy:void 0},z0.bind(null,g,w,h,l),null),h},useId:function(){var o=nr(),l=ln.identifierPrefix;if(Fn){var h=lo,g=Ei;h=(g&~(1<<32-Tt(g)-1)).toString(32)+h,l="_"+l+"R_"+h,h=Ud++,0<h&&(l+="H"+h.toString(32)),l+="_"}else h=Gp++,l="_"+l+"r_"+h.toString(32)+"_";return o.memoizedState=l},useHostTransitionStatus:lm,useFormState:tm,useActionState:tm,useOptimistic:function(o){var l=nr();l.memoizedState=l.baseState=o;var h={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return l.queue=h,l=um.bind(null,pn,!0,h),h.dispatch=l,[o,l]},useMemoCache:Jp,useCacheRefresh:function(){return nr().memoizedState=oS.bind(null,pn)},useEffectEvent:function(o){var l=nr(),h={impl:o};return l.memoizedState=h,function(){if((Yt&2)!==0)throw Error(n(440));return h.impl.apply(void 0,arguments)}}},cm={readContext:sn,use:Qa,useCallback:nv,useContext:sn,useEffect:rm,useImperativeHandle:tv,useInsertionEffect:Q0,useLayoutEffect:j0,useMemo:iv,useReducer:Fd,useRef:kd,useState:function(){return Fd(ga)},useDebugValue:sm,useDeferredValue:function(o,l){var h=zi();return rv(h,ri.memoizedState,o,l)},useTransition:function(){var o=Fd(ga)[0],l=zi().memoizedState;return[typeof o=="boolean"?o:ef(o),l]},useSyncExternalStore:k0,useId:lv,useHostTransitionStatus:lm,useFormState:Y0,useActionState:Y0,useOptimistic:function(o,l){var h=zi();return Qp(h,ri,o,l)},useMemoCache:Jp,useCacheRefresh:uv};cm.useEffectEvent=K0;var Js={readContext:sn,use:Qa,useCallback:nv,useContext:sn,useEffect:rm,useImperativeHandle:tv,useInsertionEffect:Q0,useLayoutEffect:j0,useMemo:iv,useReducer:$p,useRef:kd,useState:function(){return $p(ga)},useDebugValue:sm,useDeferredValue:function(o,l){var h=zi();return ri===null?om(h,o,l):rv(h,ri.memoizedState,o,l)},useTransition:function(){var o=$p(ga)[0],l=zi().memoizedState;return[typeof o=="boolean"?o:ef(o),l]},useSyncExternalStore:k0,useId:lv,useHostTransitionStatus:lm,useFormState:im,useActionState:im,useOptimistic:function(o,l){var h=zi();return ri!==null?Qp(h,ri,o,l):(h.baseState=o,[o,h.queue.dispatch])},useMemoCache:Jp,useCacheRefresh:uv};Js.useEffectEvent=K0;function Vd(o,l,h,g){l=o.memoizedState,h=h(g,l),h=h==null?l:v({},l,h),o.memoizedState=h,o.lanes===0&&(o.updateQueue.baseState=h)}var nf={enqueueSetState:function(o,l,h){o=o._reactInternals;var g=Cs(),E=pa(g);E.payload=l,h!=null&&(E.callback=h),l=$a(o,E,g),l!==null&&(Mn(l,o,g),Ka(l,o,g))},enqueueReplaceState:function(o,l,h){o=o._reactInternals;var g=Cs(),E=pa(g);E.tag=1,E.payload=l,h!=null&&(E.callback=h),l=$a(o,E,g),l!==null&&(Mn(l,o,g),Ka(l,o,g))},enqueueForceUpdate:function(o,l){o=o._reactInternals;var h=Cs(),g=pa(h);g.tag=2,l!=null&&(g.callback=l),l=$a(o,g,h),l!==null&&(Mn(l,o,h),Ka(l,o,h))}};function fm(o,l,h,g,E,w,F){return o=o.stateNode,typeof o.shouldComponentUpdate=="function"?o.shouldComponentUpdate(g,w,F):l.prototype&&l.prototype.isPureReactComponent?!wu(h,g)||!wu(E,w):!0}function dm(o,l,h,g){o=l.state,typeof l.componentWillReceiveProps=="function"&&l.componentWillReceiveProps(h,g),typeof l.UNSAFE_componentWillReceiveProps=="function"&&l.UNSAFE_componentWillReceiveProps(h,g),l.state!==o&&nf.enqueueReplaceState(l,l.state,null)}function el(o,l){var h=l;if("ref"in l){h={};for(var g in l)g!=="ref"&&(h[g]=l[g])}if(o=o.defaultProps){h===l&&(h=v({},h));for(var E in o)h[E]===void 0&&(h[E]=o[E])}return h}function pv(o){Gc(o)}function hm(o){console.error(o)}function pm(o){Gc(o)}function Hd(o,l){try{var h=o.onUncaughtError;h(l.value,{componentStack:l.stack})}catch(g){setTimeout(function(){throw g})}}function mv(o,l,h){try{var g=o.onCaughtError;g(h.value,{componentStack:h.stack,errorBoundary:l.tag===1?l.stateNode:null})}catch(E){setTimeout(function(){throw E})}}function mm(o,l,h){return h=pa(h),h.tag=3,h.payload={element:null},h.callback=function(){Hd(o,l)},h}function gm(o){return o=pa(o),o.tag=3,o}function gv(o,l,h,g){var E=h.type.getDerivedStateFromError;if(typeof E=="function"){var w=g.value;o.payload=function(){return E(w)},o.callback=function(){mv(l,h,g)}}var F=h.stateNode;F!==null&&typeof F.componentDidCatch=="function"&&(o.callback=function(){mv(l,h,g),typeof E!="function"&&(Hi===null?Hi=new Set([this]):Hi.add(this));var X=g.stack;this.componentDidCatch(g.value,{componentStack:X!==null?X:""})})}function ir(o,l,h,g,E){if(h.flags|=32768,g!==null&&typeof g=="object"&&typeof g.then=="function"){if(l=h.alternate,l!==null&&zo(l,h,E,!0),h=rs.current,h!==null){switch(h.tag){case 31:case 13:return Wr===null?Qu():h.alternate===null&&Ai===0&&(Ai=3),h.flags&=-257,h.flags|=65536,h.lanes=E,g===Cd?h.flags|=16384:(l=h.updateQueue,l===null?h.updateQueue=new Set([g]):l.add(g),mf(o,g,E)),!1;case 22:return h.flags|=65536,g===Cd?h.flags|=16384:(l=h.updateQueue,l===null?(l={transitions:null,markerInstances:null,retryQueue:new Set([g])},h.updateQueue=l):(h=l.retryQueue,h===null?l.retryQueue=new Set([g]):h.add(g)),mf(o,g,E)),!1}throw Error(n(435,h.tag))}return mf(o,g,E),Qu(),!1}if(Fn)return l=rs.current,l!==null?((l.flags&65536)===0&&(l.flags|=256),l.flags|=65536,l.lanes=E,g!==Lu&&(o=Error(n(422),{cause:g}),Fo(xs(o,h)))):(g!==Lu&&(l=Error(n(423),{cause:g}),Fo(xs(l,h))),o=o.current.alternate,o.flags|=65536,E&=-E,o.lanes|=E,g=xs(g,h),E=mm(o.stateNode,g,E),Kt(o,E),Ai!==4&&(Ai=2)),!1;var w=Error(n(520),{cause:g});if(w=xs(w,h),Ql===null?Ql=[w]:Ql.push(w),Ai!==4&&(Ai=2),l===null)return!0;g=xs(g,h),h=l;do{switch(h.tag){case 3:return h.flags|=65536,o=E&-E,h.lanes|=o,o=mm(h.stateNode,g,o),Kt(h,o),!1;case 1:if(l=h.type,w=h.stateNode,(h.flags&128)===0&&(typeof l.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(Hi===null||!Hi.has(w))))return h.flags|=65536,E&=-E,h.lanes|=E,E=gm(E),gv(E,o,h,g),Kt(h,E),!1}h=h.return}while(h!==null);return!1}var Gd=Error(n(461)),Ji=!1;function pr(o,l,h,g){l.child=o===null?Nd(l,null,h,g):ha(l,o.child,h,g)}function vm(o,l,h,g,E){h=h.render;var w=l.ref;if("ref"in g){var F={};for(var X in g)X!=="ref"&&(F[X]=g[X])}else F=g;return Ja(l),g=Pd(o,l,h,F,w,E),X=Wp(),o!==null&&!Ji?(Xp(o,l,E),Bi(o,l,E)):(Fn&&X&&Po(l),l.flags|=1,pr(o,l,g,E),l.child)}function Wl(o,l,h,g,E){if(o===null){var w=h.type;return typeof w=="function"&&!yd(w)&&w.defaultProps===void 0&&h.compare===null?(l.tag=15,l.type=w,qd(o,l,w,g,E)):(o=Do(h.type,null,g,l,l.mode,E),o.ref=l.ref,o.return=l,l.child=o)}if(w=o.child,!$d(o,E)){var F=w.memoizedProps;if(h=h.compare,h=h!==null?h:wu,h(F,g)&&o.ref===l.ref)return Bi(o,l,E)}return l.flags|=1,o=ts(w,g),o.ref=l.ref,o.return=l,l.child=o}function qd(o,l,h,g,E){if(o!==null){var w=o.memoizedProps;if(wu(w,g)&&o.ref===l.ref)if(Ji=!1,l.pendingProps=g=w,$d(o,E))(o.flags&131072)!==0&&(Ji=!0);else return l.lanes=o.lanes,Bi(o,l,E)}return Xu(o,l,h,g,E)}function Xl(o,l,h,g){var E=g.children,w=o!==null?o.memoizedState:null;if(o===null&&l.stateNode===null&&(l.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),g.mode==="hidden"){if((l.flags&128)!==0){if(w=w!==null?w.baseLanes|h:h,o!==null){for(g=l.child=o.child,E=0;g!==null;)E=E|g.lanes|g.childLanes,g=g.sibling;g=E&~w}else g=0,l.child=null;return os(o,l,w,h,g)}if((h&536870912)!==0)l.memoizedState={baseLanes:0,cachePool:null},o!==null&&Yc(l,w!==null?w.cachePool:null),w!==null?P0(l,w):Vp(),L0(l);else return g=l.lanes=536870912,os(o,l,w!==null?w.baseLanes|h:h,h,g)}else w!==null?(Yc(l,w.cachePool),P0(l,w),ss(),l.memoizedState=null):(o!==null&&Yc(l,null),Vp(),ss());return pr(o,l,E,h),l.child}function Vo(o,l){return o!==null&&o.tag===22||l.stateNode!==null||(l.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),l.sibling}function os(o,l,h,g,E){var w=wd();return w=w===null?null:{parent:Yi._currentValue,pool:w},l.memoizedState={baseLanes:h,cachePool:w},o!==null&&Yc(l,null),Vp(),L0(l),o!==null&&zo(o,l,g,!0),l.childLanes=E,null}function Wd(o,l){return l=Zd({mode:l.mode,children:l.children},o.mode),l.ref=o.ref,o.child=l,l.return=o,l}function vv(o,l,h){return ha(l,o.child,null,h),o=Wd(l,l.pendingProps),o.flags|=2,Oi(l),l.memoizedState=null,o}function Xd(o,l,h){var g=l.pendingProps,E=(l.flags&128)!==0;if(l.flags&=-129,o===null){if(Fn){if(g.mode==="hidden")return o=Wd(l,g),l.lanes=536870912,Vo(null,o);if(Hp(l),(o=ui)?(o=_T(o,Ss),o=o!==null&&o.data==="&"?o:null,o!==null&&(l.memoizedState={dehydrated:o,treeContext:ua!==null?{id:Ei,overflow:lo}:null,retryLane:536870912,hydrationErrors:null},h=Du(o),h.return=l,l.child=h,Ui=l,ui=null)):o=null,o===null)throw Lo(l);return l.lanes=536870912,null}return Wd(l,g)}var w=o.memoizedState;if(w!==null){var F=w.dehydrated;if(Hp(l),E)if(l.flags&256)l.flags&=-257,l=vv(o,l,h);else if(l.memoizedState!==null)l.child=o.child,l.flags|=128,l=null;else throw Error(n(558));else if(Ji||zo(o,l,h,!1),E=(h&o.childLanes)!==0,Ji||E){if(g=ln,g!==null&&(F=Os(g,h),F!==0&&F!==w.retryLane))throw w.retryLane=F,Gr(o,F),Mn(g,o,F),Gd;Qu(),l=vv(o,l,h)}else o=w.treeContext,ui=$o(F.nextSibling),Ui=l,Fn=!0,ca=null,Ss=!1,o!==null&&bd(l,o),l=Wd(l,g),l.flags|=4096;return l}return o=ts(o.child,{mode:g.mode,children:g.children}),o.ref=l.ref,l.child=o,o.return=l,o}function Yl(o,l){var h=l.ref;if(h===null)o!==null&&o.ref!==null&&(l.flags|=4194816);else{if(typeof h!="function"&&typeof h!="object")throw Error(n(284));(o===null||o.ref!==h)&&(l.flags|=4194816)}}function Xu(o,l,h,g,E){return Ja(l),h=Pd(o,l,h,g,void 0,E),g=Wp(),o!==null&&!Ji?(Xp(o,l,E),Bi(o,l,E)):(Fn&&g&&Po(l),l.flags|=1,pr(o,l,h,E),l.child)}function rf(o,l,h,g,E,w){return Ja(l),l.updateQueue=null,h=Gl(l,g,h,E),F0(o),g=Wp(),o!==null&&!Ji?(Xp(o,l,w),Bi(o,l,w)):(Fn&&g&&Po(l),l.flags|=1,pr(o,l,h,w),l.child)}function Yd(o,l,h,g,E){if(Ja(l),l.stateNode===null){var w=Ha,F=h.contextType;typeof F=="object"&&F!==null&&(w=sn(F)),w=new h(g,w),l.memoizedState=w.state!==null&&w.state!==void 0?w.state:null,w.updater=nf,l.stateNode=w,w._reactInternals=l,w=l.stateNode,w.props=g,w.state=l.memoizedState,w.refs={},$c(l),F=h.contextType,w.context=typeof F=="object"&&F!==null?sn(F):Ha,w.state=l.memoizedState,F=h.getDerivedStateFromProps,typeof F=="function"&&(Vd(l,h,F,g),w.state=l.memoizedState),typeof h.getDerivedStateFromProps=="function"||typeof w.getSnapshotBeforeUpdate=="function"||typeof w.UNSAFE_componentWillMount!="function"&&typeof w.componentWillMount!="function"||(F=w.state,typeof w.componentWillMount=="function"&&w.componentWillMount(),typeof w.UNSAFE_componentWillMount=="function"&&w.UNSAFE_componentWillMount(),F!==w.state&&nf.enqueueReplaceState(w,w.state,null),Bu(l,g,w,E),Kc(),w.state=l.memoizedState),typeof w.componentDidMount=="function"&&(l.flags|=4194308),g=!0}else if(o===null){w=l.stateNode;var X=l.memoizedProps,se=el(h,X);w.props=se;var Me=w.context,ze=h.contextType;F=Ha,typeof ze=="object"&&ze!==null&&(F=sn(ze));var Je=h.getDerivedStateFromProps;ze=typeof Je=="function"||typeof w.getSnapshotBeforeUpdate=="function",X=l.pendingProps!==X,ze||typeof w.UNSAFE_componentWillReceiveProps!="function"&&typeof w.componentWillReceiveProps!="function"||(X||Me!==F)&&dm(l,w,g,F),qr=!1;var Ae=l.memoizedState;w.state=Ae,Bu(l,g,w,E),Kc(),Me=l.memoizedState,X||Ae!==Me||qr?(typeof Je=="function"&&(Vd(l,h,Je,g),Me=l.memoizedState),(se=qr||fm(l,h,se,g,Ae,Me,F))?(ze||typeof w.UNSAFE_componentWillMount!="function"&&typeof w.componentWillMount!="function"||(typeof w.componentWillMount=="function"&&w.componentWillMount(),typeof w.UNSAFE_componentWillMount=="function"&&w.UNSAFE_componentWillMount()),typeof w.componentDidMount=="function"&&(l.flags|=4194308)):(typeof w.componentDidMount=="function"&&(l.flags|=4194308),l.memoizedProps=g,l.memoizedState=Me),w.props=g,w.state=Me,w.context=F,g=se):(typeof w.componentDidMount=="function"&&(l.flags|=4194308),g=!1)}else{w=l.stateNode,zp(o,l),F=l.memoizedProps,ze=el(h,F),w.props=ze,Je=l.pendingProps,Ae=w.context,Me=h.contextType,se=Ha,typeof Me=="object"&&Me!==null&&(se=sn(Me)),X=h.getDerivedStateFromProps,(Me=typeof X=="function"||typeof w.getSnapshotBeforeUpdate=="function")||typeof w.UNSAFE_componentWillReceiveProps!="function"&&typeof w.componentWillReceiveProps!="function"||(F!==Je||Ae!==se)&&dm(l,w,g,se),qr=!1,Ae=l.memoizedState,w.state=Ae,Bu(l,g,w,E),Kc();var Fe=l.memoizedState;F!==Je||Ae!==Fe||qr||o!==null&&o.dependencies!==null&&Xc(o.dependencies)?(typeof X=="function"&&(Vd(l,h,X,g),Fe=l.memoizedState),(ze=qr||fm(l,h,ze,g,Ae,Fe,se)||o!==null&&o.dependencies!==null&&Xc(o.dependencies))?(Me||typeof w.UNSAFE_componentWillUpdate!="function"&&typeof w.componentWillUpdate!="function"||(typeof w.componentWillUpdate=="function"&&w.componentWillUpdate(g,Fe,se),typeof w.UNSAFE_componentWillUpdate=="function"&&w.UNSAFE_componentWillUpdate(g,Fe,se)),typeof w.componentDidUpdate=="function"&&(l.flags|=4),typeof w.getSnapshotBeforeUpdate=="function"&&(l.flags|=1024)):(typeof w.componentDidUpdate!="function"||F===o.memoizedProps&&Ae===o.memoizedState||(l.flags|=4),typeof w.getSnapshotBeforeUpdate!="function"||F===o.memoizedProps&&Ae===o.memoizedState||(l.flags|=1024),l.memoizedProps=g,l.memoizedState=Fe),w.props=g,w.state=Fe,w.context=se,g=ze):(typeof w.componentDidUpdate!="function"||F===o.memoizedProps&&Ae===o.memoizedState||(l.flags|=4),typeof w.getSnapshotBeforeUpdate!="function"||F===o.memoizedProps&&Ae===o.memoizedState||(l.flags|=1024),g=!1)}return w=g,Yl(o,l),g=(l.flags&128)!==0,w||g?(w=l.stateNode,h=g&&typeof h.getDerivedStateFromError!="function"?null:w.render(),l.flags|=1,o!==null&&g?(l.child=ha(l,o.child,null,E),l.child=ha(l,null,h,E)):pr(o,l,h,E),l.memoizedState=w.state,o=l.child):o=Bi(o,l,E),o}function yv(o,l,h,g){return Xa(),l.flags|=256,pr(o,l,h,g),l.child}var ym={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Dr(o){return{baseLanes:o,cachePool:Op()}}function Jd(o,l,h){return o=o!==null?o.childLanes&~h:0,l&&(o|=Jr),o}function _v(o,l,h){var g=l.pendingProps,E=!1,w=(l.flags&128)!==0,F;if((F=w)||(F=o!==null&&o.memoizedState===null?!1:(kn.current&2)!==0),F&&(E=!0,l.flags&=-129),F=(l.flags&32)!==0,l.flags&=-33,o===null){if(Fn){if(E?ma(l):ss(),(o=ui)?(o=_T(o,Ss),o=o!==null&&o.data!=="&"?o:null,o!==null&&(l.memoizedState={dehydrated:o,treeContext:ua!==null?{id:Ei,overflow:lo}:null,retryLane:536870912,hydrationErrors:null},h=Du(o),h.return=l,l.child=h,Ui=l,ui=null)):o=null,o===null)throw Lo(l);return SS(o)?l.lanes=32:l.lanes=536870912,null}var X=g.children;return g=g.fallback,E?(ss(),E=l.mode,X=Zd({mode:"hidden",children:X},E),g=Ga(g,E,h,null),X.return=l,g.return=l,X.sibling=g,l.child=X,g=l.child,g.memoizedState=Dr(h),g.childLanes=Jd(o,F,h),l.memoizedState=ym,Vo(null,g)):(ma(l),sf(l,X))}var se=o.memoizedState;if(se!==null&&(X=se.dehydrated,X!==null)){if(w)l.flags&256?(ma(l),l.flags&=-257,l=_m(o,l,h)):l.memoizedState!==null?(ss(),l.child=o.child,l.flags|=128,l=null):(ss(),X=g.fallback,E=l.mode,g=Zd({mode:"visible",children:g.children},E),X=Ga(X,E,h,null),X.flags|=2,g.return=l,X.return=l,g.sibling=X,l.child=g,ha(l,o.child,null,h),g=l.child,g.memoizedState=Dr(h),g.childLanes=Jd(o,F,h),l.memoizedState=ym,l=Vo(null,g));else if(ma(l),SS(X)){if(F=X.nextSibling&&X.nextSibling.dataset,F)var Me=F.dgst;F=Me,g=Error(n(419)),g.stack="",g.digest=F,Fo({value:g,source:null,stack:null}),l=_m(o,l,h)}else if(Ji||zo(o,l,h,!1),F=(h&o.childLanes)!==0,Ji||F){if(F=ln,F!==null&&(g=Os(F,h),g!==0&&g!==se.retryLane))throw se.retryLane=g,Gr(o,g),Mn(F,o,g),Gd;xS(X)||Qu(),l=_m(o,l,h)}else xS(X)?(l.flags|=192,l.child=o.child,l=null):(o=se.treeContext,ui=$o(X.nextSibling),Ui=l,Fn=!0,ca=null,Ss=!1,o!==null&&bd(l,o),l=sf(l,g.children),l.flags|=4096);return l}return E?(ss(),X=g.fallback,E=l.mode,se=o.child,Me=se.sibling,g=ts(se,{mode:"hidden",children:g.children}),g.subtreeFlags=se.subtreeFlags&65011712,Me!==null?X=ts(Me,X):(X=Ga(X,E,h,null),X.flags|=2),X.return=l,g.return=l,g.sibling=X,l.child=g,Vo(null,g),g=l.child,X=o.child.memoizedState,X===null?X=Dr(h):(E=X.cachePool,E!==null?(se=Yi._currentValue,E=E.parent!==se?{parent:se,pool:se}:E):E=Op(),X={baseLanes:X.baseLanes|h,cachePool:E}),g.memoizedState=X,g.childLanes=Jd(o,F,h),l.memoizedState=ym,Vo(o.child,g)):(ma(l),h=o.child,o=h.sibling,h=ts(h,{mode:"visible",children:g.children}),h.return=l,h.sibling=null,o!==null&&(F=l.deletions,F===null?(l.deletions=[o],l.flags|=16):F.push(o)),l.child=h,l.memoizedState=null,h)}function sf(o,l){return l=Zd({mode:"visible",children:l},o.mode),l.return=o,o.child=l}function Zd(o,l){return o=Mi(22,o,null,l),o.lanes=0,o}function _m(o,l,h){return ha(l,o.child,null,h),o=sf(l,l.pendingProps.children),o.flags|=2,l.memoizedState=null,o}function xv(o,l,h){o.lanes|=l;var g=o.alternate;g!==null&&(g.lanes|=l),Ed(o.return,l,h)}function Jl(o,l,h,g,E,w){var F=o.memoizedState;F===null?o.memoizedState={isBackwards:l,rendering:null,renderingStartTime:0,last:g,tail:h,tailMode:E,treeForkCount:w}:(F.isBackwards=l,F.rendering=null,F.renderingStartTime=0,F.last=g,F.tail=h,F.tailMode=E,F.treeForkCount=w)}function as(o,l,h){var g=l.pendingProps,E=g.revealOrder,w=g.tail;g=g.children;var F=kn.current,X=(F&2)!==0;if(X?(F=F&1|2,l.flags|=128):F&=1,Ee(kn,F),pr(o,l,g,h),g=Fn?Pu:0,!X&&o!==null&&(o.flags&128)!==0)e:for(o=l.child;o!==null;){if(o.tag===13)o.memoizedState!==null&&xv(o,h,l);else if(o.tag===19)xv(o,h,l);else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===l)break e;for(;o.sibling===null;){if(o.return===null||o.return===l)break e;o=o.return}o.sibling.return=o.return,o=o.sibling}switch(E){case"forwards":for(h=l.child,E=null;h!==null;)o=h.alternate,o!==null&&Ms(o)===null&&(E=h),h=h.sibling;h=E,h===null?(E=l.child,l.child=null):(E=h.sibling,h.sibling=null),Jl(l,!1,E,h,w,g);break;case"backwards":case"unstable_legacy-backwards":for(h=null,E=l.child,l.child=null;E!==null;){if(o=E.alternate,o!==null&&Ms(o)===null){l.child=E;break}o=E.sibling,E.sibling=h,h=E,E=o}Jl(l,!0,h,null,w,g);break;case"together":Jl(l,!1,null,null,void 0,g);break;default:l.memoizedState=null}return l.child}function Bi(o,l,h){if(o!==null&&(l.dependencies=o.dependencies),Yo|=l.lanes,(h&l.childLanes)===0)if(o!==null){if(zo(o,l,h,!1),(h&l.childLanes)===0)return null}else return null;if(o!==null&&l.child!==o.child)throw Error(n(153));if(l.child!==null){for(o=l.child,h=ts(o,o.pendingProps),l.child=h,h.return=l;o.sibling!==null;)o=o.sibling,h=h.sibling=ts(o,o.pendingProps),h.return=l;h.sibling=null}return l.child}function $d(o,l){return(o.lanes&l)!==0?!0:(o=o.dependencies,!!(o!==null&&Xc(o)))}function lS(o,l,h){switch(l.tag){case 3:ot(l,l.stateNode.containerInfo),fa(l,Yi,o.memoizedState.cache),Xa();break;case 27:case 5:Dt(l);break;case 4:ot(l,l.stateNode.containerInfo);break;case 10:fa(l,l.type,l.memoizedProps.value);break;case 31:if(l.memoizedState!==null)return l.flags|=128,Hp(l),null;break;case 13:var g=l.memoizedState;if(g!==null)return g.dehydrated!==null?(ma(l),l.flags|=128,null):(h&l.child.childLanes)!==0?_v(o,l,h):(ma(l),o=Bi(o,l,h),o!==null?o.sibling:null);ma(l);break;case 19:var E=(o.flags&128)!==0;if(g=(h&l.childLanes)!==0,g||(zo(o,l,h,!1),g=(h&l.childLanes)!==0),E){if(g)return as(o,l,h);l.flags|=128}if(E=l.memoizedState,E!==null&&(E.rendering=null,E.tail=null,E.lastEffect=null),Ee(kn,kn.current),g)break;return null;case 22:return l.lanes=0,Xl(o,l,h,l.pendingProps);case 24:fa(l,Yi,o.memoizedState.cache)}return Bi(o,l,h)}function Kd(o,l,h){if(o!==null)if(o.memoizedProps!==l.pendingProps)Ji=!0;else{if(!$d(o,h)&&(l.flags&128)===0)return Ji=!1,lS(o,l,h);Ji=(o.flags&131072)!==0}else Ji=!1,Fn&&(l.flags&1048576)!==0&&w0(l,Pu,l.index);switch(l.lanes=0,l.tag){case 16:e:{var g=l.pendingProps;if(o=kl(l.elementType),l.type=o,typeof o=="function")yd(o)?(g=el(o,g),l.tag=1,l=Yd(null,l,o,g,h)):(l.tag=0,l=Xu(null,l,o,g,h));else{if(o!=null){var E=o.$$typeof;if(E===L){l.tag=11,l=vm(null,l,o,g,h);break e}else if(E===k){l.tag=14,l=Wl(null,l,o,g,h);break e}}throw l=re(o)||o,Error(n(306,l,""))}}return l;case 0:return Xu(o,l,l.type,l.pendingProps,h);case 1:return g=l.type,E=el(g,l.pendingProps),Yd(o,l,g,E,h);case 3:e:{if(ot(l,l.stateNode.containerInfo),o===null)throw Error(n(387));g=l.pendingProps;var w=l.memoizedState;E=w.element,zp(o,l),Bu(l,g,null,h);var F=l.memoizedState;if(g=F.cache,fa(l,Yi,g),g!==w.cache&&Td(l,[Yi],h,!0),Kc(),g=F.element,w.isDehydrated)if(w={element:g,isDehydrated:!1,cache:F.cache},l.updateQueue.baseState=w,l.memoizedState=w,l.flags&256){l=yv(o,l,g,h);break e}else if(g!==E){E=xs(Error(n(424)),l),Fo(E),l=yv(o,l,g,h);break e}else{switch(o=l.stateNode.containerInfo,o.nodeType){case 9:o=o.body;break;default:o=o.nodeName==="HTML"?o.ownerDocument.body:o}for(ui=$o(o.firstChild),Ui=l,Fn=!0,ca=null,Ss=!0,h=Nd(l,null,g,h),l.child=h;h;)h.flags=h.flags&-3|4096,h=h.sibling}else{if(Xa(),g===E){l=Bi(o,l,h);break e}pr(o,l,g,h)}l=l.child}return l;case 26:return Yl(o,l),o===null?(h=TT(l.type,null,l.pendingProps,null))?l.memoizedState=h:Fn||(h=l.type,o=l.pendingProps,g=Ev(ve.current).createElement(h),g[gi]=l,g[H]=o,$r(g,h,o),q(g),l.stateNode=g):l.memoizedState=TT(l.type,o.memoizedProps,l.pendingProps,o.memoizedState),null;case 27:return Dt(l),o===null&&Fn&&(g=l.stateNode=bT(l.type,l.pendingProps,ve.current),Ui=l,Ss=!0,E=ui,nc(l.type)?(bS=E,ui=$o(g.firstChild)):ui=E),pr(o,l,l.pendingProps.children,h),Yl(o,l),o===null&&(l.flags|=4194304),l.child;case 5:return o===null&&Fn&&((E=g=ui)&&(g=AN(g,l.type,l.pendingProps,Ss),g!==null?(l.stateNode=g,Ui=l,ui=$o(g.firstChild),Ss=!1,E=!0):E=!1),E||Lo(l)),Dt(l),E=l.type,w=l.pendingProps,F=o!==null?o.memoizedProps:null,g=w.children,vS(E,w)?g=null:F!==null&&vS(E,F)&&(l.flags|=32),l.memoizedState!==null&&(E=Pd(o,l,ql,null,null,h),Im._currentValue=E),Yl(o,l),pr(o,l,g,h),l.child;case 6:return o===null&&Fn&&((o=h=ui)&&(h=wN(h,l.pendingProps,Ss),h!==null?(l.stateNode=h,Ui=l,ui=null,o=!0):o=!1),o||Lo(l)),null;case 13:return _v(o,l,h);case 4:return ot(l,l.stateNode.containerInfo),g=l.pendingProps,o===null?l.child=ha(l,null,g,h):pr(o,l,g,h),l.child;case 11:return vm(o,l,l.type,l.pendingProps,h);case 7:return pr(o,l,l.pendingProps,h),l.child;case 8:return pr(o,l,l.pendingProps.children,h),l.child;case 12:return pr(o,l,l.pendingProps.children,h),l.child;case 10:return g=l.pendingProps,fa(l,l.type,g.value),pr(o,l,g.children,h),l.child;case 9:return E=l.type._context,g=l.pendingProps.children,Ja(l),E=sn(E),g=g(E),l.flags|=1,pr(o,l,g,h),l.child;case 14:return Wl(o,l,l.type,l.pendingProps,h);case 15:return qd(o,l,l.type,l.pendingProps,h);case 19:return as(o,l,h);case 31:return Xd(o,l,h);case 22:return Xl(o,l,h,l.pendingProps);case 24:return Ja(l),g=sn(Yi),o===null?(E=wd(),E===null&&(E=ln,w=Pp(),E.pooledCache=w,w.refCount++,w!==null&&(E.pooledCacheLanes|=h),E=w),l.memoizedState={parent:g,cache:E},$c(l),fa(l,Yi,E)):((o.lanes&h)!==0&&(zp(o,l),Bu(l,null,null,h),Kc()),E=o.memoizedState,w=l.memoizedState,E.parent!==g?(E={parent:g,cache:g},l.memoizedState=E,l.lanes===0&&(l.memoizedState=l.updateQueue.baseState=E),fa(l,Yi,g)):(g=w.cache,fa(l,Yi,g),g!==E.cache&&Td(l,[Yi],h,!0))),pr(o,l,l.pendingProps.children,h),l.child;case 29:throw l.pendingProps}throw Error(n(156,l.tag))}function Ho(o){o.flags|=4}function of(o,l,h,g,E){if((l=(o.mode&32)!==0)&&(l=!1),l){if(o.flags|=16777216,(E&335544128)===E)if(o.stateNode.complete)o.flags|=8192;else if(Ci())o.flags|=8192;else throw Bo=Cd,Jc}else o.flags&=-16777217}function xm(o,l){if(l.type!=="stylesheet"||(l.state.loading&4)!==0)o.flags&=-16777217;else if(o.flags|=16777216,!IT(l))if(Ci())o.flags|=8192;else throw Bo=Cd,Jc}function va(o,l){l!==null&&(o.flags|=4),o.flags&16384&&(l=o.tag!==22?Nn():536870912,o.lanes|=l,vi|=l)}function Go(o,l){if(!Fn)switch(o.tailMode){case"hidden":l=o.tail;for(var h=null;l!==null;)l.alternate!==null&&(h=l),l=l.sibling;h===null?o.tail=null:h.sibling=null;break;case"collapsed":h=o.tail;for(var g=null;h!==null;)h.alternate!==null&&(g=h),h=h.sibling;g===null?l||o.tail===null?o.tail=null:o.tail.sibling=null:g.sibling=null}}function si(o){var l=o.alternate!==null&&o.alternate.child===o.child,h=0,g=0;if(l)for(var E=o.child;E!==null;)h|=E.lanes|E.childLanes,g|=E.subtreeFlags&65011712,g|=E.flags&65011712,E.return=o,E=E.sibling;else for(E=o.child;E!==null;)h|=E.lanes|E.childLanes,g|=E.subtreeFlags,g|=E.flags,E.return=o,E=E.sibling;return o.subtreeFlags|=g,o.childLanes=h,l}function af(o,l,h){var g=l.pendingProps;switch(Sd(l),l.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return si(l),null;case 1:return si(l),null;case 3:return h=l.stateNode,g=null,o!==null&&(g=o.memoizedState.cache),l.memoizedState.cache!==g&&(l.flags|=2048),Oo(Yi),bt(),h.pendingContext&&(h.context=h.pendingContext,h.pendingContext=null),(o===null||o.child===null)&&(Fu(l)?Ho(l):o===null||o.memoizedState.isDehydrated&&(l.flags&256)===0||(l.flags|=1024,Md())),si(l),null;case 26:var E=l.type,w=l.memoizedState;return o===null?(Ho(l),w!==null?(si(l),xm(l,w)):(si(l),of(l,E,null,g,h))):w?w!==o.memoizedState?(Ho(l),si(l),xm(l,w)):(si(l),l.flags&=-16777217):(o=o.memoizedProps,o!==g&&Ho(l),si(l),of(l,E,o,g,h)),null;case 27:if(cn(l),h=ve.current,E=l.type,o!==null&&l.stateNode!=null)o.memoizedProps!==g&&Ho(l);else{if(!g){if(l.stateNode===null)throw Error(n(166));return si(l),null}o=Be.current,Fu(l)?C0(l):(o=bT(E,g,h),l.stateNode=o,Ho(l))}return si(l),null;case 5:if(cn(l),E=l.type,o!==null&&l.stateNode!=null)o.memoizedProps!==g&&Ho(l);else{if(!g){if(l.stateNode===null)throw Error(n(166));return si(l),null}if(w=Be.current,Fu(l))C0(l);else{var F=Ev(ve.current);switch(w){case 1:w=F.createElementNS("http://www.w3.org/2000/svg",E);break;case 2:w=F.createElementNS("http://www.w3.org/1998/Math/MathML",E);break;default:switch(E){case"svg":w=F.createElementNS("http://www.w3.org/2000/svg",E);break;case"math":w=F.createElementNS("http://www.w3.org/1998/Math/MathML",E);break;case"script":w=F.createElement("div"),w.innerHTML="<script><\/script>",w=w.removeChild(w.firstChild);break;case"select":w=typeof g.is=="string"?F.createElement("select",{is:g.is}):F.createElement("select"),g.multiple?w.multiple=!0:g.size&&(w.size=g.size);break;default:w=typeof g.is=="string"?F.createElement(E,{is:g.is}):F.createElement(E)}}w[gi]=l,w[H]=g;e:for(F=l.child;F!==null;){if(F.tag===5||F.tag===6)w.appendChild(F.stateNode);else if(F.tag!==4&&F.tag!==27&&F.child!==null){F.child.return=F,F=F.child;continue}if(F===l)break e;for(;F.sibling===null;){if(F.return===null||F.return===l)break e;F=F.return}F.sibling.return=F.return,F=F.sibling}l.stateNode=w;e:switch($r(w,E,g),E){case"button":case"input":case"select":case"textarea":g=!!g.autoFocus;break e;case"img":g=!0;break e;default:g=!1}g&&Ho(l)}}return si(l),of(l,l.type,o===null?null:o.memoizedProps,l.pendingProps,h),null;case 6:if(o&&l.stateNode!=null)o.memoizedProps!==g&&Ho(l);else{if(typeof g!="string"&&l.stateNode===null)throw Error(n(166));if(o=ve.current,Fu(l)){if(o=l.stateNode,h=l.memoizedProps,g=null,E=Ui,E!==null)switch(E.tag){case 27:case 5:g=E.memoizedProps}o[gi]=l,o=!!(o.nodeValue===h||g!==null&&g.suppressHydrationWarning===!0||fT(o.nodeValue,h)),o||Lo(l,!0)}else o=Ev(o).createTextNode(g),o[gi]=l,l.stateNode=o}return si(l),null;case 31:if(h=l.memoizedState,o===null||o.memoizedState!==null){if(g=Fu(l),h!==null){if(o===null){if(!g)throw Error(n(318));if(o=l.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(n(557));o[gi]=l}else Xa(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;si(l),o=!1}else h=Md(),o!==null&&o.memoizedState!==null&&(o.memoizedState.hydrationErrors=h),o=!0;if(!o)return l.flags&256?(Oi(l),l):(Oi(l),null);if((l.flags&128)!==0)throw Error(n(558))}return si(l),null;case 13:if(g=l.memoizedState,o===null||o.memoizedState!==null&&o.memoizedState.dehydrated!==null){if(E=Fu(l),g!==null&&g.dehydrated!==null){if(o===null){if(!E)throw Error(n(318));if(E=l.memoizedState,E=E!==null?E.dehydrated:null,!E)throw Error(n(317));E[gi]=l}else Xa(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;si(l),E=!1}else E=Md(),o!==null&&o.memoizedState!==null&&(o.memoizedState.hydrationErrors=E),E=!0;if(!E)return l.flags&256?(Oi(l),l):(Oi(l),null)}return Oi(l),(l.flags&128)!==0?(l.lanes=h,l):(h=g!==null,o=o!==null&&o.memoizedState!==null,h&&(g=l.child,E=null,g.alternate!==null&&g.alternate.memoizedState!==null&&g.alternate.memoizedState.cachePool!==null&&(E=g.alternate.memoizedState.cachePool.pool),w=null,g.memoizedState!==null&&g.memoizedState.cachePool!==null&&(w=g.memoizedState.cachePool.pool),w!==E&&(g.flags|=2048)),h!==o&&h&&(l.child.flags|=8192),va(l,l.updateQueue),si(l),null);case 4:return bt(),o===null&&dS(l.stateNode.containerInfo),si(l),null;case 10:return Oo(l.type),si(l),null;case 19:if(ce(kn),g=l.memoizedState,g===null)return si(l),null;if(E=(l.flags&128)!==0,w=g.rendering,w===null)if(E)Go(g,!1);else{if(Ai!==0||o!==null&&(o.flags&128)!==0)for(o=l.child;o!==null;){if(w=Ms(o),w!==null){for(l.flags|=128,Go(g,!1),o=w.updateQueue,l.updateQueue=o,va(l,o),l.subtreeFlags=0,o=h,h=l.child;h!==null;)Nu(h,o),h=h.sibling;return Ee(kn,kn.current&1|2),Fn&&Uo(l,g.treeForkCount),l.child}o=o.sibling}g.tail!==null&&V()>Vi&&(l.flags|=128,E=!0,Go(g,!1),l.lanes=4194304)}else{if(!E)if(o=Ms(w),o!==null){if(l.flags|=128,E=!0,o=o.updateQueue,l.updateQueue=o,va(l,o),Go(g,!0),g.tail===null&&g.tailMode==="hidden"&&!w.alternate&&!Fn)return si(l),null}else 2*V()-g.renderingStartTime>Vi&&h!==536870912&&(l.flags|=128,E=!0,Go(g,!1),l.lanes=4194304);g.isBackwards?(w.sibling=l.child,l.child=w):(o=g.last,o!==null?o.sibling=w:l.child=w,g.last=w)}return g.tail!==null?(o=g.tail,g.rendering=o,g.tail=o.sibling,g.renderingStartTime=V(),o.sibling=null,h=kn.current,Ee(kn,E?h&1|2:h&1),Fn&&Uo(l,g.treeForkCount),o):(si(l),null);case 22:case 23:return Oi(l),Qc(),g=l.memoizedState!==null,o!==null?o.memoizedState!==null!==g&&(l.flags|=8192):g&&(l.flags|=8192),g?(h&536870912)!==0&&(l.flags&128)===0&&(si(l),l.subtreeFlags&6&&(l.flags|=8192)):si(l),h=l.updateQueue,h!==null&&va(l,h.retryQueue),h=null,o!==null&&o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(h=o.memoizedState.cachePool.pool),g=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(g=l.memoizedState.cachePool.pool),g!==h&&(l.flags|=2048),o!==null&&ce(Za),null;case 24:return h=null,o!==null&&(h=o.memoizedState.cache),l.memoizedState.cache!==h&&(l.flags|=2048),Oo(Yi),si(l),null;case 25:return null;case 30:return null}throw Error(n(156,l.tag))}function Zs(o,l){switch(Sd(l),l.tag){case 1:return o=l.flags,o&65536?(l.flags=o&-65537|128,l):null;case 3:return Oo(Yi),bt(),o=l.flags,(o&65536)!==0&&(o&128)===0?(l.flags=o&-65537|128,l):null;case 26:case 27:case 5:return cn(l),null;case 31:if(l.memoizedState!==null){if(Oi(l),l.alternate===null)throw Error(n(340));Xa()}return o=l.flags,o&65536?(l.flags=o&-65537|128,l):null;case 13:if(Oi(l),o=l.memoizedState,o!==null&&o.dehydrated!==null){if(l.alternate===null)throw Error(n(340));Xa()}return o=l.flags,o&65536?(l.flags=o&-65537|128,l):null;case 19:return ce(kn),null;case 4:return bt(),null;case 10:return Oo(l.type),null;case 22:case 23:return Oi(l),Qc(),o!==null&&ce(Za),o=l.flags,o&65536?(l.flags=o&-65537|128,l):null;case 24:return Oo(Yi),null;case 25:return null;default:return null}}function Es(o,l){switch(Sd(l),l.tag){case 3:Oo(Yi),bt();break;case 26:case 27:case 5:cn(l);break;case 4:bt();break;case 31:l.memoizedState!==null&&Oi(l);break;case 13:Oi(l);break;case 19:ce(kn);break;case 10:Oo(l.type);break;case 22:case 23:Oi(l),Qc(),o!==null&&ce(Za);break;case 24:Oo(Yi)}}function $s(o,l){try{var h=l.updateQueue,g=h!==null?h.lastEffect:null;if(g!==null){var E=g.next;h=E;do{if((h.tag&o)===o){g=void 0;var w=h.create,F=h.inst;g=w(),F.destroy=g}h=h.next}while(h!==E)}}catch(X){Wn(l,l.return,X)}}function xr(o,l,h){try{var g=l.updateQueue,E=g!==null?g.lastEffect:null;if(E!==null){var w=E.next;g=w;do{if((g.tag&o)===o){var F=g.inst,X=F.destroy;if(X!==void 0){F.destroy=void 0,E=l;var se=h,Me=X;try{Me()}catch(ze){Wn(E,se,ze)}}}g=g.next}while(g!==w)}}catch(ze){Wn(l,l.return,ze)}}function uo(o){var l=o.updateQueue;if(l!==null){var h=o.stateNode;try{U0(l,h)}catch(g){Wn(o,o.return,g)}}}function mr(o,l,h){h.props=el(o.type,o.memoizedProps),h.state=o.memoizedState;try{h.componentWillUnmount()}catch(g){Wn(o,l,g)}}function ya(o,l){try{var h=o.ref;if(h!==null){switch(o.tag){case 26:case 27:case 5:var g=o.stateNode;break;case 30:g=o.stateNode;break;default:g=o.stateNode}typeof h=="function"?o.refCleanup=h(g):h.current=g}}catch(E){Wn(o,l,E)}}function Sr(o,l){var h=o.ref,g=o.refCleanup;if(h!==null)if(typeof g=="function")try{g()}catch(E){Wn(o,l,E)}finally{o.refCleanup=null,o=o.alternate,o!=null&&(o.refCleanup=null)}else if(typeof h=="function")try{h(null)}catch(E){Wn(o,l,E)}else h.current=null}function lf(o){var l=o.type,h=o.memoizedProps,g=o.stateNode;try{e:switch(l){case"button":case"input":case"select":case"textarea":h.autoFocus&&g.focus();break e;case"img":h.src?g.src=h.src:h.srcSet&&(g.srcset=h.srcSet)}}catch(E){Wn(o,o.return,E)}}function rr(o,l,h){try{var g=o.stateNode;xN(g,o.type,h,l),g[H]=l}catch(E){Wn(o,o.return,E)}}function Si(o){return o.tag===5||o.tag===3||o.tag===26||o.tag===27&&nc(o.type)||o.tag===4}function Un(o){e:for(;;){for(;o.sibling===null;){if(o.return===null||Si(o.return))return null;o=o.return}for(o.sibling.return=o.return,o=o.sibling;o.tag!==5&&o.tag!==6&&o.tag!==18;){if(o.tag===27&&nc(o.type)||o.flags&2||o.child===null||o.tag===4)continue e;o.child.return=o,o=o.child}if(!(o.flags&2))return o.stateNode}}function qo(o,l,h){var g=o.tag;if(g===5||g===6)o=o.stateNode,l?(h.nodeType===9?h.body:h.nodeName==="HTML"?h.ownerDocument.body:h).insertBefore(o,l):(l=h.nodeType===9?h.body:h.nodeName==="HTML"?h.ownerDocument.body:h,l.appendChild(o),h=h._reactRootContainer,h!=null||l.onclick!==null||(l.onclick=oa));else if(g!==4&&(g===27&&nc(o.type)&&(h=o.stateNode,l=null),o=o.child,o!==null))for(qo(o,l,h),o=o.sibling;o!==null;)qo(o,l,h),o=o.sibling}function Xr(o,l,h){var g=o.tag;if(g===5||g===6)o=o.stateNode,l?h.insertBefore(o,l):h.appendChild(o);else if(g!==4&&(g===27&&nc(o.type)&&(h=o.stateNode),o=o.child,o!==null))for(Xr(o,l,h),o=o.sibling;o!==null;)Xr(o,l,h),o=o.sibling}function Qd(o){var l=o.stateNode,h=o.memoizedProps;try{for(var g=o.type,E=l.attributes;E.length;)l.removeAttributeNode(E[0]);$r(l,g,h),l[gi]=o,l[H]=h}catch(w){Wn(o,o.return,w)}}var Ks=!1,ci=!1,co=!1,Sv=typeof WeakSet=="function"?WeakSet:Set,gr=null;function uS(o,l){if(o=o.containerInfo,mS=Nv,o=M0(o),Rp(o)){if("selectionStart"in o)var h={start:o.selectionStart,end:o.selectionEnd};else e:{h=(h=o.ownerDocument)&&h.defaultView||window;var g=h.getSelection&&h.getSelection();if(g&&g.rangeCount!==0){h=g.anchorNode;var E=g.anchorOffset,w=g.focusNode;g=g.focusOffset;try{h.nodeType,w.nodeType}catch{h=null;break e}var F=0,X=-1,se=-1,Me=0,ze=0,Je=o,Ae=null;t:for(;;){for(var Fe;Je!==h||E!==0&&Je.nodeType!==3||(X=F+E),Je!==w||g!==0&&Je.nodeType!==3||(se=F+g),Je.nodeType===3&&(F+=Je.nodeValue.length),(Fe=Je.firstChild)!==null;)Ae=Je,Je=Fe;for(;;){if(Je===o)break t;if(Ae===h&&++Me===E&&(X=F),Ae===w&&++ze===g&&(se=F),(Fe=Je.nextSibling)!==null)break;Je=Ae,Ae=Je.parentNode}Je=Fe}h=X===-1||se===-1?null:{start:X,end:se}}else h=null}h=h||{start:0,end:0}}else h=null;for(gS={focusedElem:o,selectionRange:h},Nv=!1,gr=l;gr!==null;)if(l=gr,o=l.child,(l.subtreeFlags&1028)!==0&&o!==null)o.return=l,gr=o;else for(;gr!==null;){switch(l=gr,w=l.alternate,o=l.flags,l.tag){case 0:if((o&4)!==0&&(o=l.updateQueue,o=o!==null?o.events:null,o!==null))for(h=0;h<o.length;h++)E=o[h],E.ref.impl=E.nextImpl;break;case 11:case 15:break;case 1:if((o&1024)!==0&&w!==null){o=void 0,h=l,E=w.memoizedProps,w=w.memoizedState,g=h.stateNode;try{var Vt=el(h.type,E);o=g.getSnapshotBeforeUpdate(Vt,w),g.__reactInternalSnapshotBeforeUpdate=o}catch(rn){Wn(h,h.return,rn)}}break;case 3:if((o&1024)!==0){if(o=l.stateNode.containerInfo,h=o.nodeType,h===9)_S(o);else if(h===1)switch(o.nodeName){case"HEAD":case"HTML":case"BODY":_S(o);break;default:o.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((o&1024)!==0)throw Error(n(163))}if(o=l.sibling,o!==null){o.return=l.return,gr=o;break}gr=l.return}}function bi(o,l,h){var g=h.flags;switch(h.tag){case 0:case 11:case 15:eo(o,h),g&4&&$s(5,h);break;case 1:if(eo(o,h),g&4)if(o=h.stateNode,l===null)try{o.componentDidMount()}catch(F){Wn(h,h.return,F)}else{var E=el(h.type,l.memoizedProps);l=l.memoizedState;try{o.componentDidUpdate(E,l,o.__reactInternalSnapshotBeforeUpdate)}catch(F){Wn(h,h.return,F)}}g&64&&uo(h),g&512&&ya(h,h.return);break;case 3:if(eo(o,h),g&64&&(o=h.updateQueue,o!==null)){if(l=null,h.child!==null)switch(h.child.tag){case 27:case 5:l=h.child.stateNode;break;case 1:l=h.child.stateNode}try{U0(o,l)}catch(F){Wn(h,h.return,F)}}break;case 27:l===null&&g&4&&Qd(h);case 26:case 5:eo(o,h),l===null&&g&4&&lf(h),g&512&&ya(h,h.return);break;case 12:eo(o,h);break;case 31:eo(o,h),g&4&&tl(o,h);break;case 13:eo(o,h),g&4&&Yu(o,h),g&64&&(o=h.memoizedState,o!==null&&(o=o.dehydrated,o!==null&&(h=y.bind(null,h),CN(o,h))));break;case 22:if(g=h.memoizedState!==null||Ks,!g){l=l!==null&&l.memoizedState!==null||ci,E=Ks;var w=ci;Ks=g,(ci=l)&&!w?Yr(o,h,(h.subtreeFlags&8772)!==0):eo(o,h),Ks=E,ci=w}break;case 30:break;default:eo(o,h)}}function uf(o){var l=o.alternate;l!==null&&(o.alternate=null,uf(l)),o.child=null,o.deletions=null,o.sibling=null,o.tag===5&&(l=o.stateNode,l!==null&&Qe(l)),o.stateNode=null,o.return=null,o.dependencies=null,o.memoizedProps=null,o.memoizedState=null,o.pendingProps=null,o.stateNode=null,o.updateQueue=null}var ti=null,Ur=!1;function Qs(o,l,h){for(h=h.child;h!==null;)jd(o,l,h),h=h.sibling}function jd(o,l,h){if(Ke&&typeof Ke.onCommitFiberUnmount=="function")try{Ke.onCommitFiberUnmount(Ze,h)}catch{}switch(h.tag){case 26:ci||Sr(h,l),Qs(o,l,h),h.memoizedState?h.memoizedState.count--:h.stateNode&&(h=h.stateNode,h.parentNode.removeChild(h));break;case 27:ci||Sr(h,l);var g=ti,E=Ur;nc(h.type)&&(ti=h.stateNode,Ur=!1),Qs(o,l,h),wm(h.stateNode),ti=g,Ur=E;break;case 5:ci||Sr(h,l);case 6:if(g=ti,E=Ur,ti=null,Qs(o,l,h),ti=g,Ur=E,ti!==null)if(Ur)try{(ti.nodeType===9?ti.body:ti.nodeName==="HTML"?ti.ownerDocument.body:ti).removeChild(h.stateNode)}catch(w){Wn(h,l,w)}else try{ti.removeChild(h.stateNode)}catch(w){Wn(h,l,w)}break;case 18:ti!==null&&(Ur?(o=ti,vT(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,h.stateNode),ah(o)):vT(ti,h.stateNode));break;case 4:g=ti,E=Ur,ti=h.stateNode.containerInfo,Ur=!0,Qs(o,l,h),ti=g,Ur=E;break;case 0:case 11:case 14:case 15:xr(2,h,l),ci||xr(4,h,l),Qs(o,l,h);break;case 1:ci||(Sr(h,l),g=h.stateNode,typeof g.componentWillUnmount=="function"&&mr(h,l,g)),Qs(o,l,h);break;case 21:Qs(o,l,h);break;case 22:ci=(g=ci)||h.memoizedState!==null,Qs(o,l,h),ci=g;break;default:Qs(o,l,h)}}function tl(o,l){if(l.memoizedState===null&&(o=l.alternate,o!==null&&(o=o.memoizedState,o!==null))){o=o.dehydrated;try{ah(o)}catch(h){Wn(l,l.return,h)}}}function Yu(o,l){if(l.memoizedState===null&&(o=l.alternate,o!==null&&(o=o.memoizedState,o!==null&&(o=o.dehydrated,o!==null))))try{ah(o)}catch(h){Wn(l,l.return,h)}}function Sm(o){switch(o.tag){case 31:case 13:case 19:var l=o.stateNode;return l===null&&(l=o.stateNode=new Sv),l;case 22:return o=o.stateNode,l=o._retryCache,l===null&&(l=o._retryCache=new Sv),l;default:throw Error(n(435,o.tag))}}function _a(o,l){var h=Sm(o);l.forEach(function(g){if(!h.has(g)){h.add(g);var E=M.bind(null,o,g);g.then(E,E)}})}function sr(o,l){var h=l.deletions;if(h!==null)for(var g=0;g<h.length;g++){var E=h[g],w=o,F=l,X=F;e:for(;X!==null;){switch(X.tag){case 27:if(nc(X.type)){ti=X.stateNode,Ur=!1;break e}break;case 5:ti=X.stateNode,Ur=!1;break e;case 3:case 4:ti=X.stateNode.containerInfo,Ur=!0;break e}X=X.return}if(ti===null)throw Error(n(160));jd(w,F,E),ti=null,Ur=!1,w=E.alternate,w!==null&&(w.return=null),E.return=null}if(l.subtreeFlags&13886)for(l=l.child;l!==null;)nl(l,o),l=l.sibling}var js=null;function nl(o,l){var h=o.alternate,g=o.flags;switch(o.tag){case 0:case 11:case 14:case 15:sr(l,o),or(o),g&4&&(xr(3,o,o.return),$s(3,o),xr(5,o,o.return));break;case 1:sr(l,o),or(o),g&512&&(ci||h===null||Sr(h,h.return)),g&64&&Ks&&(o=o.updateQueue,o!==null&&(g=o.callbacks,g!==null&&(h=o.shared.hiddenCallbacks,o.shared.hiddenCallbacks=h===null?g:h.concat(g))));break;case 26:var E=js;if(sr(l,o),or(o),g&512&&(ci||h===null||Sr(h,h.return)),g&4){var w=h!==null?h.memoizedState:null;if(g=o.memoizedState,h===null)if(g===null)if(o.stateNode===null){e:{g=o.type,h=o.memoizedProps,E=E.ownerDocument||E;t:switch(g){case"title":w=E.getElementsByTagName("title")[0],(!w||w[it]||w[gi]||w.namespaceURI==="http://www.w3.org/2000/svg"||w.hasAttribute("itemprop"))&&(w=E.createElement(g),E.head.insertBefore(w,E.querySelector("head > title"))),$r(w,g,h),w[gi]=o,q(w),g=w;break e;case"link":var F=CT("link","href",E).get(g+(h.href||""));if(F){for(var X=0;X<F.length;X++)if(w=F[X],w.getAttribute("href")===(h.href==null||h.href===""?null:h.href)&&w.getAttribute("rel")===(h.rel==null?null:h.rel)&&w.getAttribute("title")===(h.title==null?null:h.title)&&w.getAttribute("crossorigin")===(h.crossOrigin==null?null:h.crossOrigin)){F.splice(X,1);break t}}w=E.createElement(g),$r(w,g,h),E.head.appendChild(w);break;case"meta":if(F=CT("meta","content",E).get(g+(h.content||""))){for(X=0;X<F.length;X++)if(w=F[X],w.getAttribute("content")===(h.content==null?null:""+h.content)&&w.getAttribute("name")===(h.name==null?null:h.name)&&w.getAttribute("property")===(h.property==null?null:h.property)&&w.getAttribute("http-equiv")===(h.httpEquiv==null?null:h.httpEquiv)&&w.getAttribute("charset")===(h.charSet==null?null:h.charSet)){F.splice(X,1);break t}}w=E.createElement(g),$r(w,g,h),E.head.appendChild(w);break;default:throw Error(n(468,g))}w[gi]=o,q(w),g=w}o.stateNode=g}else RT(E,o.type,o.stateNode);else o.stateNode=wT(E,g,o.memoizedProps);else w!==g?(w===null?h.stateNode!==null&&(h=h.stateNode,h.parentNode.removeChild(h)):w.count--,g===null?RT(E,o.type,o.stateNode):wT(E,g,o.memoizedProps)):g===null&&o.stateNode!==null&&rr(o,o.memoizedProps,h.memoizedProps)}break;case 27:sr(l,o),or(o),g&512&&(ci||h===null||Sr(h,h.return)),h!==null&&g&4&&rr(o,o.memoizedProps,h.memoizedProps);break;case 5:if(sr(l,o),or(o),g&512&&(ci||h===null||Sr(h,h.return)),o.flags&32){E=o.stateNode;try{Xi(E,"")}catch(Vt){Wn(o,o.return,Vt)}}g&4&&o.stateNode!=null&&(E=o.memoizedProps,rr(o,E,h!==null?h.memoizedProps:E)),g&1024&&(co=!0);break;case 6:if(sr(l,o),or(o),g&4){if(o.stateNode===null)throw Error(n(162));g=o.memoizedProps,h=o.stateNode;try{h.nodeValue=g}catch(Vt){Wn(o,o.return,Vt)}}break;case 3:if(wv=null,E=js,js=Tv(l.containerInfo),sr(l,o),js=E,or(o),g&4&&h!==null&&h.memoizedState.isDehydrated)try{ah(l.containerInfo)}catch(Vt){Wn(o,o.return,Vt)}co&&(co=!1,eh(o));break;case 4:g=js,js=Tv(o.stateNode.containerInfo),sr(l,o),or(o),js=g;break;case 12:sr(l,o),or(o);break;case 31:sr(l,o),or(o),g&4&&(g=o.updateQueue,g!==null&&(o.updateQueue=null,_a(o,g)));break;case 13:sr(l,o),or(o),o.child.flags&8192&&o.memoizedState!==null!=(h!==null&&h.memoizedState!==null)&&(Ju=V()),g&4&&(g=o.updateQueue,g!==null&&(o.updateQueue=null,_a(o,g)));break;case 22:E=o.memoizedState!==null;var se=h!==null&&h.memoizedState!==null,Me=Ks,ze=ci;if(Ks=Me||E,ci=ze||se,sr(l,o),ci=ze,Ks=Me,or(o),g&8192)e:for(l=o.stateNode,l._visibility=E?l._visibility&-2:l._visibility|1,E&&(h===null||se||Ks||ci||Wo(o)),h=null,l=o;;){if(l.tag===5||l.tag===26){if(h===null){se=h=l;try{if(w=se.stateNode,E)F=w.style,typeof F.setProperty=="function"?F.setProperty("display","none","important"):F.display="none";else{X=se.stateNode;var Je=se.memoizedProps.style,Ae=Je!=null&&Je.hasOwnProperty("display")?Je.display:null;X.style.display=Ae==null||typeof Ae=="boolean"?"":(""+Ae).trim()}}catch(Vt){Wn(se,se.return,Vt)}}}else if(l.tag===6){if(h===null){se=l;try{se.stateNode.nodeValue=E?"":se.memoizedProps}catch(Vt){Wn(se,se.return,Vt)}}}else if(l.tag===18){if(h===null){se=l;try{var Fe=se.stateNode;E?yT(Fe,!0):yT(se.stateNode,!1)}catch(Vt){Wn(se,se.return,Vt)}}}else if((l.tag!==22&&l.tag!==23||l.memoizedState===null||l===o)&&l.child!==null){l.child.return=l,l=l.child;continue}if(l===o)break e;for(;l.sibling===null;){if(l.return===null||l.return===o)break e;h===l&&(h=null),l=l.return}h===l&&(h=null),l.sibling.return=l.return,l=l.sibling}g&4&&(g=o.updateQueue,g!==null&&(h=g.retryQueue,h!==null&&(g.retryQueue=null,_a(o,h))));break;case 19:sr(l,o),or(o),g&4&&(g=o.updateQueue,g!==null&&(o.updateQueue=null,_a(o,g)));break;case 30:break;case 21:break;default:sr(l,o),or(o)}}function or(o){var l=o.flags;if(l&2){try{for(var h,g=o.return;g!==null;){if(Si(g)){h=g;break}g=g.return}if(h==null)throw Error(n(160));switch(h.tag){case 27:var E=h.stateNode,w=Un(o);Xr(o,w,E);break;case 5:var F=h.stateNode;h.flags&32&&(Xi(F,""),h.flags&=-33);var X=Un(o);Xr(o,X,F);break;case 3:case 4:var se=h.stateNode.containerInfo,Me=Un(o);qo(o,Me,se);break;default:throw Error(n(161))}}catch(ze){Wn(o,o.return,ze)}o.flags&=-3}l&4096&&(o.flags&=-4097)}function eh(o){if(o.subtreeFlags&1024)for(o=o.child;o!==null;){var l=o;eh(l),l.tag===5&&l.flags&1024&&l.stateNode.reset(),o=o.sibling}}function eo(o,l){if(l.subtreeFlags&8772)for(l=l.child;l!==null;)bi(o,l.alternate,l),l=l.sibling}function Wo(o){for(o=o.child;o!==null;){var l=o;switch(l.tag){case 0:case 11:case 14:case 15:xr(4,l,l.return),Wo(l);break;case 1:Sr(l,l.return);var h=l.stateNode;typeof h.componentWillUnmount=="function"&&mr(l,l.return,h),Wo(l);break;case 27:wm(l.stateNode);case 26:case 5:Sr(l,l.return),Wo(l);break;case 22:l.memoizedState===null&&Wo(l);break;case 30:Wo(l);break;default:Wo(l)}o=o.sibling}}function Yr(o,l,h){for(h=h&&(l.subtreeFlags&8772)!==0,l=l.child;l!==null;){var g=l.alternate,E=o,w=l,F=w.flags;switch(w.tag){case 0:case 11:case 15:Yr(E,w,h),$s(4,w);break;case 1:if(Yr(E,w,h),g=w,E=g.stateNode,typeof E.componentDidMount=="function")try{E.componentDidMount()}catch(Me){Wn(g,g.return,Me)}if(g=w,E=g.updateQueue,E!==null){var X=g.stateNode;try{var se=E.shared.hiddenCallbacks;if(se!==null)for(E.shared.hiddenCallbacks=null,E=0;E<se.length;E++)Vu(se[E],X)}catch(Me){Wn(g,g.return,Me)}}h&&F&64&&uo(w),ya(w,w.return);break;case 27:Qd(w);case 26:case 5:Yr(E,w,h),h&&g===null&&F&4&&lf(w),ya(w,w.return);break;case 12:Yr(E,w,h);break;case 31:Yr(E,w,h),h&&F&4&&tl(E,w);break;case 13:Yr(E,w,h),h&&F&4&&Yu(E,w);break;case 22:w.memoizedState===null&&Yr(E,w,h),ya(w,w.return);break;case 30:break;default:Yr(E,w,h)}l=l.sibling}}function il(o,l){var h=null;o!==null&&o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(h=o.memoizedState.cachePool.pool),o=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(o=l.memoizedState.cachePool.pool),o!==h&&(o!=null&&o.refCount++,h!=null&&Ll(h))}function Zl(o,l){o=null,l.alternate!==null&&(o=l.alternate.memoizedState.cache),l=l.memoizedState.cache,l!==o&&(l.refCount++,o!=null&&Ll(o))}function br(o,l,h,g){if(l.subtreeFlags&10256)for(l=l.child;l!==null;)bm(o,l,h,g),l=l.sibling}function bm(o,l,h,g){var E=l.flags;switch(l.tag){case 0:case 11:case 15:br(o,l,h,g),E&2048&&$s(9,l);break;case 1:br(o,l,h,g);break;case 3:br(o,l,h,g),E&2048&&(o=null,l.alternate!==null&&(o=l.alternate.memoizedState.cache),l=l.memoizedState.cache,l!==o&&(l.refCount++,o!=null&&Ll(o)));break;case 12:if(E&2048){br(o,l,h,g),o=l.stateNode;try{var w=l.memoizedProps,F=w.id,X=w.onPostCommit;typeof X=="function"&&X(F,l.alternate===null?"mount":"update",o.passiveEffectDuration,-0)}catch(se){Wn(l,l.return,se)}}else br(o,l,h,g);break;case 31:br(o,l,h,g);break;case 13:br(o,l,h,g);break;case 23:break;case 22:w=l.stateNode,F=l.alternate,l.memoizedState!==null?w._visibility&2?br(o,l,h,g):Xo(o,l):w._visibility&2?br(o,l,h,g):(w._visibility|=2,Mr(o,l,h,g,(l.subtreeFlags&10256)!==0||!1)),E&2048&&il(F,l);break;case 24:br(o,l,h,g),E&2048&&Zl(l.alternate,l);break;default:br(o,l,h,g)}}function Mr(o,l,h,g,E){for(E=E&&((l.subtreeFlags&10256)!==0||!1),l=l.child;l!==null;){var w=o,F=l,X=h,se=g,Me=F.flags;switch(F.tag){case 0:case 11:case 15:Mr(w,F,X,se,E),$s(8,F);break;case 23:break;case 22:var ze=F.stateNode;F.memoizedState!==null?ze._visibility&2?Mr(w,F,X,se,E):Xo(w,F):(ze._visibility|=2,Mr(w,F,X,se,E)),E&&Me&2048&&il(F.alternate,F);break;case 24:Mr(w,F,X,se,E),E&&Me&2048&&Zl(F.alternate,F);break;default:Mr(w,F,X,se,E)}l=l.sibling}}function Xo(o,l){if(l.subtreeFlags&10256)for(l=l.child;l!==null;){var h=o,g=l,E=g.flags;switch(g.tag){case 22:Xo(h,g),E&2048&&il(g.alternate,g);break;case 24:Xo(h,g),E&2048&&Zl(g.alternate,g);break;default:Xo(h,g)}l=l.sibling}}var $l=8192;function Ts(o,l,h){if(o.subtreeFlags&$l)for(o=o.child;o!==null;)th(o,l,h),o=o.sibling}function th(o,l,h){switch(o.tag){case 26:Ts(o,l,h),o.flags&$l&&o.memoizedState!==null&&BN(h,js,o.memoizedState,o.memoizedProps);break;case 5:Ts(o,l,h);break;case 3:case 4:var g=js;js=Tv(o.stateNode.containerInfo),Ts(o,l,h),js=g;break;case 22:o.memoizedState===null&&(g=o.alternate,g!==null&&g.memoizedState!==null?(g=$l,$l=16777216,Ts(o,l,h),$l=g):Ts(o,l,h));break;default:Ts(o,l,h)}}function Kl(o){var l=o.alternate;if(l!==null&&(o=l.child,o!==null)){l.child=null;do l=o.sibling,o.sibling=null,o=l;while(o!==null)}}function rl(o){var l=o.deletions;if((o.flags&16)!==0){if(l!==null)for(var h=0;h<l.length;h++){var g=l[h];gr=g,Pi(g,o)}Kl(o)}if(o.subtreeFlags&10256)for(o=o.child;o!==null;)ls(o),o=o.sibling}function ls(o){switch(o.tag){case 0:case 11:case 15:rl(o),o.flags&2048&&xr(9,o,o.return);break;case 3:rl(o);break;case 12:rl(o);break;case 22:var l=o.stateNode;o.memoizedState!==null&&l._visibility&2&&(o.return===null||o.return.tag!==13)?(l._visibility&=-3,us(o)):rl(o);break;default:rl(o)}}function us(o){var l=o.deletions;if((o.flags&16)!==0){if(l!==null)for(var h=0;h<l.length;h++){var g=l[h];gr=g,Pi(g,o)}Kl(o)}for(o=o.child;o!==null;){switch(l=o,l.tag){case 0:case 11:case 15:xr(8,l,l.return),us(l);break;case 22:h=l.stateNode,h._visibility&2&&(h._visibility&=-3,us(l));break;default:us(l)}o=o.sibling}}function Pi(o,l){for(;gr!==null;){var h=gr;switch(h.tag){case 0:case 11:case 15:xr(8,h,l);break;case 23:case 22:if(h.memoizedState!==null&&h.memoizedState.cachePool!==null){var g=h.memoizedState.cachePool.pool;g!=null&&g.refCount++}break;case 24:Ll(h.memoizedState.cache)}if(g=h.child,g!==null)g.return=h,gr=g;else e:for(h=o;gr!==null;){g=gr;var E=g.sibling,w=g.return;if(uf(g),g===h){gr=null;break e}if(E!==null){E.return=w,gr=E;break e}gr=w}}}var xa={getCacheForType:function(o){var l=sn(Yi),h=l.data.get(o);return h===void 0&&(h=o(),l.data.set(o,h)),h},cacheSignal:function(){return sn(Yi).controller.signal}},mn=typeof WeakMap=="function"?WeakMap:Map,Yt=0,ln=null,bn=null,_n=0,On=0,Pr=null,to=!1,fo=!1,Mm=!1,As=0,Ai=0,Yo=0,sl=0,cf=0,Jr=0,vi=0,Ql=null,Li=null,Fi=!1,Ju=0,Em=0,Vi=1/0,wi=null,Hi=null,ni=0,ws=null,Zu=null,no=0,$u=0,Ku=null,ff=null,ol=0,jl=null;function Cs(){return(Yt&2)!==0&&_n!==0?_n&-_n:J.T!==null?Ie():ys()}function Rn(){if(Jr===0)if((_n&536870912)===0||Fn){var o=nt;nt<<=1,(nt&3932160)===0&&(nt=262144),Jr=o}else Jr=536870912;return o=rs.current,o!==null&&(o.flags|=32),Jr}function Mn(o,l,h){(o===ln&&(On===2||On===9)||o.cancelPendingCommit!==null)&&(ll(o,0),Zi(o,_n,Jr,!1)),ji(o,h),((Yt&2)===0||o!==ln)&&(o===ln&&((Yt&2)===0&&(sl|=h),Ai===4&&Zi(o,_n,Jr,!1)),st(o))}function In(o,l,h){if((Yt&6)!==0)throw Error(n(327));var g=!h&&(l&127)===0&&(l&o.expiredLanes)===0||vt(o,l),E=g?df(o,l):Zr(o,l,!0),w=g;do{if(E===0){fo&&!g&&Zi(o,l,0,!1);break}else{if(h=o.current.alternate,w&&!ii(h)){E=Zr(o,l,!1),w=!1;continue}if(E===2){if(w=l,o.errorRecoveryDisabledLanes&w)var F=0;else F=o.pendingLanes&-536870913,F=F!==0?F:F&536870912?536870912:0;if(F!==0){l=F;e:{var X=o;E=Ql;var se=X.current.memoizedState.isDehydrated;if(se&&(ll(X,F).flags|=256),F=Zr(X,F,!1),F!==2){if(Mm&&!se){X.errorRecoveryDisabledLanes|=w,sl|=w,E=4;break e}w=Li,Li=E,w!==null&&(Li===null?Li=w:Li.push.apply(Li,w))}E=F}if(w=!1,E!==2)continue}}if(E===1){ll(o,0),Zi(o,l,0,!0);break}e:{switch(g=o,w=E,w){case 0:case 1:throw Error(n(345));case 4:if((l&4194048)!==l)break;case 6:Zi(g,l,Jr,!to);break e;case 2:Li=null;break;case 3:case 5:break;default:throw Error(n(329))}if((l&62914560)===l&&(E=Ju+300-V(),10<E)){if(Zi(g,l,Jr,!to),He(g,0,!0)!==0)break e;no=l,g.timeoutHandle=mT(Pn.bind(null,g,h,Li,wi,Fi,l,Jr,sl,vi,to,w,"Throttled",-0,0),E);break e}Pn(g,h,Li,wi,Fi,l,Jr,sl,vi,to,w,null,-0,0)}}break}while(!0);st(o)}function Pn(o,l,h,g,E,w,F,X,se,Me,ze,Je,Ae,Fe){if(o.timeoutHandle=-1,Je=l.subtreeFlags,Je&8192||(Je&16785408)===16785408){Je={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:oa},th(l,w,Je);var Vt=(w&62914560)===w?Ju-V():(w&4194048)===w?Em-V():0;if(Vt=VN(Je,Vt),Vt!==null){no=w,o.cancelPendingCommit=Vt(ba.bind(null,o,l,w,h,g,E,F,X,se,ze,Je,null,Ae,Fe)),Zi(o,w,F,!Me);return}}ba(o,l,w,h,g,E,F,X,se)}function ii(o){for(var l=o;;){var h=l.tag;if((h===0||h===11||h===15)&&l.flags&16384&&(h=l.updateQueue,h!==null&&(h=h.stores,h!==null)))for(var g=0;g<h.length;g++){var E=h[g],w=E.getSnapshot;E=E.value;try{if(!Hr(w(),E))return!1}catch{return!1}}if(h=l.child,l.subtreeFlags&16384&&h!==null)h.return=l,l=h;else{if(l===o)break;for(;l.sibling===null;){if(l.return===null||l.return===o)return!0;l=l.return}l.sibling.return=l.return,l=l.sibling}}return!0}function Zi(o,l,h,g){l&=~cf,l&=~sl,o.suspendedLanes|=l,o.pingedLanes&=~l,g&&(o.warmLanes|=l),g=o.expirationTimes;for(var E=l;0<E;){var w=31-Tt(E),F=1<<w;g[w]=-1,E&=~F}h!==0&&To(o,h,l)}function ho(){return(Yt&6)===0?(Lt(0),!1):!0}function al(){if(bn!==null){if(On===0)var o=bn.return;else o=bn,ko=Ya=null,Yp(o),Bl=null,Vl=0,o=bn;for(;o!==null;)Es(o.alternate,o),o=o.return;bn=null}}function ll(o,l){var h=o.timeoutHandle;h!==-1&&(o.timeoutHandle=-1,MN(h)),h=o.cancelPendingCommit,h!==null&&(o.cancelPendingCommit=null,h()),no=0,al(),ln=o,bn=h=ts(o.current,null),_n=l,On=0,Pr=null,to=!1,fo=vt(o,l),Mm=!1,vi=Jr=cf=sl=Yo=Ai=0,Li=Ql=null,Fi=!1,(l&8)!==0&&(l|=l&32);var g=o.entangledLanes;if(g!==0)for(o=o.entanglements,g&=l;0<g;){var E=31-Tt(g),w=1<<E;l|=o[E],g&=~w}return As=l,qc(),h}function Jo(o,l){pn=null,J.H=Wu,l===Fl||l===Sn?(l=Ol(),On=3):l===Jc?(l=Ol(),On=4):On=l===Gd?8:l!==null&&typeof l=="object"&&typeof l.then=="function"?6:1,Pr=l,bn===null&&(Ai=1,Hd(o,xs(l,o.current)))}function Ci(){var o=rs.current;return o===null?!0:(_n&4194048)===_n?Wr===null:(_n&62914560)===_n||(_n&536870912)!==0?o===Wr:!1}function Sa(){var o=J.H;return J.H=Wu,o===null?Wu:o}function ul(){var o=J.A;return J.A=xa,o}function Qu(){Ai=4,to||(_n&4194048)!==_n&&rs.current!==null||(fo=!0),(Yo&134217727)===0&&(sl&134217727)===0||ln===null||Zi(ln,_n,Jr,!1)}function Zr(o,l,h){var g=Yt;Yt|=2;var E=Sa(),w=ul();(ln!==o||_n!==l)&&(wi=null,ll(o,l)),l=!1;var F=Ai;e:do try{if(On!==0&&bn!==null){var X=bn,se=Pr;switch(On){case 8:al(),F=6;break e;case 3:case 2:case 9:case 6:rs.current===null&&(l=!0);var Me=On;if(On=0,Pr=null,eu(o,X,se,Me),h&&fo){F=0;break e}break;default:Me=On,On=0,Pr=null,eu(o,X,se,Me)}}ju(),F=Ai;break}catch(ze){Jo(o,ze)}while(!0);return l&&o.shellSuspendCounter++,ko=Ya=null,Yt=g,J.H=E,J.A=w,bn===null&&(ln=null,_n=0,qc()),F}function ju(){for(;bn!==null;)nh(bn)}function df(o,l){var h=Yt;Yt|=2;var g=Sa(),E=ul();ln!==o||_n!==l?(wi=null,Vi=V()+500,ll(o,l)):fo=vt(o,l);e:do try{if(On!==0&&bn!==null){l=bn;var w=Pr;t:switch(On){case 1:On=0,Pr=null,eu(o,l,w,1);break;case 2:case 9:if(is(w)){On=0,Pr=null,hf(l);break}l=function(){On!==2&&On!==9||ln!==o||(On=7),st(o)},w.then(l,l);break e;case 3:On=7;break e;case 4:On=5;break e;case 7:is(w)?(On=0,Pr=null,hf(l)):(On=0,Pr=null,eu(o,l,w,7));break;case 5:var F=null;switch(bn.tag){case 26:F=bn.memoizedState;case 5:case 27:var X=bn;if(F?IT(F):X.stateNode.complete){On=0,Pr=null;var se=X.sibling;if(se!==null)bn=se;else{var Me=X.return;Me!==null?(bn=Me,cl(Me)):bn=null}break t}}On=0,Pr=null,eu(o,l,w,5);break;case 6:On=0,Pr=null,eu(o,l,w,6);break;case 8:al(),Ai=6;break e;default:throw Error(n(462))}}cs();break}catch(ze){Jo(o,ze)}while(!0);return ko=Ya=null,J.H=g,J.A=E,Yt=h,bn!==null?0:(ln=null,_n=0,qc(),Ai)}function cs(){for(;bn!==null&&!ut();)nh(bn)}function nh(o){var l=Kd(o.alternate,o,As);o.memoizedProps=o.pendingProps,l===null?cl(o):bn=l}function hf(o){var l=o,h=l.alternate;switch(l.tag){case 15:case 0:l=rf(h,l,l.pendingProps,l.type,void 0,_n);break;case 11:l=rf(h,l,l.pendingProps,l.type.render,l.ref,_n);break;case 5:Yp(l);default:Es(h,l),l=bn=Nu(l,As),l=Kd(h,l,As)}o.memoizedProps=o.pendingProps,l===null?cl(o):bn=l}function eu(o,l,h,g){ko=Ya=null,Yp(l),Bl=null,Vl=0;var E=l.return;try{if(ir(o,E,l,h,_n)){Ai=1,Hd(o,xs(h,o.current)),bn=null;return}}catch(w){if(E!==null)throw bn=E,w;Ai=1,Hd(o,xs(h,o.current)),bn=null;return}l.flags&32768?(Fn||g===1?o=!0:fo||(_n&536870912)!==0?o=!1:(to=o=!0,(g===2||g===9||g===3||g===6)&&(g=rs.current,g!==null&&g.tag===13&&(g.flags|=16384))),pf(l,o)):cl(l)}function cl(o){var l=o;do{if((l.flags&32768)!==0){pf(l,to);return}o=l.return;var h=af(l.alternate,l,As);if(h!==null){bn=h;return}if(l=l.sibling,l!==null){bn=l;return}bn=l=o}while(l!==null);Ai===0&&(Ai=5)}function pf(o,l){do{var h=Zs(o.alternate,o);if(h!==null){h.flags&=32767,bn=h;return}if(h=o.return,h!==null&&(h.flags|=32768,h.subtreeFlags=0,h.deletions=null),!l&&(o=o.sibling,o!==null)){bn=o;return}bn=o=h}while(o!==null);Ai=6,bn=null}function ba(o,l,h,g,E,w,F,X,se){o.cancelPendingCommit=null;do ec();while(ni!==0);if((Yt&6)!==0)throw Error(n(327));if(l!==null){if(l===o.current)throw Error(n(177));if(w=l.lanes|l.childLanes,w|=dr,Rr(o,h,w,F,X,se),o===ln&&(bn=ln=null,_n=0),Zu=l,ws=o,no=h,$u=w,Ku=E,ff=g,(l.subtreeFlags&10256)!==0||(l.flags&10256)!==0?(o.callbackNode=null,o.callbackPriority=0,R(Ne,function(){return ih(),null})):(o.callbackNode=null,o.callbackPriority=0),g=(l.flags&13878)!==0,(l.subtreeFlags&13878)!==0||g){g=J.T,J.T=null,E=te.p,te.p=2,F=Yt,Yt|=4;try{uS(o,l,h)}finally{Yt=F,te.p=E,J.T=g}}ni=1,$i(),Ma(),tu()}}function $i(){if(ni===1){ni=0;var o=ws,l=Zu,h=(l.flags&13878)!==0;if((l.subtreeFlags&13878)!==0||h){h=J.T,J.T=null;var g=te.p;te.p=2;var E=Yt;Yt|=4;try{nl(l,o);var w=gS,F=M0(o.containerInfo),X=w.focusedElem,se=w.selectionRange;if(F!==X&&X&&X.ownerDocument&&li(X.ownerDocument.documentElement,X)){if(se!==null&&Rp(X)){var Me=se.start,ze=se.end;if(ze===void 0&&(ze=Me),"selectionStart"in X)X.selectionStart=Me,X.selectionEnd=Math.min(ze,X.value.length);else{var Je=X.ownerDocument||document,Ae=Je&&Je.defaultView||window;if(Ae.getSelection){var Fe=Ae.getSelection(),Vt=X.textContent.length,rn=Math.min(se.start,Vt),di=se.end===void 0?rn:Math.min(se.end,Vt);!Fe.extend&&rn>di&&(F=di,di=rn,rn=F);var _e=Cu(X,rn),fe=Cu(X,di);if(_e&&fe&&(Fe.rangeCount!==1||Fe.anchorNode!==_e.node||Fe.anchorOffset!==_e.offset||Fe.focusNode!==fe.node||Fe.focusOffset!==fe.offset)){var be=Je.createRange();be.setStart(_e.node,_e.offset),Fe.removeAllRanges(),rn>di?(Fe.addRange(be),Fe.extend(fe.node,fe.offset)):(be.setEnd(fe.node,fe.offset),Fe.addRange(be))}}}}for(Je=[],Fe=X;Fe=Fe.parentNode;)Fe.nodeType===1&&Je.push({element:Fe,left:Fe.scrollLeft,top:Fe.scrollTop});for(typeof X.focus=="function"&&X.focus(),X=0;X<Je.length;X++){var Ye=Je[X];Ye.element.scrollLeft=Ye.left,Ye.element.scrollTop=Ye.top}}Nv=!!mS,gS=mS=null}finally{Yt=E,te.p=g,J.T=h}}o.current=l,ni=2}}function Ma(){if(ni===2){ni=0;var o=ws,l=Zu,h=(l.flags&8772)!==0;if((l.subtreeFlags&8772)!==0||h){h=J.T,J.T=null;var g=te.p;te.p=2;var E=Yt;Yt|=4;try{bi(o,l.alternate,l)}finally{Yt=E,te.p=g,J.T=h}}ni=3}}function tu(){if(ni===4||ni===3){ni=0,K();var o=ws,l=Zu,h=no,g=ff;(l.subtreeFlags&10256)!==0||(l.flags&10256)!==0?ni=5:(ni=0,Zu=ws=null,Zo(o,o.pendingLanes));var E=o.pendingLanes;if(E===0&&(Hi=null),Br(h),l=l.stateNode,Ke&&typeof Ke.onCommitFiberRoot=="function")try{Ke.onCommitFiberRoot(Ze,l,void 0,(l.current.flags&128)===128)}catch{}if(g!==null){l=J.T,E=te.p,te.p=2,J.T=null;try{for(var w=o.onRecoverableError,F=0;F<g.length;F++){var X=g[F];w(X.value,{componentStack:X.stack})}}finally{J.T=l,te.p=E}}(no&3)!==0&&ec(),st(o),E=o.pendingLanes,(h&261930)!==0&&(E&42)!==0?o===jl?ol++:(ol=0,jl=o):ol=0,Lt(0)}}function Zo(o,l){(o.pooledCacheLanes&=l)===0&&(l=o.pooledCache,l!=null&&(o.pooledCache=null,Ll(l)))}function ec(){return $i(),Ma(),tu(),ih()}function ih(){if(ni!==5)return!1;var o=ws,l=$u;$u=0;var h=Br(no),g=J.T,E=te.p;try{te.p=32>h?32:h,J.T=null,h=Ku,Ku=null;var w=ws,F=no;if(ni=0,Zu=ws=null,no=0,(Yt&6)!==0)throw Error(n(331));var X=Yt;if(Yt|=4,ls(w.current),bm(w,w.current,F,h),Yt=X,Lt(0,!1),Ke&&typeof Ke.onPostCommitFiberRoot=="function")try{Ke.onPostCommitFiberRoot(Ze,w)}catch{}return!0}finally{te.p=E,J.T=g,Zo(o,l)}}function Tm(o,l,h){l=xs(h,l),l=mm(o.stateNode,l,2),o=$a(o,l,2),o!==null&&(ji(o,2),st(o))}function Wn(o,l,h){if(o.tag===3)Tm(o,o,h);else for(;l!==null;){if(l.tag===3){Tm(l,o,h);break}else if(l.tag===1){var g=l.stateNode;if(typeof l.type.getDerivedStateFromError=="function"||typeof g.componentDidCatch=="function"&&(Hi===null||!Hi.has(g))){o=xs(h,o),h=gm(2),g=$a(l,h,2),g!==null&&(gv(h,g,l,o),ji(g,2),st(g));break}}l=l.return}}function mf(o,l,h){var g=o.pingCache;if(g===null){g=o.pingCache=new mn;var E=new Set;g.set(l,E)}else E=g.get(l),E===void 0&&(E=new Set,g.set(l,E));E.has(h)||(Mm=!0,E.add(h),o=u.bind(null,o,l,h),l.then(o,o))}function u(o,l,h){var g=o.pingCache;g!==null&&g.delete(l),o.pingedLanes|=o.suspendedLanes&h,o.warmLanes&=~h,ln===o&&(_n&h)===h&&(Ai===4||Ai===3&&(_n&62914560)===_n&&300>V()-Ju?(Yt&2)===0&&ll(o,0):cf|=h,vi===_n&&(vi=0)),st(o)}function f(o,l){l===0&&(l=Nn()),o=Gr(o,l),o!==null&&(ji(o,l),st(o))}function y(o){var l=o.memoizedState,h=0;l!==null&&(h=l.retryLane),f(o,h)}function M(o,l){var h=0;switch(o.tag){case 31:case 13:var g=o.stateNode,E=o.memoizedState;E!==null&&(h=E.retryLane);break;case 19:g=o.stateNode;break;case 22:g=o.stateNode._retryCache;break;default:throw Error(n(314))}g!==null&&g.delete(l),f(o,h)}function R(o,l){return Et(o,l)}var N=null,W=null,ae=!1,Pe=!1,je=!1,xt=0;function st(o){o!==W&&o.next===null&&(W===null?N=W=o:W=W.next=o),Pe=!0,ae||(ae=!0,xe())}function Lt(o,l){if(!je&&Pe){je=!0;do for(var h=!1,g=N;g!==null;){if(o!==0){var E=g.pendingLanes;if(E===0)var w=0;else{var F=g.suspendedLanes,X=g.pingedLanes;w=(1<<31-Tt(42|o)+1)-1,w&=E&~(F&~X),w=w&201326741?w&201326741|1:w?w|2:0}w!==0&&(h=!0,Te(g,w))}else w=_n,w=He(g,g===ln?w:0,g.cancelPendingCommit!==null||g.timeoutHandle!==-1),(w&3)===0||vt(g,w)||(h=!0,Te(g,w));g=g.next}while(h);je=!1}}function dn(){Gi()}function Gi(){Pe=ae=!1;var o=0;xt!==0&&bN()&&(o=xt);for(var l=V(),h=null,g=N;g!==null;){var E=g.next,w=tc(g,l);w===0?(g.next=null,h===null?N=E:h.next=E,E===null&&(W=h)):(h=g,(o!==0||(w&3)!==0)&&(Pe=!0)),g=E}ni!==0&&ni!==5||Lt(o),xt!==0&&(xt=0)}function tc(o,l){for(var h=o.suspendedLanes,g=o.pingedLanes,E=o.expirationTimes,w=o.pendingLanes&-62914561;0<w;){var F=31-Tt(w),X=1<<F,se=E[F];se===-1?((X&h)===0||(X&g)!==0)&&(E[F]=nn(X,l)):se<=l&&(o.expiredLanes|=X),w&=~X}if(l=ln,h=_n,h=He(o,o===l?h:0,o.cancelPendingCommit!==null||o.timeoutHandle!==-1),g=o.callbackNode,h===0||o===l&&(On===2||On===9)||o.cancelPendingCommit!==null)return g!==null&&g!==null&&Gt(g),o.callbackNode=null,o.callbackPriority=0;if((h&3)===0||vt(o,h)){if(l=h&-h,l===o.callbackPriority)return l;switch(g!==null&&Gt(g),Br(h)){case 2:case 8:h=We;break;case 32:h=Ne;break;case 268435456:h=ht;break;default:h=Ne}return g=fl.bind(null,o),h=Et(h,g),o.callbackPriority=l,o.callbackNode=h,l}return g!==null&&g!==null&&Gt(g),o.callbackPriority=2,o.callbackNode=null,2}function fl(o,l){if(ni!==0&&ni!==5)return o.callbackNode=null,o.callbackPriority=0,null;var h=o.callbackNode;if(ec()&&o.callbackNode!==h)return null;var g=_n;return g=He(o,o===ln?g:0,o.cancelPendingCommit!==null||o.timeoutHandle!==-1),g===0?null:(In(o,g,l),tc(o,V()),o.callbackNode!=null&&o.callbackNode===h?fl.bind(null,o):null)}function Te(o,l){if(ec())return null;In(o,l,!0)}function xe(){EN(function(){(Yt&6)!==0?Et(De,dn):Gi()})}function Ie(){if(xt===0){var o=da;o===0&&(o=Ce,Ce<<=1,(Ce&261888)===0&&(Ce=256)),xt=o}return xt}function mt(o){return o==null||typeof o=="symbol"||typeof o=="boolean"?null:typeof o=="function"?o:Ic(""+o)}function en(o,l){var h=l.ownerDocument.createElement("input");return h.name=l.name,h.value=l.value,o.id&&h.setAttribute("form",o.id),l.parentNode.insertBefore(h,l),o=new FormData(o),h.parentNode.removeChild(h),o}function Ri(o,l,h,g,E){if(l==="submit"&&h&&h.stateNode===E){var w=mt((E[H]||null).action),F=g.submitter;F&&(l=(l=F[H]||null)?mt(l.formAction):F.getAttribute("formAction"),l!==null&&(w=l,F=null));var X=new Uc("action","action",null,g,E);o.push({event:X,listeners:[{instance:null,listener:function(){if(g.defaultPrevented){if(xt!==0){var se=F?en(E,F):new FormData(E);am(h,{pending:!0,data:se,method:E.method,action:w},null,se)}}else typeof w=="function"&&(X.preventDefault(),se=F?en(E,F):new FormData(E),am(h,{pending:!0,data:se,method:E.method,action:w},w,se))},currentTarget:E}]})}}for(var tn=0;tn<Hc.length;tn++){var Vn=Hc[tn],vr=Vn.toLowerCase(),Yn=Vn[0].toUpperCase()+Vn.slice(1);Hs(vr,"on"+Yn)}Hs(gd,"onAnimationEnd"),Hs(Vc,"onAnimationIteration"),Hs(Np,"onAnimationStart"),Hs("dblclick","onDoubleClick"),Hs("focusin","onFocus"),Hs("focusout","onBlur"),Hs(T0,"onTransitionRun"),Hs(tS,"onTransitionStart"),Hs(A0,"onTransitionCancel"),Hs(Dp,"onTransitionEnd"),le("onMouseEnter",["mouseout","mouseover"]),le("onMouseLeave",["mouseout","mouseover"]),le("onPointerEnter",["pointerout","pointerover"]),le("onPointerLeave",["pointerout","pointerover"]),ge("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),ge("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),ge("onBeforeInput",["compositionend","keypress","textInput","paste"]),ge("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),ge("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),ge("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var io="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),cS=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(io));function aT(o,l){l=(l&4)!==0;for(var h=0;h<o.length;h++){var g=o[h],E=g.event;g=g.listeners;e:{var w=void 0;if(l)for(var F=g.length-1;0<=F;F--){var X=g[F],se=X.instance,Me=X.currentTarget;if(X=X.listener,se!==w&&E.isPropagationStopped())break e;w=X,E.currentTarget=Me;try{w(E)}catch(ze){Gc(ze)}E.currentTarget=null,w=se}else for(F=0;F<g.length;F++){if(X=g[F],se=X.instance,Me=X.currentTarget,X=X.listener,se!==w&&E.isPropagationStopped())break e;w=X,E.currentTarget=Me;try{w(E)}catch(ze){Gc(ze)}E.currentTarget=null,w=se}}}}function zn(o,l){var h=l[oe];h===void 0&&(h=l[oe]=new Set);var g=o+"__bubble";h.has(g)||(lT(l,o,2,!1),h.add(g))}function fS(o,l,h){var g=0;l&&(g|=4),lT(h,o,g,l)}var bv="_reactListening"+Math.random().toString(36).slice(2);function dS(o){if(!o[bv]){o[bv]=!0,ne.forEach(function(h){h!=="selectionchange"&&(cS.has(h)||fS(h,!1,o),fS(h,!0,o))});var l=o.nodeType===9?o:o.ownerDocument;l===null||l[bv]||(l[bv]=!0,fS("selectionchange",!1,l))}}function lT(o,l,h,g){switch(kT(l)){case 2:var E=qN;break;case 8:E=WN;break;default:E=wS}h=E.bind(null,l,h,o),E=void 0,!hp||l!=="touchstart"&&l!=="touchmove"&&l!=="wheel"||(E=!0),g?E!==void 0?o.addEventListener(l,h,{capture:!0,passive:E}):o.addEventListener(l,h,!0):E!==void 0?o.addEventListener(l,h,{passive:E}):o.addEventListener(l,h,!1)}function hS(o,l,h,g,E){var w=g;if((l&1)===0&&(l&2)===0&&g!==null)e:for(;;){if(g===null)return;var F=g.tag;if(F===3||F===4){var X=g.stateNode.containerInfo;if(X===E)break;if(F===4)for(F=g.return;F!==null;){var se=F.tag;if((se===3||se===4)&&F.stateNode.containerInfo===E)return;F=F.return}for(;X!==null;){if(F=pt(X),F===null)return;if(se=F.tag,se===5||se===6||se===26||se===27){g=w=F;continue e}X=X.parentNode}}g=g.return}dp(function(){var Me=w,ze=id(h),Je=[];e:{var Ae=Vs.get(o);if(Ae!==void 0){var Fe=Uc,Vt=o;switch(o){case"keypress":if(Dc(h)===0)break e;case"keydown":case"keyup":Fe=Il;break;case"focusin":Vt="focus",Fe=ad;break;case"focusout":Vt="blur",Fe=ad;break;case"beforeblur":case"afterblur":Fe=ad;break;case"click":if(h.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Fe=pp;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Fe=s0;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Fe=f0;break;case gd:case Vc:case Np:Fe=Qx;break;case Dp:Fe=eS;break;case"scroll":case"scrollend":Fe=i0;break;case"wheel":Fe=h0;break;case"copy":case"cut":case"paste":Fe=a0;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Fe=vp;break;case"toggle":case"beforetoggle":Fe=m0}var rn=(l&4)!==0,di=!rn&&(o==="scroll"||o==="scrollend"),_e=rn?Ae!==null?Ae+"Capture":null:Ae;rn=[];for(var fe=Me,be;fe!==null;){var Ye=fe;if(be=Ye.stateNode,Ye=Ye.tag,Ye!==5&&Ye!==26&&Ye!==27||be===null||_e===null||(Ye=_u(fe,_e),Ye!=null&&rn.push(Am(fe,Ye,be))),di)break;fe=fe.return}0<rn.length&&(Ae=new Fe(Ae,Vt,null,h,ze),Je.push({event:Ae,listeners:rn}))}}if((l&7)===0){e:{if(Ae=o==="mouseover"||o==="pointerover",Fe=o==="mouseout"||o==="pointerout",Ae&&h!==nd&&(Vt=h.relatedTarget||h.fromElement)&&(pt(Vt)||Vt[Y]))break e;if((Fe||Ae)&&(Ae=ze.window===ze?ze:(Ae=ze.ownerDocument)?Ae.defaultView||Ae.parentWindow:window,Fe?(Vt=h.relatedTarget||h.toElement,Fe=Me,Vt=Vt?pt(Vt):null,Vt!==null&&(di=s(Vt),rn=Vt.tag,Vt!==di||rn!==5&&rn!==27&&rn!==6)&&(Vt=null)):(Fe=null,Vt=Me),Fe!==Vt)){if(rn=pp,Ye="onMouseLeave",_e="onMouseEnter",fe="mouse",(o==="pointerout"||o==="pointerover")&&(rn=vp,Ye="onPointerLeave",_e="onPointerEnter",fe="pointer"),di=Fe==null?Ae:yt(Fe),be=Vt==null?Ae:yt(Vt),Ae=new rn(Ye,fe+"leave",Fe,h,ze),Ae.target=di,Ae.relatedTarget=be,Ye=null,pt(ze)===Me&&(rn=new rn(_e,fe+"enter",Vt,h,ze),rn.target=be,rn.relatedTarget=di,Ye=rn),di=Ye,Fe&&Vt)t:{for(rn=vN,_e=Fe,fe=Vt,be=0,Ye=_e;Ye;Ye=rn(Ye))be++;Ye=0;for(var Qt=fe;Qt;Qt=rn(Qt))Ye++;for(;0<be-Ye;)_e=rn(_e),be--;for(;0<Ye-be;)fe=rn(fe),Ye--;for(;be--;){if(_e===fe||fe!==null&&_e===fe.alternate){rn=_e;break t}_e=rn(_e),fe=rn(fe)}rn=null}else rn=null;Fe!==null&&uT(Je,Ae,Fe,rn,!1),Vt!==null&&di!==null&&uT(Je,di,Vt,rn,!0)}}e:{if(Ae=Me?yt(Me):window,Fe=Ae.nodeName&&Ae.nodeName.toLowerCase(),Fe==="select"||Fe==="input"&&Ae.type==="file")var Qn=Ep;else if(Mp(Ae))if(Ro)Qn=b0;else{Qn=wp;var Wt=x0}else Fe=Ae.nodeName,!Fe||Fe.toLowerCase()!=="input"||Ae.type!=="checkbox"&&Ae.type!=="radio"?Me&&zs(Me.elementType)&&(Qn=Ep):Qn=S0;if(Qn&&(Qn=Qn(o,Me))){pd(Je,Qn,h,ze);break e}Wt&&Wt(o,Ae,Me),o==="focusout"&&Me&&Ae.type==="number"&&Me.memoizedProps.value!=null&&An(Ae,"number",Ae.value)}switch(Wt=Me?yt(Me):window,o){case"focusin":(Mp(Wt)||Wt.contentEditable==="true")&&(Io=Wt,No=Me,Ru=null);break;case"focusout":Ru=No=Io=null;break;case"mousedown":md=!0;break;case"contextmenu":case"mouseup":case"dragend":md=!1,Iu(Je,h,ze);break;case"selectionchange":if(E0)break;case"keydown":case"keyup":Iu(Je,h,ze)}var wn;if(Nl)e:{switch(o){case"compositionstart":var Hn="onCompositionStart";break e;case"compositionend":Hn="onCompositionEnd";break e;case"compositionupdate":Hn="onCompositionUpdate";break e}Hn=void 0}else Dl?hd(o,h)&&(Hn="onCompositionEnd"):o==="keydown"&&h.keyCode===229&&(Hn="onCompositionStart");Hn&&(_p&&h.locale!=="ko"&&(Dl||Hn!=="onCompositionStart"?Hn==="onCompositionEnd"&&Dl&&(wn=Nc()):(_s=ze,sd="value"in _s?_s.value:_s.textContent,Dl=!0)),Wt=Mv(Me,Hn),0<Wt.length&&(Hn=new ld(Hn,o,null,h,ze),Je.push({event:Hn,listeners:Wt}),wn?Hn.data=wn:(wn=xp(h),wn!==null&&(Hn.data=wn)))),(wn=dd?y0(o,h):Sp(o,h))&&(Hn=Mv(Me,"onBeforeInput"),0<Hn.length&&(Wt=new ld("onBeforeInput","beforeinput",null,h,ze),Je.push({event:Wt,listeners:Hn}),Wt.data=wn)),Ri(Je,o,Me,h,ze)}aT(Je,l)})}function Am(o,l,h){return{instance:o,listener:l,currentTarget:h}}function Mv(o,l){for(var h=l+"Capture",g=[];o!==null;){var E=o,w=E.stateNode;if(E=E.tag,E!==5&&E!==26&&E!==27||w===null||(E=_u(o,h),E!=null&&g.unshift(Am(o,E,w)),E=_u(o,l),E!=null&&g.push(Am(o,E,w))),o.tag===3)return g;o=o.return}return[]}function vN(o){if(o===null)return null;do o=o.return;while(o&&o.tag!==5&&o.tag!==27);return o||null}function uT(o,l,h,g,E){for(var w=l._reactName,F=[];h!==null&&h!==g;){var X=h,se=X.alternate,Me=X.stateNode;if(X=X.tag,se!==null&&se===g)break;X!==5&&X!==26&&X!==27||Me===null||(se=Me,E?(Me=_u(h,w),Me!=null&&F.unshift(Am(h,Me,se))):E||(Me=_u(h,w),Me!=null&&F.push(Am(h,Me,se)))),h=h.return}F.length!==0&&o.push({event:l,listeners:F})}var yN=/\r\n?/g,_N=/\u0000|\uFFFD/g;function cT(o){return(typeof o=="string"?o:""+o).replace(yN,`
`).replace(_N,"")}function fT(o,l){return l=cT(l),cT(o)===l}function fi(o,l,h,g,E,w){switch(h){case"children":typeof g=="string"?l==="body"||l==="textarea"&&g===""||Xi(o,g):(typeof g=="number"||typeof g=="bigint")&&l!=="body"&&Xi(o,""+g);break;case"className":Bt(o,"class",g);break;case"tabIndex":Bt(o,"tabindex",g);break;case"dir":case"role":case"viewBox":case"width":case"height":Bt(o,h,g);break;case"style":wl(o,g,w);break;case"data":if(l!=="object"){Bt(o,"data",g);break}case"src":case"href":if(g===""&&(l!=="a"||h!=="href")){o.removeAttribute(h);break}if(g==null||typeof g=="function"||typeof g=="symbol"||typeof g=="boolean"){o.removeAttribute(h);break}g=Ic(""+g),o.setAttribute(h,g);break;case"action":case"formAction":if(typeof g=="function"){o.setAttribute(h,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof w=="function"&&(h==="formAction"?(l!=="input"&&fi(o,l,"name",E.name,E,null),fi(o,l,"formEncType",E.formEncType,E,null),fi(o,l,"formMethod",E.formMethod,E,null),fi(o,l,"formTarget",E.formTarget,E,null)):(fi(o,l,"encType",E.encType,E,null),fi(o,l,"method",E.method,E,null),fi(o,l,"target",E.target,E,null)));if(g==null||typeof g=="symbol"||typeof g=="boolean"){o.removeAttribute(h);break}g=Ic(""+g),o.setAttribute(h,g);break;case"onClick":g!=null&&(o.onclick=oa);break;case"onScroll":g!=null&&zn("scroll",o);break;case"onScrollEnd":g!=null&&zn("scrollend",o);break;case"dangerouslySetInnerHTML":if(g!=null){if(typeof g!="object"||!("__html"in g))throw Error(n(61));if(h=g.__html,h!=null){if(E.children!=null)throw Error(n(60));o.innerHTML=h}}break;case"multiple":o.multiple=g&&typeof g!="function"&&typeof g!="symbol";break;case"muted":o.muted=g&&typeof g!="function"&&typeof g!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(g==null||typeof g=="function"||typeof g=="boolean"||typeof g=="symbol"){o.removeAttribute("xlink:href");break}h=Ic(""+g),o.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",h);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":g!=null&&typeof g!="function"&&typeof g!="symbol"?o.setAttribute(h,""+g):o.removeAttribute(h);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":g&&typeof g!="function"&&typeof g!="symbol"?o.setAttribute(h,""):o.removeAttribute(h);break;case"capture":case"download":g===!0?o.setAttribute(h,""):g!==!1&&g!=null&&typeof g!="function"&&typeof g!="symbol"?o.setAttribute(h,g):o.removeAttribute(h);break;case"cols":case"rows":case"size":case"span":g!=null&&typeof g!="function"&&typeof g!="symbol"&&!isNaN(g)&&1<=g?o.setAttribute(h,g):o.removeAttribute(h);break;case"rowSpan":case"start":g==null||typeof g=="function"||typeof g=="symbol"||isNaN(g)?o.removeAttribute(h):o.setAttribute(h,g);break;case"popover":zn("beforetoggle",o),zn("toggle",o),dt(o,"popover",g);break;case"xlinkActuate":gt(o,"http://www.w3.org/1999/xlink","xlink:actuate",g);break;case"xlinkArcrole":gt(o,"http://www.w3.org/1999/xlink","xlink:arcrole",g);break;case"xlinkRole":gt(o,"http://www.w3.org/1999/xlink","xlink:role",g);break;case"xlinkShow":gt(o,"http://www.w3.org/1999/xlink","xlink:show",g);break;case"xlinkTitle":gt(o,"http://www.w3.org/1999/xlink","xlink:title",g);break;case"xlinkType":gt(o,"http://www.w3.org/1999/xlink","xlink:type",g);break;case"xmlBase":gt(o,"http://www.w3.org/XML/1998/namespace","xml:base",g);break;case"xmlLang":gt(o,"http://www.w3.org/XML/1998/namespace","xml:lang",g);break;case"xmlSpace":gt(o,"http://www.w3.org/XML/1998/namespace","xml:space",g);break;case"is":dt(o,"is",g);break;case"innerText":case"textContent":break;default:(!(2<h.length)||h[0]!=="o"&&h[0]!=="O"||h[1]!=="n"&&h[1]!=="N")&&(h=t0.get(h)||h,dt(o,h,g))}}function pS(o,l,h,g,E,w){switch(h){case"style":wl(o,g,w);break;case"dangerouslySetInnerHTML":if(g!=null){if(typeof g!="object"||!("__html"in g))throw Error(n(61));if(h=g.__html,h!=null){if(E.children!=null)throw Error(n(60));o.innerHTML=h}}break;case"children":typeof g=="string"?Xi(o,g):(typeof g=="number"||typeof g=="bigint")&&Xi(o,""+g);break;case"onScroll":g!=null&&zn("scroll",o);break;case"onScrollEnd":g!=null&&zn("scrollend",o);break;case"onClick":g!=null&&(o.onclick=oa);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!he.hasOwnProperty(h))e:{if(h[0]==="o"&&h[1]==="n"&&(E=h.endsWith("Capture"),l=h.slice(2,E?h.length-7:void 0),w=o[H]||null,w=w!=null?w[h]:null,typeof w=="function"&&o.removeEventListener(l,w,E),typeof g=="function")){typeof w!="function"&&w!==null&&(h in o?o[h]=null:o.hasAttribute(h)&&o.removeAttribute(h)),o.addEventListener(l,g,E);break e}h in o?o[h]=g:g===!0?o.setAttribute(h,""):dt(o,h,g)}}}function $r(o,l,h){switch(l){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":zn("error",o),zn("load",o);var g=!1,E=!1,w;for(w in h)if(h.hasOwnProperty(w)){var F=h[w];if(F!=null)switch(w){case"src":g=!0;break;case"srcSet":E=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,l));default:fi(o,l,w,F,h,null)}}E&&fi(o,l,"srcSet",h.srcSet,h,null),g&&fi(o,l,"src",h.src,h,null);return;case"input":zn("invalid",o);var X=w=F=E=null,se=null,Me=null;for(g in h)if(h.hasOwnProperty(g)){var ze=h[g];if(ze!=null)switch(g){case"name":E=ze;break;case"type":F=ze;break;case"checked":se=ze;break;case"defaultChecked":Me=ze;break;case"value":w=ze;break;case"defaultValue":X=ze;break;case"children":case"dangerouslySetInnerHTML":if(ze!=null)throw Error(n(137,l));break;default:fi(o,l,g,ze,h,null)}}er(o,w,X,se,Me,F,E,!1);return;case"select":zn("invalid",o),g=F=w=null;for(E in h)if(h.hasOwnProperty(E)&&(X=h[E],X!=null))switch(E){case"value":w=X;break;case"defaultValue":F=X;break;case"multiple":g=X;default:fi(o,l,E,X,h,null)}l=w,h=F,o.multiple=!!g,l!=null?yi(o,!!g,l,!1):h!=null&&yi(o,!!g,h,!0);return;case"textarea":zn("invalid",o),w=E=g=null;for(F in h)if(h.hasOwnProperty(F)&&(X=h[F],X!=null))switch(F){case"value":g=X;break;case"defaultValue":E=X;break;case"children":w=X;break;case"dangerouslySetInnerHTML":if(X!=null)throw Error(n(91));break;default:fi(o,l,F,X,h,null)}tr(o,g,E,w);return;case"option":for(se in h)if(h.hasOwnProperty(se)&&(g=h[se],g!=null))switch(se){case"selected":o.selected=g&&typeof g!="function"&&typeof g!="symbol";break;default:fi(o,l,se,g,h,null)}return;case"dialog":zn("beforetoggle",o),zn("toggle",o),zn("cancel",o),zn("close",o);break;case"iframe":case"object":zn("load",o);break;case"video":case"audio":for(g=0;g<io.length;g++)zn(io[g],o);break;case"image":zn("error",o),zn("load",o);break;case"details":zn("toggle",o);break;case"embed":case"source":case"link":zn("error",o),zn("load",o);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Me in h)if(h.hasOwnProperty(Me)&&(g=h[Me],g!=null))switch(Me){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,l));default:fi(o,l,Me,g,h,null)}return;default:if(zs(l)){for(ze in h)h.hasOwnProperty(ze)&&(g=h[ze],g!==void 0&&pS(o,l,ze,g,h,void 0));return}}for(X in h)h.hasOwnProperty(X)&&(g=h[X],g!=null&&fi(o,l,X,g,h,null))}function xN(o,l,h,g){switch(l){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var E=null,w=null,F=null,X=null,se=null,Me=null,ze=null;for(Fe in h){var Je=h[Fe];if(h.hasOwnProperty(Fe)&&Je!=null)switch(Fe){case"checked":break;case"value":break;case"defaultValue":se=Je;default:g.hasOwnProperty(Fe)||fi(o,l,Fe,null,g,Je)}}for(var Ae in g){var Fe=g[Ae];if(Je=h[Ae],g.hasOwnProperty(Ae)&&(Fe!=null||Je!=null))switch(Ae){case"type":w=Fe;break;case"name":E=Fe;break;case"checked":Me=Fe;break;case"defaultChecked":ze=Fe;break;case"value":F=Fe;break;case"defaultValue":X=Fe;break;case"children":case"dangerouslySetInnerHTML":if(Fe!=null)throw Error(n(137,l));break;default:Fe!==Je&&fi(o,l,Ae,Fe,g,Je)}}qn(o,F,X,se,Me,ze,w,E);return;case"select":Fe=F=X=Ae=null;for(w in h)if(se=h[w],h.hasOwnProperty(w)&&se!=null)switch(w){case"value":break;case"multiple":Fe=se;default:g.hasOwnProperty(w)||fi(o,l,w,null,g,se)}for(E in g)if(w=g[E],se=h[E],g.hasOwnProperty(E)&&(w!=null||se!=null))switch(E){case"value":Ae=w;break;case"defaultValue":X=w;break;case"multiple":F=w;default:w!==se&&fi(o,l,E,w,g,se)}l=X,h=F,g=Fe,Ae!=null?yi(o,!!h,Ae,!1):!!g!=!!h&&(l!=null?yi(o,!!h,l,!0):yi(o,!!h,h?[]:"",!1));return;case"textarea":Fe=Ae=null;for(X in h)if(E=h[X],h.hasOwnProperty(X)&&E!=null&&!g.hasOwnProperty(X))switch(X){case"value":break;case"children":break;default:fi(o,l,X,null,g,E)}for(F in g)if(E=g[F],w=h[F],g.hasOwnProperty(F)&&(E!=null||w!=null))switch(F){case"value":Ae=E;break;case"defaultValue":Fe=E;break;case"children":break;case"dangerouslySetInnerHTML":if(E!=null)throw Error(n(91));break;default:E!==w&&fi(o,l,F,E,g,w)}Jn(o,Ae,Fe);return;case"option":for(var Vt in h)if(Ae=h[Vt],h.hasOwnProperty(Vt)&&Ae!=null&&!g.hasOwnProperty(Vt))switch(Vt){case"selected":o.selected=!1;break;default:fi(o,l,Vt,null,g,Ae)}for(se in g)if(Ae=g[se],Fe=h[se],g.hasOwnProperty(se)&&Ae!==Fe&&(Ae!=null||Fe!=null))switch(se){case"selected":o.selected=Ae&&typeof Ae!="function"&&typeof Ae!="symbol";break;default:fi(o,l,se,Ae,g,Fe)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var rn in h)Ae=h[rn],h.hasOwnProperty(rn)&&Ae!=null&&!g.hasOwnProperty(rn)&&fi(o,l,rn,null,g,Ae);for(Me in g)if(Ae=g[Me],Fe=h[Me],g.hasOwnProperty(Me)&&Ae!==Fe&&(Ae!=null||Fe!=null))switch(Me){case"children":case"dangerouslySetInnerHTML":if(Ae!=null)throw Error(n(137,l));break;default:fi(o,l,Me,Ae,g,Fe)}return;default:if(zs(l)){for(var di in h)Ae=h[di],h.hasOwnProperty(di)&&Ae!==void 0&&!g.hasOwnProperty(di)&&pS(o,l,di,void 0,g,Ae);for(ze in g)Ae=g[ze],Fe=h[ze],!g.hasOwnProperty(ze)||Ae===Fe||Ae===void 0&&Fe===void 0||pS(o,l,ze,Ae,g,Fe);return}}for(var _e in h)Ae=h[_e],h.hasOwnProperty(_e)&&Ae!=null&&!g.hasOwnProperty(_e)&&fi(o,l,_e,null,g,Ae);for(Je in g)Ae=g[Je],Fe=h[Je],!g.hasOwnProperty(Je)||Ae===Fe||Ae==null&&Fe==null||fi(o,l,Je,Ae,g,Fe)}function dT(o){switch(o){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function SN(){if(typeof performance.getEntriesByType=="function"){for(var o=0,l=0,h=performance.getEntriesByType("resource"),g=0;g<h.length;g++){var E=h[g],w=E.transferSize,F=E.initiatorType,X=E.duration;if(w&&X&&dT(F)){for(F=0,X=E.responseEnd,g+=1;g<h.length;g++){var se=h[g],Me=se.startTime;if(Me>X)break;var ze=se.transferSize,Je=se.initiatorType;ze&&dT(Je)&&(se=se.responseEnd,F+=ze*(se<X?1:(X-Me)/(se-Me)))}if(--g,l+=8*(w+F)/(E.duration/1e3),o++,10<o)break}}if(0<o)return l/o/1e6}return navigator.connection&&(o=navigator.connection.downlink,typeof o=="number")?o:5}var mS=null,gS=null;function Ev(o){return o.nodeType===9?o:o.ownerDocument}function hT(o){switch(o){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function pT(o,l){if(o===0)switch(l){case"svg":return 1;case"math":return 2;default:return 0}return o===1&&l==="foreignObject"?0:o}function vS(o,l){return o==="textarea"||o==="noscript"||typeof l.children=="string"||typeof l.children=="number"||typeof l.children=="bigint"||typeof l.dangerouslySetInnerHTML=="object"&&l.dangerouslySetInnerHTML!==null&&l.dangerouslySetInnerHTML.__html!=null}var yS=null;function bN(){var o=window.event;return o&&o.type==="popstate"?o===yS?!1:(yS=o,!0):(yS=null,!1)}var mT=typeof setTimeout=="function"?setTimeout:void 0,MN=typeof clearTimeout=="function"?clearTimeout:void 0,gT=typeof Promise=="function"?Promise:void 0,EN=typeof queueMicrotask=="function"?queueMicrotask:typeof gT<"u"?function(o){return gT.resolve(null).then(o).catch(TN)}:mT;function TN(o){setTimeout(function(){throw o})}function nc(o){return o==="head"}function vT(o,l){var h=l,g=0;do{var E=h.nextSibling;if(o.removeChild(h),E&&E.nodeType===8)if(h=E.data,h==="/$"||h==="/&"){if(g===0){o.removeChild(E),ah(l);return}g--}else if(h==="$"||h==="$?"||h==="$~"||h==="$!"||h==="&")g++;else if(h==="html")wm(o.ownerDocument.documentElement);else if(h==="head"){h=o.ownerDocument.head,wm(h);for(var w=h.firstChild;w;){var F=w.nextSibling,X=w.nodeName;w[it]||X==="SCRIPT"||X==="STYLE"||X==="LINK"&&w.rel.toLowerCase()==="stylesheet"||h.removeChild(w),w=F}}else h==="body"&&wm(o.ownerDocument.body);h=E}while(h);ah(l)}function yT(o,l){var h=o;o=0;do{var g=h.nextSibling;if(h.nodeType===1?l?(h._stashedDisplay=h.style.display,h.style.display="none"):(h.style.display=h._stashedDisplay||"",h.getAttribute("style")===""&&h.removeAttribute("style")):h.nodeType===3&&(l?(h._stashedText=h.nodeValue,h.nodeValue=""):h.nodeValue=h._stashedText||""),g&&g.nodeType===8)if(h=g.data,h==="/$"){if(o===0)break;o--}else h!=="$"&&h!=="$?"&&h!=="$~"&&h!=="$!"||o++;h=g}while(h)}function _S(o){var l=o.firstChild;for(l&&l.nodeType===10&&(l=l.nextSibling);l;){var h=l;switch(l=l.nextSibling,h.nodeName){case"HTML":case"HEAD":case"BODY":_S(h),Qe(h);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(h.rel.toLowerCase()==="stylesheet")continue}o.removeChild(h)}}function AN(o,l,h,g){for(;o.nodeType===1;){var E=h;if(o.nodeName.toLowerCase()!==l.toLowerCase()){if(!g&&(o.nodeName!=="INPUT"||o.type!=="hidden"))break}else if(g){if(!o[it])switch(l){case"meta":if(!o.hasAttribute("itemprop"))break;return o;case"link":if(w=o.getAttribute("rel"),w==="stylesheet"&&o.hasAttribute("data-precedence"))break;if(w!==E.rel||o.getAttribute("href")!==(E.href==null||E.href===""?null:E.href)||o.getAttribute("crossorigin")!==(E.crossOrigin==null?null:E.crossOrigin)||o.getAttribute("title")!==(E.title==null?null:E.title))break;return o;case"style":if(o.hasAttribute("data-precedence"))break;return o;case"script":if(w=o.getAttribute("src"),(w!==(E.src==null?null:E.src)||o.getAttribute("type")!==(E.type==null?null:E.type)||o.getAttribute("crossorigin")!==(E.crossOrigin==null?null:E.crossOrigin))&&w&&o.hasAttribute("async")&&!o.hasAttribute("itemprop"))break;return o;default:return o}}else if(l==="input"&&o.type==="hidden"){var w=E.name==null?null:""+E.name;if(E.type==="hidden"&&o.getAttribute("name")===w)return o}else return o;if(o=$o(o.nextSibling),o===null)break}return null}function wN(o,l,h){if(l==="")return null;for(;o.nodeType!==3;)if((o.nodeType!==1||o.nodeName!=="INPUT"||o.type!=="hidden")&&!h||(o=$o(o.nextSibling),o===null))return null;return o}function _T(o,l){for(;o.nodeType!==8;)if((o.nodeType!==1||o.nodeName!=="INPUT"||o.type!=="hidden")&&!l||(o=$o(o.nextSibling),o===null))return null;return o}function xS(o){return o.data==="$?"||o.data==="$~"}function SS(o){return o.data==="$!"||o.data==="$?"&&o.ownerDocument.readyState!=="loading"}function CN(o,l){var h=o.ownerDocument;if(o.data==="$~")o._reactRetry=l;else if(o.data!=="$?"||h.readyState!=="loading")l();else{var g=function(){l(),h.removeEventListener("DOMContentLoaded",g)};h.addEventListener("DOMContentLoaded",g),o._reactRetry=g}}function $o(o){for(;o!=null;o=o.nextSibling){var l=o.nodeType;if(l===1||l===3)break;if(l===8){if(l=o.data,l==="$"||l==="$!"||l==="$?"||l==="$~"||l==="&"||l==="F!"||l==="F")break;if(l==="/$"||l==="/&")return null}}return o}var bS=null;function xT(o){o=o.nextSibling;for(var l=0;o;){if(o.nodeType===8){var h=o.data;if(h==="/$"||h==="/&"){if(l===0)return $o(o.nextSibling);l--}else h!=="$"&&h!=="$!"&&h!=="$?"&&h!=="$~"&&h!=="&"||l++}o=o.nextSibling}return null}function ST(o){o=o.previousSibling;for(var l=0;o;){if(o.nodeType===8){var h=o.data;if(h==="$"||h==="$!"||h==="$?"||h==="$~"||h==="&"){if(l===0)return o;l--}else h!=="/$"&&h!=="/&"||l++}o=o.previousSibling}return null}function bT(o,l,h){switch(l=Ev(h),o){case"html":if(o=l.documentElement,!o)throw Error(n(452));return o;case"head":if(o=l.head,!o)throw Error(n(453));return o;case"body":if(o=l.body,!o)throw Error(n(454));return o;default:throw Error(n(451))}}function wm(o){for(var l=o.attributes;l.length;)o.removeAttributeNode(l[0]);Qe(o)}var Ko=new Map,MT=new Set;function Tv(o){return typeof o.getRootNode=="function"?o.getRootNode():o.nodeType===9?o:o.ownerDocument}var nu=te.d;te.d={f:RN,r:IN,D:NN,C:DN,L:UN,m:PN,X:FN,S:LN,M:kN};function RN(){var o=nu.f(),l=ho();return o||l}function IN(o){var l=ft(o);l!==null&&l.tag===5&&l.type==="form"?av(l):nu.r(o)}var rh=typeof document>"u"?null:document;function ET(o,l,h){var g=rh;if(g&&typeof l=="string"&&l){var E=At(l);E='link[rel="'+o+'"][href="'+E+'"]',typeof h=="string"&&(E+='[crossorigin="'+h+'"]'),MT.has(E)||(MT.add(E),o={rel:o,crossOrigin:h,href:l},g.querySelector(E)===null&&(l=g.createElement("link"),$r(l,"link",o),q(l),g.head.appendChild(l)))}}function NN(o){nu.D(o),ET("dns-prefetch",o,null)}function DN(o,l){nu.C(o,l),ET("preconnect",o,l)}function UN(o,l,h){nu.L(o,l,h);var g=rh;if(g&&o&&l){var E='link[rel="preload"][as="'+At(l)+'"]';l==="image"&&h&&h.imageSrcSet?(E+='[imagesrcset="'+At(h.imageSrcSet)+'"]',typeof h.imageSizes=="string"&&(E+='[imagesizes="'+At(h.imageSizes)+'"]')):E+='[href="'+At(o)+'"]';var w=E;switch(l){case"style":w=sh(o);break;case"script":w=oh(o)}Ko.has(w)||(o=v({rel:"preload",href:l==="image"&&h&&h.imageSrcSet?void 0:o,as:l},h),Ko.set(w,o),g.querySelector(E)!==null||l==="style"&&g.querySelector(Cm(w))||l==="script"&&g.querySelector(Rm(w))||(l=g.createElement("link"),$r(l,"link",o),q(l),g.head.appendChild(l)))}}function PN(o,l){nu.m(o,l);var h=rh;if(h&&o){var g=l&&typeof l.as=="string"?l.as:"script",E='link[rel="modulepreload"][as="'+At(g)+'"][href="'+At(o)+'"]',w=E;switch(g){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":w=oh(o)}if(!Ko.has(w)&&(o=v({rel:"modulepreload",href:o},l),Ko.set(w,o),h.querySelector(E)===null)){switch(g){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(h.querySelector(Rm(w)))return}g=h.createElement("link"),$r(g,"link",o),q(g),h.head.appendChild(g)}}}function LN(o,l,h){nu.S(o,l,h);var g=rh;if(g&&o){var E=ct(g).hoistableStyles,w=sh(o);l=l||"default";var F=E.get(w);if(!F){var X={loading:0,preload:null};if(F=g.querySelector(Cm(w)))X.loading=5;else{o=v({rel:"stylesheet",href:o,"data-precedence":l},h),(h=Ko.get(w))&&MS(o,h);var se=F=g.createElement("link");q(se),$r(se,"link",o),se._p=new Promise(function(Me,ze){se.onload=Me,se.onerror=ze}),se.addEventListener("load",function(){X.loading|=1}),se.addEventListener("error",function(){X.loading|=2}),X.loading|=4,Av(F,l,g)}F={type:"stylesheet",instance:F,count:1,state:X},E.set(w,F)}}}function FN(o,l){nu.X(o,l);var h=rh;if(h&&o){var g=ct(h).hoistableScripts,E=oh(o),w=g.get(E);w||(w=h.querySelector(Rm(E)),w||(o=v({src:o,async:!0},l),(l=Ko.get(E))&&ES(o,l),w=h.createElement("script"),q(w),$r(w,"link",o),h.head.appendChild(w)),w={type:"script",instance:w,count:1,state:null},g.set(E,w))}}function kN(o,l){nu.M(o,l);var h=rh;if(h&&o){var g=ct(h).hoistableScripts,E=oh(o),w=g.get(E);w||(w=h.querySelector(Rm(E)),w||(o=v({src:o,async:!0,type:"module"},l),(l=Ko.get(E))&&ES(o,l),w=h.createElement("script"),q(w),$r(w,"link",o),h.head.appendChild(w)),w={type:"script",instance:w,count:1,state:null},g.set(E,w))}}function TT(o,l,h,g){var E=(E=ve.current)?Tv(E):null;if(!E)throw Error(n(446));switch(o){case"meta":case"title":return null;case"style":return typeof h.precedence=="string"&&typeof h.href=="string"?(l=sh(h.href),h=ct(E).hoistableStyles,g=h.get(l),g||(g={type:"style",instance:null,count:0,state:null},h.set(l,g)),g):{type:"void",instance:null,count:0,state:null};case"link":if(h.rel==="stylesheet"&&typeof h.href=="string"&&typeof h.precedence=="string"){o=sh(h.href);var w=ct(E).hoistableStyles,F=w.get(o);if(F||(E=E.ownerDocument||E,F={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},w.set(o,F),(w=E.querySelector(Cm(o)))&&!w._p&&(F.instance=w,F.state.loading=5),Ko.has(o)||(h={rel:"preload",as:"style",href:h.href,crossOrigin:h.crossOrigin,integrity:h.integrity,media:h.media,hrefLang:h.hrefLang,referrerPolicy:h.referrerPolicy},Ko.set(o,h),w||ON(E,o,h,F.state))),l&&g===null)throw Error(n(528,""));return F}if(l&&g!==null)throw Error(n(529,""));return null;case"script":return l=h.async,h=h.src,typeof h=="string"&&l&&typeof l!="function"&&typeof l!="symbol"?(l=oh(h),h=ct(E).hoistableScripts,g=h.get(l),g||(g={type:"script",instance:null,count:0,state:null},h.set(l,g)),g):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,o))}}function sh(o){return'href="'+At(o)+'"'}function Cm(o){return'link[rel="stylesheet"]['+o+"]"}function AT(o){return v({},o,{"data-precedence":o.precedence,precedence:null})}function ON(o,l,h,g){o.querySelector('link[rel="preload"][as="style"]['+l+"]")?g.loading=1:(l=o.createElement("link"),g.preload=l,l.addEventListener("load",function(){return g.loading|=1}),l.addEventListener("error",function(){return g.loading|=2}),$r(l,"link",h),q(l),o.head.appendChild(l))}function oh(o){return'[src="'+At(o)+'"]'}function Rm(o){return"script[async]"+o}function wT(o,l,h){if(l.count++,l.instance===null)switch(l.type){case"style":var g=o.querySelector('style[data-href~="'+At(h.href)+'"]');if(g)return l.instance=g,q(g),g;var E=v({},h,{"data-href":h.href,"data-precedence":h.precedence,href:null,precedence:null});return g=(o.ownerDocument||o).createElement("style"),q(g),$r(g,"style",E),Av(g,h.precedence,o),l.instance=g;case"stylesheet":E=sh(h.href);var w=o.querySelector(Cm(E));if(w)return l.state.loading|=4,l.instance=w,q(w),w;g=AT(h),(E=Ko.get(E))&&MS(g,E),w=(o.ownerDocument||o).createElement("link"),q(w);var F=w;return F._p=new Promise(function(X,se){F.onload=X,F.onerror=se}),$r(w,"link",g),l.state.loading|=4,Av(w,h.precedence,o),l.instance=w;case"script":return w=oh(h.src),(E=o.querySelector(Rm(w)))?(l.instance=E,q(E),E):(g=h,(E=Ko.get(w))&&(g=v({},h),ES(g,E)),o=o.ownerDocument||o,E=o.createElement("script"),q(E),$r(E,"link",g),o.head.appendChild(E),l.instance=E);case"void":return null;default:throw Error(n(443,l.type))}else l.type==="stylesheet"&&(l.state.loading&4)===0&&(g=l.instance,l.state.loading|=4,Av(g,h.precedence,o));return l.instance}function Av(o,l,h){for(var g=h.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),E=g.length?g[g.length-1]:null,w=E,F=0;F<g.length;F++){var X=g[F];if(X.dataset.precedence===l)w=X;else if(w!==E)break}w?w.parentNode.insertBefore(o,w.nextSibling):(l=h.nodeType===9?h.head:h,l.insertBefore(o,l.firstChild))}function MS(o,l){o.crossOrigin==null&&(o.crossOrigin=l.crossOrigin),o.referrerPolicy==null&&(o.referrerPolicy=l.referrerPolicy),o.title==null&&(o.title=l.title)}function ES(o,l){o.crossOrigin==null&&(o.crossOrigin=l.crossOrigin),o.referrerPolicy==null&&(o.referrerPolicy=l.referrerPolicy),o.integrity==null&&(o.integrity=l.integrity)}var wv=null;function CT(o,l,h){if(wv===null){var g=new Map,E=wv=new Map;E.set(h,g)}else E=wv,g=E.get(h),g||(g=new Map,E.set(h,g));if(g.has(o))return g;for(g.set(o,null),h=h.getElementsByTagName(o),E=0;E<h.length;E++){var w=h[E];if(!(w[it]||w[gi]||o==="link"&&w.getAttribute("rel")==="stylesheet")&&w.namespaceURI!=="http://www.w3.org/2000/svg"){var F=w.getAttribute(l)||"";F=o+F;var X=g.get(F);X?X.push(w):g.set(F,[w])}}return g}function RT(o,l,h){o=o.ownerDocument||o,o.head.insertBefore(h,l==="title"?o.querySelector("head > title"):null)}function zN(o,l,h){if(h===1||l.itemProp!=null)return!1;switch(o){case"meta":case"title":return!0;case"style":if(typeof l.precedence!="string"||typeof l.href!="string"||l.href==="")break;return!0;case"link":if(typeof l.rel!="string"||typeof l.href!="string"||l.href===""||l.onLoad||l.onError)break;switch(l.rel){case"stylesheet":return o=l.disabled,typeof l.precedence=="string"&&o==null;default:return!0}case"script":if(l.async&&typeof l.async!="function"&&typeof l.async!="symbol"&&!l.onLoad&&!l.onError&&l.src&&typeof l.src=="string")return!0}return!1}function IT(o){return!(o.type==="stylesheet"&&(o.state.loading&3)===0)}function BN(o,l,h,g){if(h.type==="stylesheet"&&(typeof g.media!="string"||matchMedia(g.media).matches!==!1)&&(h.state.loading&4)===0){if(h.instance===null){var E=sh(g.href),w=l.querySelector(Cm(E));if(w){l=w._p,l!==null&&typeof l=="object"&&typeof l.then=="function"&&(o.count++,o=Cv.bind(o),l.then(o,o)),h.state.loading|=4,h.instance=w,q(w);return}w=l.ownerDocument||l,g=AT(g),(E=Ko.get(E))&&MS(g,E),w=w.createElement("link"),q(w);var F=w;F._p=new Promise(function(X,se){F.onload=X,F.onerror=se}),$r(w,"link",g),h.instance=w}o.stylesheets===null&&(o.stylesheets=new Map),o.stylesheets.set(h,l),(l=h.state.preload)&&(h.state.loading&3)===0&&(o.count++,h=Cv.bind(o),l.addEventListener("load",h),l.addEventListener("error",h))}}var TS=0;function VN(o,l){return o.stylesheets&&o.count===0&&Iv(o,o.stylesheets),0<o.count||0<o.imgCount?function(h){var g=setTimeout(function(){if(o.stylesheets&&Iv(o,o.stylesheets),o.unsuspend){var w=o.unsuspend;o.unsuspend=null,w()}},6e4+l);0<o.imgBytes&&TS===0&&(TS=62500*SN());var E=setTimeout(function(){if(o.waitingForImages=!1,o.count===0&&(o.stylesheets&&Iv(o,o.stylesheets),o.unsuspend)){var w=o.unsuspend;o.unsuspend=null,w()}},(o.imgBytes>TS?50:800)+l);return o.unsuspend=h,function(){o.unsuspend=null,clearTimeout(g),clearTimeout(E)}}:null}function Cv(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Iv(this,this.stylesheets);else if(this.unsuspend){var o=this.unsuspend;this.unsuspend=null,o()}}}var Rv=null;function Iv(o,l){o.stylesheets=null,o.unsuspend!==null&&(o.count++,Rv=new Map,l.forEach(HN,o),Rv=null,Cv.call(o))}function HN(o,l){if(!(l.state.loading&4)){var h=Rv.get(o);if(h)var g=h.get(null);else{h=new Map,Rv.set(o,h);for(var E=o.querySelectorAll("link[data-precedence],style[data-precedence]"),w=0;w<E.length;w++){var F=E[w];(F.nodeName==="LINK"||F.getAttribute("media")!=="not all")&&(h.set(F.dataset.precedence,F),g=F)}g&&h.set(null,g)}E=l.instance,F=E.getAttribute("data-precedence"),w=h.get(F)||g,w===g&&h.set(null,E),h.set(F,E),this.count++,g=Cv.bind(this),E.addEventListener("load",g),E.addEventListener("error",g),w?w.parentNode.insertBefore(E,w.nextSibling):(o=o.nodeType===9?o.head:o,o.insertBefore(E,o.firstChild)),l.state.loading|=4}}var Im={$$typeof:U,Provider:null,Consumer:null,_currentValue:ye,_currentValue2:ye,_threadCount:0};function GN(o,l,h,g,E,w,F,X,se){this.tag=1,this.containerInfo=o,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ln(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ln(0),this.hiddenUpdates=Ln(null),this.identifierPrefix=g,this.onUncaughtError=E,this.onCaughtError=w,this.onRecoverableError=F,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=se,this.incompleteTransitions=new Map}function NT(o,l,h,g,E,w,F,X,se,Me,ze,Je){return o=new GN(o,l,h,F,se,Me,ze,Je,X),l=1,w===!0&&(l|=24),w=Mi(3,null,null,l),o.current=w,w.stateNode=o,l=Pp(),l.refCount++,o.pooledCache=l,l.refCount++,w.memoizedState={element:g,isDehydrated:h,cache:l},$c(w),o}function DT(o){return o?(o=Ha,o):Ha}function UT(o,l,h,g,E,w){E=DT(E),g.context===null?g.context=E:g.pendingContext=E,g=pa(l),g.payload={element:h},w=w===void 0?null:w,w!==null&&(g.callback=w),h=$a(o,g,l),h!==null&&(Mn(h,o,l),Ka(h,o,l))}function PT(o,l){if(o=o.memoizedState,o!==null&&o.dehydrated!==null){var h=o.retryLane;o.retryLane=h!==0&&h<l?h:l}}function AS(o,l){PT(o,l),(o=o.alternate)&&PT(o,l)}function LT(o){if(o.tag===13||o.tag===31){var l=Gr(o,67108864);l!==null&&Mn(l,o,67108864),AS(o,67108864)}}function FT(o){if(o.tag===13||o.tag===31){var l=Cs();l=wo(l);var h=Gr(o,l);h!==null&&Mn(h,o,l),AS(o,l)}}var Nv=!0;function qN(o,l,h,g){var E=J.T;J.T=null;var w=te.p;try{te.p=2,wS(o,l,h,g)}finally{te.p=w,J.T=E}}function WN(o,l,h,g){var E=J.T;J.T=null;var w=te.p;try{te.p=8,wS(o,l,h,g)}finally{te.p=w,J.T=E}}function wS(o,l,h,g){if(Nv){var E=CS(g);if(E===null)hS(o,l,g,Dv,h),OT(o,g);else if(YN(E,o,l,h,g))g.stopPropagation();else if(OT(o,g),l&4&&-1<XN.indexOf(o)){for(;E!==null;){var w=ft(E);if(w!==null)switch(w.tag){case 3:if(w=w.stateNode,w.current.memoizedState.isDehydrated){var F=tt(w.pendingLanes);if(F!==0){var X=w;for(X.pendingLanes|=2,X.entangledLanes|=2;F;){var se=1<<31-Tt(F);X.entanglements[1]|=se,F&=~se}st(w),(Yt&6)===0&&(Vi=V()+500,Lt(0))}}break;case 31:case 13:X=Gr(w,2),X!==null&&Mn(X,w,2),ho(),AS(w,2)}if(w=CS(g),w===null&&hS(o,l,g,Dv,h),w===E)break;E=w}E!==null&&g.stopPropagation()}else hS(o,l,g,null,h)}}function CS(o){return o=id(o),RS(o)}var Dv=null;function RS(o){if(Dv=null,o=pt(o),o!==null){var l=s(o);if(l===null)o=null;else{var h=l.tag;if(h===13){if(o=a(l),o!==null)return o;o=null}else if(h===31){if(o=c(l),o!==null)return o;o=null}else if(h===3){if(l.stateNode.current.memoizedState.isDehydrated)return l.tag===3?l.stateNode.containerInfo:null;o=null}else l!==o&&(o=null)}}return Dv=o,null}function kT(o){switch(o){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(pe()){case De:return 2;case We:return 8;case Ne:case Ct:return 32;case ht:return 268435456;default:return 32}default:return 32}}var IS=!1,ic=null,rc=null,sc=null,Nm=new Map,Dm=new Map,oc=[],XN="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function OT(o,l){switch(o){case"focusin":case"focusout":ic=null;break;case"dragenter":case"dragleave":rc=null;break;case"mouseover":case"mouseout":sc=null;break;case"pointerover":case"pointerout":Nm.delete(l.pointerId);break;case"gotpointercapture":case"lostpointercapture":Dm.delete(l.pointerId)}}function Um(o,l,h,g,E,w){return o===null||o.nativeEvent!==w?(o={blockedOn:l,domEventName:h,eventSystemFlags:g,nativeEvent:w,targetContainers:[E]},l!==null&&(l=ft(l),l!==null&&LT(l)),o):(o.eventSystemFlags|=g,l=o.targetContainers,E!==null&&l.indexOf(E)===-1&&l.push(E),o)}function YN(o,l,h,g,E){switch(l){case"focusin":return ic=Um(ic,o,l,h,g,E),!0;case"dragenter":return rc=Um(rc,o,l,h,g,E),!0;case"mouseover":return sc=Um(sc,o,l,h,g,E),!0;case"pointerover":var w=E.pointerId;return Nm.set(w,Um(Nm.get(w)||null,o,l,h,g,E)),!0;case"gotpointercapture":return w=E.pointerId,Dm.set(w,Um(Dm.get(w)||null,o,l,h,g,E)),!0}return!1}function zT(o){var l=pt(o.target);if(l!==null){var h=s(l);if(h!==null){if(l=h.tag,l===13){if(l=a(h),l!==null){o.blockedOn=l,jt(o.priority,function(){FT(h)});return}}else if(l===31){if(l=c(h),l!==null){o.blockedOn=l,jt(o.priority,function(){FT(h)});return}}else if(l===3&&h.stateNode.current.memoizedState.isDehydrated){o.blockedOn=h.tag===3?h.stateNode.containerInfo:null;return}}}o.blockedOn=null}function Uv(o){if(o.blockedOn!==null)return!1;for(var l=o.targetContainers;0<l.length;){var h=CS(o.nativeEvent);if(h===null){h=o.nativeEvent;var g=new h.constructor(h.type,h);nd=g,h.target.dispatchEvent(g),nd=null}else return l=ft(h),l!==null&&LT(l),o.blockedOn=h,!1;l.shift()}return!0}function BT(o,l,h){Uv(o)&&h.delete(l)}function JN(){IS=!1,ic!==null&&Uv(ic)&&(ic=null),rc!==null&&Uv(rc)&&(rc=null),sc!==null&&Uv(sc)&&(sc=null),Nm.forEach(BT),Dm.forEach(BT)}function Pv(o,l){o.blockedOn===l&&(o.blockedOn=null,IS||(IS=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,JN)))}var Lv=null;function VT(o){Lv!==o&&(Lv=o,i.unstable_scheduleCallback(i.unstable_NormalPriority,function(){Lv===o&&(Lv=null);for(var l=0;l<o.length;l+=3){var h=o[l],g=o[l+1],E=o[l+2];if(typeof g!="function"){if(RS(g||h)===null)continue;break}var w=ft(h);w!==null&&(o.splice(l,3),l-=3,am(w,{pending:!0,data:E,method:h.method,action:g},g,E))}}))}function ah(o){function l(se){return Pv(se,o)}ic!==null&&Pv(ic,o),rc!==null&&Pv(rc,o),sc!==null&&Pv(sc,o),Nm.forEach(l),Dm.forEach(l);for(var h=0;h<oc.length;h++){var g=oc[h];g.blockedOn===o&&(g.blockedOn=null)}for(;0<oc.length&&(h=oc[0],h.blockedOn===null);)zT(h),h.blockedOn===null&&oc.shift();if(h=(o.ownerDocument||o).$$reactFormReplay,h!=null)for(g=0;g<h.length;g+=3){var E=h[g],w=h[g+1],F=E[H]||null;if(typeof w=="function")F||VT(h);else if(F){var X=null;if(w&&w.hasAttribute("formAction")){if(E=w,F=w[H]||null)X=F.formAction;else if(RS(E)!==null)continue}else X=F.action;typeof X=="function"?h[g+1]=X:(h.splice(g,3),g-=3),VT(h)}}}function HT(){function o(w){w.canIntercept&&w.info==="react-transition"&&w.intercept({handler:function(){return new Promise(function(F){return E=F})},focusReset:"manual",scroll:"manual"})}function l(){E!==null&&(E(),E=null),g||setTimeout(h,20)}function h(){if(!g&&!navigation.transition){var w=navigation.currentEntry;w&&w.url!=null&&navigation.navigate(w.url,{state:w.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var g=!1,E=null;return navigation.addEventListener("navigate",o),navigation.addEventListener("navigatesuccess",l),navigation.addEventListener("navigateerror",l),setTimeout(h,100),function(){g=!0,navigation.removeEventListener("navigate",o),navigation.removeEventListener("navigatesuccess",l),navigation.removeEventListener("navigateerror",l),E!==null&&(E(),E=null)}}}function NS(o){this._internalRoot=o}Fv.prototype.render=NS.prototype.render=function(o){var l=this._internalRoot;if(l===null)throw Error(n(409));var h=l.current,g=Cs();UT(h,g,o,l,null,null)},Fv.prototype.unmount=NS.prototype.unmount=function(){var o=this._internalRoot;if(o!==null){this._internalRoot=null;var l=o.containerInfo;UT(o.current,2,null,o,null,null),ho(),l[Y]=null}};function Fv(o){this._internalRoot=o}Fv.prototype.unstable_scheduleHydration=function(o){if(o){var l=ys();o={blockedOn:null,target:o,priority:l};for(var h=0;h<oc.length&&l!==0&&l<oc[h].priority;h++);oc.splice(h,0,o),h===0&&zT(o)}};var GT=e.version;if(GT!=="19.2.3")throw Error(n(527,GT,"19.2.3"));te.findDOMNode=function(o){var l=o._reactInternals;if(l===void 0)throw typeof o.render=="function"?Error(n(188)):(o=Object.keys(o).join(","),Error(n(268,o)));return o=p(l),o=o!==null?m(o):null,o=o===null?null:o.stateNode,o};var ZN={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:J,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var kv=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!kv.isDisabled&&kv.supportsFiber)try{Ze=kv.inject(ZN),Ke=kv}catch{}}return Lm.createRoot=function(o,l){if(!r(o))throw Error(n(299));var h=!1,g="",E=pv,w=hm,F=pm;return l!=null&&(l.unstable_strictMode===!0&&(h=!0),l.identifierPrefix!==void 0&&(g=l.identifierPrefix),l.onUncaughtError!==void 0&&(E=l.onUncaughtError),l.onCaughtError!==void 0&&(w=l.onCaughtError),l.onRecoverableError!==void 0&&(F=l.onRecoverableError)),l=NT(o,1,!1,null,null,h,g,null,E,w,F,HT),o[Y]=l.current,dS(o),new NS(l)},Lm.hydrateRoot=function(o,l,h){if(!r(o))throw Error(n(299));var g=!1,E="",w=pv,F=hm,X=pm,se=null;return h!=null&&(h.unstable_strictMode===!0&&(g=!0),h.identifierPrefix!==void 0&&(E=h.identifierPrefix),h.onUncaughtError!==void 0&&(w=h.onUncaughtError),h.onCaughtError!==void 0&&(F=h.onCaughtError),h.onRecoverableError!==void 0&&(X=h.onRecoverableError),h.formState!==void 0&&(se=h.formState)),l=NT(o,1,!0,l,h??null,g,E,se,w,F,X,HT),l.context=DT(null),h=l.current,g=Cs(),g=wo(g),E=pa(g),E.callback=null,$a(h,E,g),h=g,l.current.lanes=h,ji(l,h),st(l),o[Y]=l.current,dS(o),new Fv(l)},Lm.version="19.2.3",Lm}var t1;function aD(){if(t1)return PS.exports;t1=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(e){console.error(e)}}return i(),PS.exports=oD(),PS.exports}var lD=aD();const uD=nx(lD);/**
 * @license
 * Copyright 2010-2025 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const tp="182",cD={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},fD={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},GC=0,Jb=1,qC=2,dD=3,WC=0,Oh=1,rg=2,Uf=3,hu=0,gs=1,vo=2,Ia=0,zf=1,Zb=2,$b=3,Kb=4,XC=5,gc=100,YC=101,JC=102,ZC=103,$C=104,KC=200,QC=201,jC=202,eR=203,Zy=204,$y=205,tR=206,nR=207,iR=208,rR=209,sR=210,oR=211,aR=212,lR=213,uR=214,Ky=0,Qy=1,jy=2,Gf=3,e_=4,t_=5,n_=6,i_=7,kg=0,cR=1,fR=2,ta=0,kM=1,OM=2,zM=3,ix=4,BM=5,VM=6,HM=7,Qb="attached",dR="detached",bc=300,Ua=301,Mc=302,Gh=303,vg=304,np=306,yg=1e3,Qi=1001,_g=1002,lr=1003,GM=1004,hD=1004,Uh=1005,pD=1005,Bn=1006,sg=1007,mD=1007,_l=1008,jb=1008,kr=1009,rx=1010,sx=1011,qh=1012,Og=1013,Mo=1014,Ni=1015,Wi=1016,ox=1017,ax=1018,Wh=1020,qM=35902,WM=35899,XM=1021,YM=1022,ur=1023,Ml=1026,vc=1027,zg=1028,Bg=1029,qf=1030,lx=1031,gD=1032,ux=1033,og=33776,ag=33777,lg=33778,ug=33779,r_=35840,s_=35841,o_=35842,a_=35843,l_=36196,u_=37492,c_=37496,f_=37488,d_=37489,h_=37490,p_=37491,m_=37808,g_=37809,v_=37810,y_=37811,__=37812,x_=37813,S_=37814,b_=37815,M_=37816,E_=37817,T_=37818,A_=37819,w_=37820,C_=37821,R_=36492,I_=36494,N_=36495,D_=36283,U_=36284,P_=36285,L_=36286,hR=2200,pR=2201,mR=2202,xg=2300,F_=2301,Gy=2302,Pf=2400,Lf=2401,Sg=2402,cx=2500,JM=2501,vD=0,yD=1,_D=2,gR=3200,xD=3201,SD=3202,bD=3203,Ac=0,vR=1,cu="",es="srgb",Pa="srgb-linear",bg="linear",oi="srgb",MD="",ED="rg",TD="ga",AD=0,If=7680,wD=7681,CD=7682,RD=7683,ID=34055,ND=34056,DD=5386,UD=512,PD=513,LD=514,FD=515,kD=516,OD=517,zD=518,eM=519,yR=512,_R=513,xR=514,fx=515,SR=516,bR=517,dx=518,MR=519,Mg=35044,BD=35048,VD=35040,HD=35045,GD=35049,qD=35041,WD=35046,XD=35050,YD=35042,JD="100",tM="300 es",yo=2e3,Xh=2001,ZD={COMPUTE:"compute",RENDER:"render"},$D={PERSPECTIVE:"perspective",LINEAR:"linear",FLAT:"flat"},KD={NORMAL:"normal",CENTROID:"centroid",SAMPLE:"sample",FIRST:"first",EITHER:"either"};function ER(i){for(let e=i.length-1;e>=0;--e)if(i[e]>=65535)return!0;return!1}const QD={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function Ph(i,e){return new QD[i](e)}function TR(i){return ArrayBuffer.isView(i)&&!(i instanceof DataView)}function Eg(i){return document.createElementNS("http://www.w3.org/1999/xhtml",i)}function AR(){const i=Eg("canvas");return i.style.display="block",i}const n1={};let Ec=null;function jD(i){Ec=i}function eU(){return Ec}function Tg(...i){const e="THREE."+i.shift();Ec?Ec("log",e,...i):console.log(e,...i)}function It(...i){const e="THREE."+i.shift();Ec?Ec("warn",e,...i):console.warn(e,...i)}function Jt(...i){const e="THREE."+i.shift();Ec?Ec("error",e,...i):console.error(e,...i)}function Yh(...i){const e=i.join(" ");e in n1||(n1[e]=!0,It(...i))}function tU(i,e,t){return new Promise(function(n,r){function s(){switch(i.clientWaitSync(e,i.SYNC_FLUSH_COMMANDS_BIT,0)){case i.WAIT_FAILED:r();break;case i.TIMEOUT_EXPIRED:setTimeout(s,t);break;default:n()}}setTimeout(s,t)})}class Tl{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const n=this._listeners;n[e]===void 0&&(n[e]=[]),n[e].indexOf(t)===-1&&n[e].push(t)}hasEventListener(e,t){const n=this._listeners;return n===void 0?!1:n[e]!==void 0&&n[e].indexOf(t)!==-1}removeEventListener(e,t){const n=this._listeners;if(n===void 0)return;const r=n[e];if(r!==void 0){const s=r.indexOf(t);s!==-1&&r.splice(s,1)}}dispatchEvent(e){const t=this._listeners;if(t===void 0)return;const n=t[e.type];if(n!==void 0){e.target=this;const r=n.slice(0);for(let s=0,a=r.length;s<a;s++)r[s].call(this,e);e.target=null}}}const ds=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let i1=1234567;const Bf=Math.PI/180,Jh=180/Math.PI;function xo(){const i=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,n=Math.random()*4294967295|0;return(ds[i&255]+ds[i>>8&255]+ds[i>>16&255]+ds[i>>24&255]+"-"+ds[e&255]+ds[e>>8&255]+"-"+ds[e>>16&15|64]+ds[e>>24&255]+"-"+ds[t&63|128]+ds[t>>8&255]+"-"+ds[t>>16&255]+ds[t>>24&255]+ds[n&255]+ds[n>>8&255]+ds[n>>16&255]+ds[n>>24&255]).toLowerCase()}function on(i,e,t){return Math.max(e,Math.min(t,i))}function ZM(i,e){return(i%e+e)%e}function nU(i,e,t,n,r){return n+(i-e)*(r-n)/(t-e)}function iU(i,e,t){return i!==e?(t-i)/(e-i):0}function cg(i,e,t){return(1-t)*i+t*e}function rU(i,e,t,n){return cg(i,e,1-Math.exp(-t*n))}function sU(i,e=1){return e-Math.abs(ZM(i,e*2)-e)}function oU(i,e,t){return i<=e?0:i>=t?1:(i=(i-e)/(t-e),i*i*(3-2*i))}function aU(i,e,t){return i<=e?0:i>=t?1:(i=(i-e)/(t-e),i*i*i*(i*(i*6-15)+10))}function lU(i,e){return i+Math.floor(Math.random()*(e-i+1))}function uU(i,e){return i+Math.random()*(e-i)}function cU(i){return i*(.5-Math.random())}function fU(i){i!==void 0&&(i1=i);let e=i1+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function dU(i){return i*Bf}function hU(i){return i*Jh}function pU(i){return(i&i-1)===0&&i!==0}function mU(i){return Math.pow(2,Math.ceil(Math.log(i)/Math.LN2))}function gU(i){return Math.pow(2,Math.floor(Math.log(i)/Math.LN2))}function vU(i,e,t,n,r){const s=Math.cos,a=Math.sin,c=s(t/2),d=a(t/2),p=s((e+n)/2),m=a((e+n)/2),v=s((e-n)/2),_=a((e-n)/2),b=s((n-e)/2),T=a((n-e)/2);switch(r){case"XYX":i.set(c*m,d*v,d*_,c*p);break;case"YZY":i.set(d*_,c*m,d*v,c*p);break;case"ZXZ":i.set(d*v,d*_,c*m,c*p);break;case"XZX":i.set(c*m,d*T,d*b,c*p);break;case"YXY":i.set(d*b,c*m,d*T,c*p);break;case"ZYZ":i.set(d*T,d*b,c*m,c*p);break;default:It("MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}}function Us(i,e){switch(e.constructor){case Float32Array:return i;case Uint32Array:return i/4294967295;case Uint16Array:return i/65535;case Uint8Array:return i/255;case Int32Array:return Math.max(i/2147483647,-1);case Int16Array:return Math.max(i/32767,-1);case Int8Array:return Math.max(i/127,-1);default:throw new Error("Invalid component type.")}}function En(i,e){switch(e.constructor){case Float32Array:return i;case Uint32Array:return Math.round(i*4294967295);case Uint16Array:return Math.round(i*65535);case Uint8Array:return Math.round(i*255);case Int32Array:return Math.round(i*2147483647);case Int16Array:return Math.round(i*32767);case Int8Array:return Math.round(i*127);default:throw new Error("Invalid component type.")}}const Ps={DEG2RAD:Bf,RAD2DEG:Jh,generateUUID:xo,clamp:on,euclideanModulo:ZM,mapLinear:nU,inverseLerp:iU,lerp:cg,damp:rU,pingpong:sU,smoothstep:oU,smootherstep:aU,randInt:lU,randFloat:uU,randFloatSpread:cU,seededRandom:fU,degToRad:dU,radToDeg:hU,isPowerOfTwo:pU,ceilPowerOfTwo:mU,floorPowerOfTwo:gU,setQuaternionFromProperEuler:vU,normalize:En,denormalize:Us};class $e{constructor(e=0,t=0){$e.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,n=this.y,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6],this.y=r[1]*t+r[4]*n+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=on(this.x,e.x,t.x),this.y=on(this.y,e.y,t.y),this}clampScalar(e,t){return this.x=on(this.x,e,t),this.y=on(this.y,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(on(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(on(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y;return t*t+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const n=Math.cos(t),r=Math.sin(t),s=this.x-e.x,a=this.y-e.y;return this.x=s*n-a*r+e.x,this.y=s*r+a*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class ao{constructor(e=0,t=0,n=0,r=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=n,this._w=r}static slerpFlat(e,t,n,r,s,a,c){let d=n[r+0],p=n[r+1],m=n[r+2],v=n[r+3],_=s[a+0],b=s[a+1],T=s[a+2],I=s[a+3];if(c<=0){e[t+0]=d,e[t+1]=p,e[t+2]=m,e[t+3]=v;return}if(c>=1){e[t+0]=_,e[t+1]=b,e[t+2]=T,e[t+3]=I;return}if(v!==I||d!==_||p!==b||m!==T){let C=d*_+p*b+m*T+v*I;C<0&&(_=-_,b=-b,T=-T,I=-I,C=-C);let A=1-c;if(C<.9995){const D=Math.acos(C),U=Math.sin(D);A=Math.sin(A*D)/U,c=Math.sin(c*D)/U,d=d*A+_*c,p=p*A+b*c,m=m*A+T*c,v=v*A+I*c}else{d=d*A+_*c,p=p*A+b*c,m=m*A+T*c,v=v*A+I*c;const D=1/Math.sqrt(d*d+p*p+m*m+v*v);d*=D,p*=D,m*=D,v*=D}}e[t]=d,e[t+1]=p,e[t+2]=m,e[t+3]=v}static multiplyQuaternionsFlat(e,t,n,r,s,a){const c=n[r],d=n[r+1],p=n[r+2],m=n[r+3],v=s[a],_=s[a+1],b=s[a+2],T=s[a+3];return e[t]=c*T+m*v+d*b-p*_,e[t+1]=d*T+m*_+p*v-c*b,e[t+2]=p*T+m*b+c*_-d*v,e[t+3]=m*T-c*v-d*_-p*b,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t=!0){const n=e._x,r=e._y,s=e._z,a=e._order,c=Math.cos,d=Math.sin,p=c(n/2),m=c(r/2),v=c(s/2),_=d(n/2),b=d(r/2),T=d(s/2);switch(a){case"XYZ":this._x=_*m*v+p*b*T,this._y=p*b*v-_*m*T,this._z=p*m*T+_*b*v,this._w=p*m*v-_*b*T;break;case"YXZ":this._x=_*m*v+p*b*T,this._y=p*b*v-_*m*T,this._z=p*m*T-_*b*v,this._w=p*m*v+_*b*T;break;case"ZXY":this._x=_*m*v-p*b*T,this._y=p*b*v+_*m*T,this._z=p*m*T+_*b*v,this._w=p*m*v-_*b*T;break;case"ZYX":this._x=_*m*v-p*b*T,this._y=p*b*v+_*m*T,this._z=p*m*T-_*b*v,this._w=p*m*v+_*b*T;break;case"YZX":this._x=_*m*v+p*b*T,this._y=p*b*v+_*m*T,this._z=p*m*T-_*b*v,this._w=p*m*v-_*b*T;break;case"XZY":this._x=_*m*v-p*b*T,this._y=p*b*v-_*m*T,this._z=p*m*T+_*b*v,this._w=p*m*v+_*b*T;break;default:It("Quaternion: .setFromEuler() encountered an unknown order: "+a)}return t===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const n=t/2,r=Math.sin(n);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,n=t[0],r=t[4],s=t[8],a=t[1],c=t[5],d=t[9],p=t[2],m=t[6],v=t[10],_=n+c+v;if(_>0){const b=.5/Math.sqrt(_+1);this._w=.25/b,this._x=(m-d)*b,this._y=(s-p)*b,this._z=(a-r)*b}else if(n>c&&n>v){const b=2*Math.sqrt(1+n-c-v);this._w=(m-d)/b,this._x=.25*b,this._y=(r+a)/b,this._z=(s+p)/b}else if(c>v){const b=2*Math.sqrt(1+c-n-v);this._w=(s-p)/b,this._x=(r+a)/b,this._y=.25*b,this._z=(d+m)/b}else{const b=2*Math.sqrt(1+v-n-c);this._w=(a-r)/b,this._x=(s+p)/b,this._y=(d+m)/b,this._z=.25*b}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let n=e.dot(t)+1;return n<1e-8?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(on(this.dot(e),-1,1)))}rotateTowards(e,t){const n=this.angleTo(e);if(n===0)return this;const r=Math.min(1,t/n);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const n=e._x,r=e._y,s=e._z,a=e._w,c=t._x,d=t._y,p=t._z,m=t._w;return this._x=n*m+a*c+r*p-s*d,this._y=r*m+a*d+s*c-n*p,this._z=s*m+a*p+n*d-r*c,this._w=a*m-n*c-r*d-s*p,this._onChangeCallback(),this}slerp(e,t){if(t<=0)return this;if(t>=1)return this.copy(e);let n=e._x,r=e._y,s=e._z,a=e._w,c=this.dot(e);c<0&&(n=-n,r=-r,s=-s,a=-a,c=-c);let d=1-t;if(c<.9995){const p=Math.acos(c),m=Math.sin(p);d=Math.sin(d*p)/m,t=Math.sin(t*p)/m,this._x=this._x*d+n*t,this._y=this._y*d+r*t,this._z=this._z*d+s*t,this._w=this._w*d+a*t,this._onChangeCallback()}else this._x=this._x*d+n*t,this._y=this._y*d+r*t,this._z=this._z*d+s*t,this._w=this._w*d+a*t,this.normalize();return this}slerpQuaternions(e,t,n){return this.copy(e).slerp(t,n)}random(){const e=2*Math.PI*Math.random(),t=2*Math.PI*Math.random(),n=Math.random(),r=Math.sqrt(1-n),s=Math.sqrt(n);return this.set(r*Math.sin(e),r*Math.cos(e),s*Math.sin(t),s*Math.cos(t))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class Q{constructor(e=0,t=0,n=0){Q.prototype.isVector3=!0,this.x=e,this.y=t,this.z=n}set(e,t,n){return n===void 0&&(n=this.z),this.x=e,this.y=t,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(r1.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(r1.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,n=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[3]*n+s[6]*r,this.y=s[1]*t+s[4]*n+s[7]*r,this.z=s[2]*t+s[5]*n+s[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,n=this.y,r=this.z,s=e.elements,a=1/(s[3]*t+s[7]*n+s[11]*r+s[15]);return this.x=(s[0]*t+s[4]*n+s[8]*r+s[12])*a,this.y=(s[1]*t+s[5]*n+s[9]*r+s[13])*a,this.z=(s[2]*t+s[6]*n+s[10]*r+s[14])*a,this}applyQuaternion(e){const t=this.x,n=this.y,r=this.z,s=e.x,a=e.y,c=e.z,d=e.w,p=2*(a*r-c*n),m=2*(c*t-s*r),v=2*(s*n-a*t);return this.x=t+d*p+a*v-c*m,this.y=n+d*m+c*p-s*v,this.z=r+d*v+s*m-a*p,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,n=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[4]*n+s[8]*r,this.y=s[1]*t+s[5]*n+s[9]*r,this.z=s[2]*t+s[6]*n+s[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=on(this.x,e.x,t.x),this.y=on(this.y,e.y,t.y),this.z=on(this.z,e.z,t.z),this}clampScalar(e,t){return this.x=on(this.x,e,t),this.y=on(this.y,e,t),this.z=on(this.z,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(on(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const n=e.x,r=e.y,s=e.z,a=t.x,c=t.y,d=t.z;return this.x=r*d-s*c,this.y=s*a-n*d,this.z=n*c-r*a,this}projectOnVector(e){const t=e.lengthSq();if(t===0)return this.set(0,0,0);const n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){return OS.copy(this).projectOnVector(e),this.sub(OS)}reflect(e){return this.sub(OS.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(on(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y,r=this.z-e.z;return t*t+n*n+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,n){const r=Math.sin(t)*e;return this.x=r*Math.sin(n),this.y=Math.cos(t)*e,this.z=r*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,t=Math.random()*2-1,n=Math.sqrt(1-t*t);return this.x=n*Math.cos(e),this.y=t,this.z=n*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const OS=new Q,r1=new ao;class xn{constructor(e,t,n,r,s,a,c,d,p){xn.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,t,n,r,s,a,c,d,p)}set(e,t,n,r,s,a,c,d,p){const m=this.elements;return m[0]=e,m[1]=r,m[2]=c,m[3]=t,m[4]=s,m[5]=d,m[6]=n,m[7]=a,m[8]=p,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}extractBasis(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,r=t.elements,s=this.elements,a=n[0],c=n[3],d=n[6],p=n[1],m=n[4],v=n[7],_=n[2],b=n[5],T=n[8],I=r[0],C=r[3],A=r[6],D=r[1],U=r[4],L=r[7],z=r[2],B=r[5],k=r[8];return s[0]=a*I+c*D+d*z,s[3]=a*C+c*U+d*B,s[6]=a*A+c*L+d*k,s[1]=p*I+m*D+v*z,s[4]=p*C+m*U+v*B,s[7]=p*A+m*L+v*k,s[2]=_*I+b*D+T*z,s[5]=_*C+b*U+T*B,s[8]=_*A+b*L+T*k,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[1],r=e[2],s=e[3],a=e[4],c=e[5],d=e[6],p=e[7],m=e[8];return t*a*m-t*c*p-n*s*m+n*c*d+r*s*p-r*a*d}invert(){const e=this.elements,t=e[0],n=e[1],r=e[2],s=e[3],a=e[4],c=e[5],d=e[6],p=e[7],m=e[8],v=m*a-c*p,_=c*d-m*s,b=p*s-a*d,T=t*v+n*_+r*b;if(T===0)return this.set(0,0,0,0,0,0,0,0,0);const I=1/T;return e[0]=v*I,e[1]=(r*p-m*n)*I,e[2]=(c*n-r*a)*I,e[3]=_*I,e[4]=(m*t-r*d)*I,e[5]=(r*s-c*t)*I,e[6]=b*I,e[7]=(n*d-p*t)*I,e[8]=(a*t-n*s)*I,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,n,r,s,a,c){const d=Math.cos(s),p=Math.sin(s);return this.set(n*d,n*p,-n*(d*a+p*c)+a+e,-r*p,r*d,-r*(-p*a+d*c)+c+t,0,0,1),this}scale(e,t){return this.premultiply(zS.makeScale(e,t)),this}rotate(e){return this.premultiply(zS.makeRotation(-e)),this}translate(e,t){return this.premultiply(zS.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,n,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,n=e.elements;for(let r=0;r<9;r++)if(t[r]!==n[r])return!1;return!0}fromArray(e,t=0){for(let n=0;n<9;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const zS=new xn,s1=new xn().set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),o1=new xn().set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);function yU(){const i={enabled:!0,workingColorSpace:Pa,spaces:{},convert:function(r,s,a){return this.enabled===!1||s===a||!s||!a||(this.spaces[s].transfer===oi&&(r.r=du(r.r),r.g=du(r.g),r.b=du(r.b)),this.spaces[s].primaries!==this.spaces[a].primaries&&(r.applyMatrix3(this.spaces[s].toXYZ),r.applyMatrix3(this.spaces[a].fromXYZ)),this.spaces[a].transfer===oi&&(r.r=zh(r.r),r.g=zh(r.g),r.b=zh(r.b))),r},workingToColorSpace:function(r,s){return this.convert(r,this.workingColorSpace,s)},colorSpaceToWorking:function(r,s){return this.convert(r,s,this.workingColorSpace)},getPrimaries:function(r){return this.spaces[r].primaries},getTransfer:function(r){return r===cu?bg:this.spaces[r].transfer},getToneMappingMode:function(r){return this.spaces[r].outputColorSpaceConfig.toneMappingMode||"standard"},getLuminanceCoefficients:function(r,s=this.workingColorSpace){return r.fromArray(this.spaces[s].luminanceCoefficients)},define:function(r){Object.assign(this.spaces,r)},_getMatrix:function(r,s,a){return r.copy(this.spaces[s].toXYZ).multiply(this.spaces[a].fromXYZ)},_getDrawingBufferColorSpace:function(r){return this.spaces[r].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(r=this.workingColorSpace){return this.spaces[r].workingColorSpaceConfig.unpackColorSpace},fromWorkingColorSpace:function(r,s){return Yh("ColorManagement: .fromWorkingColorSpace() has been renamed to .workingToColorSpace()."),i.workingToColorSpace(r,s)},toWorkingColorSpace:function(r,s){return Yh("ColorManagement: .toWorkingColorSpace() has been renamed to .colorSpaceToWorking()."),i.colorSpaceToWorking(r,s)}},e=[.64,.33,.3,.6,.15,.06],t=[.2126,.7152,.0722],n=[.3127,.329];return i.define({[Pa]:{primaries:e,whitePoint:n,transfer:bg,toXYZ:s1,fromXYZ:o1,luminanceCoefficients:t,workingColorSpaceConfig:{unpackColorSpace:es},outputColorSpaceConfig:{drawingBufferColorSpace:es}},[es]:{primaries:e,whitePoint:n,transfer:oi,toXYZ:s1,fromXYZ:o1,luminanceCoefficients:t,outputColorSpaceConfig:{drawingBufferColorSpace:es}}}),i}const Gn=yU();function du(i){return i<.04045?i*.0773993808:Math.pow(i*.9478672986+.0521327014,2.4)}function zh(i){return i<.0031308?i*12.92:1.055*Math.pow(i,.41666)-.055}let lh;class wR{static getDataURL(e,t="image/png"){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let n;if(e instanceof HTMLCanvasElement)n=e;else{lh===void 0&&(lh=Eg("canvas")),lh.width=e.width,lh.height=e.height;const r=lh.getContext("2d");e instanceof ImageData?r.putImageData(e,0,0):r.drawImage(e,0,0,e.width,e.height),n=lh}return n.toDataURL(t)}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=Eg("canvas");t.width=e.width,t.height=e.height;const n=t.getContext("2d");n.drawImage(e,0,0,e.width,e.height);const r=n.getImageData(0,0,e.width,e.height),s=r.data;for(let a=0;a<s.length;a++)s[a]=du(s[a]/255)*255;return n.putImageData(r,0,0),t}else if(e.data){const t=e.data.slice(0);for(let n=0;n<t.length;n++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[n]=Math.floor(du(t[n]/255)*255):t[n]=du(t[n]);return{data:t,width:e.width,height:e.height}}else return It("ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let _U=0;class yc{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:_U++}),this.uuid=xo(),this.data=e,this.dataReady=!0,this.version=0}getSize(e){const t=this.data;return typeof HTMLVideoElement<"u"&&t instanceof HTMLVideoElement?e.set(t.videoWidth,t.videoHeight,0):typeof VideoFrame<"u"&&t instanceof VideoFrame?e.set(t.displayHeight,t.displayWidth,0):t!==null?e.set(t.width,t.height,t.depth||0):e.set(0,0,0),e}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const n={uuid:this.uuid,url:""},r=this.data;if(r!==null){let s;if(Array.isArray(r)){s=[];for(let a=0,c=r.length;a<c;a++)r[a].isDataTexture?s.push(BS(r[a].image)):s.push(BS(r[a]))}else s=BS(r);n.url=s}return t||(e.images[this.uuid]=n),n}}function BS(i){return typeof HTMLImageElement<"u"&&i instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&i instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&i instanceof ImageBitmap?wR.getDataURL(i):i.data?{data:Array.from(i.data),width:i.width,height:i.height,type:i.data.constructor.name}:(It("Texture: Unable to serialize Texture."),{})}let xU=0;const VS=new Q;class hi extends Tl{constructor(e=hi.DEFAULT_IMAGE,t=hi.DEFAULT_MAPPING,n=Qi,r=Qi,s=Bn,a=_l,c=ur,d=kr,p=hi.DEFAULT_ANISOTROPY,m=cu){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:xU++}),this.uuid=xo(),this.name="",this.source=new yc(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=n,this.wrapT=r,this.magFilter=s,this.minFilter=a,this.anisotropy=p,this.format=c,this.internalFormat=null,this.type=d,this.offset=new $e(0,0),this.repeat=new $e(1,1),this.center=new $e(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new xn,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=m,this.userData={},this.updateRanges=[],this.version=0,this.onUpdate=null,this.renderTarget=null,this.isRenderTargetTexture=!1,this.isArrayTexture=!!(e&&e.depth&&e.depth>1),this.pmremVersion=0}get width(){return this.source.getSize(VS).x}get height(){return this.source.getSize(VS).y}get depth(){return this.source.getSize(VS).z}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.renderTarget=e.renderTarget,this.isRenderTargetTexture=e.isRenderTargetTexture,this.isArrayTexture=e.isArrayTexture,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}setValues(e){for(const t in e){const n=e[t];if(n===void 0){It(`Texture.setValues(): parameter '${t}' has value of undefined.`);continue}const r=this[t];if(r===void 0){It(`Texture.setValues(): property '${t}' does not exist.`);continue}r&&n&&r.isVector2&&n.isVector2||r&&n&&r.isVector3&&n.isVector3||r&&n&&r.isMatrix3&&n.isMatrix3?r.copy(n):this[t]=n}}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const n={metadata:{version:4.7,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(n.userData=this.userData),t||(e.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==bc)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case yg:e.x=e.x-Math.floor(e.x);break;case Qi:e.x=e.x<0?0:1;break;case _g:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case yg:e.y=e.y-Math.floor(e.y);break;case Qi:e.y=e.y<0?0:1;break;case _g:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){e===!0&&this.pmremVersion++}}hi.DEFAULT_IMAGE=null;hi.DEFAULT_MAPPING=bc;hi.DEFAULT_ANISOTROPY=1;class $n{constructor(e=0,t=0,n=0,r=1){$n.prototype.isVector4=!0,this.x=e,this.y=t,this.z=n,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,n,r){return this.x=e,this.y=t,this.z=n,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,n=this.y,r=this.z,s=this.w,a=e.elements;return this.x=a[0]*t+a[4]*n+a[8]*r+a[12]*s,this.y=a[1]*t+a[5]*n+a[9]*r+a[13]*s,this.z=a[2]*t+a[6]*n+a[10]*r+a[14]*s,this.w=a[3]*t+a[7]*n+a[11]*r+a[15]*s,this}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this.w/=e.w,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,n,r,s;const d=e.elements,p=d[0],m=d[4],v=d[8],_=d[1],b=d[5],T=d[9],I=d[2],C=d[6],A=d[10];if(Math.abs(m-_)<.01&&Math.abs(v-I)<.01&&Math.abs(T-C)<.01){if(Math.abs(m+_)<.1&&Math.abs(v+I)<.1&&Math.abs(T+C)<.1&&Math.abs(p+b+A-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const U=(p+1)/2,L=(b+1)/2,z=(A+1)/2,B=(m+_)/4,k=(v+I)/4,G=(T+C)/4;return U>L&&U>z?U<.01?(n=0,r=.707106781,s=.707106781):(n=Math.sqrt(U),r=B/n,s=k/n):L>z?L<.01?(n=.707106781,r=0,s=.707106781):(r=Math.sqrt(L),n=B/r,s=G/r):z<.01?(n=.707106781,r=.707106781,s=0):(s=Math.sqrt(z),n=k/s,r=G/s),this.set(n,r,s,t),this}let D=Math.sqrt((C-T)*(C-T)+(v-I)*(v-I)+(_-m)*(_-m));return Math.abs(D)<.001&&(D=1),this.x=(C-T)/D,this.y=(v-I)/D,this.z=(_-m)/D,this.w=Math.acos((p+b+A-1)/2),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this.w=t[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=on(this.x,e.x,t.x),this.y=on(this.y,e.y,t.y),this.z=on(this.z,e.z,t.z),this.w=on(this.w,e.w,t.w),this}clampScalar(e,t){return this.x=on(this.x,e,t),this.y=on(this.y,e,t),this.z=on(this.z,e,t),this.w=on(this.w,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(on(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class $M extends Tl{constructor(e=1,t=1,n={}){super(),n=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:Bn,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1,depth:1,multiview:!1},n),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=n.depth,this.scissor=new $n(0,0,e,t),this.scissorTest=!1,this.viewport=new $n(0,0,e,t);const r={width:e,height:t,depth:n.depth},s=new hi(r);this.textures=[];const a=n.count;for(let c=0;c<a;c++)this.textures[c]=s.clone(),this.textures[c].isRenderTargetTexture=!0,this.textures[c].renderTarget=this;this._setTextureOptions(n),this.depthBuffer=n.depthBuffer,this.stencilBuffer=n.stencilBuffer,this.resolveDepthBuffer=n.resolveDepthBuffer,this.resolveStencilBuffer=n.resolveStencilBuffer,this._depthTexture=null,this.depthTexture=n.depthTexture,this.samples=n.samples,this.multiview=n.multiview}_setTextureOptions(e={}){const t={minFilter:Bn,generateMipmaps:!1,flipY:!1,internalFormat:null};e.mapping!==void 0&&(t.mapping=e.mapping),e.wrapS!==void 0&&(t.wrapS=e.wrapS),e.wrapT!==void 0&&(t.wrapT=e.wrapT),e.wrapR!==void 0&&(t.wrapR=e.wrapR),e.magFilter!==void 0&&(t.magFilter=e.magFilter),e.minFilter!==void 0&&(t.minFilter=e.minFilter),e.format!==void 0&&(t.format=e.format),e.type!==void 0&&(t.type=e.type),e.anisotropy!==void 0&&(t.anisotropy=e.anisotropy),e.colorSpace!==void 0&&(t.colorSpace=e.colorSpace),e.flipY!==void 0&&(t.flipY=e.flipY),e.generateMipmaps!==void 0&&(t.generateMipmaps=e.generateMipmaps),e.internalFormat!==void 0&&(t.internalFormat=e.internalFormat);for(let n=0;n<this.textures.length;n++)this.textures[n].setValues(t)}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}set depthTexture(e){this._depthTexture!==null&&(this._depthTexture.renderTarget=null),e!==null&&(e.renderTarget=this),this._depthTexture=e}get depthTexture(){return this._depthTexture}setSize(e,t,n=1){if(this.width!==e||this.height!==t||this.depth!==n){this.width=e,this.height=t,this.depth=n;for(let r=0,s=this.textures.length;r<s;r++)this.textures[r].image.width=e,this.textures[r].image.height=t,this.textures[r].image.depth=n,this.textures[r].isData3DTexture!==!0&&(this.textures[r].isArrayTexture=this.textures[r].image.depth>1);this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let t=0,n=e.textures.length;t<n;t++){this.textures[t]=e.textures[t].clone(),this.textures[t].isRenderTargetTexture=!0,this.textures[t].renderTarget=this;const r=Object.assign({},e.textures[t].image);this.textures[t].source=new yc(r)}return this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class Or extends $M{constructor(e=1,t=1,n={}){super(e,t,n),this.isWebGLRenderTarget=!0}}class hx extends hi{constructor(e=null,t=1,n=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:n,depth:r},this.magFilter=lr,this.minFilter=lr,this.wrapR=Qi,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class SU extends Or{constructor(e=1,t=1,n=1,r={}){super(e,t,r),this.isWebGLArrayRenderTarget=!0,this.depth=n,this.texture=new hx(null,e,t,n),this._setTextureOptions(r),this.texture.isRenderTargetTexture=!0}}class px extends hi{constructor(e=null,t=1,n=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:n,depth:r},this.magFilter=lr,this.minFilter=lr,this.wrapR=Qi,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class bU extends Or{constructor(e=1,t=1,n=1,r={}){super(e,t,r),this.isWebGL3DRenderTarget=!0,this.depth=n,this.texture=new px(null,e,t,n),this._setTextureOptions(r),this.texture.isRenderTargetTexture=!0}}class Er{constructor(e=new Q(1/0,1/0,1/0),t=new Q(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t+=3)this.expandByPoint(Ea.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,n=e.count;t<n;t++)this.expandByPoint(Ea.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=Ea.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const n=e.geometry;if(n!==void 0){const s=n.getAttribute("position");if(t===!0&&s!==void 0&&e.isInstancedMesh!==!0)for(let a=0,c=s.count;a<c;a++)e.isMesh===!0?e.getVertexPosition(a,Ea):Ea.fromBufferAttribute(s,a),Ea.applyMatrix4(e.matrixWorld),this.expandByPoint(Ea);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),zv.copy(e.boundingBox)):(n.boundingBox===null&&n.computeBoundingBox(),zv.copy(n.boundingBox)),zv.applyMatrix4(e.matrixWorld),this.union(zv)}const r=e.children;for(let s=0,a=r.length;s<a;s++)this.expandByObject(r[s],t);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){return this.clampPoint(e.center,Ea),Ea.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Fm),Bv.subVectors(this.max,Fm),uh.subVectors(e.a,Fm),ch.subVectors(e.b,Fm),fh.subVectors(e.c,Fm),lc.subVectors(ch,uh),uc.subVectors(fh,ch),gf.subVectors(uh,fh);let t=[0,-lc.z,lc.y,0,-uc.z,uc.y,0,-gf.z,gf.y,lc.z,0,-lc.x,uc.z,0,-uc.x,gf.z,0,-gf.x,-lc.y,lc.x,0,-uc.y,uc.x,0,-gf.y,gf.x,0];return!HS(t,uh,ch,fh,Bv)||(t=[1,0,0,0,1,0,0,0,1],!HS(t,uh,ch,fh,Bv))?!1:(Vv.crossVectors(lc,uc),t=[Vv.x,Vv.y,Vv.z],HS(t,uh,ch,fh,Bv))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,Ea).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(Ea).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(iu[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),iu[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),iu[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),iu[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),iu[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),iu[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),iu[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),iu[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(iu),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}toJSON(){return{min:this.min.toArray(),max:this.max.toArray()}}fromJSON(e){return this.min.fromArray(e.min),this.max.fromArray(e.max),this}}const iu=[new Q,new Q,new Q,new Q,new Q,new Q,new Q,new Q],Ea=new Q,zv=new Er,uh=new Q,ch=new Q,fh=new Q,lc=new Q,uc=new Q,gf=new Q,Fm=new Q,Bv=new Q,Vv=new Q,vf=new Q;function HS(i,e,t,n,r){for(let s=0,a=i.length-3;s<=a;s+=3){vf.fromArray(i,s);const c=r.x*Math.abs(vf.x)+r.y*Math.abs(vf.y)+r.z*Math.abs(vf.z),d=e.dot(vf),p=t.dot(vf),m=n.dot(vf);if(Math.max(-Math.max(d,p,m),Math.min(d,p,m))>c)return!1}return!0}const MU=new Er,km=new Q,GS=new Q;let Tr=class{constructor(e=new Q,t=-1){this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const n=this.center;t!==void 0?n.copy(t):MU.setFromPoints(e).getCenter(n);let r=0;for(let s=0,a=e.length;s<a;s++)r=Math.max(r,n.distanceToSquared(e[s]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const n=this.center.distanceToSquared(e);return t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;km.subVectors(e,this.center);const t=km.lengthSq();if(t>this.radius*this.radius){const n=Math.sqrt(t),r=(n-this.radius)*.5;this.center.addScaledVector(km,r/n),this.radius+=r}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(GS.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(km.copy(e.center).add(GS)),this.expandByPoint(km.copy(e.center).sub(GS))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}toJSON(){return{radius:this.radius,center:this.center.toArray()}}fromJSON(e){return this.radius=e.radius,this.center.fromArray(e.center),this}};const ru=new Q,qS=new Q,Hv=new Q,cc=new Q,WS=new Q,Gv=new Q,XS=new Q;class ip{constructor(e=new Q,t=new Q(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,ru)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,n)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=ru.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(ru.copy(this.origin).addScaledVector(this.direction,t),ru.distanceToSquared(e))}distanceSqToSegment(e,t,n,r){qS.copy(e).add(t).multiplyScalar(.5),Hv.copy(t).sub(e).normalize(),cc.copy(this.origin).sub(qS);const s=e.distanceTo(t)*.5,a=-this.direction.dot(Hv),c=cc.dot(this.direction),d=-cc.dot(Hv),p=cc.lengthSq(),m=Math.abs(1-a*a);let v,_,b,T;if(m>0)if(v=a*d-c,_=a*c-d,T=s*m,v>=0)if(_>=-T)if(_<=T){const I=1/m;v*=I,_*=I,b=v*(v+a*_+2*c)+_*(a*v+_+2*d)+p}else _=s,v=Math.max(0,-(a*_+c)),b=-v*v+_*(_+2*d)+p;else _=-s,v=Math.max(0,-(a*_+c)),b=-v*v+_*(_+2*d)+p;else _<=-T?(v=Math.max(0,-(-a*s+c)),_=v>0?-s:Math.min(Math.max(-s,-d),s),b=-v*v+_*(_+2*d)+p):_<=T?(v=0,_=Math.min(Math.max(-s,-d),s),b=_*(_+2*d)+p):(v=Math.max(0,-(a*s+c)),_=v>0?s:Math.min(Math.max(-s,-d),s),b=-v*v+_*(_+2*d)+p);else _=a>0?-s:s,v=Math.max(0,-(a*_+c)),b=-v*v+_*(_+2*d)+p;return n&&n.copy(this.origin).addScaledVector(this.direction,v),r&&r.copy(qS).addScaledVector(Hv,_),b}intersectSphere(e,t){ru.subVectors(e.center,this.origin);const n=ru.dot(this.direction),r=ru.dot(ru)-n*n,s=e.radius*e.radius;if(r>s)return null;const a=Math.sqrt(s-r),c=n-a,d=n+a;return d<0?null:c<0?this.at(d,t):this.at(c,t)}intersectsSphere(e){return e.radius<0?!1:this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;const n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}intersectPlane(e,t){const n=this.distanceToPlane(e);return n===null?null:this.at(n,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let n,r,s,a,c,d;const p=1/this.direction.x,m=1/this.direction.y,v=1/this.direction.z,_=this.origin;return p>=0?(n=(e.min.x-_.x)*p,r=(e.max.x-_.x)*p):(n=(e.max.x-_.x)*p,r=(e.min.x-_.x)*p),m>=0?(s=(e.min.y-_.y)*m,a=(e.max.y-_.y)*m):(s=(e.max.y-_.y)*m,a=(e.min.y-_.y)*m),n>a||s>r||((s>n||isNaN(n))&&(n=s),(a<r||isNaN(r))&&(r=a),v>=0?(c=(e.min.z-_.z)*v,d=(e.max.z-_.z)*v):(c=(e.max.z-_.z)*v,d=(e.min.z-_.z)*v),n>d||c>r)||((c>n||n!==n)&&(n=c),(d<r||r!==r)&&(r=d),r<0)?null:this.at(n>=0?n:r,t)}intersectsBox(e){return this.intersectBox(e,ru)!==null}intersectTriangle(e,t,n,r,s){WS.subVectors(t,e),Gv.subVectors(n,e),XS.crossVectors(WS,Gv);let a=this.direction.dot(XS),c;if(a>0){if(r)return null;c=1}else if(a<0)c=-1,a=-a;else return null;cc.subVectors(this.origin,e);const d=c*this.direction.dot(Gv.crossVectors(cc,Gv));if(d<0)return null;const p=c*this.direction.dot(WS.cross(cc));if(p<0||d+p>a)return null;const m=-c*cc.dot(XS);return m<0?null:this.at(m/a,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class an{constructor(e,t,n,r,s,a,c,d,p,m,v,_,b,T,I,C){an.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,t,n,r,s,a,c,d,p,m,v,_,b,T,I,C)}set(e,t,n,r,s,a,c,d,p,m,v,_,b,T,I,C){const A=this.elements;return A[0]=e,A[4]=t,A[8]=n,A[12]=r,A[1]=s,A[5]=a,A[9]=c,A[13]=d,A[2]=p,A[6]=m,A[10]=v,A[14]=_,A[3]=b,A[7]=T,A[11]=I,A[15]=C,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new an().fromArray(this.elements)}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}copyPosition(e){const t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,n){return this.determinant()===0?(e.set(1,0,0),t.set(0,1,0),n.set(0,0,1),this):(e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this)}makeBasis(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}extractRotation(e){if(e.determinant()===0)return this.identity();const t=this.elements,n=e.elements,r=1/dh.setFromMatrixColumn(e,0).length(),s=1/dh.setFromMatrixColumn(e,1).length(),a=1/dh.setFromMatrixColumn(e,2).length();return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=0,t[4]=n[4]*s,t[5]=n[5]*s,t[6]=n[6]*s,t[7]=0,t[8]=n[8]*a,t[9]=n[9]*a,t[10]=n[10]*a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,n=e.x,r=e.y,s=e.z,a=Math.cos(n),c=Math.sin(n),d=Math.cos(r),p=Math.sin(r),m=Math.cos(s),v=Math.sin(s);if(e.order==="XYZ"){const _=a*m,b=a*v,T=c*m,I=c*v;t[0]=d*m,t[4]=-d*v,t[8]=p,t[1]=b+T*p,t[5]=_-I*p,t[9]=-c*d,t[2]=I-_*p,t[6]=T+b*p,t[10]=a*d}else if(e.order==="YXZ"){const _=d*m,b=d*v,T=p*m,I=p*v;t[0]=_+I*c,t[4]=T*c-b,t[8]=a*p,t[1]=a*v,t[5]=a*m,t[9]=-c,t[2]=b*c-T,t[6]=I+_*c,t[10]=a*d}else if(e.order==="ZXY"){const _=d*m,b=d*v,T=p*m,I=p*v;t[0]=_-I*c,t[4]=-a*v,t[8]=T+b*c,t[1]=b+T*c,t[5]=a*m,t[9]=I-_*c,t[2]=-a*p,t[6]=c,t[10]=a*d}else if(e.order==="ZYX"){const _=a*m,b=a*v,T=c*m,I=c*v;t[0]=d*m,t[4]=T*p-b,t[8]=_*p+I,t[1]=d*v,t[5]=I*p+_,t[9]=b*p-T,t[2]=-p,t[6]=c*d,t[10]=a*d}else if(e.order==="YZX"){const _=a*d,b=a*p,T=c*d,I=c*p;t[0]=d*m,t[4]=I-_*v,t[8]=T*v+b,t[1]=v,t[5]=a*m,t[9]=-c*m,t[2]=-p*m,t[6]=b*v+T,t[10]=_-I*v}else if(e.order==="XZY"){const _=a*d,b=a*p,T=c*d,I=c*p;t[0]=d*m,t[4]=-v,t[8]=p*m,t[1]=_*v+I,t[5]=a*m,t[9]=b*v-T,t[2]=T*v-b,t[6]=c*m,t[10]=I*v+_}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(EU,e,TU)}lookAt(e,t,n){const r=this.elements;return po.subVectors(e,t),po.lengthSq()===0&&(po.z=1),po.normalize(),fc.crossVectors(n,po),fc.lengthSq()===0&&(Math.abs(n.z)===1?po.x+=1e-4:po.z+=1e-4,po.normalize(),fc.crossVectors(n,po)),fc.normalize(),qv.crossVectors(po,fc),r[0]=fc.x,r[4]=qv.x,r[8]=po.x,r[1]=fc.y,r[5]=qv.y,r[9]=po.y,r[2]=fc.z,r[6]=qv.z,r[10]=po.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,r=t.elements,s=this.elements,a=n[0],c=n[4],d=n[8],p=n[12],m=n[1],v=n[5],_=n[9],b=n[13],T=n[2],I=n[6],C=n[10],A=n[14],D=n[3],U=n[7],L=n[11],z=n[15],B=r[0],k=r[4],G=r[8],P=r[12],O=r[1],Z=r[5],ie=r[9],ee=r[13],re=r[2],de=r[6],J=r[10],te=r[14],ye=r[3],Ue=r[7],we=r[11],$=r[15];return s[0]=a*B+c*O+d*re+p*ye,s[4]=a*k+c*Z+d*de+p*Ue,s[8]=a*G+c*ie+d*J+p*we,s[12]=a*P+c*ee+d*te+p*$,s[1]=m*B+v*O+_*re+b*ye,s[5]=m*k+v*Z+_*de+b*Ue,s[9]=m*G+v*ie+_*J+b*we,s[13]=m*P+v*ee+_*te+b*$,s[2]=T*B+I*O+C*re+A*ye,s[6]=T*k+I*Z+C*de+A*Ue,s[10]=T*G+I*ie+C*J+A*we,s[14]=T*P+I*ee+C*te+A*$,s[3]=D*B+U*O+L*re+z*ye,s[7]=D*k+U*Z+L*de+z*Ue,s[11]=D*G+U*ie+L*J+z*we,s[15]=D*P+U*ee+L*te+z*$,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[4],r=e[8],s=e[12],a=e[1],c=e[5],d=e[9],p=e[13],m=e[2],v=e[6],_=e[10],b=e[14],T=e[3],I=e[7],C=e[11],A=e[15],D=d*b-p*_,U=c*b-p*v,L=c*_-d*v,z=a*b-p*m,B=a*_-d*m,k=a*v-c*m;return t*(I*D-C*U+A*L)-n*(T*D-C*z+A*B)+r*(T*U-I*z+A*k)-s*(T*L-I*B+C*k)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,n){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=n),this}invert(){const e=this.elements,t=e[0],n=e[1],r=e[2],s=e[3],a=e[4],c=e[5],d=e[6],p=e[7],m=e[8],v=e[9],_=e[10],b=e[11],T=e[12],I=e[13],C=e[14],A=e[15],D=v*C*p-I*_*p+I*d*b-c*C*b-v*d*A+c*_*A,U=T*_*p-m*C*p-T*d*b+a*C*b+m*d*A-a*_*A,L=m*I*p-T*v*p+T*c*b-a*I*b-m*c*A+a*v*A,z=T*v*d-m*I*d-T*c*_+a*I*_+m*c*C-a*v*C,B=t*D+n*U+r*L+s*z;if(B===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const k=1/B;return e[0]=D*k,e[1]=(I*_*s-v*C*s-I*r*b+n*C*b+v*r*A-n*_*A)*k,e[2]=(c*C*s-I*d*s+I*r*p-n*C*p-c*r*A+n*d*A)*k,e[3]=(v*d*s-c*_*s-v*r*p+n*_*p+c*r*b-n*d*b)*k,e[4]=U*k,e[5]=(m*C*s-T*_*s+T*r*b-t*C*b-m*r*A+t*_*A)*k,e[6]=(T*d*s-a*C*s-T*r*p+t*C*p+a*r*A-t*d*A)*k,e[7]=(a*_*s-m*d*s+m*r*p-t*_*p-a*r*b+t*d*b)*k,e[8]=L*k,e[9]=(T*v*s-m*I*s-T*n*b+t*I*b+m*n*A-t*v*A)*k,e[10]=(a*I*s-T*c*s+T*n*p-t*I*p-a*n*A+t*c*A)*k,e[11]=(m*c*s-a*v*s-m*n*p+t*v*p+a*n*b-t*c*b)*k,e[12]=z*k,e[13]=(m*I*r-T*v*r+T*n*_-t*I*_-m*n*C+t*v*C)*k,e[14]=(T*c*r-a*I*r-T*n*d+t*I*d+a*n*C-t*c*C)*k,e[15]=(a*v*r-m*c*r+m*n*d-t*v*d-a*n*_+t*c*_)*k,this}scale(e){const t=this.elements,n=e.x,r=e.y,s=e.z;return t[0]*=n,t[4]*=r,t[8]*=s,t[1]*=n,t[5]*=r,t[9]*=s,t[2]*=n,t[6]*=r,t[10]*=s,t[3]*=n,t[7]*=r,t[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,r))}makeTranslation(e,t,n){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const n=Math.cos(t),r=Math.sin(t),s=1-n,a=e.x,c=e.y,d=e.z,p=s*a,m=s*c;return this.set(p*a+n,p*c-r*d,p*d+r*c,0,p*c+r*d,m*c+n,m*d-r*a,0,p*d-r*c,m*d+r*a,s*d*d+n,0,0,0,0,1),this}makeScale(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,t,n,r,s,a){return this.set(1,n,s,0,e,1,a,0,t,r,1,0,0,0,0,1),this}compose(e,t,n){const r=this.elements,s=t._x,a=t._y,c=t._z,d=t._w,p=s+s,m=a+a,v=c+c,_=s*p,b=s*m,T=s*v,I=a*m,C=a*v,A=c*v,D=d*p,U=d*m,L=d*v,z=n.x,B=n.y,k=n.z;return r[0]=(1-(I+A))*z,r[1]=(b+L)*z,r[2]=(T-U)*z,r[3]=0,r[4]=(b-L)*B,r[5]=(1-(_+A))*B,r[6]=(C+D)*B,r[7]=0,r[8]=(T+U)*k,r[9]=(C-D)*k,r[10]=(1-(_+I))*k,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,n){const r=this.elements;if(e.x=r[12],e.y=r[13],e.z=r[14],this.determinant()===0)return n.set(1,1,1),t.identity(),this;let s=dh.set(r[0],r[1],r[2]).length();const a=dh.set(r[4],r[5],r[6]).length(),c=dh.set(r[8],r[9],r[10]).length();this.determinant()<0&&(s=-s),Ta.copy(this);const p=1/s,m=1/a,v=1/c;return Ta.elements[0]*=p,Ta.elements[1]*=p,Ta.elements[2]*=p,Ta.elements[4]*=m,Ta.elements[5]*=m,Ta.elements[6]*=m,Ta.elements[8]*=v,Ta.elements[9]*=v,Ta.elements[10]*=v,t.setFromRotationMatrix(Ta),n.x=s,n.y=a,n.z=c,this}makePerspective(e,t,n,r,s,a,c=yo,d=!1){const p=this.elements,m=2*s/(t-e),v=2*s/(n-r),_=(t+e)/(t-e),b=(n+r)/(n-r);let T,I;if(d)T=s/(a-s),I=a*s/(a-s);else if(c===yo)T=-(a+s)/(a-s),I=-2*a*s/(a-s);else if(c===Xh)T=-a/(a-s),I=-a*s/(a-s);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+c);return p[0]=m,p[4]=0,p[8]=_,p[12]=0,p[1]=0,p[5]=v,p[9]=b,p[13]=0,p[2]=0,p[6]=0,p[10]=T,p[14]=I,p[3]=0,p[7]=0,p[11]=-1,p[15]=0,this}makeOrthographic(e,t,n,r,s,a,c=yo,d=!1){const p=this.elements,m=2/(t-e),v=2/(n-r),_=-(t+e)/(t-e),b=-(n+r)/(n-r);let T,I;if(d)T=1/(a-s),I=a/(a-s);else if(c===yo)T=-2/(a-s),I=-(a+s)/(a-s);else if(c===Xh)T=-1/(a-s),I=-s/(a-s);else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+c);return p[0]=m,p[4]=0,p[8]=0,p[12]=_,p[1]=0,p[5]=v,p[9]=0,p[13]=b,p[2]=0,p[6]=0,p[10]=T,p[14]=I,p[3]=0,p[7]=0,p[11]=0,p[15]=1,this}equals(e){const t=this.elements,n=e.elements;for(let r=0;r<16;r++)if(t[r]!==n[r])return!1;return!0}fromArray(e,t=0){for(let n=0;n<16;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}}const dh=new Q,Ta=new an,EU=new Q(0,0,0),TU=new Q(1,1,1),fc=new Q,qv=new Q,po=new Q,a1=new an,l1=new ao;class Eo{constructor(e=0,t=0,n=0,r=Eo.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=n,this._order=r}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,n,r=this._order){return this._x=e,this._y=t,this._z=n,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,n=!0){const r=e.elements,s=r[0],a=r[4],c=r[8],d=r[1],p=r[5],m=r[9],v=r[2],_=r[6],b=r[10];switch(t){case"XYZ":this._y=Math.asin(on(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(-m,b),this._z=Math.atan2(-a,s)):(this._x=Math.atan2(_,p),this._z=0);break;case"YXZ":this._x=Math.asin(-on(m,-1,1)),Math.abs(m)<.9999999?(this._y=Math.atan2(c,b),this._z=Math.atan2(d,p)):(this._y=Math.atan2(-v,s),this._z=0);break;case"ZXY":this._x=Math.asin(on(_,-1,1)),Math.abs(_)<.9999999?(this._y=Math.atan2(-v,b),this._z=Math.atan2(-a,p)):(this._y=0,this._z=Math.atan2(d,s));break;case"ZYX":this._y=Math.asin(-on(v,-1,1)),Math.abs(v)<.9999999?(this._x=Math.atan2(_,b),this._z=Math.atan2(d,s)):(this._x=0,this._z=Math.atan2(-a,p));break;case"YZX":this._z=Math.asin(on(d,-1,1)),Math.abs(d)<.9999999?(this._x=Math.atan2(-m,p),this._y=Math.atan2(-v,s)):(this._x=0,this._y=Math.atan2(c,b));break;case"XZY":this._z=Math.asin(-on(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(_,p),this._y=Math.atan2(c,s)):(this._x=Math.atan2(-m,b),this._y=0);break;default:It("Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,n===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,n){return a1.makeRotationFromQuaternion(e),this.setFromRotationMatrix(a1,t,n)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return l1.setFromEuler(this),this.setFromQuaternion(l1,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}Eo.DEFAULT_ORDER="XYZ";class Zh{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let AU=0;const u1=new Q,hh=new ao,su=new an,Wv=new Q,Om=new Q,wU=new Q,CU=new ao,c1=new Q(1,0,0),f1=new Q(0,1,0),d1=new Q(0,0,1),h1={type:"added"},RU={type:"removed"},ph={type:"childadded",child:null},YS={type:"childremoved",child:null};class Kn extends Tl{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:AU++}),this.uuid=xo(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Kn.DEFAULT_UP.clone();const e=new Q,t=new Eo,n=new ao,r=new Q(1,1,1);function s(){n.setFromEuler(t,!1)}function a(){t.setFromQuaternion(n,void 0,!1)}t._onChange(s),n._onChange(a),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new an},normalMatrix:{value:new xn}}),this.matrix=new an,this.matrixWorld=new an,this.matrixAutoUpdate=Kn.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=Kn.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new Zh,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.customDepthMaterial=void 0,this.customDistanceMaterial=void 0,this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return hh.setFromAxisAngle(e,t),this.quaternion.multiply(hh),this}rotateOnWorldAxis(e,t){return hh.setFromAxisAngle(e,t),this.quaternion.premultiply(hh),this}rotateX(e){return this.rotateOnAxis(c1,e)}rotateY(e){return this.rotateOnAxis(f1,e)}rotateZ(e){return this.rotateOnAxis(d1,e)}translateOnAxis(e,t){return u1.copy(e).applyQuaternion(this.quaternion),this.position.add(u1.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(c1,e)}translateY(e){return this.translateOnAxis(f1,e)}translateZ(e){return this.translateOnAxis(d1,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(su.copy(this.matrixWorld).invert())}lookAt(e,t,n){e.isVector3?Wv.copy(e):Wv.set(e,t,n);const r=this.parent;this.updateWorldMatrix(!0,!1),Om.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?su.lookAt(Om,Wv,this.up):su.lookAt(Wv,Om,this.up),this.quaternion.setFromRotationMatrix(su),r&&(su.extractRotation(r.matrixWorld),hh.setFromRotationMatrix(su),this.quaternion.premultiply(hh.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(Jt("Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(h1),ph.child=e,this.dispatchEvent(ph),ph.child=null):Jt("Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.remove(arguments[n]);return this}const t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(RU),YS.child=e,this.dispatchEvent(YS),YS.child=null),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),su.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),su.multiply(e.parent.matrixWorld)),e.applyMatrix4(su),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(h1),ph.child=e,this.dispatchEvent(ph),ph.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let n=0,r=this.children.length;n<r;n++){const a=this.children[n].getObjectByProperty(e,t);if(a!==void 0)return a}}getObjectsByProperty(e,t,n=[]){this[e]===t&&n.push(this);const r=this.children;for(let s=0,a=r.length;s<a;s++)r[s].getObjectsByProperty(e,t,n);return n}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Om,e,wU),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Om,CU,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].traverseVisible(e)}traverseAncestors(e){const t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let n=0,r=t.length;n<r;n++)t[n].updateMatrixWorld(e)}updateWorldMatrix(e,t){const n=this.parent;if(e===!0&&n!==null&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),t===!0){const r=this.children;for(let s=0,a=r.length;s<a;s++)r[s].updateWorldMatrix(!1,!0)}}toJSON(e){const t=e===void 0||typeof e=="string",n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.7,type:"Object",generator:"Object3D.toJSON"});const r={};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.castShadow===!0&&(r.castShadow=!0),this.receiveShadow===!0&&(r.receiveShadow=!0),this.visible===!1&&(r.visible=!1),this.frustumCulled===!1&&(r.frustumCulled=!1),this.renderOrder!==0&&(r.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),r.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(r.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(r.type="BatchedMesh",r.perObjectFrustumCulled=this.perObjectFrustumCulled,r.sortObjects=this.sortObjects,r.drawRanges=this._drawRanges,r.reservedRanges=this._reservedRanges,r.geometryInfo=this._geometryInfo.map(c=>({...c,boundingBox:c.boundingBox?c.boundingBox.toJSON():void 0,boundingSphere:c.boundingSphere?c.boundingSphere.toJSON():void 0})),r.instanceInfo=this._instanceInfo.map(c=>({...c})),r.availableInstanceIds=this._availableInstanceIds.slice(),r.availableGeometryIds=this._availableGeometryIds.slice(),r.nextIndexStart=this._nextIndexStart,r.nextVertexStart=this._nextVertexStart,r.geometryCount=this._geometryCount,r.maxInstanceCount=this._maxInstanceCount,r.maxVertexCount=this._maxVertexCount,r.maxIndexCount=this._maxIndexCount,r.geometryInitialized=this._geometryInitialized,r.matricesTexture=this._matricesTexture.toJSON(e),r.indirectTexture=this._indirectTexture.toJSON(e),this._colorsTexture!==null&&(r.colorsTexture=this._colorsTexture.toJSON(e)),this.boundingSphere!==null&&(r.boundingSphere=this.boundingSphere.toJSON()),this.boundingBox!==null&&(r.boundingBox=this.boundingBox.toJSON()));function s(c,d){return c[d.uuid]===void 0&&(c[d.uuid]=d.toJSON(e)),d.uuid}if(this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(r.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=s(e.geometries,this.geometry);const c=this.geometry.parameters;if(c!==void 0&&c.shapes!==void 0){const d=c.shapes;if(Array.isArray(d))for(let p=0,m=d.length;p<m;p++){const v=d[p];s(e.shapes,v)}else s(e.shapes,d)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(s(e.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const c=[];for(let d=0,p=this.material.length;d<p;d++)c.push(s(e.materials,this.material[d]));r.material=c}else r.material=s(e.materials,this.material);if(this.children.length>0){r.children=[];for(let c=0;c<this.children.length;c++)r.children.push(this.children[c].toJSON(e).object)}if(this.animations.length>0){r.animations=[];for(let c=0;c<this.animations.length;c++){const d=this.animations[c];r.animations.push(s(e.animations,d))}}if(t){const c=a(e.geometries),d=a(e.materials),p=a(e.textures),m=a(e.images),v=a(e.shapes),_=a(e.skeletons),b=a(e.animations),T=a(e.nodes);c.length>0&&(n.geometries=c),d.length>0&&(n.materials=d),p.length>0&&(n.textures=p),m.length>0&&(n.images=m),v.length>0&&(n.shapes=v),_.length>0&&(n.skeletons=_),b.length>0&&(n.animations=b),T.length>0&&(n.nodes=T)}return n.object=r,n;function a(c){const d=[];for(const p in c){const m=c[p];delete m.metadata,d.push(m)}return d}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let n=0;n<e.children.length;n++){const r=e.children[n];this.add(r.clone())}return this}}Kn.DEFAULT_UP=new Q(0,1,0);Kn.DEFAULT_MATRIX_AUTO_UPDATE=!0;Kn.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const Aa=new Q,ou=new Q,JS=new Q,au=new Q,mh=new Q,gh=new Q,p1=new Q,ZS=new Q,$S=new Q,KS=new Q,QS=new $n,jS=new $n,eb=new $n;class oo{constructor(e=new Q,t=new Q,n=new Q){this.a=e,this.b=t,this.c=n}static getNormal(e,t,n,r){r.subVectors(n,t),Aa.subVectors(e,t),r.cross(Aa);const s=r.lengthSq();return s>0?r.multiplyScalar(1/Math.sqrt(s)):r.set(0,0,0)}static getBarycoord(e,t,n,r,s){Aa.subVectors(r,t),ou.subVectors(n,t),JS.subVectors(e,t);const a=Aa.dot(Aa),c=Aa.dot(ou),d=Aa.dot(JS),p=ou.dot(ou),m=ou.dot(JS),v=a*p-c*c;if(v===0)return s.set(0,0,0),null;const _=1/v,b=(p*d-c*m)*_,T=(a*m-c*d)*_;return s.set(1-b-T,T,b)}static containsPoint(e,t,n,r){return this.getBarycoord(e,t,n,r,au)===null?!1:au.x>=0&&au.y>=0&&au.x+au.y<=1}static getInterpolation(e,t,n,r,s,a,c,d){return this.getBarycoord(e,t,n,r,au)===null?(d.x=0,d.y=0,"z"in d&&(d.z=0),"w"in d&&(d.w=0),null):(d.setScalar(0),d.addScaledVector(s,au.x),d.addScaledVector(a,au.y),d.addScaledVector(c,au.z),d)}static getInterpolatedAttribute(e,t,n,r,s,a){return QS.setScalar(0),jS.setScalar(0),eb.setScalar(0),QS.fromBufferAttribute(e,t),jS.fromBufferAttribute(e,n),eb.fromBufferAttribute(e,r),a.setScalar(0),a.addScaledVector(QS,s.x),a.addScaledVector(jS,s.y),a.addScaledVector(eb,s.z),a}static isFrontFacing(e,t,n,r){return Aa.subVectors(n,t),ou.subVectors(e,t),Aa.cross(ou).dot(r)<0}set(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}setFromPointsAndIndices(e,t,n,r){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,n,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return Aa.subVectors(this.c,this.b),ou.subVectors(this.a,this.b),Aa.cross(ou).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return oo.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return oo.getBarycoord(e,this.a,this.b,this.c,t)}getInterpolation(e,t,n,r,s){return oo.getInterpolation(e,this.a,this.b,this.c,t,n,r,s)}containsPoint(e){return oo.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return oo.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const n=this.a,r=this.b,s=this.c;let a,c;mh.subVectors(r,n),gh.subVectors(s,n),ZS.subVectors(e,n);const d=mh.dot(ZS),p=gh.dot(ZS);if(d<=0&&p<=0)return t.copy(n);$S.subVectors(e,r);const m=mh.dot($S),v=gh.dot($S);if(m>=0&&v<=m)return t.copy(r);const _=d*v-m*p;if(_<=0&&d>=0&&m<=0)return a=d/(d-m),t.copy(n).addScaledVector(mh,a);KS.subVectors(e,s);const b=mh.dot(KS),T=gh.dot(KS);if(T>=0&&b<=T)return t.copy(s);const I=b*p-d*T;if(I<=0&&p>=0&&T<=0)return c=p/(p-T),t.copy(n).addScaledVector(gh,c);const C=m*T-b*v;if(C<=0&&v-m>=0&&b-T>=0)return p1.subVectors(s,r),c=(v-m)/(v-m+(b-T)),t.copy(r).addScaledVector(p1,c);const A=1/(C+I+_);return a=I*A,c=_*A,t.copy(n).addScaledVector(mh,a).addScaledVector(gh,c)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const CR={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},dc={h:0,s:0,l:0},Xv={h:0,s:0,l:0};function tb(i,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?i+(e-i)*6*t:t<1/2?e:t<2/3?i+(e-i)*6*(2/3-t):i}class Pt{constructor(e,t,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,n)}set(e,t,n){if(t===void 0&&n===void 0){const r=e;r&&r.isColor?this.copy(r):typeof r=="number"?this.setHex(r):typeof r=="string"&&this.setStyle(r)}else this.setRGB(e,t,n);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=es){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,Gn.colorSpaceToWorking(this,t),this}setRGB(e,t,n,r=Gn.workingColorSpace){return this.r=e,this.g=t,this.b=n,Gn.colorSpaceToWorking(this,r),this}setHSL(e,t,n,r=Gn.workingColorSpace){if(e=ZM(e,1),t=on(t,0,1),n=on(n,0,1),t===0)this.r=this.g=this.b=n;else{const s=n<=.5?n*(1+t):n+t-n*t,a=2*n-s;this.r=tb(a,s,e+1/3),this.g=tb(a,s,e),this.b=tb(a,s,e-1/3)}return Gn.colorSpaceToWorking(this,r),this}setStyle(e,t=es){function n(s){s!==void 0&&parseFloat(s)<1&&It("Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(e)){let s;const a=r[1],c=r[2];switch(a){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(c))return n(s[4]),this.setRGB(Math.min(255,parseInt(s[1],10))/255,Math.min(255,parseInt(s[2],10))/255,Math.min(255,parseInt(s[3],10))/255,t);if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(c))return n(s[4]),this.setRGB(Math.min(100,parseInt(s[1],10))/100,Math.min(100,parseInt(s[2],10))/100,Math.min(100,parseInt(s[3],10))/100,t);break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(c))return n(s[4]),this.setHSL(parseFloat(s[1])/360,parseFloat(s[2])/100,parseFloat(s[3])/100,t);break;default:It("Color: Unknown color model "+e)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){const s=r[1],a=s.length;if(a===3)return this.setRGB(parseInt(s.charAt(0),16)/15,parseInt(s.charAt(1),16)/15,parseInt(s.charAt(2),16)/15,t);if(a===6)return this.setHex(parseInt(s,16),t);It("Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=es){const n=CR[e.toLowerCase()];return n!==void 0?this.setHex(n,t):It("Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=du(e.r),this.g=du(e.g),this.b=du(e.b),this}copyLinearToSRGB(e){return this.r=zh(e.r),this.g=zh(e.g),this.b=zh(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=es){return Gn.workingToColorSpace(hs.copy(this),e),Math.round(on(hs.r*255,0,255))*65536+Math.round(on(hs.g*255,0,255))*256+Math.round(on(hs.b*255,0,255))}getHexString(e=es){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=Gn.workingColorSpace){Gn.workingToColorSpace(hs.copy(this),t);const n=hs.r,r=hs.g,s=hs.b,a=Math.max(n,r,s),c=Math.min(n,r,s);let d,p;const m=(c+a)/2;if(c===a)d=0,p=0;else{const v=a-c;switch(p=m<=.5?v/(a+c):v/(2-a-c),a){case n:d=(r-s)/v+(r<s?6:0);break;case r:d=(s-n)/v+2;break;case s:d=(n-r)/v+4;break}d/=6}return e.h=d,e.s=p,e.l=m,e}getRGB(e,t=Gn.workingColorSpace){return Gn.workingToColorSpace(hs.copy(this),t),e.r=hs.r,e.g=hs.g,e.b=hs.b,e}getStyle(e=es){Gn.workingToColorSpace(hs.copy(this),e);const t=hs.r,n=hs.g,r=hs.b;return e!==es?`color(${e} ${t.toFixed(3)} ${n.toFixed(3)} ${r.toFixed(3)})`:`rgb(${Math.round(t*255)},${Math.round(n*255)},${Math.round(r*255)})`}offsetHSL(e,t,n){return this.getHSL(dc),this.setHSL(dc.h+e,dc.s+t,dc.l+n)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,n){return this.r=e.r+(t.r-e.r)*n,this.g=e.g+(t.g-e.g)*n,this.b=e.b+(t.b-e.b)*n,this}lerpHSL(e,t){this.getHSL(dc),e.getHSL(Xv);const n=cg(dc.h,Xv.h,t),r=cg(dc.s,Xv.s,t),s=cg(dc.l,Xv.l,t);return this.setHSL(n,r,s),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,n=this.g,r=this.b,s=e.elements;return this.r=s[0]*t+s[3]*n+s[6]*r,this.g=s[1]*t+s[4]*n+s[7]*r,this.b=s[2]*t+s[5]*n+s[8]*r,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const hs=new Pt;Pt.NAMES=CR;let IU=0;class vs extends Tl{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:IU++}),this.uuid=xo(),this.name="",this.type="Material",this.blending=zf,this.side=hu,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=Zy,this.blendDst=$y,this.blendEquation=gc,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new Pt(0,0,0),this.blendAlpha=0,this.depthFunc=Gf,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=eM,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=If,this.stencilZFail=If,this.stencilZPass=If,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.allowOverride=!0,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const t in e){const n=e[t];if(n===void 0){It(`Material: parameter '${t}' has value of undefined.`);continue}const r=this[t];if(r===void 0){It(`Material: '${t}' is not a property of THREE.${this.type}.`);continue}r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[t]=n}}toJSON(e){const t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});const n={metadata:{version:4.7,type:"Material",generator:"Material.toJSON"}};n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),this.roughness!==void 0&&(n.roughness=this.roughness),this.metalness!==void 0&&(n.metalness=this.metalness),this.sheen!==void 0&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(n.shininess=this.shininess),this.clearcoat!==void 0&&(n.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.sheenColorMap&&this.sheenColorMap.isTexture&&(n.sheenColorMap=this.sheenColorMap.toJSON(e).uuid),this.sheenRoughnessMap&&this.sheenRoughnessMap.isTexture&&(n.sheenRoughnessMap=this.sheenRoughnessMap.toJSON(e).uuid),this.dispersion!==void 0&&(n.dispersion=this.dispersion),this.iridescence!==void 0&&(n.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(n.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(n.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(n.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(n.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(n.combine=this.combine)),this.envMapRotation!==void 0&&(n.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(n.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(n.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(n.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(n.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(n.size=this.size),this.shadowSide!==null&&(n.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==zf&&(n.blending=this.blending),this.side!==hu&&(n.side=this.side),this.vertexColors===!0&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),this.transparent===!0&&(n.transparent=!0),this.blendSrc!==Zy&&(n.blendSrc=this.blendSrc),this.blendDst!==$y&&(n.blendDst=this.blendDst),this.blendEquation!==gc&&(n.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(n.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(n.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(n.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(n.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(n.blendAlpha=this.blendAlpha),this.depthFunc!==Gf&&(n.depthFunc=this.depthFunc),this.depthTest===!1&&(n.depthTest=this.depthTest),this.depthWrite===!1&&(n.depthWrite=this.depthWrite),this.colorWrite===!1&&(n.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(n.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==eM&&(n.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(n.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(n.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==If&&(n.stencilFail=this.stencilFail),this.stencilZFail!==If&&(n.stencilZFail=this.stencilZFail),this.stencilZPass!==If&&(n.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(n.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(n.rotation=this.rotation),this.polygonOffset===!0&&(n.polygonOffset=!0),this.polygonOffsetFactor!==0&&(n.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(n.linewidth=this.linewidth),this.dashSize!==void 0&&(n.dashSize=this.dashSize),this.gapSize!==void 0&&(n.gapSize=this.gapSize),this.scale!==void 0&&(n.scale=this.scale),this.dithering===!0&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),this.alphaHash===!0&&(n.alphaHash=!0),this.alphaToCoverage===!0&&(n.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(n.premultipliedAlpha=!0),this.forceSinglePass===!0&&(n.forceSinglePass=!0),this.allowOverride===!1&&(n.allowOverride=!1),this.wireframe===!0&&(n.wireframe=!0),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(n.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(n.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(n.flatShading=!0),this.visible===!1&&(n.visible=!1),this.toneMapped===!1&&(n.toneMapped=!1),this.fog===!1&&(n.fog=!1),Object.keys(this.userData).length>0&&(n.userData=this.userData);function r(s){const a=[];for(const c in s){const d=s[c];delete d.metadata,a.push(d)}return a}if(t){const s=r(e.textures),a=r(e.images);s.length>0&&(n.textures=s),a.length>0&&(n.images=a)}return n}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let n=null;if(t!==null){const r=t.length;n=new Array(r);for(let s=0;s!==r;++s)n[s]=t[s].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.allowOverride=e.allowOverride,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}}class mu extends vs{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Pt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Eo,this.combine=kg,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const fu=NU();function NU(){const i=new ArrayBuffer(4),e=new Float32Array(i),t=new Uint32Array(i),n=new Uint32Array(512),r=new Uint32Array(512);for(let d=0;d<256;++d){const p=d-127;p<-27?(n[d]=0,n[d|256]=32768,r[d]=24,r[d|256]=24):p<-14?(n[d]=1024>>-p-14,n[d|256]=1024>>-p-14|32768,r[d]=-p-1,r[d|256]=-p-1):p<=15?(n[d]=p+15<<10,n[d|256]=p+15<<10|32768,r[d]=13,r[d|256]=13):p<128?(n[d]=31744,n[d|256]=64512,r[d]=24,r[d|256]=24):(n[d]=31744,n[d|256]=64512,r[d]=13,r[d|256]=13)}const s=new Uint32Array(2048),a=new Uint32Array(64),c=new Uint32Array(64);for(let d=1;d<1024;++d){let p=d<<13,m=0;for(;(p&8388608)===0;)p<<=1,m-=8388608;p&=-8388609,m+=947912704,s[d]=p|m}for(let d=1024;d<2048;++d)s[d]=939524096+(d-1024<<13);for(let d=1;d<31;++d)a[d]=d<<23;a[31]=1199570944,a[32]=2147483648;for(let d=33;d<63;++d)a[d]=2147483648+(d-32<<23);a[63]=3347054592;for(let d=1;d<64;++d)d!==32&&(c[d]=1024);return{floatView:e,uint32View:t,baseTable:n,shiftTable:r,mantissaTable:s,exponentTable:a,offsetTable:c}}function so(i){Math.abs(i)>65504&&It("DataUtils.toHalfFloat(): Value out of range."),i=on(i,-65504,65504),fu.floatView[0]=i;const e=fu.uint32View[0],t=e>>23&511;return fu.baseTable[t]+((e&8388607)>>fu.shiftTable[t])}function eg(i){const e=i>>10;return fu.uint32View[0]=fu.mantissaTable[fu.offsetTable[e]+(i&1023)]+fu.exponentTable[e],fu.floatView[0]}class Ff{static toHalfFloat(e){return so(e)}static fromHalfFloat(e){return eg(e)}}const yr=new Q,Yv=new $e;let DU=0;class pi{constructor(e,t,n=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,Object.defineProperty(this,"id",{value:DU++}),this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=n,this.usage=Mg,this.updateRanges=[],this.gpuType=Ni,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,n){e*=this.itemSize,n*=t.itemSize;for(let r=0,s=this.itemSize;r<s;r++)this.array[e+r]=t.array[n+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,n=this.count;t<n;t++)Yv.fromBufferAttribute(this,t),Yv.applyMatrix3(e),this.setXY(t,Yv.x,Yv.y);else if(this.itemSize===3)for(let t=0,n=this.count;t<n;t++)yr.fromBufferAttribute(this,t),yr.applyMatrix3(e),this.setXYZ(t,yr.x,yr.y,yr.z);return this}applyMatrix4(e){for(let t=0,n=this.count;t<n;t++)yr.fromBufferAttribute(this,t),yr.applyMatrix4(e),this.setXYZ(t,yr.x,yr.y,yr.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)yr.fromBufferAttribute(this,t),yr.applyNormalMatrix(e),this.setXYZ(t,yr.x,yr.y,yr.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)yr.fromBufferAttribute(this,t),yr.transformDirection(e),this.setXYZ(t,yr.x,yr.y,yr.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let n=this.array[e*this.itemSize+t];return this.normalized&&(n=Us(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=En(n,this.array)),this.array[e*this.itemSize+t]=n,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=Us(t,this.array)),t}setX(e,t){return this.normalized&&(t=En(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=Us(t,this.array)),t}setY(e,t){return this.normalized&&(t=En(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=Us(t,this.array)),t}setZ(e,t){return this.normalized&&(t=En(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=Us(t,this.array)),t}setW(e,t){return this.normalized&&(t=En(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=En(t,this.array),n=En(n,this.array)),this.array[e+0]=t,this.array[e+1]=n,this}setXYZ(e,t,n,r){return e*=this.itemSize,this.normalized&&(t=En(t,this.array),n=En(n,this.array),r=En(r,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this}setXYZW(e,t,n,r,s){return e*=this.itemSize,this.normalized&&(t=En(t,this.array),n=En(n,this.array),r=En(r,this.array),s=En(s,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==Mg&&(e.usage=this.usage),e}}class UU extends pi{constructor(e,t,n){super(new Int8Array(e),t,n)}}class PU extends pi{constructor(e,t,n){super(new Uint8Array(e),t,n)}}class LU extends pi{constructor(e,t,n){super(new Uint8ClampedArray(e),t,n)}}class FU extends pi{constructor(e,t,n){super(new Int16Array(e),t,n)}}class KM extends pi{constructor(e,t,n){super(new Uint16Array(e),t,n)}}class kU extends pi{constructor(e,t,n){super(new Int32Array(e),t,n)}}class QM extends pi{constructor(e,t,n){super(new Uint32Array(e),t,n)}}class OU extends pi{constructor(e,t,n){super(new Uint16Array(e),t,n),this.isFloat16BufferAttribute=!0}getX(e){let t=eg(this.array[e*this.itemSize]);return this.normalized&&(t=Us(t,this.array)),t}setX(e,t){return this.normalized&&(t=En(t,this.array)),this.array[e*this.itemSize]=so(t),this}getY(e){let t=eg(this.array[e*this.itemSize+1]);return this.normalized&&(t=Us(t,this.array)),t}setY(e,t){return this.normalized&&(t=En(t,this.array)),this.array[e*this.itemSize+1]=so(t),this}getZ(e){let t=eg(this.array[e*this.itemSize+2]);return this.normalized&&(t=Us(t,this.array)),t}setZ(e,t){return this.normalized&&(t=En(t,this.array)),this.array[e*this.itemSize+2]=so(t),this}getW(e){let t=eg(this.array[e*this.itemSize+3]);return this.normalized&&(t=Us(t,this.array)),t}setW(e,t){return this.normalized&&(t=En(t,this.array)),this.array[e*this.itemSize+3]=so(t),this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=En(t,this.array),n=En(n,this.array)),this.array[e+0]=so(t),this.array[e+1]=so(n),this}setXYZ(e,t,n,r){return e*=this.itemSize,this.normalized&&(t=En(t,this.array),n=En(n,this.array),r=En(r,this.array)),this.array[e+0]=so(t),this.array[e+1]=so(n),this.array[e+2]=so(r),this}setXYZW(e,t,n,r,s){return e*=this.itemSize,this.normalized&&(t=En(t,this.array),n=En(n,this.array),r=En(r,this.array),s=En(s,this.array)),this.array[e+0]=so(t),this.array[e+1]=so(n),this.array[e+2]=so(r),this.array[e+3]=so(s),this}}class zt extends pi{constructor(e,t,n){super(new Float32Array(e),t,n)}}let zU=0;const Qo=new an,nb=new Kn,vh=new Q,mo=new Er,zm=new Er,Lr=new Q;class vn extends Tl{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:zU++}),this.uuid=xo(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.indirectOffset=0,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(ER(e)?QM:KM)(e,1):this.index=e,this}setIndirect(e,t=0){return this.indirect=e,this.indirectOffset=t,this}getIndirect(){return this.indirect}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,n=0){this.groups.push({start:e,count:t,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);const n=this.attributes.normal;if(n!==void 0){const s=new xn().getNormalMatrix(e);n.applyNormalMatrix(s),n.needsUpdate=!0}const r=this.attributes.tangent;return r!==void 0&&(r.transformDirection(e),r.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return Qo.makeRotationFromQuaternion(e),this.applyMatrix4(Qo),this}rotateX(e){return Qo.makeRotationX(e),this.applyMatrix4(Qo),this}rotateY(e){return Qo.makeRotationY(e),this.applyMatrix4(Qo),this}rotateZ(e){return Qo.makeRotationZ(e),this.applyMatrix4(Qo),this}translate(e,t,n){return Qo.makeTranslation(e,t,n),this.applyMatrix4(Qo),this}scale(e,t,n){return Qo.makeScale(e,t,n),this.applyMatrix4(Qo),this}lookAt(e){return nb.lookAt(e),nb.updateMatrix(),this.applyMatrix4(nb.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(vh).negate(),this.translate(vh.x,vh.y,vh.z),this}setFromPoints(e){const t=this.getAttribute("position");if(t===void 0){const n=[];for(let r=0,s=e.length;r<s;r++){const a=e[r];n.push(a.x,a.y,a.z||0)}this.setAttribute("position",new zt(n,3))}else{const n=Math.min(e.length,t.count);for(let r=0;r<n;r++){const s=e[r];t.setXYZ(r,s.x,s.y,s.z||0)}e.length>t.count&&It("BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),t.needsUpdate=!0}return this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Er);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){Jt("BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new Q(-1/0,-1/0,-1/0),new Q(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let n=0,r=t.length;n<r;n++){const s=t[n];mo.setFromBufferAttribute(s),this.morphTargetsRelative?(Lr.addVectors(this.boundingBox.min,mo.min),this.boundingBox.expandByPoint(Lr),Lr.addVectors(this.boundingBox.max,mo.max),this.boundingBox.expandByPoint(Lr)):(this.boundingBox.expandByPoint(mo.min),this.boundingBox.expandByPoint(mo.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&Jt('BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Tr);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){Jt("BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new Q,1/0);return}if(e){const n=this.boundingSphere.center;if(mo.setFromBufferAttribute(e),t)for(let s=0,a=t.length;s<a;s++){const c=t[s];zm.setFromBufferAttribute(c),this.morphTargetsRelative?(Lr.addVectors(mo.min,zm.min),mo.expandByPoint(Lr),Lr.addVectors(mo.max,zm.max),mo.expandByPoint(Lr)):(mo.expandByPoint(zm.min),mo.expandByPoint(zm.max))}mo.getCenter(n);let r=0;for(let s=0,a=e.count;s<a;s++)Lr.fromBufferAttribute(e,s),r=Math.max(r,n.distanceToSquared(Lr));if(t)for(let s=0,a=t.length;s<a;s++){const c=t[s],d=this.morphTargetsRelative;for(let p=0,m=c.count;p<m;p++)Lr.fromBufferAttribute(c,p),d&&(vh.fromBufferAttribute(e,p),Lr.add(vh)),r=Math.max(r,n.distanceToSquared(Lr))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&Jt('BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){Jt("BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const n=t.position,r=t.normal,s=t.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new pi(new Float32Array(4*n.count),4));const a=this.getAttribute("tangent"),c=[],d=[];for(let G=0;G<n.count;G++)c[G]=new Q,d[G]=new Q;const p=new Q,m=new Q,v=new Q,_=new $e,b=new $e,T=new $e,I=new Q,C=new Q;function A(G,P,O){p.fromBufferAttribute(n,G),m.fromBufferAttribute(n,P),v.fromBufferAttribute(n,O),_.fromBufferAttribute(s,G),b.fromBufferAttribute(s,P),T.fromBufferAttribute(s,O),m.sub(p),v.sub(p),b.sub(_),T.sub(_);const Z=1/(b.x*T.y-T.x*b.y);isFinite(Z)&&(I.copy(m).multiplyScalar(T.y).addScaledVector(v,-b.y).multiplyScalar(Z),C.copy(v).multiplyScalar(b.x).addScaledVector(m,-T.x).multiplyScalar(Z),c[G].add(I),c[P].add(I),c[O].add(I),d[G].add(C),d[P].add(C),d[O].add(C))}let D=this.groups;D.length===0&&(D=[{start:0,count:e.count}]);for(let G=0,P=D.length;G<P;++G){const O=D[G],Z=O.start,ie=O.count;for(let ee=Z,re=Z+ie;ee<re;ee+=3)A(e.getX(ee+0),e.getX(ee+1),e.getX(ee+2))}const U=new Q,L=new Q,z=new Q,B=new Q;function k(G){z.fromBufferAttribute(r,G),B.copy(z);const P=c[G];U.copy(P),U.sub(z.multiplyScalar(z.dot(P))).normalize(),L.crossVectors(B,P);const Z=L.dot(d[G])<0?-1:1;a.setXYZW(G,U.x,U.y,U.z,Z)}for(let G=0,P=D.length;G<P;++G){const O=D[G],Z=O.start,ie=O.count;for(let ee=Z,re=Z+ie;ee<re;ee+=3)k(e.getX(ee+0)),k(e.getX(ee+1)),k(e.getX(ee+2))}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(t!==void 0){let n=this.getAttribute("normal");if(n===void 0)n=new pi(new Float32Array(t.count*3),3),this.setAttribute("normal",n);else for(let _=0,b=n.count;_<b;_++)n.setXYZ(_,0,0,0);const r=new Q,s=new Q,a=new Q,c=new Q,d=new Q,p=new Q,m=new Q,v=new Q;if(e)for(let _=0,b=e.count;_<b;_+=3){const T=e.getX(_+0),I=e.getX(_+1),C=e.getX(_+2);r.fromBufferAttribute(t,T),s.fromBufferAttribute(t,I),a.fromBufferAttribute(t,C),m.subVectors(a,s),v.subVectors(r,s),m.cross(v),c.fromBufferAttribute(n,T),d.fromBufferAttribute(n,I),p.fromBufferAttribute(n,C),c.add(m),d.add(m),p.add(m),n.setXYZ(T,c.x,c.y,c.z),n.setXYZ(I,d.x,d.y,d.z),n.setXYZ(C,p.x,p.y,p.z)}else for(let _=0,b=t.count;_<b;_+=3)r.fromBufferAttribute(t,_+0),s.fromBufferAttribute(t,_+1),a.fromBufferAttribute(t,_+2),m.subVectors(a,s),v.subVectors(r,s),m.cross(v),n.setXYZ(_+0,m.x,m.y,m.z),n.setXYZ(_+1,m.x,m.y,m.z),n.setXYZ(_+2,m.x,m.y,m.z);this.normalizeNormals(),n.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,n=e.count;t<n;t++)Lr.fromBufferAttribute(e,t),Lr.normalize(),e.setXYZ(t,Lr.x,Lr.y,Lr.z)}toNonIndexed(){function e(c,d){const p=c.array,m=c.itemSize,v=c.normalized,_=new p.constructor(d.length*m);let b=0,T=0;for(let I=0,C=d.length;I<C;I++){c.isInterleavedBufferAttribute?b=d[I]*c.data.stride+c.offset:b=d[I]*m;for(let A=0;A<m;A++)_[T++]=p[b++]}return new pi(_,m,v)}if(this.index===null)return It("BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new vn,n=this.index.array,r=this.attributes;for(const c in r){const d=r[c],p=e(d,n);t.setAttribute(c,p)}const s=this.morphAttributes;for(const c in s){const d=[],p=s[c];for(let m=0,v=p.length;m<v;m++){const _=p[m],b=e(_,n);d.push(b)}t.morphAttributes[c]=d}t.morphTargetsRelative=this.morphTargetsRelative;const a=this.groups;for(let c=0,d=a.length;c<d;c++){const p=a[c];t.addGroup(p.start,p.count,p.materialIndex)}return t}toJSON(){const e={metadata:{version:4.7,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const d=this.parameters;for(const p in d)d[p]!==void 0&&(e[p]=d[p]);return e}e.data={attributes:{}};const t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const n=this.attributes;for(const d in n){const p=n[d];e.data.attributes[d]=p.toJSON(e.data)}const r={};let s=!1;for(const d in this.morphAttributes){const p=this.morphAttributes[d],m=[];for(let v=0,_=p.length;v<_;v++){const b=p[v];m.push(b.toJSON(e.data))}m.length>0&&(r[d]=m,s=!0)}s&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const a=this.groups;a.length>0&&(e.data.groups=JSON.parse(JSON.stringify(a)));const c=this.boundingSphere;return c!==null&&(e.data.boundingSphere=c.toJSON()),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const n=e.index;n!==null&&this.setIndex(n.clone());const r=e.attributes;for(const p in r){const m=r[p];this.setAttribute(p,m.clone(t))}const s=e.morphAttributes;for(const p in s){const m=[],v=s[p];for(let _=0,b=v.length;_<b;_++)m.push(v[_].clone(t));this.morphAttributes[p]=m}this.morphTargetsRelative=e.morphTargetsRelative;const a=e.groups;for(let p=0,m=a.length;p<m;p++){const v=a[p];this.addGroup(v.start,v.count,v.materialIndex)}const c=e.boundingBox;c!==null&&(this.boundingBox=c.clone());const d=e.boundingSphere;return d!==null&&(this.boundingSphere=d.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const m1=new an,yf=new ip,Jv=new Tr,g1=new Q,Zv=new Q,$v=new Q,Kv=new Q,ib=new Q,Qv=new Q,v1=new Q,jv=new Q;class Di extends Kn{constructor(e=new vn,t=new mu){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.count=1,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const r=t[n[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,a=r.length;s<a;s++){const c=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[c]=s}}}}getVertexPosition(e,t){const n=this.geometry,r=n.attributes.position,s=n.morphAttributes.position,a=n.morphTargetsRelative;t.fromBufferAttribute(r,e);const c=this.morphTargetInfluences;if(s&&c){Qv.set(0,0,0);for(let d=0,p=s.length;d<p;d++){const m=c[d],v=s[d];m!==0&&(ib.fromBufferAttribute(v,e),a?Qv.addScaledVector(ib,m):Qv.addScaledVector(ib.sub(t),m))}t.add(Qv)}return t}raycast(e,t){const n=this.geometry,r=this.material,s=this.matrixWorld;r!==void 0&&(n.boundingSphere===null&&n.computeBoundingSphere(),Jv.copy(n.boundingSphere),Jv.applyMatrix4(s),yf.copy(e.ray).recast(e.near),!(Jv.containsPoint(yf.origin)===!1&&(yf.intersectSphere(Jv,g1)===null||yf.origin.distanceToSquared(g1)>(e.far-e.near)**2))&&(m1.copy(s).invert(),yf.copy(e.ray).applyMatrix4(m1),!(n.boundingBox!==null&&yf.intersectsBox(n.boundingBox)===!1)&&this._computeIntersections(e,t,yf)))}_computeIntersections(e,t,n){let r;const s=this.geometry,a=this.material,c=s.index,d=s.attributes.position,p=s.attributes.uv,m=s.attributes.uv1,v=s.attributes.normal,_=s.groups,b=s.drawRange;if(c!==null)if(Array.isArray(a))for(let T=0,I=_.length;T<I;T++){const C=_[T],A=a[C.materialIndex],D=Math.max(C.start,b.start),U=Math.min(c.count,Math.min(C.start+C.count,b.start+b.count));for(let L=D,z=U;L<z;L+=3){const B=c.getX(L),k=c.getX(L+1),G=c.getX(L+2);r=ey(this,A,e,n,p,m,v,B,k,G),r&&(r.faceIndex=Math.floor(L/3),r.face.materialIndex=C.materialIndex,t.push(r))}}else{const T=Math.max(0,b.start),I=Math.min(c.count,b.start+b.count);for(let C=T,A=I;C<A;C+=3){const D=c.getX(C),U=c.getX(C+1),L=c.getX(C+2);r=ey(this,a,e,n,p,m,v,D,U,L),r&&(r.faceIndex=Math.floor(C/3),t.push(r))}}else if(d!==void 0)if(Array.isArray(a))for(let T=0,I=_.length;T<I;T++){const C=_[T],A=a[C.materialIndex],D=Math.max(C.start,b.start),U=Math.min(d.count,Math.min(C.start+C.count,b.start+b.count));for(let L=D,z=U;L<z;L+=3){const B=L,k=L+1,G=L+2;r=ey(this,A,e,n,p,m,v,B,k,G),r&&(r.faceIndex=Math.floor(L/3),r.face.materialIndex=C.materialIndex,t.push(r))}}else{const T=Math.max(0,b.start),I=Math.min(d.count,b.start+b.count);for(let C=T,A=I;C<A;C+=3){const D=C,U=C+1,L=C+2;r=ey(this,a,e,n,p,m,v,D,U,L),r&&(r.faceIndex=Math.floor(C/3),t.push(r))}}}}function BU(i,e,t,n,r,s,a,c){let d;if(e.side===gs?d=n.intersectTriangle(a,s,r,!0,c):d=n.intersectTriangle(r,s,a,e.side===hu,c),d===null)return null;jv.copy(c),jv.applyMatrix4(i.matrixWorld);const p=t.ray.origin.distanceTo(jv);return p<t.near||p>t.far?null:{distance:p,point:jv.clone(),object:i}}function ey(i,e,t,n,r,s,a,c,d,p){i.getVertexPosition(c,Zv),i.getVertexPosition(d,$v),i.getVertexPosition(p,Kv);const m=BU(i,e,t,n,Zv,$v,Kv,v1);if(m){const v=new Q;oo.getBarycoord(v1,Zv,$v,Kv,v),r&&(m.uv=oo.getInterpolatedAttribute(r,c,d,p,v,new $e)),s&&(m.uv1=oo.getInterpolatedAttribute(s,c,d,p,v,new $e)),a&&(m.normal=oo.getInterpolatedAttribute(a,c,d,p,v,new Q),m.normal.dot(n.direction)>0&&m.normal.multiplyScalar(-1));const _={a:c,b:d,c:p,normal:new Q,materialIndex:0};oo.getNormal(Zv,$v,Kv,_.normal),m.face=_,m.barycoord=v}return m}class $f extends vn{constructor(e=1,t=1,n=1,r=1,s=1,a=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:r,heightSegments:s,depthSegments:a};const c=this;r=Math.floor(r),s=Math.floor(s),a=Math.floor(a);const d=[],p=[],m=[],v=[];let _=0,b=0;T("z","y","x",-1,-1,n,t,e,a,s,0),T("z","y","x",1,-1,n,t,-e,a,s,1),T("x","z","y",1,1,e,n,t,r,a,2),T("x","z","y",1,-1,e,n,-t,r,a,3),T("x","y","z",1,-1,e,t,n,r,s,4),T("x","y","z",-1,-1,e,t,-n,r,s,5),this.setIndex(d),this.setAttribute("position",new zt(p,3)),this.setAttribute("normal",new zt(m,3)),this.setAttribute("uv",new zt(v,2));function T(I,C,A,D,U,L,z,B,k,G,P){const O=L/k,Z=z/G,ie=L/2,ee=z/2,re=B/2,de=k+1,J=G+1;let te=0,ye=0;const Ue=new Q;for(let we=0;we<J;we++){const $=we*Z-ee;for(let ce=0;ce<de;ce++){const Ee=ce*O-ie;Ue[I]=Ee*D,Ue[C]=$*U,Ue[A]=re,p.push(Ue.x,Ue.y,Ue.z),Ue[I]=0,Ue[C]=0,Ue[A]=B>0?1:-1,m.push(Ue.x,Ue.y,Ue.z),v.push(ce/k),v.push(1-we/G),te+=1}}for(let we=0;we<G;we++)for(let $=0;$<k;$++){const ce=_+$+de*we,Ee=_+$+de*(we+1),Be=_+($+1)+de*(we+1),St=_+($+1)+de*we;d.push(ce,Ee,St),d.push(Ee,Be,St),ye+=6}c.addGroup(b,ye,P),b+=ye,_+=te}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new $f(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function $h(i){const e={};for(const t in i){e[t]={};for(const n in i[t]){const r=i[t][n];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.isRenderTargetTexture?(It("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][n]=null):e[t][n]=r.clone():Array.isArray(r)?e[t][n]=r.slice():e[t][n]=r}}return e}function Is(i){const e={};for(let t=0;t<i.length;t++){const n=$h(i[t]);for(const r in n)e[r]=n[r]}return e}function VU(i){const e=[];for(let t=0;t<i.length;t++)e.push(i[t].clone());return e}function RR(i){const e=i.getRenderTarget();return e===null?i.outputColorSpace:e.isXRRenderTarget===!0?e.texture.colorSpace:Gn.workingColorSpace}const Ag={clone:$h,merge:Is};var HU=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,GU=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class Ar extends vs{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=HU,this.fragmentShader=GU,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=$h(e.uniforms),this.uniformsGroups=VU(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this.defaultAttributeValues=Object.assign({},e.defaultAttributeValues),this.index0AttributeName=e.index0AttributeName,this.uniformsNeedUpdate=e.uniformsNeedUpdate,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const r in this.uniforms){const a=this.uniforms[r].value;a&&a.isTexture?t.uniforms[r]={type:"t",value:a.toJSON(e).uuid}:a&&a.isColor?t.uniforms[r]={type:"c",value:a.getHex()}:a&&a.isVector2?t.uniforms[r]={type:"v2",value:a.toArray()}:a&&a.isVector3?t.uniforms[r]={type:"v3",value:a.toArray()}:a&&a.isVector4?t.uniforms[r]={type:"v4",value:a.toArray()}:a&&a.isMatrix3?t.uniforms[r]={type:"m3",value:a.toArray()}:a&&a.isMatrix4?t.uniforms[r]={type:"m4",value:a.toArray()}:t.uniforms[r]={value:a}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const n={};for(const r in this.extensions)this.extensions[r]===!0&&(n[r]=!0);return Object.keys(n).length>0&&(t.extensions=n),t}}class mx extends Kn{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new an,this.projectionMatrix=new an,this.projectionMatrixInverse=new an,this.coordinateSystem=yo,this._reversedDepth=!1}get reversedDepth(){return this._reversedDepth}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}const hc=new Q,y1=new $e,_1=new $e;let Fr=class extends mx{constructor(e=50,t=1,n=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=n,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=Jh*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(Bf*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return Jh*2*Math.atan(Math.tan(Bf*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,t,n){hc.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),t.set(hc.x,hc.y).multiplyScalar(-e/hc.z),hc.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),n.set(hc.x,hc.y).multiplyScalar(-e/hc.z)}getViewSize(e,t){return this.getViewBounds(e,y1,_1),t.subVectors(_1,y1)}setViewOffset(e,t,n,r,s,a){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=s,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(Bf*.5*this.fov)/this.zoom,n=2*t,r=this.aspect*n,s=-.5*r;const a=this.view;if(this.view!==null&&this.view.enabled){const d=a.fullWidth,p=a.fullHeight;s+=a.offsetX*r/d,t-=a.offsetY*n/p,r*=a.width/d,n*=a.height/p}const c=this.filmOffset;c!==0&&(s+=e*c/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+r,t,t-n,e,this.far,this.coordinateSystem,this.reversedDepth),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}};const yh=-90,_h=1;class IR extends Kn{constructor(e,t,n){super(),this.type="CubeCamera",this.renderTarget=n,this.coordinateSystem=null,this.activeMipmapLevel=0;const r=new Fr(yh,_h,e,t);r.layers=this.layers,this.add(r);const s=new Fr(yh,_h,e,t);s.layers=this.layers,this.add(s);const a=new Fr(yh,_h,e,t);a.layers=this.layers,this.add(a);const c=new Fr(yh,_h,e,t);c.layers=this.layers,this.add(c);const d=new Fr(yh,_h,e,t);d.layers=this.layers,this.add(d);const p=new Fr(yh,_h,e,t);p.layers=this.layers,this.add(p)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[n,r,s,a,c,d]=t;for(const p of t)this.remove(p);if(e===yo)n.up.set(0,1,0),n.lookAt(1,0,0),r.up.set(0,1,0),r.lookAt(-1,0,0),s.up.set(0,0,-1),s.lookAt(0,1,0),a.up.set(0,0,1),a.lookAt(0,-1,0),c.up.set(0,1,0),c.lookAt(0,0,1),d.up.set(0,1,0),d.lookAt(0,0,-1);else if(e===Xh)n.up.set(0,-1,0),n.lookAt(-1,0,0),r.up.set(0,-1,0),r.lookAt(1,0,0),s.up.set(0,0,1),s.lookAt(0,1,0),a.up.set(0,0,-1),a.lookAt(0,-1,0),c.up.set(0,-1,0),c.lookAt(0,0,1),d.up.set(0,-1,0),d.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(const p of t)this.add(p),p.updateMatrixWorld()}update(e,t){this.parent===null&&this.updateMatrixWorld();const{renderTarget:n,activeMipmapLevel:r}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[s,a,c,d,p,m]=this.children,v=e.getRenderTarget(),_=e.getActiveCubeFace(),b=e.getActiveMipmapLevel(),T=e.xr.enabled;e.xr.enabled=!1;const I=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0,r),e.render(t,s),e.setRenderTarget(n,1,r),e.render(t,a),e.setRenderTarget(n,2,r),e.render(t,c),e.setRenderTarget(n,3,r),e.render(t,d),e.setRenderTarget(n,4,r),e.render(t,p),n.texture.generateMipmaps=I,e.setRenderTarget(n,5,r),e.render(t,m),e.setRenderTarget(v,_,b),e.xr.enabled=T,n.texture.needsPMREMUpdate=!0}}class Vg extends hi{constructor(e=[],t=Ua,n,r,s,a,c,d,p,m){super(e,t,n,r,s,a,c,d,p,m),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class gx extends Or{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const n={width:e,height:e,depth:1},r=[n,n,n,n,n,n];this.texture=new Vg(r),this._setTextureOptions(t),this.texture.isRenderTargetTexture=!0}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const n={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},r=new $f(5,5,5),s=new Ar({name:"CubemapFromEquirect",uniforms:$h(n.uniforms),vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,side:gs,blending:Ia});s.uniforms.tEquirect.value=t;const a=new Di(r,s),c=t.minFilter;return t.minFilter===_l&&(t.minFilter=Bn),new IR(1,10,this).update(e,a),t.minFilter=c,a.geometry.dispose(),a.material.dispose(),this}clear(e,t=!0,n=!0,r=!0){const s=e.getRenderTarget();for(let a=0;a<6;a++)e.setRenderTarget(this,a),e.clear(t,n,r);e.setRenderTarget(s)}}class Lh extends Kn{constructor(){super(),this.isGroup=!0,this.type="Group"}}const qU={type:"move"};class qy{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new Lh,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new Lh,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new Q,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new Q),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new Lh,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new Q,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new Q),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const n of e.hand.values())this._getHandJoint(t,n)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,n){let r=null,s=null,a=null;const c=this._targetRay,d=this._grip,p=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(p&&e.hand){a=!0;for(const I of e.hand.values()){const C=t.getJointPose(I,n),A=this._getHandJoint(p,I);C!==null&&(A.matrix.fromArray(C.transform.matrix),A.matrix.decompose(A.position,A.rotation,A.scale),A.matrixWorldNeedsUpdate=!0,A.jointRadius=C.radius),A.visible=C!==null}const m=p.joints["index-finger-tip"],v=p.joints["thumb-tip"],_=m.position.distanceTo(v.position),b=.02,T=.005;p.inputState.pinching&&_>b+T?(p.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!p.inputState.pinching&&_<=b-T&&(p.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else d!==null&&e.gripSpace&&(s=t.getPose(e.gripSpace,n),s!==null&&(d.matrix.fromArray(s.transform.matrix),d.matrix.decompose(d.position,d.rotation,d.scale),d.matrixWorldNeedsUpdate=!0,s.linearVelocity?(d.hasLinearVelocity=!0,d.linearVelocity.copy(s.linearVelocity)):d.hasLinearVelocity=!1,s.angularVelocity?(d.hasAngularVelocity=!0,d.angularVelocity.copy(s.angularVelocity)):d.hasAngularVelocity=!1));c!==null&&(r=t.getPose(e.targetRaySpace,n),r===null&&s!==null&&(r=s),r!==null&&(c.matrix.fromArray(r.transform.matrix),c.matrix.decompose(c.position,c.rotation,c.scale),c.matrixWorldNeedsUpdate=!0,r.linearVelocity?(c.hasLinearVelocity=!0,c.linearVelocity.copy(r.linearVelocity)):c.hasLinearVelocity=!1,r.angularVelocity?(c.hasAngularVelocity=!0,c.angularVelocity.copy(r.angularVelocity)):c.hasAngularVelocity=!1,this.dispatchEvent(qU)))}return c!==null&&(c.visible=r!==null),d!==null&&(d.visible=s!==null),p!==null&&(p.visible=a!==null),this}_getHandJoint(e,t){if(e.joints[t.jointName]===void 0){const n=new Lh;n.matrixAutoUpdate=!1,n.visible=!1,e.joints[t.jointName]=n,e.add(n)}return e.joints[t.jointName]}}class vx{constructor(e,t=25e-5){this.isFogExp2=!0,this.name="",this.color=new Pt(e),this.density=t}clone(){return new vx(this.color,this.density)}toJSON(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}}class yx{constructor(e,t=1,n=1e3){this.isFog=!0,this.name="",this.color=new Pt(e),this.near=t,this.far=n}clone(){return new yx(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}}class Hg extends Kn{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new Eo,this.environmentIntensity=1,this.environmentRotation=new Eo,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(t.object.backgroundIntensity=this.backgroundIntensity),t.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(t.object.environmentIntensity=this.environmentIntensity),t.object.environmentRotation=this.environmentRotation.toArray(),t}}class _x{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=Mg,this.updateRanges=[],this.version=0,this.uuid=xo()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,n){e*=this.stride,n*=t.stride;for(let r=0,s=this.stride;r<s;r++)this.array[e+r]=t.array[n+r];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=xo()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(t,this.stride);return n.setUsage(this.usage),n}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=xo()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const Rs=new Q;class _o{constructor(e,t,n,r=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=n,this.normalized=r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,n=this.data.count;t<n;t++)Rs.fromBufferAttribute(this,t),Rs.applyMatrix4(e),this.setXYZ(t,Rs.x,Rs.y,Rs.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)Rs.fromBufferAttribute(this,t),Rs.applyNormalMatrix(e),this.setXYZ(t,Rs.x,Rs.y,Rs.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)Rs.fromBufferAttribute(this,t),Rs.transformDirection(e),this.setXYZ(t,Rs.x,Rs.y,Rs.z);return this}getComponent(e,t){let n=this.array[e*this.data.stride+this.offset+t];return this.normalized&&(n=Us(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=En(n,this.array)),this.data.array[e*this.data.stride+this.offset+t]=n,this}setX(e,t){return this.normalized&&(t=En(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=En(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=En(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=En(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=Us(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=Us(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=Us(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=Us(t,this.array)),t}setXY(e,t,n){return e=e*this.data.stride+this.offset,this.normalized&&(t=En(t,this.array),n=En(n,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this}setXYZ(e,t,n,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=En(t,this.array),n=En(n,this.array),r=En(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this}setXYZW(e,t,n,r,s){return e=e*this.data.stride+this.offset,this.normalized&&(t=En(t,this.array),n=En(n,this.array),r=En(r,this.array),s=En(s,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this.data.array[e+3]=s,this}clone(e){if(e===void 0){Tg("InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let n=0;n<this.count;n++){const r=n*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return new pi(new this.array.constructor(t),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new _o(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){Tg("InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let n=0;n<this.count;n++){const r=n*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class jM extends vs{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new Pt(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let xh;const Bm=new Q,Sh=new Q,bh=new Q,Mh=new $e,Vm=new $e,NR=new an,ty=new Q,Hm=new Q,ny=new Q,x1=new $e,rb=new $e,S1=new $e;class DR extends Kn{constructor(e=new jM){if(super(),this.isSprite=!0,this.type="Sprite",xh===void 0){xh=new vn;const t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),n=new _x(t,5);xh.setIndex([0,1,2,0,2,3]),xh.setAttribute("position",new _o(n,3,0,!1)),xh.setAttribute("uv",new _o(n,2,3,!1))}this.geometry=xh,this.material=e,this.center=new $e(.5,.5),this.count=1}raycast(e,t){e.camera===null&&Jt('Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Sh.setFromMatrixScale(this.matrixWorld),NR.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),bh.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&Sh.multiplyScalar(-bh.z);const n=this.material.rotation;let r,s;n!==0&&(s=Math.cos(n),r=Math.sin(n));const a=this.center;iy(ty.set(-.5,-.5,0),bh,a,Sh,r,s),iy(Hm.set(.5,-.5,0),bh,a,Sh,r,s),iy(ny.set(.5,.5,0),bh,a,Sh,r,s),x1.set(0,0),rb.set(1,0),S1.set(1,1);let c=e.ray.intersectTriangle(ty,Hm,ny,!1,Bm);if(c===null&&(iy(Hm.set(-.5,.5,0),bh,a,Sh,r,s),rb.set(0,1),c=e.ray.intersectTriangle(ty,ny,Hm,!1,Bm),c===null))return;const d=e.ray.origin.distanceTo(Bm);d<e.near||d>e.far||t.push({distance:d,point:Bm.clone(),uv:oo.getInterpolation(Bm,ty,Hm,ny,x1,rb,S1,new $e),face:null,object:this})}copy(e,t){return super.copy(e,t),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}}function iy(i,e,t,n,r,s){Mh.subVectors(i,t).addScalar(.5).multiply(n),r!==void 0?(Vm.x=s*Mh.x-r*Mh.y,Vm.y=r*Mh.x+s*Mh.y):Vm.copy(Mh),i.copy(e),i.x+=Vm.x,i.y+=Vm.y,i.applyMatrix4(NR)}const ry=new Q,b1=new Q;class UR extends Kn{constructor(){super(),this.isLOD=!0,this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const t=e.levels;for(let n=0,r=t.length;n<r;n++){const s=t[n];this.addLevel(s.object.clone(),s.distance,s.hysteresis)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,t=0,n=0){t=Math.abs(t);const r=this.levels;let s;for(s=0;s<r.length&&!(t<r[s].distance);s++);return r.splice(s,0,{distance:t,hysteresis:n,object:e}),this.add(e),this}removeLevel(e){const t=this.levels;for(let n=0;n<t.length;n++)if(t[n].distance===e){const r=t.splice(n,1);return this.remove(r[0].object),!0}return!1}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const t=this.levels;if(t.length>0){let n,r;for(n=1,r=t.length;n<r;n++){let s=t[n].distance;if(t[n].object.visible&&(s-=s*t[n].hysteresis),e<s)break}return t[n-1].object}return null}raycast(e,t){if(this.levels.length>0){ry.setFromMatrixPosition(this.matrixWorld);const r=e.ray.origin.distanceTo(ry);this.getObjectForDistance(r).raycast(e,t)}}update(e){const t=this.levels;if(t.length>1){ry.setFromMatrixPosition(e.matrixWorld),b1.setFromMatrixPosition(this.matrixWorld);const n=ry.distanceTo(b1)/e.zoom;t[0].object.visible=!0;let r,s;for(r=1,s=t.length;r<s;r++){let a=t[r].distance;if(t[r].object.visible&&(a-=a*t[r].hysteresis),n>=a)t[r-1].object.visible=!1,t[r].object.visible=!0;else break}for(this._currentLevel=r-1;r<s;r++)t[r].object.visible=!1}}toJSON(e){const t=super.toJSON(e);this.autoUpdate===!1&&(t.object.autoUpdate=!1),t.object.levels=[];const n=this.levels;for(let r=0,s=n.length;r<s;r++){const a=n[r];t.object.levels.push({object:a.object.uuid,distance:a.distance,hysteresis:a.hysteresis})}return t}}const M1=new Q,E1=new $n,T1=new $n,WU=new Q,A1=new an,sy=new Q,sb=new Tr,w1=new an,ob=new ip;class PR extends Di{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=Qb,this.bindMatrix=new an,this.bindMatrixInverse=new an,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;this.boundingBox===null&&(this.boundingBox=new Er),this.boundingBox.makeEmpty();const t=e.getAttribute("position");for(let n=0;n<t.count;n++)this.getVertexPosition(n,sy),this.boundingBox.expandByPoint(sy)}computeBoundingSphere(){const e=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new Tr),this.boundingSphere.makeEmpty();const t=e.getAttribute("position");for(let n=0;n<t.count;n++)this.getVertexPosition(n,sy),this.boundingSphere.expandByPoint(sy)}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,t){const n=this.material,r=this.matrixWorld;n!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),sb.copy(this.boundingSphere),sb.applyMatrix4(r),e.ray.intersectsSphere(sb)!==!1&&(w1.copy(r).invert(),ob.copy(e.ray).applyMatrix4(w1),!(this.boundingBox!==null&&ob.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(e,t,ob)))}getVertexPosition(e,t){return super.getVertexPosition(e,t),this.applyBoneTransform(e,t),t}bind(e,t){this.skeleton=e,t===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new $n,t=this.geometry.attributes.skinWeight;for(let n=0,r=t.count;n<r;n++){e.fromBufferAttribute(t,n);const s=1/e.manhattanLength();s!==1/0?e.multiplyScalar(s):e.set(1,0,0,0),t.setXYZW(n,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===Qb?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===dR?this.bindMatrixInverse.copy(this.bindMatrix).invert():It("SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,t){const n=this.skeleton,r=this.geometry;E1.fromBufferAttribute(r.attributes.skinIndex,e),T1.fromBufferAttribute(r.attributes.skinWeight,e),M1.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let s=0;s<4;s++){const a=T1.getComponent(s);if(a!==0){const c=E1.getComponent(s);A1.multiplyMatrices(n.bones[c].matrixWorld,n.boneInverses[c]),t.addScaledVector(WU.copy(M1).applyMatrix4(A1),a)}}return t.applyMatrix4(this.bindMatrixInverse)}}class eE extends Kn{constructor(){super(),this.isBone=!0,this.type="Bone"}}class na extends hi{constructor(e=null,t=1,n=1,r,s,a,c,d,p=lr,m=lr,v,_){super(null,a,c,d,p,m,r,s,v,_),this.isDataTexture=!0,this.image={data:e,width:t,height:n},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const C1=new an,XU=new an;class xx{constructor(e=[],t=[]){this.uuid=xo(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.previousBoneMatrices=null,this.boneTexture=null,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),t.length===0)this.calculateInverses();else if(e.length!==t.length){It("Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let n=0,r=this.bones.length;n<r;n++)this.boneInverses.push(new an)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const n=new an;this.bones[e]&&n.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(n)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const n=this.bones[e];n&&n.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const n=this.bones[e];n&&(n.parent&&n.parent.isBone?(n.matrix.copy(n.parent.matrixWorld).invert(),n.matrix.multiply(n.matrixWorld)):n.matrix.copy(n.matrixWorld),n.matrix.decompose(n.position,n.quaternion,n.scale))}}update(){const e=this.bones,t=this.boneInverses,n=this.boneMatrices,r=this.boneTexture;for(let s=0,a=e.length;s<a;s++){const c=e[s]?e[s].matrixWorld:XU;C1.multiplyMatrices(c,t[s]),C1.toArray(n,s*16)}r!==null&&(r.needsUpdate=!0)}clone(){return new xx(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const n=new na(t,e,e,ur,Ni);return n.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=n,this}getBoneByName(e){for(let t=0,n=this.bones.length;t<n;t++){const r=this.bones[t];if(r.name===e)return r}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let n=0,r=e.bones.length;n<r;n++){const s=e.bones[n];let a=t[s];a===void 0&&(It("Skeleton: No bone found with UUID:",s),a=new eE),this.bones.push(a),this.boneInverses.push(new an().fromArray(e.boneInverses[n]))}return this.init(),this}toJSON(){const e={metadata:{version:4.7,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,n=this.boneInverses;for(let r=0,s=t.length;r<s;r++){const a=t[r];e.bones.push(a.uuid);const c=n[r];e.boneInverses.push(c.toArray())}return e}}class Kh extends pi{constructor(e,t,n,r=1){super(e,t,n),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const Eh=new an,R1=new an,oy=[],I1=new Er,YU=new an,Gm=new Di,qm=new Tr;class LR extends Di{constructor(e,t,n){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new Kh(new Float32Array(n*16),16),this.instanceColor=null,this.morphTexture=null,this.count=n,this.boundingBox=null,this.boundingSphere=null;for(let r=0;r<n;r++)this.setMatrixAt(r,YU)}computeBoundingBox(){const e=this.geometry,t=this.count;this.boundingBox===null&&(this.boundingBox=new Er),e.boundingBox===null&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let n=0;n<t;n++)this.getMatrixAt(n,Eh),I1.copy(e.boundingBox).applyMatrix4(Eh),this.boundingBox.union(I1)}computeBoundingSphere(){const e=this.geometry,t=this.count;this.boundingSphere===null&&(this.boundingSphere=new Tr),e.boundingSphere===null&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let n=0;n<t;n++)this.getMatrixAt(n,Eh),qm.copy(e.boundingSphere).applyMatrix4(Eh),this.boundingSphere.union(qm)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),e.morphTexture!==null&&(this.morphTexture=e.morphTexture.clone()),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,t){t.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,e*16)}getMorphAt(e,t){const n=t.morphTargetInfluences,r=this.morphTexture.source.data.data,s=n.length+1,a=e*s+1;for(let c=0;c<n.length;c++)n[c]=r[a+c]}raycast(e,t){const n=this.matrixWorld,r=this.count;if(Gm.geometry=this.geometry,Gm.material=this.material,Gm.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),qm.copy(this.boundingSphere),qm.applyMatrix4(n),e.ray.intersectsSphere(qm)!==!1))for(let s=0;s<r;s++){this.getMatrixAt(s,Eh),R1.multiplyMatrices(n,Eh),Gm.matrixWorld=R1,Gm.raycast(e,oy);for(let a=0,c=oy.length;a<c;a++){const d=oy[a];d.instanceId=s,d.object=this,t.push(d)}oy.length=0}}setColorAt(e,t){this.instanceColor===null&&(this.instanceColor=new Kh(new Float32Array(this.instanceMatrix.count*3).fill(1),3)),t.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,e*16)}setMorphAt(e,t){const n=t.morphTargetInfluences,r=n.length+1;this.morphTexture===null&&(this.morphTexture=new na(new Float32Array(r*this.count),r,this.count,zg,Ni));const s=this.morphTexture.source.data.data;let a=0;for(let p=0;p<n.length;p++)a+=n[p];const c=this.geometry.morphTargetsRelative?1:1-a,d=r*e;s[d]=c,s.set(n,d+1)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"}),this.morphTexture!==null&&(this.morphTexture.dispose(),this.morphTexture=null)}}const ab=new Q,JU=new Q,ZU=new xn;class uu{constructor(e=new Q(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,n,r){return this.normal.set(e,t,n),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,n){const r=ab.subVectors(n,t).cross(JU.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const n=e.delta(ab),r=this.normal.dot(n);if(r===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/r;return s<0||s>1?null:t.copy(e.start).addScaledVector(n,s)}intersectsLine(e){const t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const n=t||ZU.getNormalMatrix(e),r=this.coplanarPoint(ab).applyMatrix4(e),s=this.normal.applyMatrix3(n).normalize();return this.constant=-r.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const _f=new Tr,$U=new $e(.5,.5),ay=new Q;class rp{constructor(e=new uu,t=new uu,n=new uu,r=new uu,s=new uu,a=new uu){this.planes=[e,t,n,r,s,a]}set(e,t,n,r,s,a){const c=this.planes;return c[0].copy(e),c[1].copy(t),c[2].copy(n),c[3].copy(r),c[4].copy(s),c[5].copy(a),this}copy(e){const t=this.planes;for(let n=0;n<6;n++)t[n].copy(e.planes[n]);return this}setFromProjectionMatrix(e,t=yo,n=!1){const r=this.planes,s=e.elements,a=s[0],c=s[1],d=s[2],p=s[3],m=s[4],v=s[5],_=s[6],b=s[7],T=s[8],I=s[9],C=s[10],A=s[11],D=s[12],U=s[13],L=s[14],z=s[15];if(r[0].setComponents(p-a,b-m,A-T,z-D).normalize(),r[1].setComponents(p+a,b+m,A+T,z+D).normalize(),r[2].setComponents(p+c,b+v,A+I,z+U).normalize(),r[3].setComponents(p-c,b-v,A-I,z-U).normalize(),n)r[4].setComponents(d,_,C,L).normalize(),r[5].setComponents(p-d,b-_,A-C,z-L).normalize();else if(r[4].setComponents(p-d,b-_,A-C,z-L).normalize(),t===yo)r[5].setComponents(p+d,b+_,A+C,z+L).normalize();else if(t===Xh)r[5].setComponents(d,_,C,L).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),_f.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;t.boundingSphere===null&&t.computeBoundingSphere(),_f.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(_f)}intersectsSprite(e){_f.center.set(0,0,0);const t=$U.distanceTo(e.center);return _f.radius=.7071067811865476+t,_f.applyMatrix4(e.matrixWorld),this.intersectsSphere(_f)}intersectsSphere(e){const t=this.planes,n=e.center,r=-e.radius;for(let s=0;s<6;s++)if(t[s].distanceToPoint(n)<r)return!1;return!0}intersectsBox(e){const t=this.planes;for(let n=0;n<6;n++){const r=t[n];if(ay.x=r.normal.x>0?e.max.x:e.min.x,ay.y=r.normal.y>0?e.max.y:e.min.y,ay.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(ay)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}const dl=new an,hl=new rp;class Sx{constructor(){this.coordinateSystem=yo}intersectsObject(e,t){if(!t.isArrayCamera||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const r=t.cameras[n];if(dl.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),hl.setFromProjectionMatrix(dl,r.coordinateSystem,r.reversedDepth),hl.intersectsObject(e))return!0}return!1}intersectsSprite(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const r=t.cameras[n];if(dl.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),hl.setFromProjectionMatrix(dl,r.coordinateSystem,r.reversedDepth),hl.intersectsSprite(e))return!0}return!1}intersectsSphere(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const r=t.cameras[n];if(dl.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),hl.setFromProjectionMatrix(dl,r.coordinateSystem,r.reversedDepth),hl.intersectsSphere(e))return!0}return!1}intersectsBox(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const r=t.cameras[n];if(dl.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),hl.setFromProjectionMatrix(dl,r.coordinateSystem,r.reversedDepth),hl.intersectsBox(e))return!0}return!1}containsPoint(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const r=t.cameras[n];if(dl.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),hl.setFromProjectionMatrix(dl,r.coordinateSystem,r.reversedDepth),hl.containsPoint(e))return!0}return!1}clone(){return new Sx}}function lb(i,e){return i-e}function KU(i,e){return i.z-e.z}function QU(i,e){return e.z-i.z}class jU{constructor(){this.index=0,this.pool=[],this.list=[]}push(e,t,n,r){const s=this.pool,a=this.list;this.index>=s.length&&s.push({start:-1,count:-1,z:-1,index:-1});const c=s[this.index];a.push(c),this.index++,c.start=e,c.count=t,c.z=n,c.index=r}reset(){this.list.length=0,this.index=0}}const ro=new an,eP=new Pt(1,1,1),N1=new rp,tP=new Sx,ly=new Er,xf=new Tr,Wm=new Q,D1=new Q,nP=new Q,ub=new jU,ps=new Di,uy=[];function iP(i,e,t=0){const n=e.itemSize;if(i.isInterleavedBufferAttribute||i.array.constructor!==e.array.constructor){const r=i.count;for(let s=0;s<r;s++)for(let a=0;a<n;a++)e.setComponent(s+t,a,i.getComponent(s,a))}else e.array.set(i.array,t*n);e.needsUpdate=!0}function Sf(i,e){if(i.constructor!==e.constructor){const t=Math.min(i.length,e.length);for(let n=0;n<t;n++)e[n]=i[n]}else{const t=Math.min(i.length,e.length);e.set(new i.constructor(i.buffer,0,t))}}class FR extends Di{constructor(e,t,n=t*2,r){super(new vn,r),this.isBatchedMesh=!0,this.perObjectFrustumCulled=!0,this.sortObjects=!0,this.boundingBox=null,this.boundingSphere=null,this.customSort=null,this._instanceInfo=[],this._geometryInfo=[],this._availableInstanceIds=[],this._availableGeometryIds=[],this._nextIndexStart=0,this._nextVertexStart=0,this._geometryCount=0,this._visibilityChanged=!0,this._geometryInitialized=!1,this._maxInstanceCount=e,this._maxVertexCount=t,this._maxIndexCount=n,this._multiDrawCounts=new Int32Array(e),this._multiDrawStarts=new Int32Array(e),this._multiDrawCount=0,this._multiDrawInstances=null,this._matricesTexture=null,this._indirectTexture=null,this._colorsTexture=null,this._initMatricesTexture(),this._initIndirectTexture()}get maxInstanceCount(){return this._maxInstanceCount}get instanceCount(){return this._instanceInfo.length-this._availableInstanceIds.length}get unusedVertexCount(){return this._maxVertexCount-this._nextVertexStart}get unusedIndexCount(){return this._maxIndexCount-this._nextIndexStart}_initMatricesTexture(){let e=Math.sqrt(this._maxInstanceCount*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const t=new Float32Array(e*e*4),n=new na(t,e,e,ur,Ni);this._matricesTexture=n}_initIndirectTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);const t=new Uint32Array(e*e),n=new na(t,e,e,Bg,Mo);this._indirectTexture=n}_initColorsTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);const t=new Float32Array(e*e*4).fill(1),n=new na(t,e,e,ur,Ni);n.colorSpace=Gn.workingColorSpace,this._colorsTexture=n}_initializeGeometry(e){const t=this.geometry,n=this._maxVertexCount,r=this._maxIndexCount;if(this._geometryInitialized===!1){for(const s in e.attributes){const a=e.getAttribute(s),{array:c,itemSize:d,normalized:p}=a,m=new c.constructor(n*d),v=new pi(m,d,p);t.setAttribute(s,v)}if(e.getIndex()!==null){const s=n>65535?new Uint32Array(r):new Uint16Array(r);t.setIndex(new pi(s,1))}this._geometryInitialized=!0}}_validateGeometry(e){const t=this.geometry;if(!!e.getIndex()!=!!t.getIndex())throw new Error('THREE.BatchedMesh: All geometries must consistently have "index".');for(const n in t.attributes){if(!e.hasAttribute(n))throw new Error(`THREE.BatchedMesh: Added geometry missing "${n}". All geometries must have consistent attributes.`);const r=e.getAttribute(n),s=t.getAttribute(n);if(r.itemSize!==s.itemSize||r.normalized!==s.normalized)throw new Error("THREE.BatchedMesh: All attributes must have a consistent itemSize and normalized value.")}}validateInstanceId(e){const t=this._instanceInfo;if(e<0||e>=t.length||t[e].active===!1)throw new Error(`THREE.BatchedMesh: Invalid instanceId ${e}. Instance is either out of range or has been deleted.`)}validateGeometryId(e){const t=this._geometryInfo;if(e<0||e>=t.length||t[e].active===!1)throw new Error(`THREE.BatchedMesh: Invalid geometryId ${e}. Geometry is either out of range or has been deleted.`)}setCustomSort(e){return this.customSort=e,this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Er);const e=this.boundingBox,t=this._instanceInfo;e.makeEmpty();for(let n=0,r=t.length;n<r;n++){if(t[n].active===!1)continue;const s=t[n].geometryIndex;this.getMatrixAt(n,ro),this.getBoundingBoxAt(s,ly).applyMatrix4(ro),e.union(ly)}}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Tr);const e=this.boundingSphere,t=this._instanceInfo;e.makeEmpty();for(let n=0,r=t.length;n<r;n++){if(t[n].active===!1)continue;const s=t[n].geometryIndex;this.getMatrixAt(n,ro),this.getBoundingSphereAt(s,xf).applyMatrix4(ro),e.union(xf)}}addInstance(e){if(this._instanceInfo.length>=this.maxInstanceCount&&this._availableInstanceIds.length===0)throw new Error("THREE.BatchedMesh: Maximum item count reached.");const n={visible:!0,active:!0,geometryIndex:e};let r=null;this._availableInstanceIds.length>0?(this._availableInstanceIds.sort(lb),r=this._availableInstanceIds.shift(),this._instanceInfo[r]=n):(r=this._instanceInfo.length,this._instanceInfo.push(n));const s=this._matricesTexture;ro.identity().toArray(s.image.data,r*16),s.needsUpdate=!0;const a=this._colorsTexture;return a&&(eP.toArray(a.image.data,r*4),a.needsUpdate=!0),this._visibilityChanged=!0,r}addGeometry(e,t=-1,n=-1){this._initializeGeometry(e),this._validateGeometry(e);const r={vertexStart:-1,vertexCount:-1,reservedVertexCount:-1,indexStart:-1,indexCount:-1,reservedIndexCount:-1,start:-1,count:-1,boundingBox:null,boundingSphere:null,active:!0},s=this._geometryInfo;r.vertexStart=this._nextVertexStart,r.reservedVertexCount=t===-1?e.getAttribute("position").count:t;const a=e.getIndex();if(a!==null&&(r.indexStart=this._nextIndexStart,r.reservedIndexCount=n===-1?a.count:n),r.indexStart!==-1&&r.indexStart+r.reservedIndexCount>this._maxIndexCount||r.vertexStart+r.reservedVertexCount>this._maxVertexCount)throw new Error("THREE.BatchedMesh: Reserved space request exceeds the maximum buffer size.");let d;return this._availableGeometryIds.length>0?(this._availableGeometryIds.sort(lb),d=this._availableGeometryIds.shift(),s[d]=r):(d=this._geometryCount,this._geometryCount++,s.push(r)),this.setGeometryAt(d,e),this._nextIndexStart=r.indexStart+r.reservedIndexCount,this._nextVertexStart=r.vertexStart+r.reservedVertexCount,d}setGeometryAt(e,t){if(e>=this._geometryCount)throw new Error("THREE.BatchedMesh: Maximum geometry count reached.");this._validateGeometry(t);const n=this.geometry,r=n.getIndex()!==null,s=n.getIndex(),a=t.getIndex(),c=this._geometryInfo[e];if(r&&a.count>c.reservedIndexCount||t.attributes.position.count>c.reservedVertexCount)throw new Error("THREE.BatchedMesh: Reserved space not large enough for provided geometry.");const d=c.vertexStart,p=c.reservedVertexCount;c.vertexCount=t.getAttribute("position").count;for(const m in n.attributes){const v=t.getAttribute(m),_=n.getAttribute(m);iP(v,_,d);const b=v.itemSize;for(let T=v.count,I=p;T<I;T++){const C=d+T;for(let A=0;A<b;A++)_.setComponent(C,A,0)}_.needsUpdate=!0,_.addUpdateRange(d*b,p*b)}if(r){const m=c.indexStart,v=c.reservedIndexCount;c.indexCount=t.getIndex().count;for(let _=0;_<a.count;_++)s.setX(m+_,d+a.getX(_));for(let _=a.count,b=v;_<b;_++)s.setX(m+_,d);s.needsUpdate=!0,s.addUpdateRange(m,c.reservedIndexCount)}return c.start=r?c.indexStart:c.vertexStart,c.count=r?c.indexCount:c.vertexCount,c.boundingBox=null,t.boundingBox!==null&&(c.boundingBox=t.boundingBox.clone()),c.boundingSphere=null,t.boundingSphere!==null&&(c.boundingSphere=t.boundingSphere.clone()),this._visibilityChanged=!0,e}deleteGeometry(e){const t=this._geometryInfo;if(e>=t.length||t[e].active===!1)return this;const n=this._instanceInfo;for(let r=0,s=n.length;r<s;r++)n[r].active&&n[r].geometryIndex===e&&this.deleteInstance(r);return t[e].active=!1,this._availableGeometryIds.push(e),this._visibilityChanged=!0,this}deleteInstance(e){return this.validateInstanceId(e),this._instanceInfo[e].active=!1,this._availableInstanceIds.push(e),this._visibilityChanged=!0,this}optimize(){let e=0,t=0;const n=this._geometryInfo,r=n.map((a,c)=>c).sort((a,c)=>n[a].vertexStart-n[c].vertexStart),s=this.geometry;for(let a=0,c=n.length;a<c;a++){const d=r[a],p=n[d];if(p.active!==!1){if(s.index!==null){if(p.indexStart!==t){const{indexStart:m,vertexStart:v,reservedIndexCount:_}=p,b=s.index,T=b.array,I=e-v;for(let C=m;C<m+_;C++)T[C]=T[C]+I;b.array.copyWithin(t,m,m+_),b.addUpdateRange(t,_),b.needsUpdate=!0,p.indexStart=t}t+=p.reservedIndexCount}if(p.vertexStart!==e){const{vertexStart:m,reservedVertexCount:v}=p,_=s.attributes;for(const b in _){const T=_[b],{array:I,itemSize:C}=T;I.copyWithin(e*C,m*C,(m+v)*C),T.addUpdateRange(e*C,v*C),T.needsUpdate=!0}p.vertexStart=e}e+=p.reservedVertexCount,p.start=s.index?p.indexStart:p.vertexStart,this._nextIndexStart=s.index?p.indexStart+p.reservedIndexCount:0,this._nextVertexStart=p.vertexStart+p.reservedVertexCount}}return this._visibilityChanged=!0,this}getBoundingBoxAt(e,t){if(e>=this._geometryCount)return null;const n=this.geometry,r=this._geometryInfo[e];if(r.boundingBox===null){const s=new Er,a=n.index,c=n.attributes.position;for(let d=r.start,p=r.start+r.count;d<p;d++){let m=d;a&&(m=a.getX(m)),s.expandByPoint(Wm.fromBufferAttribute(c,m))}r.boundingBox=s}return t.copy(r.boundingBox),t}getBoundingSphereAt(e,t){if(e>=this._geometryCount)return null;const n=this.geometry,r=this._geometryInfo[e];if(r.boundingSphere===null){const s=new Tr;this.getBoundingBoxAt(e,ly),ly.getCenter(s.center);const a=n.index,c=n.attributes.position;let d=0;for(let p=r.start,m=r.start+r.count;p<m;p++){let v=p;a&&(v=a.getX(v)),Wm.fromBufferAttribute(c,v),d=Math.max(d,s.center.distanceToSquared(Wm))}s.radius=Math.sqrt(d),r.boundingSphere=s}return t.copy(r.boundingSphere),t}setMatrixAt(e,t){this.validateInstanceId(e);const n=this._matricesTexture,r=this._matricesTexture.image.data;return t.toArray(r,e*16),n.needsUpdate=!0,this}getMatrixAt(e,t){return this.validateInstanceId(e),t.fromArray(this._matricesTexture.image.data,e*16)}setColorAt(e,t){return this.validateInstanceId(e),this._colorsTexture===null&&this._initColorsTexture(),t.toArray(this._colorsTexture.image.data,e*4),this._colorsTexture.needsUpdate=!0,this}getColorAt(e,t){return this.validateInstanceId(e),t.fromArray(this._colorsTexture.image.data,e*4)}setVisibleAt(e,t){return this.validateInstanceId(e),this._instanceInfo[e].visible===t?this:(this._instanceInfo[e].visible=t,this._visibilityChanged=!0,this)}getVisibleAt(e){return this.validateInstanceId(e),this._instanceInfo[e].visible}setGeometryIdAt(e,t){return this.validateInstanceId(e),this.validateGeometryId(t),this._instanceInfo[e].geometryIndex=t,this}getGeometryIdAt(e){return this.validateInstanceId(e),this._instanceInfo[e].geometryIndex}getGeometryRangeAt(e,t={}){this.validateGeometryId(e);const n=this._geometryInfo[e];return t.vertexStart=n.vertexStart,t.vertexCount=n.vertexCount,t.reservedVertexCount=n.reservedVertexCount,t.indexStart=n.indexStart,t.indexCount=n.indexCount,t.reservedIndexCount=n.reservedIndexCount,t.start=n.start,t.count=n.count,t}setInstanceCount(e){const t=this._availableInstanceIds,n=this._instanceInfo;for(t.sort(lb);t[t.length-1]===n.length-1;)n.pop(),t.pop();if(e<n.length)throw new Error(`BatchedMesh: Instance ids outside the range ${e} are being used. Cannot shrink instance count.`);const r=new Int32Array(e),s=new Int32Array(e);Sf(this._multiDrawCounts,r),Sf(this._multiDrawStarts,s),this._multiDrawCounts=r,this._multiDrawStarts=s,this._maxInstanceCount=e;const a=this._indirectTexture,c=this._matricesTexture,d=this._colorsTexture;a.dispose(),this._initIndirectTexture(),Sf(a.image.data,this._indirectTexture.image.data),c.dispose(),this._initMatricesTexture(),Sf(c.image.data,this._matricesTexture.image.data),d&&(d.dispose(),this._initColorsTexture(),Sf(d.image.data,this._colorsTexture.image.data))}setGeometrySize(e,t){const n=[...this._geometryInfo].filter(c=>c.active);if(Math.max(...n.map(c=>c.vertexStart+c.reservedVertexCount))>e)throw new Error(`BatchedMesh: Geometry vertex values are being used outside the range ${t}. Cannot shrink further.`);if(this.geometry.index&&Math.max(...n.map(d=>d.indexStart+d.reservedIndexCount))>t)throw new Error(`BatchedMesh: Geometry index values are being used outside the range ${t}. Cannot shrink further.`);const s=this.geometry;s.dispose(),this._maxVertexCount=e,this._maxIndexCount=t,this._geometryInitialized&&(this._geometryInitialized=!1,this.geometry=new vn,this._initializeGeometry(s));const a=this.geometry;s.index&&Sf(s.index.array,a.index.array);for(const c in s.attributes)Sf(s.attributes[c].array,a.attributes[c].array)}raycast(e,t){const n=this._instanceInfo,r=this._geometryInfo,s=this.matrixWorld,a=this.geometry;ps.material=this.material,ps.geometry.index=a.index,ps.geometry.attributes=a.attributes,ps.geometry.boundingBox===null&&(ps.geometry.boundingBox=new Er),ps.geometry.boundingSphere===null&&(ps.geometry.boundingSphere=new Tr);for(let c=0,d=n.length;c<d;c++){if(!n[c].visible||!n[c].active)continue;const p=n[c].geometryIndex,m=r[p];ps.geometry.setDrawRange(m.start,m.count),this.getMatrixAt(c,ps.matrixWorld).premultiply(s),this.getBoundingBoxAt(p,ps.geometry.boundingBox),this.getBoundingSphereAt(p,ps.geometry.boundingSphere),ps.raycast(e,uy);for(let v=0,_=uy.length;v<_;v++){const b=uy[v];b.object=this,b.batchId=c,t.push(b)}uy.length=0}ps.material=null,ps.geometry.index=null,ps.geometry.attributes={},ps.geometry.setDrawRange(0,1/0)}copy(e){return super.copy(e),this.geometry=e.geometry.clone(),this.perObjectFrustumCulled=e.perObjectFrustumCulled,this.sortObjects=e.sortObjects,this.boundingBox=e.boundingBox!==null?e.boundingBox.clone():null,this.boundingSphere=e.boundingSphere!==null?e.boundingSphere.clone():null,this._geometryInfo=e._geometryInfo.map(t=>({...t,boundingBox:t.boundingBox!==null?t.boundingBox.clone():null,boundingSphere:t.boundingSphere!==null?t.boundingSphere.clone():null})),this._instanceInfo=e._instanceInfo.map(t=>({...t})),this._availableInstanceIds=e._availableInstanceIds.slice(),this._availableGeometryIds=e._availableGeometryIds.slice(),this._nextIndexStart=e._nextIndexStart,this._nextVertexStart=e._nextVertexStart,this._geometryCount=e._geometryCount,this._maxInstanceCount=e._maxInstanceCount,this._maxVertexCount=e._maxVertexCount,this._maxIndexCount=e._maxIndexCount,this._geometryInitialized=e._geometryInitialized,this._multiDrawCounts=e._multiDrawCounts.slice(),this._multiDrawStarts=e._multiDrawStarts.slice(),this._indirectTexture=e._indirectTexture.clone(),this._indirectTexture.image.data=this._indirectTexture.image.data.slice(),this._matricesTexture=e._matricesTexture.clone(),this._matricesTexture.image.data=this._matricesTexture.image.data.slice(),this._colorsTexture!==null&&(this._colorsTexture=e._colorsTexture.clone(),this._colorsTexture.image.data=this._colorsTexture.image.data.slice()),this}dispose(){this.geometry.dispose(),this._matricesTexture.dispose(),this._matricesTexture=null,this._indirectTexture.dispose(),this._indirectTexture=null,this._colorsTexture!==null&&(this._colorsTexture.dispose(),this._colorsTexture=null)}onBeforeRender(e,t,n,r,s){if(!this._visibilityChanged&&!this.perObjectFrustumCulled&&!this.sortObjects)return;const a=r.getIndex(),c=a===null?1:a.array.BYTES_PER_ELEMENT,d=this._instanceInfo,p=this._multiDrawStarts,m=this._multiDrawCounts,v=this._geometryInfo,_=this.perObjectFrustumCulled,b=this._indirectTexture,T=b.image.data,I=n.isArrayCamera?tP:N1;_&&!n.isArrayCamera&&(ro.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse).multiply(this.matrixWorld),N1.setFromProjectionMatrix(ro,n.coordinateSystem,n.reversedDepth));let C=0;if(this.sortObjects){ro.copy(this.matrixWorld).invert(),Wm.setFromMatrixPosition(n.matrixWorld).applyMatrix4(ro),D1.set(0,0,-1).transformDirection(n.matrixWorld).transformDirection(ro);for(let U=0,L=d.length;U<L;U++)if(d[U].visible&&d[U].active){const z=d[U].geometryIndex;this.getMatrixAt(U,ro),this.getBoundingSphereAt(z,xf).applyMatrix4(ro);let B=!1;if(_&&(B=!I.intersectsSphere(xf,n)),!B){const k=v[z],G=nP.subVectors(xf.center,Wm).dot(D1);ub.push(k.start,k.count,G,U)}}const A=ub.list,D=this.customSort;D===null?A.sort(s.transparent?QU:KU):D.call(this,A,n);for(let U=0,L=A.length;U<L;U++){const z=A[U];p[C]=z.start*c,m[C]=z.count,T[C]=z.index,C++}ub.reset()}else for(let A=0,D=d.length;A<D;A++)if(d[A].visible&&d[A].active){const U=d[A].geometryIndex;let L=!1;if(_&&(this.getMatrixAt(A,ro),this.getBoundingSphereAt(U,xf).applyMatrix4(ro),L=!I.intersectsSphere(xf,n)),!L){const z=v[U];p[C]=z.start*c,m[C]=z.count,T[C]=A,C++}}b.needsUpdate=!0,this._multiDrawCount=C,this._visibilityChanged=!1}onBeforeShadow(e,t,n,r,s,a){this.onBeforeRender(e,null,r,s,a)}}class Fs extends vs{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Pt(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const k_=new Q,O_=new Q,U1=new an,Xm=new ip,cy=new Tr,cb=new Q,P1=new Q;let Tc=class extends Kn{constructor(e=new vn,t=new Fs){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,n=[0];for(let r=1,s=t.count;r<s;r++)k_.fromBufferAttribute(t,r-1),O_.fromBufferAttribute(t,r),n[r]=n[r-1],n[r]+=k_.distanceTo(O_);e.setAttribute("lineDistance",new zt(n,1))}else It("Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const n=this.geometry,r=this.matrixWorld,s=e.params.Line.threshold,a=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),cy.copy(n.boundingSphere),cy.applyMatrix4(r),cy.radius+=s,e.ray.intersectsSphere(cy)===!1)return;U1.copy(r).invert(),Xm.copy(e.ray).applyMatrix4(U1);const c=s/((this.scale.x+this.scale.y+this.scale.z)/3),d=c*c,p=this.isLineSegments?2:1,m=n.index,_=n.attributes.position;if(m!==null){const b=Math.max(0,a.start),T=Math.min(m.count,a.start+a.count);for(let I=b,C=T-1;I<C;I+=p){const A=m.getX(I),D=m.getX(I+1),U=fy(this,e,Xm,d,A,D,I);U&&t.push(U)}if(this.isLineLoop){const I=m.getX(T-1),C=m.getX(b),A=fy(this,e,Xm,d,I,C,T-1);A&&t.push(A)}}else{const b=Math.max(0,a.start),T=Math.min(_.count,a.start+a.count);for(let I=b,C=T-1;I<C;I+=p){const A=fy(this,e,Xm,d,I,I+1,I);A&&t.push(A)}if(this.isLineLoop){const I=fy(this,e,Xm,d,T-1,b,T-1);I&&t.push(I)}}}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const r=t[n[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,a=r.length;s<a;s++){const c=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[c]=s}}}}};function fy(i,e,t,n,r,s,a){const c=i.geometry.attributes.position;if(k_.fromBufferAttribute(c,r),O_.fromBufferAttribute(c,s),t.distanceSqToSegment(k_,O_,cb,P1)>n)return;cb.applyMatrix4(i.matrixWorld);const p=e.ray.origin.distanceTo(cb);if(!(p<e.near||p>e.far))return{distance:p,point:P1.clone().applyMatrix4(i.matrixWorld),index:a,face:null,faceIndex:null,barycoord:null,object:i}}const L1=new Q,F1=new Q;class Al extends Tc{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,n=[];for(let r=0,s=t.count;r<s;r+=2)L1.fromBufferAttribute(t,r),F1.fromBufferAttribute(t,r+1),n[r]=r===0?0:n[r-1],n[r+1]=n[r]+L1.distanceTo(F1);e.setAttribute("lineDistance",new zt(n,1))}else It("LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class kR extends Tc{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class tE extends vs{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new Pt(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const k1=new an,nM=new ip,dy=new Tr,hy=new Q;class OR extends Kn{constructor(e=new vn,t=new tE){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,t){const n=this.geometry,r=this.matrixWorld,s=e.params.Points.threshold,a=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),dy.copy(n.boundingSphere),dy.applyMatrix4(r),dy.radius+=s,e.ray.intersectsSphere(dy)===!1)return;k1.copy(r).invert(),nM.copy(e.ray).applyMatrix4(k1);const c=s/((this.scale.x+this.scale.y+this.scale.z)/3),d=c*c,p=n.index,v=n.attributes.position;if(p!==null){const _=Math.max(0,a.start),b=Math.min(p.count,a.start+a.count);for(let T=_,I=b;T<I;T++){const C=p.getX(T);hy.fromBufferAttribute(v,C),O1(hy,C,d,r,e,t,this)}}else{const _=Math.max(0,a.start),b=Math.min(v.count,a.start+a.count);for(let T=_,I=b;T<I;T++)hy.fromBufferAttribute(v,T),O1(hy,T,d,r,e,t,this)}}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const r=t[n[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,a=r.length;s<a;s++){const c=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[c]=s}}}}}function O1(i,e,t,n,r,s,a){const c=nM.distanceSqToPoint(i);if(c<t){const d=new Q;nM.closestPointToPoint(i,d),d.applyMatrix4(n);const p=r.ray.origin.distanceTo(d);if(p<r.near||p>r.far)return;s.push({distance:p,distanceToRay:Math.sqrt(c),point:d,index:e,face:null,faceIndex:null,barycoord:null,object:a})}}class zR extends hi{constructor(e,t,n,r,s=Bn,a=Bn,c,d,p){super(e,t,n,r,s,a,c,d,p),this.isVideoTexture=!0,this.generateMipmaps=!1,this._requestVideoFrameCallbackId=0;const m=this;function v(){m.needsUpdate=!0,m._requestVideoFrameCallbackId=e.requestVideoFrameCallback(v)}"requestVideoFrameCallback"in e&&(this._requestVideoFrameCallbackId=e.requestVideoFrameCallback(v))}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;"requestVideoFrameCallback"in e===!1&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}dispose(){this._requestVideoFrameCallbackId!==0&&(this.source.data.cancelVideoFrameCallback(this._requestVideoFrameCallbackId),this._requestVideoFrameCallbackId=0),super.dispose()}}class rP extends zR{constructor(e,t,n,r,s,a,c,d){super({},e,t,n,r,s,a,c,d),this.isVideoFrameTexture=!0}update(){}clone(){return new this.constructor().copy(this)}setFrame(e){this.image=e,this.needsUpdate=!0}}class sP extends hi{constructor(e,t){super({width:e,height:t}),this.isFramebufferTexture=!0,this.magFilter=lr,this.minFilter=lr,this.generateMipmaps=!1,this.needsUpdate=!0}}class bx extends hi{constructor(e,t,n,r,s,a,c,d,p,m,v,_){super(null,a,c,d,p,m,r,s,v,_),this.isCompressedTexture=!0,this.image={width:t,height:n},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}class oP extends bx{constructor(e,t,n,r,s,a){super(e,t,n,s,a),this.isCompressedArrayTexture=!0,this.image.depth=r,this.wrapR=Qi,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class aP extends bx{constructor(e,t,n){super(void 0,e[0].width,e[0].height,t,n,Ua),this.isCompressedCubeTexture=!0,this.isCubeTexture=!0,this.image=e}}class lP extends hi{constructor(e,t,n,r,s,a,c,d,p){super(e,t,n,r,s,a,c,d,p),this.isCanvasTexture=!0,this.needsUpdate=!0}}class Wf extends hi{constructor(e,t,n=Mo,r,s,a,c=lr,d=lr,p,m=Ml,v=1){if(m!==Ml&&m!==vc)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");const _={width:e,height:t,depth:v};super(_,r,s,a,c,d,m,n,p),this.isDepthTexture=!0,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.source=new yc(Object.assign({},e.image)),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return this.compareFunction!==null&&(t.compareFunction=this.compareFunction),t}}class BR extends Wf{constructor(e,t=Mo,n=Ua,r,s,a=lr,c=lr,d,p=Ml){const m={width:e,height:e,depth:1},v=[m,m,m,m,m,m];super(e,e,t,n,r,s,a,c,d,p),this.image=v,this.isCubeDepthTexture=!0,this.isCubeTexture=!0}get images(){return this.image}set images(e){this.image=e}}class nE extends hi{constructor(e=null){super(),this.sourceTexture=e,this.isExternalTexture=!0}copy(e){return super.copy(e),this.sourceTexture=e.sourceTexture,this}}class Mx extends vn{constructor(e=1,t=1,n=4,r=8,s=1){super(),this.type="CapsuleGeometry",this.parameters={radius:e,height:t,capSegments:n,radialSegments:r,heightSegments:s},t=Math.max(0,t),n=Math.max(1,Math.floor(n)),r=Math.max(3,Math.floor(r)),s=Math.max(1,Math.floor(s));const a=[],c=[],d=[],p=[],m=t/2,v=Math.PI/2*e,_=t,b=2*v+_,T=n*2+s,I=r+1,C=new Q,A=new Q;for(let D=0;D<=T;D++){let U=0,L=0,z=0,B=0;if(D<=n){const P=D/n,O=P*Math.PI/2;L=-m-e*Math.cos(O),z=e*Math.sin(O),B=-e*Math.cos(O),U=P*v}else if(D<=n+s){const P=(D-n)/s;L=-m+P*t,z=e,B=0,U=v+P*_}else{const P=(D-n-s)/n,O=P*Math.PI/2;L=m+e*Math.sin(O),z=e*Math.cos(O),B=e*Math.sin(O),U=v+_+P*v}const k=Math.max(0,Math.min(1,U/b));let G=0;D===0?G=.5/r:D===T&&(G=-.5/r);for(let P=0;P<=r;P++){const O=P/r,Z=O*Math.PI*2,ie=Math.sin(Z),ee=Math.cos(Z);A.x=-z*ee,A.y=L,A.z=z*ie,c.push(A.x,A.y,A.z),C.set(-z*ee,B,z*ie),C.normalize(),d.push(C.x,C.y,C.z),p.push(O+G,k)}if(D>0){const P=(D-1)*I;for(let O=0;O<r;O++){const Z=P+O,ie=P+O+1,ee=D*I+O,re=D*I+O+1;a.push(Z,ie,ee),a.push(ie,re,ee)}}}this.setIndex(a),this.setAttribute("position",new zt(c,3)),this.setAttribute("normal",new zt(d,3)),this.setAttribute("uv",new zt(p,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Mx(e.radius,e.height,e.capSegments,e.radialSegments,e.heightSegments)}}class Ex extends vn{constructor(e=1,t=32,n=0,r=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:n,thetaLength:r},t=Math.max(3,t);const s=[],a=[],c=[],d=[],p=new Q,m=new $e;a.push(0,0,0),c.push(0,0,1),d.push(.5,.5);for(let v=0,_=3;v<=t;v++,_+=3){const b=n+v/t*r;p.x=e*Math.cos(b),p.y=e*Math.sin(b),a.push(p.x,p.y,p.z),c.push(0,0,1),m.x=(a[_]/e+1)/2,m.y=(a[_+1]/e+1)/2,d.push(m.x,m.y)}for(let v=1;v<=t;v++)s.push(v,v+1,0);this.setIndex(s),this.setAttribute("position",new zt(a,3)),this.setAttribute("normal",new zt(c,3)),this.setAttribute("uv",new zt(d,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Ex(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class Gg extends vn{constructor(e=1,t=1,n=1,r=32,s=1,a=!1,c=0,d=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:r,heightSegments:s,openEnded:a,thetaStart:c,thetaLength:d};const p=this;r=Math.floor(r),s=Math.floor(s);const m=[],v=[],_=[],b=[];let T=0;const I=[],C=n/2;let A=0;D(),a===!1&&(e>0&&U(!0),t>0&&U(!1)),this.setIndex(m),this.setAttribute("position",new zt(v,3)),this.setAttribute("normal",new zt(_,3)),this.setAttribute("uv",new zt(b,2));function D(){const L=new Q,z=new Q;let B=0;const k=(t-e)/n;for(let G=0;G<=s;G++){const P=[],O=G/s,Z=O*(t-e)+e;for(let ie=0;ie<=r;ie++){const ee=ie/r,re=ee*d+c,de=Math.sin(re),J=Math.cos(re);z.x=Z*de,z.y=-O*n+C,z.z=Z*J,v.push(z.x,z.y,z.z),L.set(de,k,J).normalize(),_.push(L.x,L.y,L.z),b.push(ee,1-O),P.push(T++)}I.push(P)}for(let G=0;G<r;G++)for(let P=0;P<s;P++){const O=I[P][G],Z=I[P+1][G],ie=I[P+1][G+1],ee=I[P][G+1];(e>0||P!==0)&&(m.push(O,Z,ee),B+=3),(t>0||P!==s-1)&&(m.push(Z,ie,ee),B+=3)}p.addGroup(A,B,0),A+=B}function U(L){const z=T,B=new $e,k=new Q;let G=0;const P=L===!0?e:t,O=L===!0?1:-1;for(let ie=1;ie<=r;ie++)v.push(0,C*O,0),_.push(0,O,0),b.push(.5,.5),T++;const Z=T;for(let ie=0;ie<=r;ie++){const re=ie/r*d+c,de=Math.cos(re),J=Math.sin(re);k.x=P*J,k.y=C*O,k.z=P*de,v.push(k.x,k.y,k.z),_.push(0,O,0),B.x=de*.5+.5,B.y=J*.5*O+.5,b.push(B.x,B.y),T++}for(let ie=0;ie<r;ie++){const ee=z+ie,re=Z+ie;L===!0?m.push(re,re+1,ee):m.push(re+1,re,ee),G+=3}p.addGroup(A,G,L===!0?1:2),A+=G}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Gg(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class qg extends Gg{constructor(e=1,t=1,n=32,r=1,s=!1,a=0,c=Math.PI*2){super(0,e,t,n,r,s,a,c),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:n,heightSegments:r,openEnded:s,thetaStart:a,thetaLength:c}}static fromJSON(e){return new qg(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class wc extends vn{constructor(e=[],t=[],n=1,r=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:n,detail:r};const s=[],a=[];c(r),p(n),m(),this.setAttribute("position",new zt(s,3)),this.setAttribute("normal",new zt(s.slice(),3)),this.setAttribute("uv",new zt(a,2)),r===0?this.computeVertexNormals():this.normalizeNormals();function c(D){const U=new Q,L=new Q,z=new Q;for(let B=0;B<t.length;B+=3)b(t[B+0],U),b(t[B+1],L),b(t[B+2],z),d(U,L,z,D)}function d(D,U,L,z){const B=z+1,k=[];for(let G=0;G<=B;G++){k[G]=[];const P=D.clone().lerp(L,G/B),O=U.clone().lerp(L,G/B),Z=B-G;for(let ie=0;ie<=Z;ie++)ie===0&&G===B?k[G][ie]=P:k[G][ie]=P.clone().lerp(O,ie/Z)}for(let G=0;G<B;G++)for(let P=0;P<2*(B-G)-1;P++){const O=Math.floor(P/2);P%2===0?(_(k[G][O+1]),_(k[G+1][O]),_(k[G][O])):(_(k[G][O+1]),_(k[G+1][O+1]),_(k[G+1][O]))}}function p(D){const U=new Q;for(let L=0;L<s.length;L+=3)U.x=s[L+0],U.y=s[L+1],U.z=s[L+2],U.normalize().multiplyScalar(D),s[L+0]=U.x,s[L+1]=U.y,s[L+2]=U.z}function m(){const D=new Q;for(let U=0;U<s.length;U+=3){D.x=s[U+0],D.y=s[U+1],D.z=s[U+2];const L=C(D)/2/Math.PI+.5,z=A(D)/Math.PI+.5;a.push(L,1-z)}T(),v()}function v(){for(let D=0;D<a.length;D+=6){const U=a[D+0],L=a[D+2],z=a[D+4],B=Math.max(U,L,z),k=Math.min(U,L,z);B>.9&&k<.1&&(U<.2&&(a[D+0]+=1),L<.2&&(a[D+2]+=1),z<.2&&(a[D+4]+=1))}}function _(D){s.push(D.x,D.y,D.z)}function b(D,U){const L=D*3;U.x=e[L+0],U.y=e[L+1],U.z=e[L+2]}function T(){const D=new Q,U=new Q,L=new Q,z=new Q,B=new $e,k=new $e,G=new $e;for(let P=0,O=0;P<s.length;P+=9,O+=6){D.set(s[P+0],s[P+1],s[P+2]),U.set(s[P+3],s[P+4],s[P+5]),L.set(s[P+6],s[P+7],s[P+8]),B.set(a[O+0],a[O+1]),k.set(a[O+2],a[O+3]),G.set(a[O+4],a[O+5]),z.copy(D).add(U).add(L).divideScalar(3);const Z=C(z);I(B,O+0,D,Z),I(k,O+2,U,Z),I(G,O+4,L,Z)}}function I(D,U,L,z){z<0&&D.x===1&&(a[U]=D.x-1),L.x===0&&L.z===0&&(a[U]=z/2/Math.PI+.5)}function C(D){return Math.atan2(D.z,-D.x)}function A(D){return Math.atan2(-D.y,Math.sqrt(D.x*D.x+D.z*D.z))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new wc(e.vertices,e.indices,e.radius,e.detail)}}class Tx extends wc{constructor(e=1,t=0){const n=(1+Math.sqrt(5))/2,r=1/n,s=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-n,0,-r,n,0,r,-n,0,r,n,-r,-n,0,-r,n,0,r,-n,0,r,n,0,-n,0,-r,n,0,-r,-n,0,r,n,0,r],a=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(s,a,e,t),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Tx(e.radius,e.detail)}}const py=new Q,my=new Q,fb=new Q,gy=new oo;class VR extends vn{constructor(e=null,t=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:t},e!==null){const r=Math.pow(10,4),s=Math.cos(Bf*t),a=e.getIndex(),c=e.getAttribute("position"),d=a?a.count:c.count,p=[0,0,0],m=["a","b","c"],v=new Array(3),_={},b=[];for(let T=0;T<d;T+=3){a?(p[0]=a.getX(T),p[1]=a.getX(T+1),p[2]=a.getX(T+2)):(p[0]=T,p[1]=T+1,p[2]=T+2);const{a:I,b:C,c:A}=gy;if(I.fromBufferAttribute(c,p[0]),C.fromBufferAttribute(c,p[1]),A.fromBufferAttribute(c,p[2]),gy.getNormal(fb),v[0]=`${Math.round(I.x*r)},${Math.round(I.y*r)},${Math.round(I.z*r)}`,v[1]=`${Math.round(C.x*r)},${Math.round(C.y*r)},${Math.round(C.z*r)}`,v[2]=`${Math.round(A.x*r)},${Math.round(A.y*r)},${Math.round(A.z*r)}`,!(v[0]===v[1]||v[1]===v[2]||v[2]===v[0]))for(let D=0;D<3;D++){const U=(D+1)%3,L=v[D],z=v[U],B=gy[m[D]],k=gy[m[U]],G=`${L}_${z}`,P=`${z}_${L}`;P in _&&_[P]?(fb.dot(_[P].normal)<=s&&(b.push(B.x,B.y,B.z),b.push(k.x,k.y,k.z)),_[P]=null):G in _||(_[G]={index0:p[D],index1:p[U],normal:fb.clone()})}}for(const T in _)if(_[T]){const{index0:I,index1:C}=_[T];py.fromBufferAttribute(c,I),my.fromBufferAttribute(c,C),b.push(py.x,py.y,py.z),b.push(my.x,my.y,my.z)}this.setAttribute("position",new zt(b,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}class La{constructor(){this.type="Curve",this.arcLengthDivisions=200,this.needsUpdate=!1,this.cacheArcLengths=null}getPoint(){It("Curve: .getPoint() not implemented.")}getPointAt(e,t){const n=this.getUtoTmapping(e);return this.getPoint(n,t)}getPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return t}getSpacedPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let n,r=this.getPoint(0),s=0;t.push(0);for(let a=1;a<=e;a++)n=this.getPoint(a/e),s+=n.distanceTo(r),t.push(s),r=n;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t=null){const n=this.getLengths();let r=0;const s=n.length;let a;t?a=t:a=e*n[s-1];let c=0,d=s-1,p;for(;c<=d;)if(r=Math.floor(c+(d-c)/2),p=n[r]-a,p<0)c=r+1;else if(p>0)d=r-1;else{d=r;break}if(r=d,n[r]===a)return r/(s-1);const m=n[r],_=n[r+1]-m,b=(a-m)/_;return(r+b)/(s-1)}getTangent(e,t){let r=e-1e-4,s=e+1e-4;r<0&&(r=0),s>1&&(s=1);const a=this.getPoint(r),c=this.getPoint(s),d=t||(a.isVector2?new $e:new Q);return d.copy(c).sub(a).normalize(),d}getTangentAt(e,t){const n=this.getUtoTmapping(e);return this.getTangent(n,t)}computeFrenetFrames(e,t=!1){const n=new Q,r=[],s=[],a=[],c=new Q,d=new an;for(let b=0;b<=e;b++){const T=b/e;r[b]=this.getTangentAt(T,new Q)}s[0]=new Q,a[0]=new Q;let p=Number.MAX_VALUE;const m=Math.abs(r[0].x),v=Math.abs(r[0].y),_=Math.abs(r[0].z);m<=p&&(p=m,n.set(1,0,0)),v<=p&&(p=v,n.set(0,1,0)),_<=p&&n.set(0,0,1),c.crossVectors(r[0],n).normalize(),s[0].crossVectors(r[0],c),a[0].crossVectors(r[0],s[0]);for(let b=1;b<=e;b++){if(s[b]=s[b-1].clone(),a[b]=a[b-1].clone(),c.crossVectors(r[b-1],r[b]),c.length()>Number.EPSILON){c.normalize();const T=Math.acos(on(r[b-1].dot(r[b]),-1,1));s[b].applyMatrix4(d.makeRotationAxis(c,T))}a[b].crossVectors(r[b],s[b])}if(t===!0){let b=Math.acos(on(s[0].dot(s[e]),-1,1));b/=e,r[0].dot(c.crossVectors(s[0],s[e]))>0&&(b=-b);for(let T=1;T<=e;T++)s[T].applyMatrix4(d.makeRotationAxis(r[T],b*T)),a[T].crossVectors(r[T],s[T])}return{tangents:r,normals:s,binormals:a}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.7,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class Ax extends La{constructor(e=0,t=0,n=1,r=1,s=0,a=Math.PI*2,c=!1,d=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=n,this.yRadius=r,this.aStartAngle=s,this.aEndAngle=a,this.aClockwise=c,this.aRotation=d}getPoint(e,t=new $e){const n=t,r=Math.PI*2;let s=this.aEndAngle-this.aStartAngle;const a=Math.abs(s)<Number.EPSILON;for(;s<0;)s+=r;for(;s>r;)s-=r;s<Number.EPSILON&&(a?s=0:s=r),this.aClockwise===!0&&!a&&(s===r?s=-r:s=s-r);const c=this.aStartAngle+e*s;let d=this.aX+this.xRadius*Math.cos(c),p=this.aY+this.yRadius*Math.sin(c);if(this.aRotation!==0){const m=Math.cos(this.aRotation),v=Math.sin(this.aRotation),_=d-this.aX,b=p-this.aY;d=_*m-b*v+this.aX,p=_*v+b*m+this.aY}return n.set(d,p)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class HR extends Ax{constructor(e,t,n,r,s,a){super(e,t,n,n,r,s,a),this.isArcCurve=!0,this.type="ArcCurve"}}function iE(){let i=0,e=0,t=0,n=0;function r(s,a,c,d){i=s,e=c,t=-3*s+3*a-2*c-d,n=2*s-2*a+c+d}return{initCatmullRom:function(s,a,c,d,p){r(a,c,p*(c-s),p*(d-a))},initNonuniformCatmullRom:function(s,a,c,d,p,m,v){let _=(a-s)/p-(c-s)/(p+m)+(c-a)/m,b=(c-a)/m-(d-a)/(m+v)+(d-c)/v;_*=m,b*=m,r(a,c,_,b)},calc:function(s){const a=s*s,c=a*s;return i+e*s+t*a+n*c}}}const vy=new Q,db=new iE,hb=new iE,pb=new iE;class GR extends La{constructor(e=[],t=!1,n="centripetal",r=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=n,this.tension=r}getPoint(e,t=new Q){const n=t,r=this.points,s=r.length,a=(s-(this.closed?0:1))*e;let c=Math.floor(a),d=a-c;this.closed?c+=c>0?0:(Math.floor(Math.abs(c)/s)+1)*s:d===0&&c===s-1&&(c=s-2,d=1);let p,m;this.closed||c>0?p=r[(c-1)%s]:(vy.subVectors(r[0],r[1]).add(r[0]),p=vy);const v=r[c%s],_=r[(c+1)%s];if(this.closed||c+2<s?m=r[(c+2)%s]:(vy.subVectors(r[s-1],r[s-2]).add(r[s-1]),m=vy),this.curveType==="centripetal"||this.curveType==="chordal"){const b=this.curveType==="chordal"?.5:.25;let T=Math.pow(p.distanceToSquared(v),b),I=Math.pow(v.distanceToSquared(_),b),C=Math.pow(_.distanceToSquared(m),b);I<1e-4&&(I=1),T<1e-4&&(T=I),C<1e-4&&(C=I),db.initNonuniformCatmullRom(p.x,v.x,_.x,m.x,T,I,C),hb.initNonuniformCatmullRom(p.y,v.y,_.y,m.y,T,I,C),pb.initNonuniformCatmullRom(p.z,v.z,_.z,m.z,T,I,C)}else this.curveType==="catmullrom"&&(db.initCatmullRom(p.x,v.x,_.x,m.x,this.tension),hb.initCatmullRom(p.y,v.y,_.y,m.y,this.tension),pb.initCatmullRom(p.z,v.z,_.z,m.z,this.tension));return n.set(db.calc(d),hb.calc(d),pb.calc(d)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const r=e.points[t];this.points.push(r.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){const r=this.points[t];e.points.push(r.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const r=e.points[t];this.points.push(new Q().fromArray(r))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function z1(i,e,t,n,r){const s=(n-e)*.5,a=(r-t)*.5,c=i*i,d=i*c;return(2*t-2*n+s+a)*d+(-3*t+3*n-2*s-a)*c+s*i+t}function uP(i,e){const t=1-i;return t*t*e}function cP(i,e){return 2*(1-i)*i*e}function fP(i,e){return i*i*e}function fg(i,e,t,n){return uP(i,e)+cP(i,t)+fP(i,n)}function dP(i,e){const t=1-i;return t*t*t*e}function hP(i,e){const t=1-i;return 3*t*t*i*e}function pP(i,e){return 3*(1-i)*i*i*e}function mP(i,e){return i*i*i*e}function dg(i,e,t,n,r){return dP(i,e)+hP(i,t)+pP(i,n)+mP(i,r)}class rE extends La{constructor(e=new $e,t=new $e,n=new $e,r=new $e){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=n,this.v3=r}getPoint(e,t=new $e){const n=t,r=this.v0,s=this.v1,a=this.v2,c=this.v3;return n.set(dg(e,r.x,s.x,a.x,c.x),dg(e,r.y,s.y,a.y,c.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class qR extends La{constructor(e=new Q,t=new Q,n=new Q,r=new Q){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=n,this.v3=r}getPoint(e,t=new Q){const n=t,r=this.v0,s=this.v1,a=this.v2,c=this.v3;return n.set(dg(e,r.x,s.x,a.x,c.x),dg(e,r.y,s.y,a.y,c.y),dg(e,r.z,s.z,a.z,c.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class sE extends La{constructor(e=new $e,t=new $e){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new $e){const n=t;return e===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new $e){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class WR extends La{constructor(e=new Q,t=new Q){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e,t=new Q){const n=t;return e===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new Q){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class oE extends La{constructor(e=new $e,t=new $e,n=new $e){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new $e){const n=t,r=this.v0,s=this.v1,a=this.v2;return n.set(fg(e,r.x,s.x,a.x),fg(e,r.y,s.y,a.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class aE extends La{constructor(e=new Q,t=new Q,n=new Q){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new Q){const n=t,r=this.v0,s=this.v1,a=this.v2;return n.set(fg(e,r.x,s.x,a.x),fg(e,r.y,s.y,a.y),fg(e,r.z,s.z,a.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class lE extends La{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new $e){const n=t,r=this.points,s=(r.length-1)*e,a=Math.floor(s),c=s-a,d=r[a===0?a:a-1],p=r[a],m=r[a>r.length-2?r.length-1:a+1],v=r[a>r.length-3?r.length-1:a+2];return n.set(z1(c,d.x,p.x,m.x,v.x),z1(c,d.y,p.y,m.y,v.y)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const r=e.points[t];this.points.push(r.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){const r=this.points[t];e.points.push(r.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const r=e.points[t];this.points.push(new $e().fromArray(r))}return this}}var z_=Object.freeze({__proto__:null,ArcCurve:HR,CatmullRomCurve3:GR,CubicBezierCurve:rE,CubicBezierCurve3:qR,EllipseCurve:Ax,LineCurve:sE,LineCurve3:WR,QuadraticBezierCurve:oE,QuadraticBezierCurve3:aE,SplineCurve:lE});class XR extends La{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);if(!e.equals(t)){const n=e.isVector2===!0?"LineCurve":"LineCurve3";this.curves.push(new z_[n](t,e))}return this}getPoint(e,t){const n=e*this.getLength(),r=this.getCurveLengths();let s=0;for(;s<r.length;){if(r[s]>=n){const a=r[s]-n,c=this.curves[s],d=c.getLength(),p=d===0?0:1-a/d;return c.getPointAt(p,t)}s++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let n=0,r=this.curves.length;n<r;n++)t+=this.curves[n].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){const t=[];let n;for(let r=0,s=this.curves;r<s.length;r++){const a=s[r],c=a.isEllipseCurve?e*2:a.isLineCurve||a.isLineCurve3?1:a.isSplineCurve?e*a.points.length:e,d=a.getPoints(c);for(let p=0;p<d.length;p++){const m=d[p];n&&n.equals(m)||(t.push(m),n=m)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const r=e.curves[t];this.curves.push(r.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,n=this.curves.length;t<n;t++){const r=this.curves[t];e.curves.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const r=e.curves[t];this.curves.push(new z_[r.type]().fromJSON(r))}return this}}class B_ extends XR{constructor(e){super(),this.type="Path",this.currentPoint=new $e,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,n=e.length;t<n;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){const n=new sE(this.currentPoint.clone(),new $e(e,t));return this.curves.push(n),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,n,r){const s=new oE(this.currentPoint.clone(),new $e(e,t),new $e(n,r));return this.curves.push(s),this.currentPoint.set(n,r),this}bezierCurveTo(e,t,n,r,s,a){const c=new rE(this.currentPoint.clone(),new $e(e,t),new $e(n,r),new $e(s,a));return this.curves.push(c),this.currentPoint.set(s,a),this}splineThru(e){const t=[this.currentPoint.clone()].concat(e),n=new lE(t);return this.curves.push(n),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,n,r,s,a){const c=this.currentPoint.x,d=this.currentPoint.y;return this.absarc(e+c,t+d,n,r,s,a),this}absarc(e,t,n,r,s,a){return this.absellipse(e,t,n,n,r,s,a),this}ellipse(e,t,n,r,s,a,c,d){const p=this.currentPoint.x,m=this.currentPoint.y;return this.absellipse(e+p,t+m,n,r,s,a,c,d),this}absellipse(e,t,n,r,s,a,c,d){const p=new Ax(e,t,n,r,s,a,c,d);if(this.curves.length>0){const v=p.getPoint(0);v.equals(this.currentPoint)||this.lineTo(v.x,v.y)}this.curves.push(p);const m=p.getPoint(1);return this.currentPoint.copy(m),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class Vf extends B_{constructor(e){super(e),this.uuid=xo(),this.type="Shape",this.holes=[]}getPointsHoles(e){const t=[];for(let n=0,r=this.holes.length;n<r;n++)t[n]=this.holes[n].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const r=e.holes[t];this.holes.push(r.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,n=this.holes.length;t<n;t++){const r=this.holes[t];e.holes.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const r=e.holes[t];this.holes.push(new B_().fromJSON(r))}return this}}function gP(i,e,t=2){const n=e&&e.length,r=n?e[0]*t:i.length;let s=YR(i,0,r,t,!0);const a=[];if(!s||s.next===s.prev)return a;let c,d,p;if(n&&(s=SP(i,e,s,t)),i.length>80*t){c=i[0],d=i[1];let m=c,v=d;for(let _=t;_<r;_+=t){const b=i[_],T=i[_+1];b<c&&(c=b),T<d&&(d=T),b>m&&(m=b),T>v&&(v=T)}p=Math.max(m-c,v-d),p=p!==0?32767/p:0}return wg(s,a,t,c,d,p,0),a}function YR(i,e,t,n,r){let s;if(r===DP(i,e,t,n)>0)for(let a=e;a<t;a+=n)s=B1(a/n|0,i[a],i[a+1],s);else for(let a=t-n;a>=e;a-=n)s=B1(a/n|0,i[a],i[a+1],s);return s&&Qh(s,s.next)&&(Rg(s),s=s.next),s}function Xf(i,e){if(!i)return i;e||(e=i);let t=i,n;do if(n=!1,!t.steiner&&(Qh(t,t.next)||qi(t.prev,t,t.next)===0)){if(Rg(t),t=e=t.prev,t===t.next)break;n=!0}else t=t.next;while(n||t!==e);return e}function wg(i,e,t,n,r,s,a){if(!i)return;!a&&s&&AP(i,n,r,s);let c=i;for(;i.prev!==i.next;){const d=i.prev,p=i.next;if(s?yP(i,n,r,s):vP(i)){e.push(d.i,i.i,p.i),Rg(i),i=p.next,c=p.next;continue}if(i=p,i===c){a?a===1?(i=_P(Xf(i),e),wg(i,e,t,n,r,s,2)):a===2&&xP(i,e,t,n,r,s):wg(Xf(i),e,t,n,r,s,1);break}}}function vP(i){const e=i.prev,t=i,n=i.next;if(qi(e,t,n)>=0)return!1;const r=e.x,s=t.x,a=n.x,c=e.y,d=t.y,p=n.y,m=Math.min(r,s,a),v=Math.min(c,d,p),_=Math.max(r,s,a),b=Math.max(c,d,p);let T=n.next;for(;T!==e;){if(T.x>=m&&T.x<=_&&T.y>=v&&T.y<=b&&tg(r,c,s,d,a,p,T.x,T.y)&&qi(T.prev,T,T.next)>=0)return!1;T=T.next}return!0}function yP(i,e,t,n){const r=i.prev,s=i,a=i.next;if(qi(r,s,a)>=0)return!1;const c=r.x,d=s.x,p=a.x,m=r.y,v=s.y,_=a.y,b=Math.min(c,d,p),T=Math.min(m,v,_),I=Math.max(c,d,p),C=Math.max(m,v,_),A=iM(b,T,e,t,n),D=iM(I,C,e,t,n);let U=i.prevZ,L=i.nextZ;for(;U&&U.z>=A&&L&&L.z<=D;){if(U.x>=b&&U.x<=I&&U.y>=T&&U.y<=C&&U!==r&&U!==a&&tg(c,m,d,v,p,_,U.x,U.y)&&qi(U.prev,U,U.next)>=0||(U=U.prevZ,L.x>=b&&L.x<=I&&L.y>=T&&L.y<=C&&L!==r&&L!==a&&tg(c,m,d,v,p,_,L.x,L.y)&&qi(L.prev,L,L.next)>=0))return!1;L=L.nextZ}for(;U&&U.z>=A;){if(U.x>=b&&U.x<=I&&U.y>=T&&U.y<=C&&U!==r&&U!==a&&tg(c,m,d,v,p,_,U.x,U.y)&&qi(U.prev,U,U.next)>=0)return!1;U=U.prevZ}for(;L&&L.z<=D;){if(L.x>=b&&L.x<=I&&L.y>=T&&L.y<=C&&L!==r&&L!==a&&tg(c,m,d,v,p,_,L.x,L.y)&&qi(L.prev,L,L.next)>=0)return!1;L=L.nextZ}return!0}function _P(i,e){let t=i;do{const n=t.prev,r=t.next.next;!Qh(n,r)&&ZR(n,t,t.next,r)&&Cg(n,r)&&Cg(r,n)&&(e.push(n.i,t.i,r.i),Rg(t),Rg(t.next),t=i=r),t=t.next}while(t!==i);return Xf(t)}function xP(i,e,t,n,r,s){let a=i;do{let c=a.next.next;for(;c!==a.prev;){if(a.i!==c.i&&RP(a,c)){let d=$R(a,c);a=Xf(a,a.next),d=Xf(d,d.next),wg(a,e,t,n,r,s,0),wg(d,e,t,n,r,s,0);return}c=c.next}a=a.next}while(a!==i)}function SP(i,e,t,n){const r=[];for(let s=0,a=e.length;s<a;s++){const c=e[s]*n,d=s<a-1?e[s+1]*n:i.length,p=YR(i,c,d,n,!1);p===p.next&&(p.steiner=!0),r.push(CP(p))}r.sort(bP);for(let s=0;s<r.length;s++)t=MP(r[s],t);return t}function bP(i,e){let t=i.x-e.x;if(t===0&&(t=i.y-e.y,t===0)){const n=(i.next.y-i.y)/(i.next.x-i.x),r=(e.next.y-e.y)/(e.next.x-e.x);t=n-r}return t}function MP(i,e){const t=EP(i,e);if(!t)return e;const n=$R(t,i);return Xf(n,n.next),Xf(t,t.next)}function EP(i,e){let t=e;const n=i.x,r=i.y;let s=-1/0,a;if(Qh(i,t))return t;do{if(Qh(i,t.next))return t.next;if(r<=t.y&&r>=t.next.y&&t.next.y!==t.y){const v=t.x+(r-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(v<=n&&v>s&&(s=v,a=t.x<t.next.x?t:t.next,v===n))return a}t=t.next}while(t!==e);if(!a)return null;const c=a,d=a.x,p=a.y;let m=1/0;t=a;do{if(n>=t.x&&t.x>=d&&n!==t.x&&JR(r<p?n:s,r,d,p,r<p?s:n,r,t.x,t.y)){const v=Math.abs(r-t.y)/(n-t.x);Cg(t,i)&&(v<m||v===m&&(t.x>a.x||t.x===a.x&&TP(a,t)))&&(a=t,m=v)}t=t.next}while(t!==c);return a}function TP(i,e){return qi(i.prev,i,e.prev)<0&&qi(e.next,i,i.next)<0}function AP(i,e,t,n){let r=i;do r.z===0&&(r.z=iM(r.x,r.y,e,t,n)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==i);r.prevZ.nextZ=null,r.prevZ=null,wP(r)}function wP(i){let e,t=1;do{let n=i,r;i=null;let s=null;for(e=0;n;){e++;let a=n,c=0;for(let p=0;p<t&&(c++,a=a.nextZ,!!a);p++);let d=t;for(;c>0||d>0&&a;)c!==0&&(d===0||!a||n.z<=a.z)?(r=n,n=n.nextZ,c--):(r=a,a=a.nextZ,d--),s?s.nextZ=r:i=r,r.prevZ=s,s=r;n=a}s.nextZ=null,t*=2}while(e>1);return i}function iM(i,e,t,n,r){return i=(i-t)*r|0,e=(e-n)*r|0,i=(i|i<<8)&16711935,i=(i|i<<4)&252645135,i=(i|i<<2)&858993459,i=(i|i<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,i|e<<1}function CP(i){let e=i,t=i;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==i);return t}function JR(i,e,t,n,r,s,a,c){return(r-a)*(e-c)>=(i-a)*(s-c)&&(i-a)*(n-c)>=(t-a)*(e-c)&&(t-a)*(s-c)>=(r-a)*(n-c)}function tg(i,e,t,n,r,s,a,c){return!(i===a&&e===c)&&JR(i,e,t,n,r,s,a,c)}function RP(i,e){return i.next.i!==e.i&&i.prev.i!==e.i&&!IP(i,e)&&(Cg(i,e)&&Cg(e,i)&&NP(i,e)&&(qi(i.prev,i,e.prev)||qi(i,e.prev,e))||Qh(i,e)&&qi(i.prev,i,i.next)>0&&qi(e.prev,e,e.next)>0)}function qi(i,e,t){return(e.y-i.y)*(t.x-e.x)-(e.x-i.x)*(t.y-e.y)}function Qh(i,e){return i.x===e.x&&i.y===e.y}function ZR(i,e,t,n){const r=_y(qi(i,e,t)),s=_y(qi(i,e,n)),a=_y(qi(t,n,i)),c=_y(qi(t,n,e));return!!(r!==s&&a!==c||r===0&&yy(i,t,e)||s===0&&yy(i,n,e)||a===0&&yy(t,i,n)||c===0&&yy(t,e,n))}function yy(i,e,t){return e.x<=Math.max(i.x,t.x)&&e.x>=Math.min(i.x,t.x)&&e.y<=Math.max(i.y,t.y)&&e.y>=Math.min(i.y,t.y)}function _y(i){return i>0?1:i<0?-1:0}function IP(i,e){let t=i;do{if(t.i!==i.i&&t.next.i!==i.i&&t.i!==e.i&&t.next.i!==e.i&&ZR(t,t.next,i,e))return!0;t=t.next}while(t!==i);return!1}function Cg(i,e){return qi(i.prev,i,i.next)<0?qi(i,e,i.next)>=0&&qi(i,i.prev,e)>=0:qi(i,e,i.prev)<0||qi(i,i.next,e)<0}function NP(i,e){let t=i,n=!1;const r=(i.x+e.x)/2,s=(i.y+e.y)/2;do t.y>s!=t.next.y>s&&t.next.y!==t.y&&r<(t.next.x-t.x)*(s-t.y)/(t.next.y-t.y)+t.x&&(n=!n),t=t.next;while(t!==i);return n}function $R(i,e){const t=rM(i.i,i.x,i.y),n=rM(e.i,e.x,e.y),r=i.next,s=e.prev;return i.next=e,e.prev=i,t.next=r,r.prev=t,n.next=t,t.prev=n,s.next=n,n.prev=s,n}function B1(i,e,t,n){const r=rM(i,e,t);return n?(r.next=n.next,r.prev=n,n.next.prev=r,n.next=r):(r.prev=r,r.next=r),r}function Rg(i){i.next.prev=i.prev,i.prev.next=i.next,i.prevZ&&(i.prevZ.nextZ=i.nextZ),i.nextZ&&(i.nextZ.prevZ=i.prevZ)}function rM(i,e,t){return{i,x:e,y:t,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function DP(i,e,t,n){let r=0;for(let s=e,a=t-n;s<t;s+=n)r+=(i[a]-i[s])*(i[s+1]+i[a+1]),a=s;return r}class UP{static triangulate(e,t,n=2){return gP(e,t,n)}}class Ra{static area(e){const t=e.length;let n=0;for(let r=t-1,s=0;s<t;r=s++)n+=e[r].x*e[s].y-e[s].x*e[r].y;return n*.5}static isClockWise(e){return Ra.area(e)<0}static triangulateShape(e,t){const n=[],r=[],s=[];V1(e),H1(n,e);let a=e.length;t.forEach(V1);for(let d=0;d<t.length;d++)r.push(a),a+=t[d].length,H1(n,t[d]);const c=UP.triangulate(n,r);for(let d=0;d<c.length;d+=3)s.push(c.slice(d,d+3));return s}}function V1(i){const e=i.length;e>2&&i[e-1].equals(i[0])&&i.pop()}function H1(i,e){for(let t=0;t<e.length;t++)i.push(e[t].x),i.push(e[t].y)}class wx extends vn{constructor(e=new Vf([new $e(.5,.5),new $e(-.5,.5),new $e(-.5,-.5),new $e(.5,-.5)]),t={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];const n=this,r=[],s=[];for(let c=0,d=e.length;c<d;c++){const p=e[c];a(p)}this.setAttribute("position",new zt(r,3)),this.setAttribute("uv",new zt(s,2)),this.computeVertexNormals();function a(c){const d=[],p=t.curveSegments!==void 0?t.curveSegments:12,m=t.steps!==void 0?t.steps:1,v=t.depth!==void 0?t.depth:1;let _=t.bevelEnabled!==void 0?t.bevelEnabled:!0,b=t.bevelThickness!==void 0?t.bevelThickness:.2,T=t.bevelSize!==void 0?t.bevelSize:b-.1,I=t.bevelOffset!==void 0?t.bevelOffset:0,C=t.bevelSegments!==void 0?t.bevelSegments:3;const A=t.extrudePath,D=t.UVGenerator!==void 0?t.UVGenerator:PP;let U,L=!1,z,B,k,G;if(A){U=A.getSpacedPoints(m),L=!0,_=!1;const Ve=A.isCatmullRomCurve3?A.closed:!1;z=A.computeFrenetFrames(m,Ve),B=new Q,k=new Q,G=new Q}_||(C=0,b=0,T=0,I=0);const P=c.extractPoints(p);let O=P.shape;const Z=P.holes;if(!Ra.isClockWise(O)){O=O.reverse();for(let Ve=0,et=Z.length;Ve<et;Ve++){const qe=Z[Ve];Ra.isClockWise(qe)&&(Z[Ve]=qe.reverse())}}function ee(Ve){const qe=10000000000000001e-36;let _t=Ve[0];for(let j=1;j<=Ve.length;j++){const Ht=j%Ve.length,Et=Ve[Ht],Gt=Et.x-_t.x,ut=Et.y-_t.y,K=Gt*Gt+ut*ut,V=Math.max(Math.abs(Et.x),Math.abs(Et.y),Math.abs(_t.x),Math.abs(_t.y)),pe=qe*V*V;if(K<=pe){Ve.splice(Ht,1),j--;continue}_t=Et}}ee(O),Z.forEach(ee);const re=Z.length,de=O;for(let Ve=0;Ve<re;Ve++){const et=Z[Ve];O=O.concat(et)}function J(Ve,et,qe){return et||Jt("ExtrudeGeometry: vec does not exist"),Ve.clone().addScaledVector(et,qe)}const te=O.length;function ye(Ve,et,qe){let _t,j,Ht;const Et=Ve.x-et.x,Gt=Ve.y-et.y,ut=qe.x-Ve.x,K=qe.y-Ve.y,V=Et*Et+Gt*Gt,pe=Et*K-Gt*ut;if(Math.abs(pe)>Number.EPSILON){const De=Math.sqrt(V),We=Math.sqrt(ut*ut+K*K),Ne=et.x-Gt/De,Ct=et.y+Et/De,ht=qe.x-K/We,Ot=qe.y+ut/We,$t=((ht-Ne)*K-(Ot-Ct)*ut)/(Et*K-Gt*ut);_t=Ne+Et*$t-Ve.x,j=Ct+Gt*$t-Ve.y;const Ze=_t*_t+j*j;if(Ze<=2)return new $e(_t,j);Ht=Math.sqrt(Ze/2)}else{let De=!1;Et>Number.EPSILON?ut>Number.EPSILON&&(De=!0):Et<-Number.EPSILON?ut<-Number.EPSILON&&(De=!0):Math.sign(Gt)===Math.sign(K)&&(De=!0),De?(_t=-Gt,j=Et,Ht=Math.sqrt(V)):(_t=Et,j=Gt,Ht=Math.sqrt(V/2))}return new $e(_t/Ht,j/Ht)}const Ue=[];for(let Ve=0,et=de.length,qe=et-1,_t=Ve+1;Ve<et;Ve++,qe++,_t++)qe===et&&(qe=0),_t===et&&(_t=0),Ue[Ve]=ye(de[Ve],de[qe],de[_t]);const we=[];let $,ce=Ue.concat();for(let Ve=0,et=re;Ve<et;Ve++){const qe=Z[Ve];$=[];for(let _t=0,j=qe.length,Ht=j-1,Et=_t+1;_t<j;_t++,Ht++,Et++)Ht===j&&(Ht=0),Et===j&&(Et=0),$[_t]=ye(qe[_t],qe[Ht],qe[Et]);we.push($),ce=ce.concat($)}let Ee;if(C===0)Ee=Ra.triangulateShape(de,Z);else{const Ve=[],et=[];for(let qe=0;qe<C;qe++){const _t=qe/C,j=b*Math.cos(_t*Math.PI/2),Ht=T*Math.sin(_t*Math.PI/2)+I;for(let Et=0,Gt=de.length;Et<Gt;Et++){const ut=J(de[Et],Ue[Et],Ht);bt(ut.x,ut.y,-j),_t===0&&Ve.push(ut)}for(let Et=0,Gt=re;Et<Gt;Et++){const ut=Z[Et];$=we[Et];const K=[];for(let V=0,pe=ut.length;V<pe;V++){const De=J(ut[V],$[V],Ht);bt(De.x,De.y,-j),_t===0&&K.push(De)}_t===0&&et.push(K)}}Ee=Ra.triangulateShape(Ve,et)}const Be=Ee.length,St=T+I;for(let Ve=0;Ve<te;Ve++){const et=_?J(O[Ve],ce[Ve],St):O[Ve];L?(k.copy(z.normals[0]).multiplyScalar(et.x),B.copy(z.binormals[0]).multiplyScalar(et.y),G.copy(U[0]).add(k).add(B),bt(G.x,G.y,G.z)):bt(et.x,et.y,0)}for(let Ve=1;Ve<=m;Ve++)for(let et=0;et<te;et++){const qe=_?J(O[et],ce[et],St):O[et];L?(k.copy(z.normals[Ve]).multiplyScalar(qe.x),B.copy(z.binormals[Ve]).multiplyScalar(qe.y),G.copy(U[Ve]).add(k).add(B),bt(G.x,G.y,G.z)):bt(qe.x,qe.y,v/m*Ve)}for(let Ve=C-1;Ve>=0;Ve--){const et=Ve/C,qe=b*Math.cos(et*Math.PI/2),_t=T*Math.sin(et*Math.PI/2)+I;for(let j=0,Ht=de.length;j<Ht;j++){const Et=J(de[j],Ue[j],_t);bt(Et.x,Et.y,v+qe)}for(let j=0,Ht=Z.length;j<Ht;j++){const Et=Z[j];$=we[j];for(let Gt=0,ut=Et.length;Gt<ut;Gt++){const K=J(Et[Gt],$[Gt],_t);L?bt(K.x,K.y+U[m-1].y,U[m-1].x+qe):bt(K.x,K.y,v+qe)}}}ve(),Re();function ve(){const Ve=r.length/3;if(_){let et=0,qe=te*et;for(let _t=0;_t<Be;_t++){const j=Ee[_t];Dt(j[2]+qe,j[1]+qe,j[0]+qe)}et=m+C*2,qe=te*et;for(let _t=0;_t<Be;_t++){const j=Ee[_t];Dt(j[0]+qe,j[1]+qe,j[2]+qe)}}else{for(let et=0;et<Be;et++){const qe=Ee[et];Dt(qe[2],qe[1],qe[0])}for(let et=0;et<Be;et++){const qe=Ee[et];Dt(qe[0]+te*m,qe[1]+te*m,qe[2]+te*m)}}n.addGroup(Ve,r.length/3-Ve,0)}function Re(){const Ve=r.length/3;let et=0;ot(de,et),et+=de.length;for(let qe=0,_t=Z.length;qe<_t;qe++){const j=Z[qe];ot(j,et),et+=j.length}n.addGroup(Ve,r.length/3-Ve,1)}function ot(Ve,et){let qe=Ve.length;for(;--qe>=0;){const _t=qe;let j=qe-1;j<0&&(j=Ve.length-1);for(let Ht=0,Et=m+C*2;Ht<Et;Ht++){const Gt=te*Ht,ut=te*(Ht+1),K=et+_t+Gt,V=et+j+Gt,pe=et+j+ut,De=et+_t+ut;cn(K,V,pe,De)}}}function bt(Ve,et,qe){d.push(Ve),d.push(et),d.push(qe)}function Dt(Ve,et,qe){Tn(Ve),Tn(et),Tn(qe);const _t=r.length/3,j=D.generateTopUV(n,r,_t-3,_t-2,_t-1);Zt(j[0]),Zt(j[1]),Zt(j[2])}function cn(Ve,et,qe,_t){Tn(Ve),Tn(et),Tn(_t),Tn(et),Tn(qe),Tn(_t);const j=r.length/3,Ht=D.generateSideWallUV(n,r,j-6,j-3,j-2,j-1);Zt(Ht[0]),Zt(Ht[1]),Zt(Ht[3]),Zt(Ht[1]),Zt(Ht[2]),Zt(Ht[3])}function Tn(Ve){r.push(d[Ve*3+0]),r.push(d[Ve*3+1]),r.push(d[Ve*3+2])}function Zt(Ve){s.push(Ve.x),s.push(Ve.y)}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),t=this.parameters.shapes,n=this.parameters.options;return LP(t,n,e)}static fromJSON(e,t){const n=[];for(let s=0,a=e.shapes.length;s<a;s++){const c=t[e.shapes[s]];n.push(c)}const r=e.options.extrudePath;return r!==void 0&&(e.options.extrudePath=new z_[r.type]().fromJSON(r)),new wx(n,e.options)}}const PP={generateTopUV:function(i,e,t,n,r){const s=e[t*3],a=e[t*3+1],c=e[n*3],d=e[n*3+1],p=e[r*3],m=e[r*3+1];return[new $e(s,a),new $e(c,d),new $e(p,m)]},generateSideWallUV:function(i,e,t,n,r,s){const a=e[t*3],c=e[t*3+1],d=e[t*3+2],p=e[n*3],m=e[n*3+1],v=e[n*3+2],_=e[r*3],b=e[r*3+1],T=e[r*3+2],I=e[s*3],C=e[s*3+1],A=e[s*3+2];return Math.abs(c-m)<Math.abs(a-p)?[new $e(a,1-d),new $e(p,1-v),new $e(_,1-T),new $e(I,1-A)]:[new $e(c,1-d),new $e(m,1-v),new $e(b,1-T),new $e(C,1-A)]}};function LP(i,e,t){if(t.shapes=[],Array.isArray(i))for(let n=0,r=i.length;n<r;n++){const s=i[n];t.shapes.push(s.uuid)}else t.shapes.push(i.uuid);return t.options=Object.assign({},e),e.extrudePath!==void 0&&(t.options.extrudePath=e.extrudePath.toJSON()),t}class Wg extends wc{constructor(e=1,t=0){const n=(1+Math.sqrt(5))/2,r=[-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],s=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(r,s,e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Wg(e.radius,e.detail)}}class Cx extends vn{constructor(e=[new $e(0,-.5),new $e(.5,0),new $e(0,.5)],t=12,n=0,r=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:n,phiLength:r},t=Math.floor(t),r=on(r,0,Math.PI*2);const s=[],a=[],c=[],d=[],p=[],m=1/t,v=new Q,_=new $e,b=new Q,T=new Q,I=new Q;let C=0,A=0;for(let D=0;D<=e.length-1;D++)switch(D){case 0:C=e[D+1].x-e[D].x,A=e[D+1].y-e[D].y,b.x=A*1,b.y=-C,b.z=A*0,I.copy(b),b.normalize(),d.push(b.x,b.y,b.z);break;case e.length-1:d.push(I.x,I.y,I.z);break;default:C=e[D+1].x-e[D].x,A=e[D+1].y-e[D].y,b.x=A*1,b.y=-C,b.z=A*0,T.copy(b),b.x+=I.x,b.y+=I.y,b.z+=I.z,b.normalize(),d.push(b.x,b.y,b.z),I.copy(T)}for(let D=0;D<=t;D++){const U=n+D*m*r,L=Math.sin(U),z=Math.cos(U);for(let B=0;B<=e.length-1;B++){v.x=e[B].x*L,v.y=e[B].y,v.z=e[B].x*z,a.push(v.x,v.y,v.z),_.x=D/t,_.y=B/(e.length-1),c.push(_.x,_.y);const k=d[3*B+0]*L,G=d[3*B+1],P=d[3*B+0]*z;p.push(k,G,P)}}for(let D=0;D<t;D++)for(let U=0;U<e.length-1;U++){const L=U+D*e.length,z=L,B=L+e.length,k=L+e.length+1,G=L+1;s.push(z,B,G),s.push(k,G,B)}this.setIndex(s),this.setAttribute("position",new zt(a,3)),this.setAttribute("uv",new zt(c,2)),this.setAttribute("normal",new zt(p,3))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Cx(e.points,e.segments,e.phiStart,e.phiLength)}}class Xg extends wc{constructor(e=1,t=0){const n=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],r=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(n,r,e,t),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Xg(e.radius,e.detail)}}class gu extends vn{constructor(e=1,t=1,n=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:r};const s=e/2,a=t/2,c=Math.floor(n),d=Math.floor(r),p=c+1,m=d+1,v=e/c,_=t/d,b=[],T=[],I=[],C=[];for(let A=0;A<m;A++){const D=A*_-a;for(let U=0;U<p;U++){const L=U*v-s;T.push(L,-D,0),I.push(0,0,1),C.push(U/c),C.push(1-A/d)}}for(let A=0;A<d;A++)for(let D=0;D<c;D++){const U=D+p*A,L=D+p*(A+1),z=D+1+p*(A+1),B=D+1+p*A;b.push(U,L,B),b.push(L,z,B)}this.setIndex(b),this.setAttribute("position",new zt(T,3)),this.setAttribute("normal",new zt(I,3)),this.setAttribute("uv",new zt(C,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new gu(e.width,e.height,e.widthSegments,e.heightSegments)}}class Rx extends vn{constructor(e=.5,t=1,n=32,r=1,s=0,a=Math.PI*2){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:n,phiSegments:r,thetaStart:s,thetaLength:a},n=Math.max(3,n),r=Math.max(1,r);const c=[],d=[],p=[],m=[];let v=e;const _=(t-e)/r,b=new Q,T=new $e;for(let I=0;I<=r;I++){for(let C=0;C<=n;C++){const A=s+C/n*a;b.x=v*Math.cos(A),b.y=v*Math.sin(A),d.push(b.x,b.y,b.z),p.push(0,0,1),T.x=(b.x/t+1)/2,T.y=(b.y/t+1)/2,m.push(T.x,T.y)}v+=_}for(let I=0;I<r;I++){const C=I*(n+1);for(let A=0;A<n;A++){const D=A+C,U=D,L=D+n+1,z=D+n+2,B=D+1;c.push(U,L,B),c.push(L,z,B)}}this.setIndex(c),this.setAttribute("position",new zt(d,3)),this.setAttribute("normal",new zt(p,3)),this.setAttribute("uv",new zt(m,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Rx(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class Ix extends vn{constructor(e=new Vf([new $e(0,.5),new $e(-.5,-.5),new $e(.5,-.5)]),t=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};const n=[],r=[],s=[],a=[];let c=0,d=0;if(Array.isArray(e)===!1)p(e);else for(let m=0;m<e.length;m++)p(e[m]),this.addGroup(c,d,m),c+=d,d=0;this.setIndex(n),this.setAttribute("position",new zt(r,3)),this.setAttribute("normal",new zt(s,3)),this.setAttribute("uv",new zt(a,2));function p(m){const v=r.length/3,_=m.extractPoints(t);let b=_.shape;const T=_.holes;Ra.isClockWise(b)===!1&&(b=b.reverse());for(let C=0,A=T.length;C<A;C++){const D=T[C];Ra.isClockWise(D)===!0&&(T[C]=D.reverse())}const I=Ra.triangulateShape(b,T);for(let C=0,A=T.length;C<A;C++){const D=T[C];b=b.concat(D)}for(let C=0,A=b.length;C<A;C++){const D=b[C];r.push(D.x,D.y,0),s.push(0,0,1),a.push(D.x,D.y)}for(let C=0,A=I.length;C<A;C++){const D=I[C],U=D[0]+v,L=D[1]+v,z=D[2]+v;n.push(U,L,z),d+=3}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),t=this.parameters.shapes;return FP(t,e)}static fromJSON(e,t){const n=[];for(let r=0,s=e.shapes.length;r<s;r++){const a=t[e.shapes[r]];n.push(a)}return new Ix(n,e.curveSegments)}}function FP(i,e){if(e.shapes=[],Array.isArray(i))for(let t=0,n=i.length;t<n;t++){const r=i[t];e.shapes.push(r.uuid)}else e.shapes.push(i.uuid);return e}class Yg extends vn{constructor(e=1,t=32,n=16,r=0,s=Math.PI*2,a=0,c=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:r,phiLength:s,thetaStart:a,thetaLength:c},t=Math.max(3,Math.floor(t)),n=Math.max(2,Math.floor(n));const d=Math.min(a+c,Math.PI);let p=0;const m=[],v=new Q,_=new Q,b=[],T=[],I=[],C=[];for(let A=0;A<=n;A++){const D=[],U=A/n;let L=0;A===0&&a===0?L=.5/t:A===n&&d===Math.PI&&(L=-.5/t);for(let z=0;z<=t;z++){const B=z/t;v.x=-e*Math.cos(r+B*s)*Math.sin(a+U*c),v.y=e*Math.cos(a+U*c),v.z=e*Math.sin(r+B*s)*Math.sin(a+U*c),T.push(v.x,v.y,v.z),_.copy(v).normalize(),I.push(_.x,_.y,_.z),C.push(B+L,1-U),D.push(p++)}m.push(D)}for(let A=0;A<n;A++)for(let D=0;D<t;D++){const U=m[A][D+1],L=m[A][D],z=m[A+1][D],B=m[A+1][D+1];(A!==0||a>0)&&b.push(U,L,B),(A!==n-1||d<Math.PI)&&b.push(L,z,B)}this.setIndex(b),this.setAttribute("position",new zt(T,3)),this.setAttribute("normal",new zt(I,3)),this.setAttribute("uv",new zt(C,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Yg(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class Nx extends wc{constructor(e=1,t=0){const n=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],r=[2,1,0,0,3,2,1,3,0,2,3,1];super(n,r,e,t),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new Nx(e.radius,e.detail)}}class Dx extends vn{constructor(e=1,t=.4,n=12,r=48,s=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:n,tubularSegments:r,arc:s},n=Math.floor(n),r=Math.floor(r);const a=[],c=[],d=[],p=[],m=new Q,v=new Q,_=new Q;for(let b=0;b<=n;b++)for(let T=0;T<=r;T++){const I=T/r*s,C=b/n*Math.PI*2;v.x=(e+t*Math.cos(C))*Math.cos(I),v.y=(e+t*Math.cos(C))*Math.sin(I),v.z=t*Math.sin(C),c.push(v.x,v.y,v.z),m.x=e*Math.cos(I),m.y=e*Math.sin(I),_.subVectors(v,m).normalize(),d.push(_.x,_.y,_.z),p.push(T/r),p.push(b/n)}for(let b=1;b<=n;b++)for(let T=1;T<=r;T++){const I=(r+1)*b+T-1,C=(r+1)*(b-1)+T-1,A=(r+1)*(b-1)+T,D=(r+1)*b+T;a.push(I,C,D),a.push(C,A,D)}this.setIndex(a),this.setAttribute("position",new zt(c,3)),this.setAttribute("normal",new zt(d,3)),this.setAttribute("uv",new zt(p,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Dx(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class Ux extends vn{constructor(e=1,t=.4,n=64,r=8,s=2,a=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:n,radialSegments:r,p:s,q:a},n=Math.floor(n),r=Math.floor(r);const c=[],d=[],p=[],m=[],v=new Q,_=new Q,b=new Q,T=new Q,I=new Q,C=new Q,A=new Q;for(let U=0;U<=n;++U){const L=U/n*s*Math.PI*2;D(L,s,a,e,b),D(L+.01,s,a,e,T),C.subVectors(T,b),A.addVectors(T,b),I.crossVectors(C,A),A.crossVectors(I,C),I.normalize(),A.normalize();for(let z=0;z<=r;++z){const B=z/r*Math.PI*2,k=-t*Math.cos(B),G=t*Math.sin(B);v.x=b.x+(k*A.x+G*I.x),v.y=b.y+(k*A.y+G*I.y),v.z=b.z+(k*A.z+G*I.z),d.push(v.x,v.y,v.z),_.subVectors(v,b).normalize(),p.push(_.x,_.y,_.z),m.push(U/n),m.push(z/r)}}for(let U=1;U<=n;U++)for(let L=1;L<=r;L++){const z=(r+1)*(U-1)+(L-1),B=(r+1)*U+(L-1),k=(r+1)*U+L,G=(r+1)*(U-1)+L;c.push(z,B,G),c.push(B,k,G)}this.setIndex(c),this.setAttribute("position",new zt(d,3)),this.setAttribute("normal",new zt(p,3)),this.setAttribute("uv",new zt(m,2));function D(U,L,z,B,k){const G=Math.cos(U),P=Math.sin(U),O=z/L*U,Z=Math.cos(O);k.x=B*(2+Z)*.5*G,k.y=B*(2+Z)*P*.5,k.z=B*Math.sin(O)*.5}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Ux(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class Px extends vn{constructor(e=new aE(new Q(-1,-1,0),new Q(-1,1,0),new Q(1,1,0)),t=64,n=1,r=8,s=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:n,radialSegments:r,closed:s};const a=e.computeFrenetFrames(t,s);this.tangents=a.tangents,this.normals=a.normals,this.binormals=a.binormals;const c=new Q,d=new Q,p=new $e;let m=new Q;const v=[],_=[],b=[],T=[];I(),this.setIndex(T),this.setAttribute("position",new zt(v,3)),this.setAttribute("normal",new zt(_,3)),this.setAttribute("uv",new zt(b,2));function I(){for(let U=0;U<t;U++)C(U);C(s===!1?t:0),D(),A()}function C(U){m=e.getPointAt(U/t,m);const L=a.normals[U],z=a.binormals[U];for(let B=0;B<=r;B++){const k=B/r*Math.PI*2,G=Math.sin(k),P=-Math.cos(k);d.x=P*L.x+G*z.x,d.y=P*L.y+G*z.y,d.z=P*L.z+G*z.z,d.normalize(),_.push(d.x,d.y,d.z),c.x=m.x+n*d.x,c.y=m.y+n*d.y,c.z=m.z+n*d.z,v.push(c.x,c.y,c.z)}}function A(){for(let U=1;U<=t;U++)for(let L=1;L<=r;L++){const z=(r+1)*(U-1)+(L-1),B=(r+1)*U+(L-1),k=(r+1)*U+L,G=(r+1)*(U-1)+L;T.push(z,B,G),T.push(B,k,G)}}function D(){for(let U=0;U<=t;U++)for(let L=0;L<=r;L++)p.x=U/t,p.y=L/r,b.push(p.x,p.y)}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new Px(new z_[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class uE extends vn{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},e!==null){const t=[],n=new Set,r=new Q,s=new Q;if(e.index!==null){const a=e.attributes.position,c=e.index;let d=e.groups;d.length===0&&(d=[{start:0,count:c.count,materialIndex:0}]);for(let p=0,m=d.length;p<m;++p){const v=d[p],_=v.start,b=v.count;for(let T=_,I=_+b;T<I;T+=3)for(let C=0;C<3;C++){const A=c.getX(T+C),D=c.getX(T+(C+1)%3);r.fromBufferAttribute(a,A),s.fromBufferAttribute(a,D),G1(r,s,n)===!0&&(t.push(r.x,r.y,r.z),t.push(s.x,s.y,s.z))}}}else{const a=e.attributes.position;for(let c=0,d=a.count/3;c<d;c++)for(let p=0;p<3;p++){const m=3*c+p,v=3*c+(p+1)%3;r.fromBufferAttribute(a,m),s.fromBufferAttribute(a,v),G1(r,s,n)===!0&&(t.push(r.x,r.y,r.z),t.push(s.x,s.y,s.z))}}this.setAttribute("position",new zt(t,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}function G1(i,e,t){const n=`${i.x},${i.y},${i.z}-${e.x},${e.y},${e.z}`,r=`${e.x},${e.y},${e.z}-${i.x},${i.y},${i.z}`;return t.has(n)===!0||t.has(r)===!0?!1:(t.add(n),t.add(r),!0)}var q1=Object.freeze({__proto__:null,BoxGeometry:$f,CapsuleGeometry:Mx,CircleGeometry:Ex,ConeGeometry:qg,CylinderGeometry:Gg,DodecahedronGeometry:Tx,EdgesGeometry:VR,ExtrudeGeometry:wx,IcosahedronGeometry:Wg,LatheGeometry:Cx,OctahedronGeometry:Xg,PlaneGeometry:gu,PolyhedronGeometry:wc,RingGeometry:Rx,ShapeGeometry:Ix,SphereGeometry:Yg,TetrahedronGeometry:Nx,TorusGeometry:Dx,TorusKnotGeometry:Ux,TubeGeometry:Px,WireframeGeometry:uE});class KR extends vs{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new Pt(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class cE extends Ar{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class fE extends vs{constructor(e){super(),this.isMeshStandardMaterial=!0,this.type="MeshStandardMaterial",this.defines={STANDARD:""},this.color=new Pt(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Pt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Ac,this.normalScale=new $e(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Eo,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class QR extends fE{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new $e(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return on(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new Pt(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new Pt(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new Pt(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get dispersion(){return this._dispersion}set dispersion(e){this._dispersion>0!=e>0&&this.version++,this._dispersion=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.dispersion=e.dispersion,this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class jR extends vs{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new Pt(16777215),this.specular=new Pt(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Pt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Ac,this.normalScale=new $e(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Eo,this.combine=kg,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class eI extends vs{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Pt(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Pt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Ac,this.normalScale=new $e(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class tI extends vs{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Ac,this.normalScale=new $e(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class nI extends vs{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new Pt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Pt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Ac,this.normalScale=new $e(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new Eo,this.combine=kg,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Lx extends vs{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=gR,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class dE extends vs{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}class iI extends vs{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Pt(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Ac,this.normalScale=new $e(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this.fog=e.fog,this}}class rI extends Fs{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}function kf(i,e){return!i||i.constructor===e?i:typeof e.BYTES_PER_ELEMENT=="number"?new e(i):Array.prototype.slice.call(i)}function sI(i){function e(r,s){return i[r]-i[s]}const t=i.length,n=new Array(t);for(let r=0;r!==t;++r)n[r]=r;return n.sort(e),n}function sM(i,e,t){const n=i.length,r=new i.constructor(n);for(let s=0,a=0;a!==n;++s){const c=t[s]*e;for(let d=0;d!==e;++d)r[a++]=i[c+d]}return r}function hE(i,e,t,n){let r=1,s=i[0];for(;s!==void 0&&s[n]===void 0;)s=i[r++];if(s===void 0)return;let a=s[n];if(a!==void 0)if(Array.isArray(a))do a=s[n],a!==void 0&&(e.push(s.time),t.push(...a)),s=i[r++];while(s!==void 0);else if(a.toArray!==void 0)do a=s[n],a!==void 0&&(e.push(s.time),a.toArray(t,t.length)),s=i[r++];while(s!==void 0);else do a=s[n],a!==void 0&&(e.push(s.time),t.push(a)),s=i[r++];while(s!==void 0)}function kP(i,e,t,n,r=30){const s=i.clone();s.name=e;const a=[];for(let d=0;d<s.tracks.length;++d){const p=s.tracks[d],m=p.getValueSize(),v=[],_=[];for(let b=0;b<p.times.length;++b){const T=p.times[b]*r;if(!(T<t||T>=n)){v.push(p.times[b]);for(let I=0;I<m;++I)_.push(p.values[b*m+I])}}v.length!==0&&(p.times=kf(v,p.times.constructor),p.values=kf(_,p.values.constructor),a.push(p))}s.tracks=a;let c=1/0;for(let d=0;d<s.tracks.length;++d)c>s.tracks[d].times[0]&&(c=s.tracks[d].times[0]);for(let d=0;d<s.tracks.length;++d)s.tracks[d].shift(-1*c);return s.resetDuration(),s}function OP(i,e=0,t=i,n=30){n<=0&&(n=30);const r=t.tracks.length,s=e/n;for(let a=0;a<r;++a){const c=t.tracks[a],d=c.ValueTypeName;if(d==="bool"||d==="string")continue;const p=i.tracks.find(function(A){return A.name===c.name&&A.ValueTypeName===d});if(p===void 0)continue;let m=0;const v=c.getValueSize();c.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(m=v/3);let _=0;const b=p.getValueSize();p.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(_=b/3);const T=c.times.length-1;let I;if(s<=c.times[0]){const A=m,D=v-m;I=c.values.slice(A,D)}else if(s>=c.times[T]){const A=T*v+m,D=A+v-m;I=c.values.slice(A,D)}else{const A=c.createInterpolant(),D=m,U=v-m;A.evaluate(s),I=A.resultBuffer.slice(D,U)}d==="quaternion"&&new ao().fromArray(I).normalize().conjugate().toArray(I);const C=p.times.length;for(let A=0;A<C;++A){const D=A*b+_;if(d==="quaternion")ao.multiplyQuaternionsFlat(p.values,D,I,0,p.values,D);else{const U=b-_*2;for(let L=0;L<U;++L)p.values[D+L]-=I[L]}}}return i.blendMode=JM,i}class zP{static convertArray(e,t){return kf(e,t)}static isTypedArray(e){return TR(e)}static getKeyframeOrder(e){return sI(e)}static sortedArray(e,t,n){return sM(e,t,n)}static flattenJSON(e,t,n,r){hE(e,t,n,r)}static subclip(e,t,n,r,s=30){return kP(e,t,n,r,s)}static makeClipAdditive(e,t=0,n=e,r=30){return OP(e,t,n,r)}}class Jg{constructor(e,t,n,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=r!==void 0?r:new t.constructor(n),this.sampleValues=t,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let n=this._cachedIndex,r=t[n],s=t[n-1];e:{t:{let a;n:{i:if(!(e<r)){for(let c=n+2;;){if(r===void 0){if(e<s)break i;return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}if(n===c)break;if(s=r,r=t[++n],e<r)break t}a=t.length;break n}if(!(e>=s)){const c=t[1];e<c&&(n=2,s=c);for(let d=n-2;;){if(s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(n===d)break;if(r=s,s=t[--n-1],e>=s)break t}a=n,n=0;break n}break e}for(;n<a;){const c=n+a>>>1;e<t[c]?a=c:n=c+1}if(r=t[n],s=t[n-1],s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(r===void 0)return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}this._cachedIndex=n,this.intervalChanged_(n,s,r)}return this.interpolate_(n,s,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,s=e*r;for(let a=0;a!==r;++a)t[a]=n[s+a];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class oI extends Jg{constructor(e,t,n,r){super(e,t,n,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:Pf,endingEnd:Pf}}intervalChanged_(e,t,n){const r=this.parameterPositions;let s=e-2,a=e+1,c=r[s],d=r[a];if(c===void 0)switch(this.getSettings_().endingStart){case Lf:s=e,c=2*t-n;break;case Sg:s=r.length-2,c=t+r[s]-r[s+1];break;default:s=e,c=n}if(d===void 0)switch(this.getSettings_().endingEnd){case Lf:a=e,d=2*n-t;break;case Sg:a=1,d=n+r[1]-r[0];break;default:a=e-1,d=t}const p=(n-t)*.5,m=this.valueSize;this._weightPrev=p/(t-c),this._weightNext=p/(d-n),this._offsetPrev=s*m,this._offsetNext=a*m}interpolate_(e,t,n,r){const s=this.resultBuffer,a=this.sampleValues,c=this.valueSize,d=e*c,p=d-c,m=this._offsetPrev,v=this._offsetNext,_=this._weightPrev,b=this._weightNext,T=(n-t)/(r-t),I=T*T,C=I*T,A=-_*C+2*_*I-_*T,D=(1+_)*C+(-1.5-2*_)*I+(-.5+_)*T+1,U=(-1-b)*C+(1.5+b)*I+.5*T,L=b*C-b*I;for(let z=0;z!==c;++z)s[z]=A*a[m+z]+D*a[p+z]+U*a[d+z]+L*a[v+z];return s}}class pE extends Jg{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e,t,n,r){const s=this.resultBuffer,a=this.sampleValues,c=this.valueSize,d=e*c,p=d-c,m=(n-t)/(r-t),v=1-m;for(let _=0;_!==c;++_)s[_]=a[p+_]*v+a[d+_]*m;return s}}class aI extends Jg{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e){return this.copySampleValue_(e-1)}}class sa{constructor(e,t,n,r){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=kf(t,this.TimeBufferType),this.values=kf(n,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let n;if(t.toJSON!==this.toJSON)n=t.toJSON(e);else{n={name:e.name,times:kf(e.times,Array),values:kf(e.values,Array)};const r=e.getInterpolation();r!==e.DefaultInterpolation&&(n.interpolation=r)}return n.type=e.ValueTypeName,n}InterpolantFactoryMethodDiscrete(e){return new aI(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new pE(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new oI(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case xg:t=this.InterpolantFactoryMethodDiscrete;break;case F_:t=this.InterpolantFactoryMethodLinear;break;case Gy:t=this.InterpolantFactoryMethodSmooth;break}if(t===void 0){const n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(n);return It("KeyframeTrack:",n),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return xg;case this.InterpolantFactoryMethodLinear:return F_;case this.InterpolantFactoryMethodSmooth:return Gy}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){const t=this.times;for(let n=0,r=t.length;n!==r;++n)t[n]+=e}return this}scale(e){if(e!==1){const t=this.times;for(let n=0,r=t.length;n!==r;++n)t[n]*=e}return this}trim(e,t){const n=this.times,r=n.length;let s=0,a=r-1;for(;s!==r&&n[s]<e;)++s;for(;a!==-1&&n[a]>t;)--a;if(++a,s!==0||a!==r){s>=a&&(a=Math.max(a,1),s=a-1);const c=this.getValueSize();this.times=n.slice(s,a),this.values=this.values.slice(s*c,a*c)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!==0&&(Jt("KeyframeTrack: Invalid value size in track.",this),e=!1);const n=this.times,r=this.values,s=n.length;s===0&&(Jt("KeyframeTrack: Track is empty.",this),e=!1);let a=null;for(let c=0;c!==s;c++){const d=n[c];if(typeof d=="number"&&isNaN(d)){Jt("KeyframeTrack: Time is not a valid number.",this,c,d),e=!1;break}if(a!==null&&a>d){Jt("KeyframeTrack: Out of order keys.",this,c,d,a),e=!1;break}a=d}if(r!==void 0&&TR(r))for(let c=0,d=r.length;c!==d;++c){const p=r[c];if(isNaN(p)){Jt("KeyframeTrack: Value is not a valid number.",this,c,p),e=!1;break}}return e}optimize(){const e=this.times.slice(),t=this.values.slice(),n=this.getValueSize(),r=this.getInterpolation()===Gy,s=e.length-1;let a=1;for(let c=1;c<s;++c){let d=!1;const p=e[c],m=e[c+1];if(p!==m&&(c!==1||p!==e[0]))if(r)d=!0;else{const v=c*n,_=v-n,b=v+n;for(let T=0;T!==n;++T){const I=t[v+T];if(I!==t[_+T]||I!==t[b+T]){d=!0;break}}}if(d){if(c!==a){e[a]=e[c];const v=c*n,_=a*n;for(let b=0;b!==n;++b)t[_+b]=t[v+b]}++a}}if(s>0){e[a]=e[s];for(let c=s*n,d=a*n,p=0;p!==n;++p)t[d+p]=t[c+p];++a}return a!==e.length?(this.times=e.slice(0,a),this.values=t.slice(0,a*n)):(this.times=e,this.values=t),this}clone(){const e=this.times.slice(),t=this.values.slice(),n=this.constructor,r=new n(this.name,e,t);return r.createInterpolant=this.createInterpolant,r}}sa.prototype.ValueTypeName="";sa.prototype.TimeBufferType=Float32Array;sa.prototype.ValueBufferType=Float32Array;sa.prototype.DefaultInterpolation=F_;class Kf extends sa{constructor(e,t,n){super(e,t,n)}}Kf.prototype.ValueTypeName="bool";Kf.prototype.ValueBufferType=Array;Kf.prototype.DefaultInterpolation=xg;Kf.prototype.InterpolantFactoryMethodLinear=void 0;Kf.prototype.InterpolantFactoryMethodSmooth=void 0;class mE extends sa{constructor(e,t,n,r){super(e,t,n,r)}}mE.prototype.ValueTypeName="color";class Ig extends sa{constructor(e,t,n,r){super(e,t,n,r)}}Ig.prototype.ValueTypeName="number";class lI extends Jg{constructor(e,t,n,r){super(e,t,n,r)}interpolate_(e,t,n,r){const s=this.resultBuffer,a=this.sampleValues,c=this.valueSize,d=(n-t)/(r-t);let p=e*c;for(let m=p+c;p!==m;p+=4)ao.slerpFlat(s,0,a,p-c,a,p,d);return s}}class Zg extends sa{constructor(e,t,n,r){super(e,t,n,r)}InterpolantFactoryMethodLinear(e){return new lI(this.times,this.values,this.getValueSize(),e)}}Zg.prototype.ValueTypeName="quaternion";Zg.prototype.InterpolantFactoryMethodSmooth=void 0;class Qf extends sa{constructor(e,t,n){super(e,t,n)}}Qf.prototype.ValueTypeName="string";Qf.prototype.ValueBufferType=Array;Qf.prototype.DefaultInterpolation=xg;Qf.prototype.InterpolantFactoryMethodLinear=void 0;Qf.prototype.InterpolantFactoryMethodSmooth=void 0;class Ng extends sa{constructor(e,t,n,r){super(e,t,n,r)}}Ng.prototype.ValueTypeName="vector";class Dg{constructor(e="",t=-1,n=[],r=cx){this.name=e,this.tracks=n,this.duration=t,this.blendMode=r,this.uuid=xo(),this.userData={},this.duration<0&&this.resetDuration()}static parse(e){const t=[],n=e.tracks,r=1/(e.fps||1);for(let a=0,c=n.length;a!==c;++a)t.push(VP(n[a]).scale(r));const s=new this(e.name,e.duration,t,e.blendMode);return s.uuid=e.uuid,s.userData=JSON.parse(e.userData||"{}"),s}static toJSON(e){const t=[],n=e.tracks,r={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode,userData:JSON.stringify(e.userData)};for(let s=0,a=n.length;s!==a;++s)t.push(sa.toJSON(n[s]));return r}static CreateFromMorphTargetSequence(e,t,n,r){const s=t.length,a=[];for(let c=0;c<s;c++){let d=[],p=[];d.push((c+s-1)%s,c,(c+1)%s),p.push(0,1,0);const m=sI(d);d=sM(d,1,m),p=sM(p,1,m),!r&&d[0]===0&&(d.push(s),p.push(p[0])),a.push(new Ig(".morphTargetInfluences["+t[c].name+"]",d,p).scale(1/n))}return new this(e,-1,a)}static findByName(e,t){let n=e;if(!Array.isArray(e)){const r=e;n=r.geometry&&r.geometry.animations||r.animations}for(let r=0;r<n.length;r++)if(n[r].name===t)return n[r];return null}static CreateClipsFromMorphTargetSequences(e,t,n){const r={},s=/^([\w-]*?)([\d]+)$/;for(let c=0,d=e.length;c<d;c++){const p=e[c],m=p.name.match(s);if(m&&m.length>1){const v=m[1];let _=r[v];_||(r[v]=_=[]),_.push(p)}}const a=[];for(const c in r)a.push(this.CreateFromMorphTargetSequence(c,r[c],t,n));return a}static parseAnimation(e,t){if(It("AnimationClip: parseAnimation() is deprecated and will be removed with r185"),!e)return Jt("AnimationClip: No animation in JSONLoader data."),null;const n=function(v,_,b,T,I){if(b.length!==0){const C=[],A=[];hE(b,C,A,T),C.length!==0&&I.push(new v(_,C,A))}},r=[],s=e.name||"default",a=e.fps||30,c=e.blendMode;let d=e.length||-1;const p=e.hierarchy||[];for(let v=0;v<p.length;v++){const _=p[v].keys;if(!(!_||_.length===0))if(_[0].morphTargets){const b={};let T;for(T=0;T<_.length;T++)if(_[T].morphTargets)for(let I=0;I<_[T].morphTargets.length;I++)b[_[T].morphTargets[I]]=-1;for(const I in b){const C=[],A=[];for(let D=0;D!==_[T].morphTargets.length;++D){const U=_[T];C.push(U.time),A.push(U.morphTarget===I?1:0)}r.push(new Ig(".morphTargetInfluence["+I+"]",C,A))}d=b.length*a}else{const b=".bones["+t[v].name+"]";n(Ng,b+".position",_,"pos",r),n(Zg,b+".quaternion",_,"rot",r),n(Ng,b+".scale",_,"scl",r)}}return r.length===0?null:new this(s,d,r,c)}resetDuration(){const e=this.tracks;let t=0;for(let n=0,r=e.length;n!==r;++n){const s=this.tracks[n];t=Math.max(t,s.times[s.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let n=0;n<this.tracks.length;n++)e.push(this.tracks[n].clone());const t=new this.constructor(this.name,this.duration,e,this.blendMode);return t.userData=JSON.parse(JSON.stringify(this.userData)),t}toJSON(){return this.constructor.toJSON(this)}}function BP(i){switch(i.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Ig;case"vector":case"vector2":case"vector3":case"vector4":return Ng;case"color":return mE;case"quaternion":return Zg;case"bool":case"boolean":return Kf;case"string":return Qf}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+i)}function VP(i){if(i.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=BP(i.type);if(i.times===void 0){const t=[],n=[];hE(i.keys,t,n,"value"),i.times=t,i.values=n}return e.parse!==void 0?e.parse(i):new e(i.name,i.times,i.values,i.interpolation)}const xl={enabled:!1,files:{},add:function(i,e){this.enabled!==!1&&(this.files[i]=e)},get:function(i){if(this.enabled!==!1)return this.files[i]},remove:function(i){delete this.files[i]},clear:function(){this.files={}}};class Fx{constructor(e,t,n){const r=this;let s=!1,a=0,c=0,d;const p=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this._abortController=null,this.itemStart=function(m){c++,s===!1&&r.onStart!==void 0&&r.onStart(m,a,c),s=!0},this.itemEnd=function(m){a++,r.onProgress!==void 0&&r.onProgress(m,a,c),a===c&&(s=!1,r.onLoad!==void 0&&r.onLoad())},this.itemError=function(m){r.onError!==void 0&&r.onError(m)},this.resolveURL=function(m){return d?d(m):m},this.setURLModifier=function(m){return d=m,this},this.addHandler=function(m,v){return p.push(m,v),this},this.removeHandler=function(m){const v=p.indexOf(m);return v!==-1&&p.splice(v,2),this},this.getHandler=function(m){for(let v=0,_=p.length;v<_;v+=2){const b=p[v],T=p[v+1];if(b.global&&(b.lastIndex=0),b.test(m))return T}return null},this.abort=function(){return this.abortController.abort(),this._abortController=null,this}}get abortController(){return this._abortController||(this._abortController=new AbortController),this._abortController}}const uI=new Fx;class ks{constructor(e){this.manager=e!==void 0?e:uI,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const n=this;return new Promise(function(r,s){n.load(e,r,t,s)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}abort(){return this}}ks.DEFAULT_MATERIAL_NAME="__DEFAULT";const lu={};class HP extends Error{constructor(e,t){super(e),this.response=t}}class So extends ks{constructor(e){super(e),this.mimeType="",this.responseType="",this._abortController=new AbortController}load(e,t,n,r){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=xl.get(`file:${e}`);if(s!==void 0)return this.manager.itemStart(e),setTimeout(()=>{t&&t(s),this.manager.itemEnd(e)},0),s;if(lu[e]!==void 0){lu[e].push({onLoad:t,onProgress:n,onError:r});return}lu[e]=[],lu[e].push({onLoad:t,onProgress:n,onError:r});const a=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin",signal:typeof AbortSignal.any=="function"?AbortSignal.any([this._abortController.signal,this.manager.abortController.signal]):this._abortController.signal}),c=this.mimeType,d=this.responseType;fetch(a).then(p=>{if(p.status===200||p.status===0){if(p.status===0&&It("FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||p.body===void 0||p.body.getReader===void 0)return p;const m=lu[e],v=p.body.getReader(),_=p.headers.get("X-File-Size")||p.headers.get("Content-Length"),b=_?parseInt(_):0,T=b!==0;let I=0;const C=new ReadableStream({start(A){D();function D(){v.read().then(({done:U,value:L})=>{if(U)A.close();else{I+=L.byteLength;const z=new ProgressEvent("progress",{lengthComputable:T,loaded:I,total:b});for(let B=0,k=m.length;B<k;B++){const G=m[B];G.onProgress&&G.onProgress(z)}A.enqueue(L),D()}},U=>{A.error(U)})}}});return new Response(C)}else throw new HP(`fetch for "${p.url}" responded with ${p.status}: ${p.statusText}`,p)}).then(p=>{switch(d){case"arraybuffer":return p.arrayBuffer();case"blob":return p.blob();case"document":return p.text().then(m=>new DOMParser().parseFromString(m,c));case"json":return p.json();default:if(c==="")return p.text();{const v=/charset="?([^;"\s]*)"?/i.exec(c),_=v&&v[1]?v[1].toLowerCase():void 0,b=new TextDecoder(_);return p.arrayBuffer().then(T=>b.decode(T))}}}).then(p=>{xl.add(`file:${e}`,p);const m=lu[e];delete lu[e];for(let v=0,_=m.length;v<_;v++){const b=m[v];b.onLoad&&b.onLoad(p)}}).catch(p=>{const m=lu[e];if(m===void 0)throw this.manager.itemError(e),p;delete lu[e];for(let v=0,_=m.length;v<_;v++){const b=m[v];b.onError&&b.onError(p)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}abort(){return this._abortController.abort(),this._abortController=new AbortController,this}}class GP extends ks{constructor(e){super(e)}load(e,t,n,r){const s=this,a=new So(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(c){try{t(s.parse(JSON.parse(c)))}catch(d){r?r(d):Jt(d),s.manager.itemError(e)}},n,r)}parse(e){const t=[];for(let n=0;n<e.length;n++){const r=Dg.parse(e[n]);t.push(r)}return t}}class qP extends ks{constructor(e){super(e)}load(e,t,n,r){const s=this,a=[],c=new bx,d=new So(this.manager);d.setPath(this.path),d.setResponseType("arraybuffer"),d.setRequestHeader(this.requestHeader),d.setWithCredentials(s.withCredentials);let p=0;function m(v){d.load(e[v],function(_){const b=s.parse(_,!0);a[v]={width:b.width,height:b.height,format:b.format,mipmaps:b.mipmaps},p+=1,p===6&&(b.mipmapCount===1&&(c.minFilter=Bn),c.image=a,c.format=b.format,c.needsUpdate=!0,t&&t(c))},n,r)}if(Array.isArray(e))for(let v=0,_=e.length;v<_;++v)m(v);else d.load(e,function(v){const _=s.parse(v,!0);if(_.isCubemap){const b=_.mipmaps.length/_.mipmapCount;for(let T=0;T<b;T++){a[T]={mipmaps:[]};for(let I=0;I<_.mipmapCount;I++)a[T].mipmaps.push(_.mipmaps[T*_.mipmapCount+I]),a[T].format=_.format,a[T].width=_.width,a[T].height=_.height}c.image=a}else c.image.width=_.width,c.image.height=_.height,c.mipmaps=_.mipmaps;_.mipmapCount===1&&(c.minFilter=Bn),c.format=_.format,c.needsUpdate=!0,t&&t(c)},n,r);return c}}const Th=new WeakMap;class Ug extends ks{constructor(e){super(e)}load(e,t,n,r){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,a=xl.get(`image:${e}`);if(a!==void 0){if(a.complete===!0)s.manager.itemStart(e),setTimeout(function(){t&&t(a),s.manager.itemEnd(e)},0);else{let v=Th.get(a);v===void 0&&(v=[],Th.set(a,v)),v.push({onLoad:t,onError:r})}return a}const c=Eg("img");function d(){m(),t&&t(this);const v=Th.get(this)||[];for(let _=0;_<v.length;_++){const b=v[_];b.onLoad&&b.onLoad(this)}Th.delete(this),s.manager.itemEnd(e)}function p(v){m(),r&&r(v),xl.remove(`image:${e}`);const _=Th.get(this)||[];for(let b=0;b<_.length;b++){const T=_[b];T.onError&&T.onError(v)}Th.delete(this),s.manager.itemError(e),s.manager.itemEnd(e)}function m(){c.removeEventListener("load",d,!1),c.removeEventListener("error",p,!1)}return c.addEventListener("load",d,!1),c.addEventListener("error",p,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(c.crossOrigin=this.crossOrigin),xl.add(`image:${e}`,c),s.manager.itemStart(e),c.src=e,c}}class cI extends ks{constructor(e){super(e)}load(e,t,n,r){const s=new Vg;s.colorSpace=es;const a=new Ug(this.manager);a.setCrossOrigin(this.crossOrigin),a.setPath(this.path);let c=0;function d(p){a.load(e[p],function(m){s.images[p]=m,c++,c===6&&(s.needsUpdate=!0,t&&t(s))},void 0,r)}for(let p=0;p<e.length;++p)d(p);return s}}class gE extends ks{constructor(e){super(e)}load(e,t,n,r){const s=this,a=new na,c=new So(this.manager);return c.setResponseType("arraybuffer"),c.setRequestHeader(this.requestHeader),c.setPath(this.path),c.setWithCredentials(s.withCredentials),c.load(e,function(d){let p;try{p=s.parse(d)}catch(m){if(r!==void 0)r(m);else{m(m);return}}p.image!==void 0?a.image=p.image:p.data!==void 0&&(a.image.width=p.width,a.image.height=p.height,a.image.data=p.data),a.wrapS=p.wrapS!==void 0?p.wrapS:Qi,a.wrapT=p.wrapT!==void 0?p.wrapT:Qi,a.magFilter=p.magFilter!==void 0?p.magFilter:Bn,a.minFilter=p.minFilter!==void 0?p.minFilter:Bn,a.anisotropy=p.anisotropy!==void 0?p.anisotropy:1,p.colorSpace!==void 0&&(a.colorSpace=p.colorSpace),p.flipY!==void 0&&(a.flipY=p.flipY),p.format!==void 0&&(a.format=p.format),p.type!==void 0&&(a.type=p.type),p.mipmaps!==void 0&&(a.mipmaps=p.mipmaps,a.minFilter=_l),p.mipmapCount===1&&(a.minFilter=Bn),p.generateMipmaps!==void 0&&(a.generateMipmaps=p.generateMipmaps),a.needsUpdate=!0,t&&t(a,p)},n,r),a}}class WP extends ks{constructor(e){super(e)}load(e,t,n,r){const s=new hi,a=new Ug(this.manager);return a.setCrossOrigin(this.crossOrigin),a.setPath(this.path),a.load(e,function(c){s.image=c,s.needsUpdate=!0,t!==void 0&&t(s)},n,r),s}}class Cc extends Kn{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new Pt(e),this.intensity=t}dispose(){this.dispatchEvent({type:"dispose"})}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,t}}class fI extends Cc{constructor(e,t,n){super(e,n),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(Kn.DEFAULT_UP),this.updateMatrix(),this.groundColor=new Pt(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}toJSON(e){const t=super.toJSON(e);return t.object.groundColor=this.groundColor.getHex(),t}}const mb=new an,W1=new Q,X1=new Q;class vE{constructor(e){this.camera=e,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new $e(512,512),this.mapType=kr,this.map=null,this.mapPass=null,this.matrix=new an,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new rp,this._frameExtents=new $e(1,1),this._viewportCount=1,this._viewports=[new $n(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,n=this.matrix;W1.setFromMatrixPosition(e.matrixWorld),t.position.copy(W1),X1.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(X1),t.updateMatrixWorld(),mb.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(mb,t.coordinateSystem,t.reversedDepth),t.reversedDepth?n.set(.5,0,0,.5,0,.5,0,.5,0,0,1,0,0,0,0,1):n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(mb)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.intensity=e.intensity,this.bias=e.bias,this.radius=e.radius,this.autoUpdate=e.autoUpdate,this.needsUpdate=e.needsUpdate,this.normalBias=e.normalBias,this.blurSamples=e.blurSamples,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.intensity!==1&&(e.intensity=this.intensity),this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class XP extends vE{constructor(){super(new Fr(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1,this.aspect=1}updateMatrices(e){const t=this.camera,n=Jh*2*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height*this.aspect,s=e.distance||t.far;(n!==t.fov||r!==t.aspect||s!==t.far)&&(t.fov=n,t.aspect=r,t.far=s,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class dI extends Cc{constructor(e,t,n=0,r=Math.PI/3,s=0,a=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Kn.DEFAULT_UP),this.updateMatrix(),this.target=new Kn,this.distance=n,this.angle=r,this.penumbra=s,this.decay=a,this.map=null,this.shadow=new XP}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){super.dispose(),this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.map=e.map,this.shadow=e.shadow.clone(),this}toJSON(e){const t=super.toJSON(e);return t.object.distance=this.distance,t.object.angle=this.angle,t.object.decay=this.decay,t.object.penumbra=this.penumbra,t.object.target=this.target.uuid,this.map&&this.map.isTexture&&(t.object.map=this.map.toJSON(e).uuid),t.object.shadow=this.shadow.toJSON(),t}}class YP extends vE{constructor(){super(new Fr(90,1,.5,500)),this.isPointLightShadow=!0}}class hI extends Cc{constructor(e,t,n=0,r=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=n,this.decay=r,this.shadow=new YP}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){super.dispose(),this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}toJSON(e){const t=super.toJSON(e);return t.object.distance=this.distance,t.object.decay=this.decay,t.object.shadow=this.shadow.toJSON(),t}}class jf extends mx{constructor(e=-1,t=1,n=1,r=-1,s=.1,a=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=n,this.bottom=r,this.near=s,this.far=a,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,n,r,s,a){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=s,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let s=n-e,a=n+e,c=r+t,d=r-t;if(this.view!==null&&this.view.enabled){const p=(this.right-this.left)/this.view.fullWidth/this.zoom,m=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=p*this.view.offsetX,a=s+p*this.view.width,c-=m*this.view.offsetY,d=c-m*this.view.height}this.projectionMatrix.makeOrthographic(s,a,c,d,this.near,this.far,this.coordinateSystem,this.reversedDepth),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}}class JP extends vE{constructor(){super(new jf(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class pI extends Cc{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Kn.DEFAULT_UP),this.updateMatrix(),this.target=new Kn,this.shadow=new JP}dispose(){super.dispose(),this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}toJSON(e){const t=super.toJSON(e);return t.object.shadow=this.shadow.toJSON(),t.object.target=this.target.uuid,t}}class mI extends Cc{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class gI extends Cc{constructor(e,t,n=10,r=10){super(e,t),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=n,this.height=r}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}}class yE{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new Q)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){const n=e.x,r=e.y,s=e.z,a=this.coefficients;return t.copy(a[0]).multiplyScalar(.282095),t.addScaledVector(a[1],.488603*r),t.addScaledVector(a[2],.488603*s),t.addScaledVector(a[3],.488603*n),t.addScaledVector(a[4],1.092548*(n*r)),t.addScaledVector(a[5],1.092548*(r*s)),t.addScaledVector(a[6],.315392*(3*s*s-1)),t.addScaledVector(a[7],1.092548*(n*s)),t.addScaledVector(a[8],.546274*(n*n-r*r)),t}getIrradianceAt(e,t){const n=e.x,r=e.y,s=e.z,a=this.coefficients;return t.copy(a[0]).multiplyScalar(.886227),t.addScaledVector(a[1],2*.511664*r),t.addScaledVector(a[2],2*.511664*s),t.addScaledVector(a[3],2*.511664*n),t.addScaledVector(a[4],2*.429043*n*r),t.addScaledVector(a[5],2*.429043*r*s),t.addScaledVector(a[6],.743125*s*s-.247708),t.addScaledVector(a[7],2*.429043*n*s),t.addScaledVector(a[8],.429043*(n*n-r*r)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let n=0;n<9;n++)this.coefficients[n].addScaledVector(e.coefficients[n],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let n=0;n<9;n++)this.coefficients[n].lerp(e.coefficients[n],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,t=0){const n=this.coefficients;for(let r=0;r<9;r++)n[r].fromArray(e,t+r*3);return this}toArray(e=[],t=0){const n=this.coefficients;for(let r=0;r<9;r++)n[r].toArray(e,t+r*3);return e}static getBasisAt(e,t){const n=e.x,r=e.y,s=e.z;t[0]=.282095,t[1]=.488603*r,t[2]=.488603*s,t[3]=.488603*n,t[4]=1.092548*n*r,t[5]=1.092548*r*s,t[6]=.315392*(3*s*s-1),t[7]=1.092548*n*s,t[8]=.546274*(n*n-r*r)}}class vI extends Cc{constructor(e=new yE,t=1){super(void 0,t),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}toJSON(e){const t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}}class kx extends ks{constructor(e){super(e),this.textures={}}load(e,t,n,r){const s=this,a=new So(s.manager);a.setPath(s.path),a.setRequestHeader(s.requestHeader),a.setWithCredentials(s.withCredentials),a.load(e,function(c){try{t(s.parse(JSON.parse(c)))}catch(d){r?r(d):Jt(d),s.manager.itemError(e)}},n,r)}parse(e){const t=this.textures;function n(s){return t[s]===void 0&&It("MaterialLoader: Undefined texture",s),t[s]}const r=this.createMaterialFromType(e.type);if(e.uuid!==void 0&&(r.uuid=e.uuid),e.name!==void 0&&(r.name=e.name),e.color!==void 0&&r.color!==void 0&&r.color.setHex(e.color),e.roughness!==void 0&&(r.roughness=e.roughness),e.metalness!==void 0&&(r.metalness=e.metalness),e.sheen!==void 0&&(r.sheen=e.sheen),e.sheenColor!==void 0&&(r.sheenColor=new Pt().setHex(e.sheenColor)),e.sheenRoughness!==void 0&&(r.sheenRoughness=e.sheenRoughness),e.emissive!==void 0&&r.emissive!==void 0&&r.emissive.setHex(e.emissive),e.specular!==void 0&&r.specular!==void 0&&r.specular.setHex(e.specular),e.specularIntensity!==void 0&&(r.specularIntensity=e.specularIntensity),e.specularColor!==void 0&&r.specularColor!==void 0&&r.specularColor.setHex(e.specularColor),e.shininess!==void 0&&(r.shininess=e.shininess),e.clearcoat!==void 0&&(r.clearcoat=e.clearcoat),e.clearcoatRoughness!==void 0&&(r.clearcoatRoughness=e.clearcoatRoughness),e.dispersion!==void 0&&(r.dispersion=e.dispersion),e.iridescence!==void 0&&(r.iridescence=e.iridescence),e.iridescenceIOR!==void 0&&(r.iridescenceIOR=e.iridescenceIOR),e.iridescenceThicknessRange!==void 0&&(r.iridescenceThicknessRange=e.iridescenceThicknessRange),e.transmission!==void 0&&(r.transmission=e.transmission),e.thickness!==void 0&&(r.thickness=e.thickness),e.attenuationDistance!==void 0&&(r.attenuationDistance=e.attenuationDistance),e.attenuationColor!==void 0&&r.attenuationColor!==void 0&&r.attenuationColor.setHex(e.attenuationColor),e.anisotropy!==void 0&&(r.anisotropy=e.anisotropy),e.anisotropyRotation!==void 0&&(r.anisotropyRotation=e.anisotropyRotation),e.fog!==void 0&&(r.fog=e.fog),e.flatShading!==void 0&&(r.flatShading=e.flatShading),e.blending!==void 0&&(r.blending=e.blending),e.combine!==void 0&&(r.combine=e.combine),e.side!==void 0&&(r.side=e.side),e.shadowSide!==void 0&&(r.shadowSide=e.shadowSide),e.opacity!==void 0&&(r.opacity=e.opacity),e.transparent!==void 0&&(r.transparent=e.transparent),e.alphaTest!==void 0&&(r.alphaTest=e.alphaTest),e.alphaHash!==void 0&&(r.alphaHash=e.alphaHash),e.depthFunc!==void 0&&(r.depthFunc=e.depthFunc),e.depthTest!==void 0&&(r.depthTest=e.depthTest),e.depthWrite!==void 0&&(r.depthWrite=e.depthWrite),e.colorWrite!==void 0&&(r.colorWrite=e.colorWrite),e.blendSrc!==void 0&&(r.blendSrc=e.blendSrc),e.blendDst!==void 0&&(r.blendDst=e.blendDst),e.blendEquation!==void 0&&(r.blendEquation=e.blendEquation),e.blendSrcAlpha!==void 0&&(r.blendSrcAlpha=e.blendSrcAlpha),e.blendDstAlpha!==void 0&&(r.blendDstAlpha=e.blendDstAlpha),e.blendEquationAlpha!==void 0&&(r.blendEquationAlpha=e.blendEquationAlpha),e.blendColor!==void 0&&r.blendColor!==void 0&&r.blendColor.setHex(e.blendColor),e.blendAlpha!==void 0&&(r.blendAlpha=e.blendAlpha),e.stencilWriteMask!==void 0&&(r.stencilWriteMask=e.stencilWriteMask),e.stencilFunc!==void 0&&(r.stencilFunc=e.stencilFunc),e.stencilRef!==void 0&&(r.stencilRef=e.stencilRef),e.stencilFuncMask!==void 0&&(r.stencilFuncMask=e.stencilFuncMask),e.stencilFail!==void 0&&(r.stencilFail=e.stencilFail),e.stencilZFail!==void 0&&(r.stencilZFail=e.stencilZFail),e.stencilZPass!==void 0&&(r.stencilZPass=e.stencilZPass),e.stencilWrite!==void 0&&(r.stencilWrite=e.stencilWrite),e.wireframe!==void 0&&(r.wireframe=e.wireframe),e.wireframeLinewidth!==void 0&&(r.wireframeLinewidth=e.wireframeLinewidth),e.wireframeLinecap!==void 0&&(r.wireframeLinecap=e.wireframeLinecap),e.wireframeLinejoin!==void 0&&(r.wireframeLinejoin=e.wireframeLinejoin),e.rotation!==void 0&&(r.rotation=e.rotation),e.linewidth!==void 0&&(r.linewidth=e.linewidth),e.dashSize!==void 0&&(r.dashSize=e.dashSize),e.gapSize!==void 0&&(r.gapSize=e.gapSize),e.scale!==void 0&&(r.scale=e.scale),e.polygonOffset!==void 0&&(r.polygonOffset=e.polygonOffset),e.polygonOffsetFactor!==void 0&&(r.polygonOffsetFactor=e.polygonOffsetFactor),e.polygonOffsetUnits!==void 0&&(r.polygonOffsetUnits=e.polygonOffsetUnits),e.dithering!==void 0&&(r.dithering=e.dithering),e.alphaToCoverage!==void 0&&(r.alphaToCoverage=e.alphaToCoverage),e.premultipliedAlpha!==void 0&&(r.premultipliedAlpha=e.premultipliedAlpha),e.forceSinglePass!==void 0&&(r.forceSinglePass=e.forceSinglePass),e.allowOverride!==void 0&&(r.allowOverride=e.allowOverride),e.visible!==void 0&&(r.visible=e.visible),e.toneMapped!==void 0&&(r.toneMapped=e.toneMapped),e.userData!==void 0&&(r.userData=e.userData),e.vertexColors!==void 0&&(typeof e.vertexColors=="number"?r.vertexColors=e.vertexColors>0:r.vertexColors=e.vertexColors),e.uniforms!==void 0)for(const s in e.uniforms){const a=e.uniforms[s];switch(r.uniforms[s]={},a.type){case"t":r.uniforms[s].value=n(a.value);break;case"c":r.uniforms[s].value=new Pt().setHex(a.value);break;case"v2":r.uniforms[s].value=new $e().fromArray(a.value);break;case"v3":r.uniforms[s].value=new Q().fromArray(a.value);break;case"v4":r.uniforms[s].value=new $n().fromArray(a.value);break;case"m3":r.uniforms[s].value=new xn().fromArray(a.value);break;case"m4":r.uniforms[s].value=new an().fromArray(a.value);break;default:r.uniforms[s].value=a.value}}if(e.defines!==void 0&&(r.defines=e.defines),e.vertexShader!==void 0&&(r.vertexShader=e.vertexShader),e.fragmentShader!==void 0&&(r.fragmentShader=e.fragmentShader),e.glslVersion!==void 0&&(r.glslVersion=e.glslVersion),e.extensions!==void 0)for(const s in e.extensions)r.extensions[s]=e.extensions[s];if(e.lights!==void 0&&(r.lights=e.lights),e.clipping!==void 0&&(r.clipping=e.clipping),e.size!==void 0&&(r.size=e.size),e.sizeAttenuation!==void 0&&(r.sizeAttenuation=e.sizeAttenuation),e.map!==void 0&&(r.map=n(e.map)),e.matcap!==void 0&&(r.matcap=n(e.matcap)),e.alphaMap!==void 0&&(r.alphaMap=n(e.alphaMap)),e.bumpMap!==void 0&&(r.bumpMap=n(e.bumpMap)),e.bumpScale!==void 0&&(r.bumpScale=e.bumpScale),e.normalMap!==void 0&&(r.normalMap=n(e.normalMap)),e.normalMapType!==void 0&&(r.normalMapType=e.normalMapType),e.normalScale!==void 0){let s=e.normalScale;Array.isArray(s)===!1&&(s=[s,s]),r.normalScale=new $e().fromArray(s)}return e.displacementMap!==void 0&&(r.displacementMap=n(e.displacementMap)),e.displacementScale!==void 0&&(r.displacementScale=e.displacementScale),e.displacementBias!==void 0&&(r.displacementBias=e.displacementBias),e.roughnessMap!==void 0&&(r.roughnessMap=n(e.roughnessMap)),e.metalnessMap!==void 0&&(r.metalnessMap=n(e.metalnessMap)),e.emissiveMap!==void 0&&(r.emissiveMap=n(e.emissiveMap)),e.emissiveIntensity!==void 0&&(r.emissiveIntensity=e.emissiveIntensity),e.specularMap!==void 0&&(r.specularMap=n(e.specularMap)),e.specularIntensityMap!==void 0&&(r.specularIntensityMap=n(e.specularIntensityMap)),e.specularColorMap!==void 0&&(r.specularColorMap=n(e.specularColorMap)),e.envMap!==void 0&&(r.envMap=n(e.envMap)),e.envMapRotation!==void 0&&r.envMapRotation.fromArray(e.envMapRotation),e.envMapIntensity!==void 0&&(r.envMapIntensity=e.envMapIntensity),e.reflectivity!==void 0&&(r.reflectivity=e.reflectivity),e.refractionRatio!==void 0&&(r.refractionRatio=e.refractionRatio),e.lightMap!==void 0&&(r.lightMap=n(e.lightMap)),e.lightMapIntensity!==void 0&&(r.lightMapIntensity=e.lightMapIntensity),e.aoMap!==void 0&&(r.aoMap=n(e.aoMap)),e.aoMapIntensity!==void 0&&(r.aoMapIntensity=e.aoMapIntensity),e.gradientMap!==void 0&&(r.gradientMap=n(e.gradientMap)),e.clearcoatMap!==void 0&&(r.clearcoatMap=n(e.clearcoatMap)),e.clearcoatRoughnessMap!==void 0&&(r.clearcoatRoughnessMap=n(e.clearcoatRoughnessMap)),e.clearcoatNormalMap!==void 0&&(r.clearcoatNormalMap=n(e.clearcoatNormalMap)),e.clearcoatNormalScale!==void 0&&(r.clearcoatNormalScale=new $e().fromArray(e.clearcoatNormalScale)),e.iridescenceMap!==void 0&&(r.iridescenceMap=n(e.iridescenceMap)),e.iridescenceThicknessMap!==void 0&&(r.iridescenceThicknessMap=n(e.iridescenceThicknessMap)),e.transmissionMap!==void 0&&(r.transmissionMap=n(e.transmissionMap)),e.thicknessMap!==void 0&&(r.thicknessMap=n(e.thicknessMap)),e.anisotropyMap!==void 0&&(r.anisotropyMap=n(e.anisotropyMap)),e.sheenColorMap!==void 0&&(r.sheenColorMap=n(e.sheenColorMap)),e.sheenRoughnessMap!==void 0&&(r.sheenRoughnessMap=n(e.sheenRoughnessMap)),r}setTextures(e){return this.textures=e,this}createMaterialFromType(e){return kx.createMaterialFromType(e)}static createMaterialFromType(e){const t={ShadowMaterial:KR,SpriteMaterial:jM,RawShaderMaterial:cE,ShaderMaterial:Ar,PointsMaterial:tE,MeshPhysicalMaterial:QR,MeshStandardMaterial:fE,MeshPhongMaterial:jR,MeshToonMaterial:eI,MeshNormalMaterial:tI,MeshLambertMaterial:nI,MeshDepthMaterial:Lx,MeshDistanceMaterial:dE,MeshBasicMaterial:mu,MeshMatcapMaterial:iI,LineDashedMaterial:rI,LineBasicMaterial:Fs,Material:vs};return new t[e]}}class oM{static extractUrlBase(e){const t=e.lastIndexOf("/");return t===-1?"./":e.slice(0,t+1)}static resolveURL(e,t){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class _E extends vn{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){const e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class yI extends ks{constructor(e){super(e)}load(e,t,n,r){const s=this,a=new So(s.manager);a.setPath(s.path),a.setRequestHeader(s.requestHeader),a.setWithCredentials(s.withCredentials),a.load(e,function(c){try{t(s.parse(JSON.parse(c)))}catch(d){r?r(d):Jt(d),s.manager.itemError(e)}},n,r)}parse(e){const t={},n={};function r(b,T){if(t[T]!==void 0)return t[T];const C=b.interleavedBuffers[T],A=s(b,C.buffer),D=Ph(C.type,A),U=new _x(D,C.stride);return U.uuid=C.uuid,t[T]=U,U}function s(b,T){if(n[T]!==void 0)return n[T];const C=b.arrayBuffers[T],A=new Uint32Array(C).buffer;return n[T]=A,A}const a=e.isInstancedBufferGeometry?new _E:new vn,c=e.data.index;if(c!==void 0){const b=Ph(c.type,c.array);a.setIndex(new pi(b,1))}const d=e.data.attributes;for(const b in d){const T=d[b];let I;if(T.isInterleavedBufferAttribute){const C=r(e.data,T.data);I=new _o(C,T.itemSize,T.offset,T.normalized)}else{const C=Ph(T.type,T.array),A=T.isInstancedBufferAttribute?Kh:pi;I=new A(C,T.itemSize,T.normalized)}T.name!==void 0&&(I.name=T.name),T.usage!==void 0&&I.setUsage(T.usage),a.setAttribute(b,I)}const p=e.data.morphAttributes;if(p)for(const b in p){const T=p[b],I=[];for(let C=0,A=T.length;C<A;C++){const D=T[C];let U;if(D.isInterleavedBufferAttribute){const L=r(e.data,D.data);U=new _o(L,D.itemSize,D.offset,D.normalized)}else{const L=Ph(D.type,D.array);U=new pi(L,D.itemSize,D.normalized)}D.name!==void 0&&(U.name=D.name),I.push(U)}a.morphAttributes[b]=I}e.data.morphTargetsRelative&&(a.morphTargetsRelative=!0);const v=e.data.groups||e.data.drawcalls||e.data.offsets;if(v!==void 0)for(let b=0,T=v.length;b!==T;++b){const I=v[b];a.addGroup(I.start,I.count,I.materialIndex)}const _=e.data.boundingSphere;return _!==void 0&&(a.boundingSphere=new Tr().fromJSON(_)),e.name&&(a.name=e.name),e.userData&&(a.userData=e.userData),a}}class ZP extends ks{constructor(e){super(e)}load(e,t,n,r){const s=this,a=this.path===""?oM.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||a;const c=new So(this.manager);c.setPath(this.path),c.setRequestHeader(this.requestHeader),c.setWithCredentials(this.withCredentials),c.load(e,function(d){let p=null;try{p=JSON.parse(d)}catch(v){r!==void 0&&r(v),v("ObjectLoader: Can't parse "+e+".",v.message);return}const m=p.metadata;if(m===void 0||m.type===void 0||m.type.toLowerCase()==="geometry"){r!==void 0&&r(new Error("THREE.ObjectLoader: Can't load "+e)),Jt("ObjectLoader: Can't load "+e);return}s.parse(p,t)},n,r)}async loadAsync(e,t){const n=this,r=this.path===""?oM.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||r;const s=new So(this.manager);s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials);const a=await s.loadAsync(e,t),c=JSON.parse(a),d=c.metadata;if(d===void 0||d.type===void 0||d.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+e);return await n.parseAsync(c)}parse(e,t){const n=this.parseAnimations(e.animations),r=this.parseShapes(e.shapes),s=this.parseGeometries(e.geometries,r),a=this.parseImages(e.images,function(){t!==void 0&&t(p)}),c=this.parseTextures(e.textures,a),d=this.parseMaterials(e.materials,c),p=this.parseObject(e.object,s,d,c,n),m=this.parseSkeletons(e.skeletons,p);if(this.bindSkeletons(p,m),this.bindLightTargets(p),t!==void 0){let v=!1;for(const _ in a)if(a[_].data instanceof HTMLImageElement){v=!0;break}v===!1&&t(p)}return p}async parseAsync(e){const t=this.parseAnimations(e.animations),n=this.parseShapes(e.shapes),r=this.parseGeometries(e.geometries,n),s=await this.parseImagesAsync(e.images),a=this.parseTextures(e.textures,s),c=this.parseMaterials(e.materials,a),d=this.parseObject(e.object,r,c,a,t),p=this.parseSkeletons(e.skeletons,d);return this.bindSkeletons(d,p),this.bindLightTargets(d),d}parseShapes(e){const t={};if(e!==void 0)for(let n=0,r=e.length;n<r;n++){const s=new Vf().fromJSON(e[n]);t[s.uuid]=s}return t}parseSkeletons(e,t){const n={},r={};if(t.traverse(function(s){s.isBone&&(r[s.uuid]=s)}),e!==void 0)for(let s=0,a=e.length;s<a;s++){const c=new xx().fromJSON(e[s],r);n[c.uuid]=c}return n}parseGeometries(e,t){const n={};if(e!==void 0){const r=new yI;for(let s=0,a=e.length;s<a;s++){let c;const d=e[s];switch(d.type){case"BufferGeometry":case"InstancedBufferGeometry":c=r.parse(d);break;default:d.type in q1?c=q1[d.type].fromJSON(d,t):It(`ObjectLoader: Unsupported geometry type "${d.type}"`)}c.uuid=d.uuid,d.name!==void 0&&(c.name=d.name),d.userData!==void 0&&(c.userData=d.userData),n[d.uuid]=c}}return n}parseMaterials(e,t){const n={},r={};if(e!==void 0){const s=new kx;s.setTextures(t);for(let a=0,c=e.length;a<c;a++){const d=e[a];n[d.uuid]===void 0&&(n[d.uuid]=s.parse(d)),r[d.uuid]=n[d.uuid]}}return r}parseAnimations(e){const t={};if(e!==void 0)for(let n=0;n<e.length;n++){const r=e[n],s=Dg.parse(r);t[s.uuid]=s}return t}parseImages(e,t){const n=this,r={};let s;function a(d){return n.manager.itemStart(d),s.load(d,function(){n.manager.itemEnd(d)},void 0,function(){n.manager.itemError(d),n.manager.itemEnd(d)})}function c(d){if(typeof d=="string"){const p=d,m=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(p)?p:n.resourcePath+p;return a(m)}else return d.data?{data:Ph(d.type,d.data),width:d.width,height:d.height}:null}if(e!==void 0&&e.length>0){const d=new Fx(t);s=new Ug(d),s.setCrossOrigin(this.crossOrigin);for(let p=0,m=e.length;p<m;p++){const v=e[p],_=v.url;if(Array.isArray(_)){const b=[];for(let T=0,I=_.length;T<I;T++){const C=_[T],A=c(C);A!==null&&(A instanceof HTMLImageElement?b.push(A):b.push(new na(A.data,A.width,A.height)))}r[v.uuid]=new yc(b)}else{const b=c(v.url);r[v.uuid]=new yc(b)}}}return r}async parseImagesAsync(e){const t=this,n={};let r;async function s(a){if(typeof a=="string"){const c=a,d=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(c)?c:t.resourcePath+c;return await r.loadAsync(d)}else return a.data?{data:Ph(a.type,a.data),width:a.width,height:a.height}:null}if(e!==void 0&&e.length>0){r=new Ug(this.manager),r.setCrossOrigin(this.crossOrigin);for(let a=0,c=e.length;a<c;a++){const d=e[a],p=d.url;if(Array.isArray(p)){const m=[];for(let v=0,_=p.length;v<_;v++){const b=p[v],T=await s(b);T!==null&&(T instanceof HTMLImageElement?m.push(T):m.push(new na(T.data,T.width,T.height)))}n[d.uuid]=new yc(m)}else{const m=await s(d.url);n[d.uuid]=new yc(m)}}}return n}parseTextures(e,t){function n(s,a){return typeof s=="number"?s:(It("ObjectLoader.parseTexture: Constant should be in numeric form.",s),a[s])}const r={};if(e!==void 0)for(let s=0,a=e.length;s<a;s++){const c=e[s];c.image===void 0&&It('ObjectLoader: No "image" specified for',c.uuid),t[c.image]===void 0&&It("ObjectLoader: Undefined image",c.image);const d=t[c.image],p=d.data;let m;Array.isArray(p)?(m=new Vg,p.length===6&&(m.needsUpdate=!0)):(p&&p.data?m=new na:m=new hi,p&&(m.needsUpdate=!0)),m.source=d,m.uuid=c.uuid,c.name!==void 0&&(m.name=c.name),c.mapping!==void 0&&(m.mapping=n(c.mapping,$P)),c.channel!==void 0&&(m.channel=c.channel),c.offset!==void 0&&m.offset.fromArray(c.offset),c.repeat!==void 0&&m.repeat.fromArray(c.repeat),c.center!==void 0&&m.center.fromArray(c.center),c.rotation!==void 0&&(m.rotation=c.rotation),c.wrap!==void 0&&(m.wrapS=n(c.wrap[0],Y1),m.wrapT=n(c.wrap[1],Y1)),c.format!==void 0&&(m.format=c.format),c.internalFormat!==void 0&&(m.internalFormat=c.internalFormat),c.type!==void 0&&(m.type=c.type),c.colorSpace!==void 0&&(m.colorSpace=c.colorSpace),c.minFilter!==void 0&&(m.minFilter=n(c.minFilter,J1)),c.magFilter!==void 0&&(m.magFilter=n(c.magFilter,J1)),c.anisotropy!==void 0&&(m.anisotropy=c.anisotropy),c.flipY!==void 0&&(m.flipY=c.flipY),c.generateMipmaps!==void 0&&(m.generateMipmaps=c.generateMipmaps),c.premultiplyAlpha!==void 0&&(m.premultiplyAlpha=c.premultiplyAlpha),c.unpackAlignment!==void 0&&(m.unpackAlignment=c.unpackAlignment),c.compareFunction!==void 0&&(m.compareFunction=c.compareFunction),c.userData!==void 0&&(m.userData=c.userData),r[c.uuid]=m}return r}parseObject(e,t,n,r,s){let a;function c(_){return t[_]===void 0&&It("ObjectLoader: Undefined geometry",_),t[_]}function d(_){if(_!==void 0){if(Array.isArray(_)){const b=[];for(let T=0,I=_.length;T<I;T++){const C=_[T];n[C]===void 0&&It("ObjectLoader: Undefined material",C),b.push(n[C])}return b}return n[_]===void 0&&It("ObjectLoader: Undefined material",_),n[_]}}function p(_){return r[_]===void 0&&It("ObjectLoader: Undefined texture",_),r[_]}let m,v;switch(e.type){case"Scene":a=new Hg,e.background!==void 0&&(Number.isInteger(e.background)?a.background=new Pt(e.background):a.background=p(e.background)),e.environment!==void 0&&(a.environment=p(e.environment)),e.fog!==void 0&&(e.fog.type==="Fog"?a.fog=new yx(e.fog.color,e.fog.near,e.fog.far):e.fog.type==="FogExp2"&&(a.fog=new vx(e.fog.color,e.fog.density)),e.fog.name!==""&&(a.fog.name=e.fog.name)),e.backgroundBlurriness!==void 0&&(a.backgroundBlurriness=e.backgroundBlurriness),e.backgroundIntensity!==void 0&&(a.backgroundIntensity=e.backgroundIntensity),e.backgroundRotation!==void 0&&a.backgroundRotation.fromArray(e.backgroundRotation),e.environmentIntensity!==void 0&&(a.environmentIntensity=e.environmentIntensity),e.environmentRotation!==void 0&&a.environmentRotation.fromArray(e.environmentRotation);break;case"PerspectiveCamera":a=new Fr(e.fov,e.aspect,e.near,e.far),e.focus!==void 0&&(a.focus=e.focus),e.zoom!==void 0&&(a.zoom=e.zoom),e.filmGauge!==void 0&&(a.filmGauge=e.filmGauge),e.filmOffset!==void 0&&(a.filmOffset=e.filmOffset),e.view!==void 0&&(a.view=Object.assign({},e.view));break;case"OrthographicCamera":a=new jf(e.left,e.right,e.top,e.bottom,e.near,e.far),e.zoom!==void 0&&(a.zoom=e.zoom),e.view!==void 0&&(a.view=Object.assign({},e.view));break;case"AmbientLight":a=new mI(e.color,e.intensity);break;case"DirectionalLight":a=new pI(e.color,e.intensity),a.target=e.target||"";break;case"PointLight":a=new hI(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":a=new gI(e.color,e.intensity,e.width,e.height);break;case"SpotLight":a=new dI(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay),a.target=e.target||"";break;case"HemisphereLight":a=new fI(e.color,e.groundColor,e.intensity);break;case"LightProbe":const _=new yE().fromArray(e.sh);a=new vI(_,e.intensity);break;case"SkinnedMesh":m=c(e.geometry),v=d(e.material),a=new PR(m,v),e.bindMode!==void 0&&(a.bindMode=e.bindMode),e.bindMatrix!==void 0&&a.bindMatrix.fromArray(e.bindMatrix),e.skeleton!==void 0&&(a.skeleton=e.skeleton);break;case"Mesh":m=c(e.geometry),v=d(e.material),a=new Di(m,v);break;case"InstancedMesh":m=c(e.geometry),v=d(e.material);const b=e.count,T=e.instanceMatrix,I=e.instanceColor;a=new LR(m,v,b),a.instanceMatrix=new Kh(new Float32Array(T.array),16),I!==void 0&&(a.instanceColor=new Kh(new Float32Array(I.array),I.itemSize));break;case"BatchedMesh":m=c(e.geometry),v=d(e.material),a=new FR(e.maxInstanceCount,e.maxVertexCount,e.maxIndexCount,v),a.geometry=m,a.perObjectFrustumCulled=e.perObjectFrustumCulled,a.sortObjects=e.sortObjects,a._drawRanges=e.drawRanges,a._reservedRanges=e.reservedRanges,a._geometryInfo=e.geometryInfo.map(C=>{let A=null,D=null;return C.boundingBox!==void 0&&(A=new Er().fromJSON(C.boundingBox)),C.boundingSphere!==void 0&&(D=new Tr().fromJSON(C.boundingSphere)),{...C,boundingBox:A,boundingSphere:D}}),a._instanceInfo=e.instanceInfo,a._availableInstanceIds=e._availableInstanceIds,a._availableGeometryIds=e._availableGeometryIds,a._nextIndexStart=e.nextIndexStart,a._nextVertexStart=e.nextVertexStart,a._geometryCount=e.geometryCount,a._maxInstanceCount=e.maxInstanceCount,a._maxVertexCount=e.maxVertexCount,a._maxIndexCount=e.maxIndexCount,a._geometryInitialized=e.geometryInitialized,a._matricesTexture=p(e.matricesTexture.uuid),a._indirectTexture=p(e.indirectTexture.uuid),e.colorsTexture!==void 0&&(a._colorsTexture=p(e.colorsTexture.uuid)),e.boundingSphere!==void 0&&(a.boundingSphere=new Tr().fromJSON(e.boundingSphere)),e.boundingBox!==void 0&&(a.boundingBox=new Er().fromJSON(e.boundingBox));break;case"LOD":a=new UR;break;case"Line":a=new Tc(c(e.geometry),d(e.material));break;case"LineLoop":a=new kR(c(e.geometry),d(e.material));break;case"LineSegments":a=new Al(c(e.geometry),d(e.material));break;case"PointCloud":case"Points":a=new OR(c(e.geometry),d(e.material));break;case"Sprite":a=new DR(d(e.material));break;case"Group":a=new Lh;break;case"Bone":a=new eE;break;default:a=new Kn}if(a.uuid=e.uuid,e.name!==void 0&&(a.name=e.name),e.matrix!==void 0?(a.matrix.fromArray(e.matrix),e.matrixAutoUpdate!==void 0&&(a.matrixAutoUpdate=e.matrixAutoUpdate),a.matrixAutoUpdate&&a.matrix.decompose(a.position,a.quaternion,a.scale)):(e.position!==void 0&&a.position.fromArray(e.position),e.rotation!==void 0&&a.rotation.fromArray(e.rotation),e.quaternion!==void 0&&a.quaternion.fromArray(e.quaternion),e.scale!==void 0&&a.scale.fromArray(e.scale)),e.up!==void 0&&a.up.fromArray(e.up),e.castShadow!==void 0&&(a.castShadow=e.castShadow),e.receiveShadow!==void 0&&(a.receiveShadow=e.receiveShadow),e.shadow&&(e.shadow.intensity!==void 0&&(a.shadow.intensity=e.shadow.intensity),e.shadow.bias!==void 0&&(a.shadow.bias=e.shadow.bias),e.shadow.normalBias!==void 0&&(a.shadow.normalBias=e.shadow.normalBias),e.shadow.radius!==void 0&&(a.shadow.radius=e.shadow.radius),e.shadow.mapSize!==void 0&&a.shadow.mapSize.fromArray(e.shadow.mapSize),e.shadow.camera!==void 0&&(a.shadow.camera=this.parseObject(e.shadow.camera))),e.visible!==void 0&&(a.visible=e.visible),e.frustumCulled!==void 0&&(a.frustumCulled=e.frustumCulled),e.renderOrder!==void 0&&(a.renderOrder=e.renderOrder),e.userData!==void 0&&(a.userData=e.userData),e.layers!==void 0&&(a.layers.mask=e.layers),e.children!==void 0){const _=e.children;for(let b=0;b<_.length;b++)a.add(this.parseObject(_[b],t,n,r,s))}if(e.animations!==void 0){const _=e.animations;for(let b=0;b<_.length;b++){const T=_[b];a.animations.push(s[T])}}if(e.type==="LOD"){e.autoUpdate!==void 0&&(a.autoUpdate=e.autoUpdate);const _=e.levels;for(let b=0;b<_.length;b++){const T=_[b],I=a.getObjectByProperty("uuid",T.object);I!==void 0&&a.addLevel(I,T.distance,T.hysteresis)}}return a}bindSkeletons(e,t){Object.keys(t).length!==0&&e.traverse(function(n){if(n.isSkinnedMesh===!0&&n.skeleton!==void 0){const r=t[n.skeleton];r===void 0?It("ObjectLoader: No skeleton found with UUID:",n.skeleton):n.bind(r,n.bindMatrix)}})}bindLightTargets(e){e.traverse(function(t){if(t.isDirectionalLight||t.isSpotLight){const n=t.target,r=e.getObjectByProperty("uuid",n);r!==void 0?t.target=r:t.target=new Kn}})}}const $P={UVMapping:bc,CubeReflectionMapping:Ua,CubeRefractionMapping:Mc,EquirectangularReflectionMapping:Gh,EquirectangularRefractionMapping:vg,CubeUVReflectionMapping:np},Y1={RepeatWrapping:yg,ClampToEdgeWrapping:Qi,MirroredRepeatWrapping:_g},J1={NearestFilter:lr,NearestMipmapNearestFilter:GM,NearestMipmapLinearFilter:Uh,LinearFilter:Bn,LinearMipmapNearestFilter:sg,LinearMipmapLinearFilter:_l},gb=new WeakMap;class KP extends ks{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&It("ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&It("ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"},this._abortController=new AbortController}setOptions(e){return this.options=e,this}load(e,t,n,r){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,a=xl.get(`image-bitmap:${e}`);if(a!==void 0){if(s.manager.itemStart(e),a.then){a.then(p=>{if(gb.has(a)===!0)r&&r(gb.get(a)),s.manager.itemError(e),s.manager.itemEnd(e);else return t&&t(p),s.manager.itemEnd(e),p});return}return setTimeout(function(){t&&t(a),s.manager.itemEnd(e)},0),a}const c={};c.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",c.headers=this.requestHeader,c.signal=typeof AbortSignal.any=="function"?AbortSignal.any([this._abortController.signal,this.manager.abortController.signal]):this._abortController.signal;const d=fetch(e,c).then(function(p){return p.blob()}).then(function(p){return createImageBitmap(p,Object.assign(s.options,{colorSpaceConversion:"none"}))}).then(function(p){return xl.add(`image-bitmap:${e}`,p),t&&t(p),s.manager.itemEnd(e),p}).catch(function(p){r&&r(p),gb.set(d,p),xl.remove(`image-bitmap:${e}`),s.manager.itemError(e),s.manager.itemEnd(e)});xl.add(`image-bitmap:${e}`,d),s.manager.itemStart(e)}abort(){return this._abortController.abort(),this._abortController=new AbortController,this}}let xy;class xE{static getContext(){return xy===void 0&&(xy=new(window.AudioContext||window.webkitAudioContext)),xy}static setContext(e){xy=e}}class QP extends ks{constructor(e){super(e)}load(e,t,n,r){const s=this,a=new So(this.manager);a.setResponseType("arraybuffer"),a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(d){try{const p=d.slice(0);xE.getContext().decodeAudioData(p,function(v){t(v)}).catch(c)}catch(p){c(p)}},n,r);function c(d){r?r(d):Jt(d),s.manager.itemError(e)}}}const Z1=new an,$1=new an,bf=new an;class jP{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Fr,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Fr,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const t=this._cache;if(t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep){t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep,bf.copy(e.projectionMatrix);const r=t.eyeSep/2,s=r*t.near/t.focus,a=t.near*Math.tan(Bf*t.fov*.5)/t.zoom;let c,d;$1.elements[12]=-r,Z1.elements[12]=r,c=-a*t.aspect+s,d=a*t.aspect+s,bf.elements[0]=2*t.near/(d-c),bf.elements[8]=(d+c)/(d-c),this.cameraL.projectionMatrix.copy(bf),c=-a*t.aspect-s,d=a*t.aspect-s,bf.elements[0]=2*t.near/(d-c),bf.elements[8]=(d+c)/(d-c),this.cameraR.projectionMatrix.copy(bf)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply($1),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(Z1)}}class _I extends Fr{constructor(e=[]){super(),this.isArrayCamera=!0,this.isMultiViewCamera=!1,this.cameras=e}}class SE{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=performance.now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=performance.now();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}const Mf=new Q,vb=new ao,eL=new Q,Ef=new Q,Tf=new Q;class tL extends Kn{constructor(){super(),this.type="AudioListener",this.context=xE.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new SE}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const t=this.context.listener;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(Mf,vb,eL),Ef.set(0,0,-1).applyQuaternion(vb),Tf.set(0,1,0).applyQuaternion(vb),t.positionX){const n=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(Mf.x,n),t.positionY.linearRampToValueAtTime(Mf.y,n),t.positionZ.linearRampToValueAtTime(Mf.z,n),t.forwardX.linearRampToValueAtTime(Ef.x,n),t.forwardY.linearRampToValueAtTime(Ef.y,n),t.forwardZ.linearRampToValueAtTime(Ef.z,n),t.upX.linearRampToValueAtTime(Tf.x,n),t.upY.linearRampToValueAtTime(Tf.y,n),t.upZ.linearRampToValueAtTime(Tf.z,n)}else t.setPosition(Mf.x,Mf.y,Mf.z),t.setOrientation(Ef.x,Ef.y,Ef.z,Tf.x,Tf.y,Tf.z)}}class xI extends Kn{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(this.isPlaying===!0){It("Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){It("Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+e;const t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){It("Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(e=0){if(this.hasPlaybackControl===!1){It("Audio: this Audio has no playback control.");return}return this._progress=0,this.source!==null&&(this.source.stop(this.context.currentTime+e),this.source.onended=null),this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this._connected!==!1){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}}getFilters(){return this.filters}setFilters(e){return e||(e=[]),this._connected===!0?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){return this.detune=e,this.isPlaying===!0&&this.source.detune!==void 0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(this.hasPlaybackControl===!1){It("Audio: this Audio has no playback control.");return}return this.playbackRate=e,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1,this._progress=0}getLoop(){return this.hasPlaybackControl===!1?(It("Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(this.hasPlaybackControl===!1){It("Audio: this Audio has no playback control.");return}return this.loop=e,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}copy(e,t){return super.copy(e,t),e.sourceType!=="buffer"?(It("Audio: Audio source type cannot be copied."),this):(this.autoplay=e.autoplay,this.buffer=e.buffer,this.detune=e.detune,this.loop=e.loop,this.loopStart=e.loopStart,this.loopEnd=e.loopEnd,this.offset=e.offset,this.duration=e.duration,this.playbackRate=e.playbackRate,this.hasPlaybackControl=e.hasPlaybackControl,this.sourceType=e.sourceType,this.filters=e.filters.slice(),this)}clone(e){return new this.constructor(this.listener).copy(this,e)}}const Af=new Q,K1=new ao,nL=new Q,wf=new Q;class iL extends xI{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}connect(){return super.connect(),this.panner.connect(this.gain),this}disconnect(){return super.disconnect(),this.panner.disconnect(this.gain),this}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,t,n){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=n,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(Af,K1,nL),wf.set(0,0,1).applyQuaternion(K1);const t=this.panner;if(t.positionX){const n=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(Af.x,n),t.positionY.linearRampToValueAtTime(Af.y,n),t.positionZ.linearRampToValueAtTime(Af.z,n),t.orientationX.linearRampToValueAtTime(wf.x,n),t.orientationY.linearRampToValueAtTime(wf.y,n),t.orientationZ.linearRampToValueAtTime(wf.z,n)}else t.setPosition(Af.x,Af.y,Af.z),t.setOrientation(wf.x,wf.y,wf.z)}}class rL{constructor(e,t=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=t,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const t=this.getFrequencyData();for(let n=0;n<t.length;n++)e+=t[n];return e/t.length}}class SI{constructor(e,t,n){this.binding=e,this.valueSize=n;let r,s,a;switch(t){case"quaternion":r=this._slerp,s=this._slerpAdditive,a=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(n*6),this._workIndex=5;break;case"string":case"bool":r=this._select,s=this._select,a=this._setAdditiveIdentityOther,this.buffer=new Array(n*5);break;default:r=this._lerp,s=this._lerpAdditive,a=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(n*5)}this._mixBufferRegion=r,this._mixBufferRegionAdditive=s,this._setIdentity=a,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){const n=this.buffer,r=this.valueSize,s=e*r+r;let a=this.cumulativeWeight;if(a===0){for(let c=0;c!==r;++c)n[s+c]=n[c];a=t}else{a+=t;const c=t/a;this._mixBufferRegion(n,s,0,c,r)}this.cumulativeWeight=a}accumulateAdditive(e){const t=this.buffer,n=this.valueSize,r=n*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(t,r,0,e,n),this.cumulativeWeightAdditive+=e}apply(e){const t=this.valueSize,n=this.buffer,r=e*t+t,s=this.cumulativeWeight,a=this.cumulativeWeightAdditive,c=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,s<1){const d=t*this._origIndex;this._mixBufferRegion(n,r,d,1-s,t)}a>0&&this._mixBufferRegionAdditive(n,r,this._addIndex*t,1,t);for(let d=t,p=t+t;d!==p;++d)if(n[d]!==n[d+t]){c.setValue(n,r);break}}saveOriginalState(){const e=this.binding,t=this.buffer,n=this.valueSize,r=n*this._origIndex;e.getValue(t,r);for(let s=n,a=r;s!==a;++s)t[s]=t[r+s%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=this.valueSize*3;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let n=e;n<t;n++)this.buffer[n]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let n=0;n<this.valueSize;n++)this.buffer[t+n]=this.buffer[e+n]}_select(e,t,n,r,s){if(r>=.5)for(let a=0;a!==s;++a)e[t+a]=e[n+a]}_slerp(e,t,n,r){ao.slerpFlat(e,t,e,t,e,n,r)}_slerpAdditive(e,t,n,r,s){const a=this._workIndex*s;ao.multiplyQuaternionsFlat(e,a,e,t,e,n),ao.slerpFlat(e,t,e,t,e,a,r)}_lerp(e,t,n,r,s){const a=1-r;for(let c=0;c!==s;++c){const d=t+c;e[d]=e[d]*a+e[n+c]*r}}_lerpAdditive(e,t,n,r,s){for(let a=0;a!==s;++a){const c=t+a;e[c]=e[c]+e[n+a]*r}}}const bE="\\[\\]\\.:\\/",sL=new RegExp("["+bE+"]","g"),ME="[^"+bE+"]",oL="[^"+bE.replace("\\.","")+"]",aL=/((?:WC+[\/:])*)/.source.replace("WC",ME),lL=/(WCOD+)?/.source.replace("WCOD",oL),uL=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",ME),cL=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",ME),fL=new RegExp("^"+aL+lL+uL+cL+"$"),dL=["material","materials","bones","map"];class hL{constructor(e,t,n){const r=n||Zn.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,r)}getValue(e,t){this.bind();const n=this._targetGroup.nCachedObjects_,r=this._bindings[n];r!==void 0&&r.getValue(e,t)}setValue(e,t){const n=this._bindings;for(let r=this._targetGroup.nCachedObjects_,s=n.length;r!==s;++r)n[r].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}}class Zn{constructor(e,t,n){this.path=t,this.parsedPath=n||Zn.parseTrackName(t),this.node=Zn.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,n){return e&&e.isAnimationObjectGroup?new Zn.Composite(e,t,n):new Zn(e,t,n)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(sL,"")}static parseTrackName(e){const t=fL.exec(e);if(t===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const n={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},r=n.nodeName&&n.nodeName.lastIndexOf(".");if(r!==void 0&&r!==-1){const s=n.nodeName.substring(r+1);dL.indexOf(s)!==-1&&(n.nodeName=n.nodeName.substring(0,r),n.objectName=s)}if(n.propertyName===null||n.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return n}static findNode(e,t){if(t===void 0||t===""||t==="."||t===-1||t===e.name||t===e.uuid)return e;if(e.skeleton){const n=e.skeleton.getBoneByName(t);if(n!==void 0)return n}if(e.children){const n=function(s){for(let a=0;a<s.length;a++){const c=s[a];if(c.name===t||c.uuid===t)return c;const d=n(c.children);if(d)return d}return null},r=n(e.children);if(r)return r}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){const n=this.resolvedProperty;for(let r=0,s=n.length;r!==s;++r)e[t++]=n[r]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){const n=this.resolvedProperty;for(let r=0,s=n.length;r!==s;++r)n[r]=e[t++]}_setValue_array_setNeedsUpdate(e,t){const n=this.resolvedProperty;for(let r=0,s=n.length;r!==s;++r)n[r]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){const n=this.resolvedProperty;for(let r=0,s=n.length;r!==s;++r)n[r]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node;const t=this.parsedPath,n=t.objectName,r=t.propertyName;let s=t.propertyIndex;if(e||(e=Zn.findNode(this.rootNode,t.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){It("PropertyBinding: No target node found for track: "+this.path+".");return}if(n){let p=t.objectIndex;switch(n){case"materials":if(!e.material){Jt("PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){Jt("PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){Jt("PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let m=0;m<e.length;m++)if(e[m].name===p){p=m;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){Jt("PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){Jt("PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[n]===void 0){Jt("PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[n]}if(p!==void 0){if(e[p]===void 0){Jt("PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[p]}}const a=e[r];if(a===void 0){const p=t.nodeName;Jt("PropertyBinding: Trying to update property for track: "+p+"."+r+" but it wasn't found.",e);return}let c=this.Versioning.None;this.targetObject=e,e.isMaterial===!0?c=this.Versioning.NeedsUpdate:e.isObject3D===!0&&(c=this.Versioning.MatrixWorldNeedsUpdate);let d=this.BindingType.Direct;if(s!==void 0){if(r==="morphTargetInfluences"){if(!e.geometry){Jt("PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){Jt("PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[s]!==void 0&&(s=e.morphTargetDictionary[s])}d=this.BindingType.ArrayElement,this.resolvedProperty=a,this.propertyIndex=s}else a.fromArray!==void 0&&a.toArray!==void 0?(d=this.BindingType.HasFromToArray,this.resolvedProperty=a):Array.isArray(a)?(d=this.BindingType.EntireArray,this.resolvedProperty=a):this.propertyName=r;this.getValue=this.GetterByBindingType[d],this.setValue=this.SetterByBindingTypeAndVersioning[d][c]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}Zn.Composite=hL;Zn.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};Zn.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};Zn.prototype.GetterByBindingType=[Zn.prototype._getValue_direct,Zn.prototype._getValue_array,Zn.prototype._getValue_arrayElement,Zn.prototype._getValue_toArray];Zn.prototype.SetterByBindingTypeAndVersioning=[[Zn.prototype._setValue_direct,Zn.prototype._setValue_direct_setNeedsUpdate,Zn.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Zn.prototype._setValue_array,Zn.prototype._setValue_array_setNeedsUpdate,Zn.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Zn.prototype._setValue_arrayElement,Zn.prototype._setValue_arrayElement_setNeedsUpdate,Zn.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Zn.prototype._setValue_fromArray,Zn.prototype._setValue_fromArray_setNeedsUpdate,Zn.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class pL{constructor(){this.isAnimationObjectGroup=!0,this.uuid=xo(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let n=0,r=arguments.length;n!==r;++n)e[arguments[n].uuid]=n;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const t=this;this.stats={objects:{get total(){return t._objects.length},get inUse(){return this.total-t.nCachedObjects_}},get bindingsPerObject(){return t._bindings.length}}}add(){const e=this._objects,t=this._indicesByUUID,n=this._paths,r=this._parsedPaths,s=this._bindings,a=s.length;let c,d=e.length,p=this.nCachedObjects_;for(let m=0,v=arguments.length;m!==v;++m){const _=arguments[m],b=_.uuid;let T=t[b];if(T===void 0){T=d++,t[b]=T,e.push(_);for(let I=0,C=a;I!==C;++I)s[I].push(new Zn(_,n[I],r[I]))}else if(T<p){c=e[T];const I=--p,C=e[I];t[C.uuid]=T,e[T]=C,t[b]=I,e[I]=_;for(let A=0,D=a;A!==D;++A){const U=s[A],L=U[I];let z=U[T];U[T]=L,z===void 0&&(z=new Zn(_,n[A],r[A])),U[I]=z}}else e[T]!==c&&Jt("AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=p}remove(){const e=this._objects,t=this._indicesByUUID,n=this._bindings,r=n.length;let s=this.nCachedObjects_;for(let a=0,c=arguments.length;a!==c;++a){const d=arguments[a],p=d.uuid,m=t[p];if(m!==void 0&&m>=s){const v=s++,_=e[v];t[_.uuid]=m,e[m]=_,t[p]=v,e[v]=d;for(let b=0,T=r;b!==T;++b){const I=n[b],C=I[v],A=I[m];I[m]=C,I[v]=A}}}this.nCachedObjects_=s}uncache(){const e=this._objects,t=this._indicesByUUID,n=this._bindings,r=n.length;let s=this.nCachedObjects_,a=e.length;for(let c=0,d=arguments.length;c!==d;++c){const p=arguments[c],m=p.uuid,v=t[m];if(v!==void 0)if(delete t[m],v<s){const _=--s,b=e[_],T=--a,I=e[T];t[b.uuid]=v,e[v]=b,t[I.uuid]=_,e[_]=I,e.pop();for(let C=0,A=r;C!==A;++C){const D=n[C],U=D[_],L=D[T];D[v]=U,D[_]=L,D.pop()}}else{const _=--a,b=e[_];_>0&&(t[b.uuid]=v),e[v]=b,e.pop();for(let T=0,I=r;T!==I;++T){const C=n[T];C[v]=C[_],C.pop()}}}this.nCachedObjects_=s}subscribe_(e,t){const n=this._bindingsIndicesByPath;let r=n[e];const s=this._bindings;if(r!==void 0)return s[r];const a=this._paths,c=this._parsedPaths,d=this._objects,p=d.length,m=this.nCachedObjects_,v=new Array(p);r=s.length,n[e]=r,a.push(e),c.push(t),s.push(v);for(let _=m,b=d.length;_!==b;++_){const T=d[_];v[_]=new Zn(T,e,t)}return v}unsubscribe_(e){const t=this._bindingsIndicesByPath,n=t[e];if(n!==void 0){const r=this._paths,s=this._parsedPaths,a=this._bindings,c=a.length-1,d=a[c],p=e[c];t[p]=n,a[n]=d,a.pop(),s[n]=s[c],s.pop(),r[n]=r[c],r.pop()}}}class bI{constructor(e,t,n=null,r=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=n,this.blendMode=r;const s=t.tracks,a=s.length,c=new Array(a),d={endingStart:Pf,endingEnd:Pf};for(let p=0;p!==a;++p){const m=s[p].createInterpolant(null);c[p]=m,m.settings=d}this._interpolantSettings=d,this._interpolants=c,this._propertyBindings=new Array(a),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=pR,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,n=!1){if(e.fadeOut(t),this.fadeIn(t),n===!0){const r=this._clip.duration,s=e._clip.duration,a=s/r,c=r/s;e.warp(1,a,t),this.warp(c,1,t)}return this}crossFadeTo(e,t,n=!1){return e.crossFadeFrom(this,t,n)}stopFading(){const e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,n){const r=this._mixer,s=r.time,a=this.timeScale;let c=this._timeScaleInterpolant;c===null&&(c=r._lendControlInterpolant(),this._timeScaleInterpolant=c);const d=c.parameterPositions,p=c.sampleValues;return d[0]=s,d[1]=s+n,p[0]=e/a,p[1]=t/a,this}stopWarping(){const e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,n,r){if(!this.enabled){this._updateWeight(e);return}const s=this._startTime;if(s!==null){const d=(e-s)*n;d<0||n===0?t=0:(this._startTime=null,t=n*d)}t*=this._updateTimeScale(e);const a=this._updateTime(t),c=this._updateWeight(e);if(c>0){const d=this._interpolants,p=this._propertyBindings;switch(this.blendMode){case JM:for(let m=0,v=d.length;m!==v;++m)d[m].evaluate(a),p[m].accumulateAdditive(c);break;case cx:default:for(let m=0,v=d.length;m!==v;++m)d[m].evaluate(a),p[m].accumulate(r,c)}}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;const n=this._weightInterpolant;if(n!==null){const r=n.evaluate(e)[0];t*=r,e>n.parameterPositions[1]&&(this.stopFading(),r===0&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;const n=this._timeScaleInterpolant;if(n!==null){const r=n.evaluate(e)[0];t*=r,e>n.parameterPositions[1]&&(this.stopWarping(),t===0?this.paused=!0:this.timeScale=t)}}return this._effectiveTimeScale=t,t}_updateTime(e){const t=this._clip.duration,n=this.loop;let r=this.time+e,s=this._loopCount;const a=n===mR;if(e===0)return s===-1?r:a&&(s&1)===1?t-r:r;if(n===hR){s===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(r>=t)r=t;else if(r<0)r=0;else{this.time=r;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(s===-1&&(e>=0?(s=0,this._setEndings(!0,this.repetitions===0,a)):this._setEndings(this.repetitions===0,!0,a)),r>=t||r<0){const c=Math.floor(r/t);r-=t*c,s+=Math.abs(c);const d=this.repetitions-s;if(d<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,r=e>0?t:0,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(d===1){const p=e<0;this._setEndings(p,!p,a)}else this._setEndings(!1,!1,a);this._loopCount=s,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:c})}}else this.time=r;if(a&&(s&1)===1)return t-r}return r}_setEndings(e,t,n){const r=this._interpolantSettings;n?(r.endingStart=Lf,r.endingEnd=Lf):(e?r.endingStart=this.zeroSlopeAtStart?Lf:Pf:r.endingStart=Sg,t?r.endingEnd=this.zeroSlopeAtEnd?Lf:Pf:r.endingEnd=Sg)}_scheduleFading(e,t,n){const r=this._mixer,s=r.time;let a=this._weightInterpolant;a===null&&(a=r._lendControlInterpolant(),this._weightInterpolant=a);const c=a.parameterPositions,d=a.sampleValues;return c[0]=s,d[0]=t,c[1]=s+e,d[1]=n,this}}const mL=new Float32Array(1);class gL extends Tl{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){const n=e._localRoot||this._root,r=e._clip.tracks,s=r.length,a=e._propertyBindings,c=e._interpolants,d=n.uuid,p=this._bindingsByRootAndName;let m=p[d];m===void 0&&(m={},p[d]=m);for(let v=0;v!==s;++v){const _=r[v],b=_.name;let T=m[b];if(T!==void 0)++T.referenceCount,a[v]=T;else{if(T=a[v],T!==void 0){T._cacheIndex===null&&(++T.referenceCount,this._addInactiveBinding(T,d,b));continue}const I=t&&t._propertyBindings[v].binding.parsedPath;T=new SI(Zn.create(n,b,I),_.ValueTypeName,_.getValueSize()),++T.referenceCount,this._addInactiveBinding(T,d,b),a[v]=T}c[v].resultBuffer=T.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){const n=(e._localRoot||this._root).uuid,r=e._clip.uuid,s=this._actionsByClip[r];this._bindAction(e,s&&s.knownActions[0]),this._addInactiveAction(e,r,n)}const t=e._propertyBindings;for(let n=0,r=t.length;n!==r;++n){const s=t[n];s.useCount++===0&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const t=e._propertyBindings;for(let n=0,r=t.length;n!==r;++n){const s=t[n];--s.useCount===0&&(s.restoreOriginalState(),this._takeBackBinding(s))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const t=e._cacheIndex;return t!==null&&t<this._nActiveActions}_addInactiveAction(e,t,n){const r=this._actions,s=this._actionsByClip;let a=s[t];if(a===void 0)a={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,s[t]=a;else{const c=a.knownActions;e._byClipCacheIndex=c.length,c.push(e)}e._cacheIndex=r.length,r.push(e),a.actionByRoot[n]=e}_removeInactiveAction(e){const t=this._actions,n=t[t.length-1],r=e._cacheIndex;n._cacheIndex=r,t[r]=n,t.pop(),e._cacheIndex=null;const s=e._clip.uuid,a=this._actionsByClip,c=a[s],d=c.knownActions,p=d[d.length-1],m=e._byClipCacheIndex;p._byClipCacheIndex=m,d[m]=p,d.pop(),e._byClipCacheIndex=null;const v=c.actionByRoot,_=(e._localRoot||this._root).uuid;delete v[_],d.length===0&&delete a[s],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const t=e._propertyBindings;for(let n=0,r=t.length;n!==r;++n){const s=t[n];--s.referenceCount===0&&this._removeInactiveBinding(s)}}_lendAction(e){const t=this._actions,n=e._cacheIndex,r=this._nActiveActions++,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=n,t[n]=s}_takeBackAction(e){const t=this._actions,n=e._cacheIndex,r=--this._nActiveActions,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=n,t[n]=s}_addInactiveBinding(e,t,n){const r=this._bindingsByRootAndName,s=this._bindings;let a=r[t];a===void 0&&(a={},r[t]=a),a[n]=e,e._cacheIndex=s.length,s.push(e)}_removeInactiveBinding(e){const t=this._bindings,n=e.binding,r=n.rootNode.uuid,s=n.path,a=this._bindingsByRootAndName,c=a[r],d=t[t.length-1],p=e._cacheIndex;d._cacheIndex=p,t[p]=d,t.pop(),delete c[s],Object.keys(c).length===0&&delete a[r]}_lendBinding(e){const t=this._bindings,n=e._cacheIndex,r=this._nActiveBindings++,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=n,t[n]=s}_takeBackBinding(e){const t=this._bindings,n=e._cacheIndex,r=--this._nActiveBindings,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=n,t[n]=s}_lendControlInterpolant(){const e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let n=e[t];return n===void 0&&(n=new pE(new Float32Array(2),new Float32Array(2),1,mL),n.__cacheIndex=t,e[t]=n),n}_takeBackControlInterpolant(e){const t=this._controlInterpolants,n=e.__cacheIndex,r=--this._nActiveControlInterpolants,s=t[r];e.__cacheIndex=r,t[r]=e,s.__cacheIndex=n,t[n]=s}clipAction(e,t,n){const r=t||this._root,s=r.uuid;let a=typeof e=="string"?Dg.findByName(r,e):e;const c=a!==null?a.uuid:e,d=this._actionsByClip[c];let p=null;if(n===void 0&&(a!==null?n=a.blendMode:n=cx),d!==void 0){const v=d.actionByRoot[s];if(v!==void 0&&v.blendMode===n)return v;p=d.knownActions[0],a===null&&(a=p._clip)}if(a===null)return null;const m=new bI(this,a,t,n);return this._bindAction(m,p),this._addInactiveAction(m,c,s),m}existingAction(e,t){const n=t||this._root,r=n.uuid,s=typeof e=="string"?Dg.findByName(n,e):e,a=s?s.uuid:e,c=this._actionsByClip[a];return c!==void 0&&c.actionByRoot[r]||null}stopAllAction(){const e=this._actions,t=this._nActiveActions;for(let n=t-1;n>=0;--n)e[n].stop();return this}update(e){e*=this.timeScale;const t=this._actions,n=this._nActiveActions,r=this.time+=e,s=Math.sign(e),a=this._accuIndex^=1;for(let p=0;p!==n;++p)t[p]._update(r,e,s,a);const c=this._bindings,d=this._nActiveBindings;for(let p=0;p!==d;++p)c[p].apply(a);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const t=this._actions,n=e.uuid,r=this._actionsByClip,s=r[n];if(s!==void 0){const a=s.knownActions;for(let c=0,d=a.length;c!==d;++c){const p=a[c];this._deactivateAction(p);const m=p._cacheIndex,v=t[t.length-1];p._cacheIndex=null,p._byClipCacheIndex=null,v._cacheIndex=m,t[m]=v,t.pop(),this._removeInactiveBindingsForAction(p)}delete r[n]}}uncacheRoot(e){const t=e.uuid,n=this._actionsByClip;for(const a in n){const c=n[a].actionByRoot,d=c[t];d!==void 0&&(this._deactivateAction(d),this._removeInactiveAction(d))}const r=this._bindingsByRootAndName,s=r[t];if(s!==void 0)for(const a in s){const c=s[a];c.restoreOriginalState(),this._removeInactiveBinding(c)}}uncacheAction(e,t){const n=this.existingAction(e,t);n!==null&&(this._deactivateAction(n),this._removeInactiveAction(n))}}class vL extends $M{constructor(e=1,t=1,n=1,r={}){super(e,t,r),this.isRenderTarget3D=!0,this.depth=n,this.texture=new px(null,e,t,n),this._setTextureOptions(r),this.texture.isRenderTargetTexture=!0}}class Ox{constructor(e){this.value=e}clone(){return new Ox(this.value.clone===void 0?this.value:this.value.clone())}}let yL=0;class _L extends Tl{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:yL++}),this.name="",this.usage=Mg,this.uniforms=[]}add(e){return this.uniforms.push(e),this}remove(e){const t=this.uniforms.indexOf(e);return t!==-1&&this.uniforms.splice(t,1),this}setName(e){return this.name=e,this}setUsage(e){return this.usage=e,this}dispose(){this.dispatchEvent({type:"dispose"})}copy(e){this.name=e.name,this.usage=e.usage;const t=e.uniforms;this.uniforms.length=0;for(let n=0,r=t.length;n<r;n++){const s=Array.isArray(t[n])?t[n]:[t[n]];for(let a=0;a<s.length;a++)this.uniforms.push(s[a].clone())}return this}clone(){return new this.constructor().copy(this)}}class V_ extends _x{constructor(e,t,n=1){super(e,t),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=n}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){const t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}class xL{constructor(e,t,n,r,s,a=!1){this.isGLBufferAttribute=!0,this.name="",this.buffer=e,this.type=t,this.itemSize=n,this.elementSize=r,this.count=s,this.normalized=a,this.version=0}set needsUpdate(e){e===!0&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,t){return this.type=e,this.elementSize=t,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}}const Q1=new an;class EE{constructor(e,t,n=0,r=1/0){this.ray=new ip(e,t),this.near=n,this.far=r,this.camera=null,this.layers=new Zh,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):Jt("Raycaster: Unsupported camera type: "+t.type)}setFromXRController(e){return Q1.identity().extractRotation(e.matrixWorld),this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(Q1),this}intersectObject(e,t=!0,n=[]){return aM(e,this,n,t),n.sort(j1),n}intersectObjects(e,t=!0,n=[]){for(let r=0,s=e.length;r<s;r++)aM(e[r],this,n,t);return n.sort(j1),n}}function j1(i,e){return i.distance-e.distance}function aM(i,e,t,n){let r=!0;if(i.layers.test(e.layers)&&i.raycast(e,t)===!1&&(r=!1),r===!0&&n===!0){const s=i.children;for(let a=0,c=s.length;a<c;a++)aM(s[a],e,t,!0)}}class SL{constructor(){this._previousTime=0,this._currentTime=0,this._startTime=performance.now(),this._delta=0,this._elapsed=0,this._timescale=1,this._document=null,this._pageVisibilityHandler=null}connect(e){this._document=e,e.hidden!==void 0&&(this._pageVisibilityHandler=bL.bind(this),e.addEventListener("visibilitychange",this._pageVisibilityHandler,!1))}disconnect(){this._pageVisibilityHandler!==null&&(this._document.removeEventListener("visibilitychange",this._pageVisibilityHandler),this._pageVisibilityHandler=null),this._document=null}getDelta(){return this._delta/1e3}getElapsed(){return this._elapsed/1e3}getTimescale(){return this._timescale}setTimescale(e){return this._timescale=e,this}reset(){return this._currentTime=performance.now()-this._startTime,this}dispose(){this.disconnect()}update(e){return this._pageVisibilityHandler!==null&&this._document.hidden===!0?this._delta=0:(this._previousTime=this._currentTime,this._currentTime=(e!==void 0?e:performance.now())-this._startTime,this._delta=(this._currentTime-this._previousTime)*this._timescale,this._elapsed+=this._delta),this}}function bL(){this._document.hidden===!1&&this.reset()}class ML{constructor(e=1,t=0,n=0){this.radius=e,this.phi=t,this.theta=n}set(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=on(this.phi,1e-6,Math.PI-1e-6),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+t*t+n*n),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos(on(t/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class EL{constructor(e=1,t=0,n=0){this.radius=e,this.theta=t,this.y=n}set(e,t,n){return this.radius=e,this.theta=t,this.y=n,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+n*n),this.theta=Math.atan2(e,n),this.y=t,this}clone(){return new this.constructor().copy(this)}}class TE{constructor(e,t,n,r){TE.prototype.isMatrix2=!0,this.elements=[1,0,0,1],e!==void 0&&this.set(e,t,n,r)}identity(){return this.set(1,0,0,1),this}fromArray(e,t=0){for(let n=0;n<4;n++)this.elements[n]=e[n+t];return this}set(e,t,n,r){const s=this.elements;return s[0]=e,s[2]=t,s[1]=n,s[3]=r,this}}const eA=new $e;class TL{constructor(e=new $e(1/0,1/0),t=new $e(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=eA.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,eA).distanceTo(e)}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const tA=new Q,Sy=new Q,Ah=new Q,wh=new Q,yb=new Q,AL=new Q,wL=new Q;class MI{constructor(e=new Q,t=new Q){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){tA.subVectors(e,this.start),Sy.subVectors(this.end,this.start);const n=Sy.dot(Sy);let s=Sy.dot(tA)/n;return t&&(s=on(s,0,1)),s}closestPointToPoint(e,t,n){const r=this.closestPointToPointParameter(e,t);return this.delta(n).multiplyScalar(r).add(this.start)}distanceSqToLine3(e,t=AL,n=wL){const r=10000000000000001e-32;let s,a;const c=this.start,d=e.start,p=this.end,m=e.end;Ah.subVectors(p,c),wh.subVectors(m,d),yb.subVectors(c,d);const v=Ah.dot(Ah),_=wh.dot(wh),b=wh.dot(yb);if(v<=r&&_<=r)return t.copy(c),n.copy(d),t.sub(n),t.dot(t);if(v<=r)s=0,a=b/_,a=on(a,0,1);else{const T=Ah.dot(yb);if(_<=r)a=0,s=on(-T/v,0,1);else{const I=Ah.dot(wh),C=v*_-I*I;C!==0?s=on((I*b-T*_)/C,0,1):s=0,a=(I*s+b)/_,a<0?(a=0,s=on(-T/v,0,1)):a>1&&(a=1,s=on((I-T)/v,0,1))}}return t.copy(c).add(Ah.multiplyScalar(s)),n.copy(d).add(wh.multiplyScalar(a)),t.sub(n),t.dot(t)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}const nA=new Q;class CL extends Kn{constructor(e,t){super(),this.light=e,this.matrixAutoUpdate=!1,this.color=t,this.type="SpotLightHelper";const n=new vn,r=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let a=0,c=1,d=32;a<d;a++,c++){const p=a/d*Math.PI*2,m=c/d*Math.PI*2;r.push(Math.cos(p),Math.sin(p),1,Math.cos(m),Math.sin(m),1)}n.setAttribute("position",new zt(r,3));const s=new Fs({fog:!1,toneMapped:!1});this.cone=new Al(n,s),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),this.parent?(this.parent.updateWorldMatrix(!0),this.matrix.copy(this.parent.matrixWorld).invert().multiply(this.light.matrixWorld)):this.matrix.copy(this.light.matrixWorld),this.matrixWorld.copy(this.light.matrixWorld);const e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),nA.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(nA),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const pc=new Q,by=new an,_b=new an;class RL extends Al{constructor(e){const t=EI(e),n=new vn,r=[],s=[];for(let p=0;p<t.length;p++){const m=t[p];m.parent&&m.parent.isBone&&(r.push(0,0,0),r.push(0,0,0),s.push(0,0,0),s.push(0,0,0))}n.setAttribute("position",new zt(r,3)),n.setAttribute("color",new zt(s,3));const a=new Fs({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(n,a),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1;const c=new Pt(255),d=new Pt(65280);this.setColors(c,d)}updateMatrixWorld(e){const t=this.bones,n=this.geometry,r=n.getAttribute("position");_b.copy(this.root.matrixWorld).invert();for(let s=0,a=0;s<t.length;s++){const c=t[s];c.parent&&c.parent.isBone&&(by.multiplyMatrices(_b,c.matrixWorld),pc.setFromMatrixPosition(by),r.setXYZ(a,pc.x,pc.y,pc.z),by.multiplyMatrices(_b,c.parent.matrixWorld),pc.setFromMatrixPosition(by),r.setXYZ(a+1,pc.x,pc.y,pc.z),a+=2)}n.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}setColors(e,t){const r=this.geometry.getAttribute("color");for(let s=0;s<r.count;s+=2)r.setXYZ(s,e.r,e.g,e.b),r.setXYZ(s+1,t.r,t.g,t.b);return r.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}function EI(i){const e=[];i.isBone===!0&&e.push(i);for(let t=0;t<i.children.length;t++)e.push(...EI(i.children[t]));return e}class IL extends Di{constructor(e,t,n){const r=new Yg(t,4,2),s=new mu({wireframe:!0,fog:!1,toneMapped:!1});super(r,s),this.light=e,this.color=n,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const NL=new Q,iA=new Pt,rA=new Pt;class DL extends Kn{constructor(e,t,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="HemisphereLightHelper";const r=new Xg(t);r.rotateY(Math.PI*.5),this.material=new mu({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const s=r.getAttribute("position"),a=new Float32Array(s.count*3);r.setAttribute("color",new pi(a,3)),this.add(new Di(r,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const t=e.geometry.getAttribute("color");iA.copy(this.light.color),rA.copy(this.light.groundColor);for(let n=0,r=t.count;n<r;n++){const s=n<r/2?iA:rA;t.setXYZ(n,s.r,s.g,s.b)}t.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),e.lookAt(NL.setFromMatrixPosition(this.light.matrixWorld).negate())}}class UL extends Al{constructor(e=10,t=10,n=4473924,r=8947848){n=new Pt(n),r=new Pt(r);const s=t/2,a=e/t,c=e/2,d=[],p=[];for(let _=0,b=0,T=-c;_<=t;_++,T+=a){d.push(-c,0,T,c,0,T),d.push(T,0,-c,T,0,c);const I=_===s?n:r;I.toArray(p,b),b+=3,I.toArray(p,b),b+=3,I.toArray(p,b),b+=3,I.toArray(p,b),b+=3}const m=new vn;m.setAttribute("position",new zt(d,3)),m.setAttribute("color",new zt(p,3));const v=new Fs({vertexColors:!0,toneMapped:!1});super(m,v),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class PL extends Al{constructor(e=10,t=16,n=8,r=64,s=4473924,a=8947848){s=new Pt(s),a=new Pt(a);const c=[],d=[];if(t>1)for(let v=0;v<t;v++){const _=v/t*(Math.PI*2),b=Math.sin(_)*e,T=Math.cos(_)*e;c.push(0,0,0),c.push(b,0,T);const I=v&1?s:a;d.push(I.r,I.g,I.b),d.push(I.r,I.g,I.b)}for(let v=0;v<n;v++){const _=v&1?s:a,b=e-e/n*v;for(let T=0;T<r;T++){let I=T/r*(Math.PI*2),C=Math.sin(I)*b,A=Math.cos(I)*b;c.push(C,0,A),d.push(_.r,_.g,_.b),I=(T+1)/r*(Math.PI*2),C=Math.sin(I)*b,A=Math.cos(I)*b,c.push(C,0,A),d.push(_.r,_.g,_.b)}}const p=new vn;p.setAttribute("position",new zt(c,3)),p.setAttribute("color",new zt(d,3));const m=new Fs({vertexColors:!0,toneMapped:!1});super(p,m),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}const sA=new Q,My=new Q,oA=new Q;class LL extends Kn{constructor(e,t,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="DirectionalLightHelper",t===void 0&&(t=1);let r=new vn;r.setAttribute("position",new zt([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));const s=new Fs({fog:!1,toneMapped:!1});this.lightPlane=new Tc(r,s),this.add(this.lightPlane),r=new vn,r.setAttribute("position",new zt([0,0,0,0,0,1],3)),this.targetLine=new Tc(r,s),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),sA.setFromMatrixPosition(this.light.matrixWorld),My.setFromMatrixPosition(this.light.target.matrixWorld),oA.subVectors(My,sA),this.lightPlane.lookAt(My),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(My),this.targetLine.scale.z=oA.length()}}const Ey=new Q,Ki=new mx;class FL extends Al{constructor(e){const t=new vn,n=new Fs({color:16777215,vertexColors:!0,toneMapped:!1}),r=[],s=[],a={};c("n1","n2"),c("n2","n4"),c("n4","n3"),c("n3","n1"),c("f1","f2"),c("f2","f4"),c("f4","f3"),c("f3","f1"),c("n1","f1"),c("n2","f2"),c("n3","f3"),c("n4","f4"),c("p","n1"),c("p","n2"),c("p","n3"),c("p","n4"),c("u1","u2"),c("u2","u3"),c("u3","u1"),c("c","t"),c("p","c"),c("cn1","cn2"),c("cn3","cn4"),c("cf1","cf2"),c("cf3","cf4");function c(T,I){d(T),d(I)}function d(T){r.push(0,0,0),s.push(0,0,0),a[T]===void 0&&(a[T]=[]),a[T].push(r.length/3-1)}t.setAttribute("position",new zt(r,3)),t.setAttribute("color",new zt(s,3)),super(t,n),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=a,this.update();const p=new Pt(16755200),m=new Pt(16711680),v=new Pt(43775),_=new Pt(16777215),b=new Pt(3355443);this.setColors(p,m,v,_,b)}setColors(e,t,n,r,s){const c=this.geometry.getAttribute("color");return c.setXYZ(0,e.r,e.g,e.b),c.setXYZ(1,e.r,e.g,e.b),c.setXYZ(2,e.r,e.g,e.b),c.setXYZ(3,e.r,e.g,e.b),c.setXYZ(4,e.r,e.g,e.b),c.setXYZ(5,e.r,e.g,e.b),c.setXYZ(6,e.r,e.g,e.b),c.setXYZ(7,e.r,e.g,e.b),c.setXYZ(8,e.r,e.g,e.b),c.setXYZ(9,e.r,e.g,e.b),c.setXYZ(10,e.r,e.g,e.b),c.setXYZ(11,e.r,e.g,e.b),c.setXYZ(12,e.r,e.g,e.b),c.setXYZ(13,e.r,e.g,e.b),c.setXYZ(14,e.r,e.g,e.b),c.setXYZ(15,e.r,e.g,e.b),c.setXYZ(16,e.r,e.g,e.b),c.setXYZ(17,e.r,e.g,e.b),c.setXYZ(18,e.r,e.g,e.b),c.setXYZ(19,e.r,e.g,e.b),c.setXYZ(20,e.r,e.g,e.b),c.setXYZ(21,e.r,e.g,e.b),c.setXYZ(22,e.r,e.g,e.b),c.setXYZ(23,e.r,e.g,e.b),c.setXYZ(24,t.r,t.g,t.b),c.setXYZ(25,t.r,t.g,t.b),c.setXYZ(26,t.r,t.g,t.b),c.setXYZ(27,t.r,t.g,t.b),c.setXYZ(28,t.r,t.g,t.b),c.setXYZ(29,t.r,t.g,t.b),c.setXYZ(30,t.r,t.g,t.b),c.setXYZ(31,t.r,t.g,t.b),c.setXYZ(32,n.r,n.g,n.b),c.setXYZ(33,n.r,n.g,n.b),c.setXYZ(34,n.r,n.g,n.b),c.setXYZ(35,n.r,n.g,n.b),c.setXYZ(36,n.r,n.g,n.b),c.setXYZ(37,n.r,n.g,n.b),c.setXYZ(38,r.r,r.g,r.b),c.setXYZ(39,r.r,r.g,r.b),c.setXYZ(40,s.r,s.g,s.b),c.setXYZ(41,s.r,s.g,s.b),c.setXYZ(42,s.r,s.g,s.b),c.setXYZ(43,s.r,s.g,s.b),c.setXYZ(44,s.r,s.g,s.b),c.setXYZ(45,s.r,s.g,s.b),c.setXYZ(46,s.r,s.g,s.b),c.setXYZ(47,s.r,s.g,s.b),c.setXYZ(48,s.r,s.g,s.b),c.setXYZ(49,s.r,s.g,s.b),c.needsUpdate=!0,this}update(){const e=this.geometry,t=this.pointMap,n=1,r=1;let s,a;if(Ki.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),this.camera.reversedDepth===!0)s=1,a=0;else if(this.camera.coordinateSystem===yo)s=-1,a=1;else if(this.camera.coordinateSystem===Xh)s=0,a=1;else throw new Error("THREE.CameraHelper.update(): Invalid coordinate system: "+this.camera.coordinateSystem);ar("c",t,e,Ki,0,0,s),ar("t",t,e,Ki,0,0,a),ar("n1",t,e,Ki,-n,-r,s),ar("n2",t,e,Ki,n,-r,s),ar("n3",t,e,Ki,-n,r,s),ar("n4",t,e,Ki,n,r,s),ar("f1",t,e,Ki,-n,-r,a),ar("f2",t,e,Ki,n,-r,a),ar("f3",t,e,Ki,-n,r,a),ar("f4",t,e,Ki,n,r,a),ar("u1",t,e,Ki,n*.7,r*1.1,s),ar("u2",t,e,Ki,-n*.7,r*1.1,s),ar("u3",t,e,Ki,0,r*2,s),ar("cf1",t,e,Ki,-n,0,a),ar("cf2",t,e,Ki,n,0,a),ar("cf3",t,e,Ki,0,-r,a),ar("cf4",t,e,Ki,0,r,a),ar("cn1",t,e,Ki,-n,0,s),ar("cn2",t,e,Ki,n,0,s),ar("cn3",t,e,Ki,0,-r,s),ar("cn4",t,e,Ki,0,r,s),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function ar(i,e,t,n,r,s,a){Ey.set(r,s,a).unproject(n);const c=e[i];if(c!==void 0){const d=t.getAttribute("position");for(let p=0,m=c.length;p<m;p++)d.setXYZ(c[p],Ey.x,Ey.y,Ey.z)}}const Ty=new Er;class kL extends Al{constructor(e,t=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new Float32Array(24),s=new vn;s.setIndex(new pi(n,1)),s.setAttribute("position",new pi(r,3)),super(s,new Fs({color:t,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(){if(this.object!==void 0&&Ty.setFromObject(this.object),Ty.isEmpty())return;const e=Ty.min,t=Ty.max,n=this.geometry.attributes.position,r=n.array;r[0]=t.x,r[1]=t.y,r[2]=t.z,r[3]=e.x,r[4]=t.y,r[5]=t.z,r[6]=e.x,r[7]=e.y,r[8]=t.z,r[9]=t.x,r[10]=e.y,r[11]=t.z,r[12]=t.x,r[13]=t.y,r[14]=e.z,r[15]=e.x,r[16]=t.y,r[17]=e.z,r[18]=e.x,r[19]=e.y,r[20]=e.z,r[21]=t.x,r[22]=e.y,r[23]=e.z,n.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e,t){return super.copy(e,t),this.object=e.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class OL extends Al{constructor(e,t=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],s=new vn;s.setIndex(new pi(n,1)),s.setAttribute("position",new zt(r,3)),super(s,new Fs({color:t,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}}class zL extends Tc{constructor(e,t=1,n=16776960){const r=n,s=[1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],a=new vn;a.setAttribute("position",new zt(s,3)),a.computeBoundingSphere(),super(a,new Fs({color:r,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=t;const c=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],d=new vn;d.setAttribute("position",new zt(c,3)),d.computeBoundingSphere(),this.add(new Di(d,new mu({color:r,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const aA=new Q;let Ay,xb;class BL extends Kn{constructor(e=new Q(0,0,1),t=new Q(0,0,0),n=1,r=16776960,s=n*.2,a=s*.2){super(),this.type="ArrowHelper",Ay===void 0&&(Ay=new vn,Ay.setAttribute("position",new zt([0,0,0,0,1,0],3)),xb=new qg(.5,1,5,1),xb.translate(0,-.5,0)),this.position.copy(t),this.line=new Tc(Ay,new Fs({color:r,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Di(xb,new mu({color:r,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(n,s,a)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{aA.set(e.z,0,-e.x).normalize();const t=Math.acos(e.y);this.quaternion.setFromAxisAngle(aA,t)}}setLength(e,t=e*.2,n=t*.2){this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(n,t,n),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class VL extends Al{constructor(e=1){const t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],n=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],r=new vn;r.setAttribute("position",new zt(t,3)),r.setAttribute("color",new zt(n,3));const s=new Fs({vertexColors:!0,toneMapped:!1});super(r,s),this.type="AxesHelper"}setColors(e,t,n){const r=new Pt,s=this.geometry.attributes.color.array;return r.set(e),r.toArray(s,0),r.toArray(s,3),r.set(t),r.toArray(s,6),r.toArray(s,9),r.set(n),r.toArray(s,12),r.toArray(s,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class HL{constructor(){this.type="ShapePath",this.color=new Pt,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new B_,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,n,r){return this.currentPath.quadraticCurveTo(e,t,n,r),this}bezierCurveTo(e,t,n,r,s,a){return this.currentPath.bezierCurveTo(e,t,n,r,s,a),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function t(A){const D=[];for(let U=0,L=A.length;U<L;U++){const z=A[U],B=new Vf;B.curves=z.curves,D.push(B)}return D}function n(A,D){const U=D.length;let L=!1;for(let z=U-1,B=0;B<U;z=B++){let k=D[z],G=D[B],P=G.x-k.x,O=G.y-k.y;if(Math.abs(O)>Number.EPSILON){if(O<0&&(k=D[B],P=-P,G=D[z],O=-O),A.y<k.y||A.y>G.y)continue;if(A.y===k.y){if(A.x===k.x)return!0}else{const Z=O*(A.x-k.x)-P*(A.y-k.y);if(Z===0)return!0;if(Z<0)continue;L=!L}}else{if(A.y!==k.y)continue;if(G.x<=A.x&&A.x<=k.x||k.x<=A.x&&A.x<=G.x)return!0}}return L}const r=Ra.isClockWise,s=this.subPaths;if(s.length===0)return[];let a,c,d;const p=[];if(s.length===1)return c=s[0],d=new Vf,d.curves=c.curves,p.push(d),p;let m=!r(s[0].getPoints());m=e?!m:m;const v=[],_=[];let b=[],T=0,I;_[T]=void 0,b[T]=[];for(let A=0,D=s.length;A<D;A++)c=s[A],I=c.getPoints(),a=r(I),a=e?!a:a,a?(!m&&_[T]&&T++,_[T]={s:new Vf,p:I},_[T].s.curves=c.curves,m&&T++,b[T]=[]):b[T].push({h:c,p:I[0]});if(!_[0])return t(s);if(_.length>1){let A=!1,D=0;for(let U=0,L=_.length;U<L;U++)v[U]=[];for(let U=0,L=_.length;U<L;U++){const z=b[U];for(let B=0;B<z.length;B++){const k=z[B];let G=!0;for(let P=0;P<_.length;P++)n(k.p,_[P].p)&&(U!==P&&D++,G?(G=!1,v[P].push(k)):A=!0);G&&v[U].push(k)}}D>0&&A===!1&&(b=v)}let C;for(let A=0,D=_.length;A<D;A++){d=_[A].s,p.push(d),C=b[A];for(let U=0,L=C.length;U<L;U++)d.holes.push(C[U].h)}return p}}class GL extends Tl{constructor(e,t=null){super(),this.object=e,this.domElement=t,this.enabled=!0,this.state=-1,this.keys={},this.mouseButtons={LEFT:null,MIDDLE:null,RIGHT:null},this.touches={ONE:null,TWO:null}}connect(e){if(e===void 0){It("Controls: connect() now requires an element.");return}this.domElement!==null&&this.disconnect(),this.domElement=e}disconnect(){}dispose(){}update(){}}function qL(i,e){const t=i.image&&i.image.width?i.image.width/i.image.height:1;return t>e?(i.repeat.x=1,i.repeat.y=t/e,i.offset.x=0,i.offset.y=(1-i.repeat.y)/2):(i.repeat.x=e/t,i.repeat.y=1,i.offset.x=(1-i.repeat.x)/2,i.offset.y=0),i}function WL(i,e){const t=i.image&&i.image.width?i.image.width/i.image.height:1;return t>e?(i.repeat.x=e/t,i.repeat.y=1,i.offset.x=(1-i.repeat.x)/2,i.offset.y=0):(i.repeat.x=1,i.repeat.y=t/e,i.offset.x=0,i.offset.y=(1-i.repeat.y)/2),i}function XL(i){return i.repeat.x=1,i.repeat.y=1,i.offset.x=0,i.offset.y=0,i}function lM(i,e,t,n){const r=YL(n);switch(t){case XM:return i*e;case zg:return i*e/r.components*r.byteLength;case Bg:return i*e/r.components*r.byteLength;case qf:return i*e*2/r.components*r.byteLength;case lx:return i*e*2/r.components*r.byteLength;case YM:return i*e*3/r.components*r.byteLength;case ur:return i*e*4/r.components*r.byteLength;case ux:return i*e*4/r.components*r.byteLength;case og:case ag:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*8;case lg:case ug:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*16;case s_:case a_:return Math.max(i,16)*Math.max(e,8)/4;case r_:case o_:return Math.max(i,8)*Math.max(e,8)/2;case l_:case u_:case f_:case d_:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*8;case c_:case h_:case p_:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*16;case m_:return Math.floor((i+3)/4)*Math.floor((e+3)/4)*16;case g_:return Math.floor((i+4)/5)*Math.floor((e+3)/4)*16;case v_:return Math.floor((i+4)/5)*Math.floor((e+4)/5)*16;case y_:return Math.floor((i+5)/6)*Math.floor((e+4)/5)*16;case __:return Math.floor((i+5)/6)*Math.floor((e+5)/6)*16;case x_:return Math.floor((i+7)/8)*Math.floor((e+4)/5)*16;case S_:return Math.floor((i+7)/8)*Math.floor((e+5)/6)*16;case b_:return Math.floor((i+7)/8)*Math.floor((e+7)/8)*16;case M_:return Math.floor((i+9)/10)*Math.floor((e+4)/5)*16;case E_:return Math.floor((i+9)/10)*Math.floor((e+5)/6)*16;case T_:return Math.floor((i+9)/10)*Math.floor((e+7)/8)*16;case A_:return Math.floor((i+9)/10)*Math.floor((e+9)/10)*16;case w_:return Math.floor((i+11)/12)*Math.floor((e+9)/10)*16;case C_:return Math.floor((i+11)/12)*Math.floor((e+11)/12)*16;case R_:case I_:case N_:return Math.ceil(i/4)*Math.ceil(e/4)*16;case D_:case U_:return Math.ceil(i/4)*Math.ceil(e/4)*8;case P_:case L_:return Math.ceil(i/4)*Math.ceil(e/4)*16}throw new Error(`Unable to determine texture byte length for ${t} format.`)}function YL(i){switch(i){case kr:case rx:return{byteLength:1,components:1};case qh:case sx:case Wi:return{byteLength:2,components:1};case ox:case ax:return{byteLength:2,components:4};case Mo:case Og:case Ni:return{byteLength:4,components:1};case qM:case WM:return{byteLength:4,components:3}}throw new Error(`Unknown texture type ${i}.`)}class JL{static contain(e,t){return qL(e,t)}static cover(e,t){return WL(e,t)}static fill(e){return XL(e)}static getByteLength(e,t,n,r){return lM(e,t,n,r)}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:tp}}));typeof window<"u"&&(window.__THREE__?It("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=tp);/**
 * @license
 * Copyright 2010-2025 Three.js Authors
 * SPDX-License-Identifier: MIT
 */function TI(){let i=null,e=!1,t=null,n=null;function r(s,a){t(s,a),n=i.requestAnimationFrame(r)}return{start:function(){e!==!0&&t!==null&&(n=i.requestAnimationFrame(r),e=!0)},stop:function(){i.cancelAnimationFrame(n),e=!1},setAnimationLoop:function(s){t=s},setContext:function(s){i=s}}}function ZL(i){const e=new WeakMap;function t(c,d){const p=c.array,m=c.usage,v=p.byteLength,_=i.createBuffer();i.bindBuffer(d,_),i.bufferData(d,p,m),c.onUploadCallback();let b;if(p instanceof Float32Array)b=i.FLOAT;else if(typeof Float16Array<"u"&&p instanceof Float16Array)b=i.HALF_FLOAT;else if(p instanceof Uint16Array)c.isFloat16BufferAttribute?b=i.HALF_FLOAT:b=i.UNSIGNED_SHORT;else if(p instanceof Int16Array)b=i.SHORT;else if(p instanceof Uint32Array)b=i.UNSIGNED_INT;else if(p instanceof Int32Array)b=i.INT;else if(p instanceof Int8Array)b=i.BYTE;else if(p instanceof Uint8Array)b=i.UNSIGNED_BYTE;else if(p instanceof Uint8ClampedArray)b=i.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+p);return{buffer:_,type:b,bytesPerElement:p.BYTES_PER_ELEMENT,version:c.version,size:v}}function n(c,d,p){const m=d.array,v=d.updateRanges;if(i.bindBuffer(p,c),v.length===0)i.bufferSubData(p,0,m);else{v.sort((b,T)=>b.start-T.start);let _=0;for(let b=1;b<v.length;b++){const T=v[_],I=v[b];I.start<=T.start+T.count+1?T.count=Math.max(T.count,I.start+I.count-T.start):(++_,v[_]=I)}v.length=_+1;for(let b=0,T=v.length;b<T;b++){const I=v[b];i.bufferSubData(p,I.start*m.BYTES_PER_ELEMENT,m,I.start,I.count)}d.clearUpdateRanges()}d.onUploadCallback()}function r(c){return c.isInterleavedBufferAttribute&&(c=c.data),e.get(c)}function s(c){c.isInterleavedBufferAttribute&&(c=c.data);const d=e.get(c);d&&(i.deleteBuffer(d.buffer),e.delete(c))}function a(c,d){if(c.isInterleavedBufferAttribute&&(c=c.data),c.isGLBufferAttribute){const m=e.get(c);(!m||m.version<c.version)&&e.set(c,{buffer:c.buffer,type:c.type,bytesPerElement:c.elementSize,version:c.version});return}const p=e.get(c);if(p===void 0)e.set(c,t(c,d));else if(p.version<c.version){if(p.size!==c.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");n(p.buffer,c,d),p.version=c.version}}return{get:r,remove:s,update:a}}var $L=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,KL=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,QL=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,jL=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,eF=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,tF=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,nF=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,iF=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,rF=`#ifdef USE_BATCHING
	#if ! defined( GL_ANGLE_multi_draw )
	#define gl_DrawID _gl_DrawID
	uniform int _gl_DrawID;
	#endif
	uniform highp sampler2D batchingTexture;
	uniform highp usampler2D batchingIdTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
	float getIndirectIndex( const in int i ) {
		int size = textureSize( batchingIdTexture, 0 ).x;
		int x = i % size;
		int y = i / size;
		return float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );
	}
#endif
#ifdef USE_BATCHING_COLOR
	uniform sampler2D batchingColorTexture;
	vec3 getBatchingColor( const in float i ) {
		int size = textureSize( batchingColorTexture, 0 ).x;
		int j = int( i );
		int x = j % size;
		int y = j / size;
		return texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;
	}
#endif`,sF=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );
#endif`,oF=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,aF=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,lF=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,uF=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,cF=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,fF=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,dF=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,hF=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,pF=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,mF=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,gF=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,vF=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	varying vec3 vColor;
#endif`,yF=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif
#ifdef USE_BATCHING_COLOR
	vec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );
	vColor.xyz *= batchingColor.xyz;
#endif`,_F=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,xF=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,SF=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,bF=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,MF=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,EF=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	#ifdef DECODE_VIDEO_TEXTURE_EMISSIVE
		emissiveColor = sRGBTransferEOTF( emissiveColor );
	#endif
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,TF=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,AF="gl_FragColor = linearToOutputTexel( gl_FragColor );",wF=`vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferEOTF( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,CF=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,RF=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform mat3 envMapRotation;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
#endif`,IF=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,NF=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,DF=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,UF=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,PF=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,LF=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,FF=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,kF=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,OF=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,zF=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,BF=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,VF=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if ( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,HF=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, pow4( roughness ) ) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,GF=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,qF=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,WF=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,XF=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,YF=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.diffuseContribution = diffuseColor.rgb * ( 1.0 - metalnessFactor );
material.metalness = metalnessFactor;
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor;
	material.specularColorBlended = mix( material.specularColor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = vec3( 0.04 );
	material.specularColorBlended = mix( material.specularColor, diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_DISPERSION
	material.dispersion = dispersion;
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.0001, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,JF=`uniform sampler2D dfgLUT;
struct PhysicalMaterial {
	vec3 diffuseColor;
	vec3 diffuseContribution;
	vec3 specularColor;
	vec3 specularColorBlended;
	float roughness;
	float metalness;
	float specularF90;
	float dispersion;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
		vec3 iridescenceFresnelDielectric;
		vec3 iridescenceFresnelMetallic;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return v;
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColorBlended;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transpose( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float rInv = 1.0 / ( roughness + 0.1 );
	float a = -1.9362 + 1.0678 * roughness + 0.4573 * r2 - 0.8469 * rInv;
	float b = -0.6014 + 0.5538 * roughness - 0.4670 * r2 - 0.1255 * rInv;
	float DG = exp( a * dotNV + b );
	return saturate( DG );
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	vec2 fab = texture2D( dfgLUT, vec2( roughness, dotNV ) ).rg;
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	float dotNV = saturate( dot( normal, viewDir ) );
	vec2 fab = texture2D( dfgLUT, vec2( roughness, dotNV ) ).rg;
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
vec3 BRDF_GGX_Multiscatter( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 singleScatter = BRDF_GGX( lightDir, viewDir, normal, material );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	vec2 dfgV = texture2D( dfgLUT, vec2( material.roughness, dotNV ) ).rg;
	vec2 dfgL = texture2D( dfgLUT, vec2( material.roughness, dotNL ) ).rg;
	vec3 FssEss_V = material.specularColorBlended * dfgV.x + material.specularF90 * dfgV.y;
	vec3 FssEss_L = material.specularColorBlended * dfgL.x + material.specularF90 * dfgL.y;
	float Ess_V = dfgV.x + dfgV.y;
	float Ess_L = dfgL.x + dfgL.y;
	float Ems_V = 1.0 - Ess_V;
	float Ems_L = 1.0 - Ess_L;
	vec3 Favg = material.specularColorBlended + ( 1.0 - material.specularColorBlended ) * 0.047619;
	vec3 Fms = FssEss_V * FssEss_L * Favg / ( 1.0 - Ems_V * Ems_L * Favg + EPSILON );
	float compensationFactor = Ems_V * Ems_L;
	vec3 multiScatter = Fms * compensationFactor;
	return singleScatter + multiScatter;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColorBlended * t2.x + ( vec3( 1.0 ) - material.specularColorBlended ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseContribution * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
 
 		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
 
 		float sheenAlbedoV = IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
 		float sheenAlbedoL = IBLSheenBRDF( geometryNormal, directLight.direction, material.sheenRoughness );
 
 		float sheenEnergyComp = 1.0 - max3( material.sheenColor ) * max( sheenAlbedoV, sheenAlbedoL );
 
 		irradiance *= sheenEnergyComp;
 
 	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX_Multiscatter( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseContribution );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 diffuse = irradiance * BRDF_Lambert( material.diffuseContribution );
	#ifdef USE_SHEEN
		float sheenAlbedo = IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
		float sheenEnergyComp = 1.0 - max3( material.sheenColor ) * sheenAlbedo;
		diffuse *= sheenEnergyComp;
	#endif
	reflectedLight.indirectDiffuse += diffuse;
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness ) * RECIPROCAL_PI;
 	#endif
	vec3 singleScatteringDielectric = vec3( 0.0 );
	vec3 multiScatteringDielectric = vec3( 0.0 );
	vec3 singleScatteringMetallic = vec3( 0.0 );
	vec3 multiScatteringMetallic = vec3( 0.0 );
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnelDielectric, material.roughness, singleScatteringDielectric, multiScatteringDielectric );
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.diffuseColor, material.specularF90, material.iridescence, material.iridescenceFresnelMetallic, material.roughness, singleScatteringMetallic, multiScatteringMetallic );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScatteringDielectric, multiScatteringDielectric );
		computeMultiscattering( geometryNormal, geometryViewDir, material.diffuseColor, material.specularF90, material.roughness, singleScatteringMetallic, multiScatteringMetallic );
	#endif
	vec3 singleScattering = mix( singleScatteringDielectric, singleScatteringMetallic, material.metalness );
	vec3 multiScattering = mix( multiScatteringDielectric, multiScatteringMetallic, material.metalness );
	vec3 totalScatteringDielectric = singleScatteringDielectric + multiScatteringDielectric;
	vec3 diffuse = material.diffuseContribution * ( 1.0 - totalScatteringDielectric );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	vec3 indirectSpecular = radiance * singleScattering;
	indirectSpecular += multiScattering * cosineWeightedIrradiance;
	vec3 indirectDiffuse = diffuse * cosineWeightedIrradiance;
	#ifdef USE_SHEEN
		float sheenAlbedo = IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
		float sheenEnergyComp = 1.0 - max3( material.sheenColor ) * sheenAlbedo;
		indirectSpecular *= sheenEnergyComp;
		indirectDiffuse *= sheenEnergyComp;
	#endif
	reflectedLight.indirectSpecular += indirectSpecular;
	reflectedLight.indirectDiffuse += indirectDiffuse;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,ZF=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnelDielectric = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceFresnelMetallic = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.diffuseColor );
		material.iridescenceFresnel = mix( material.iridescenceFresnelDielectric, material.iridescenceFresnelMetallic, material.metalness );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS ) && ( defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_BASIC ) )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,$F=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,KF=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,QF=`#if defined( USE_LOGARITHMIC_DEPTH_BUFFER )
	gl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,jF=`#if defined( USE_LOGARITHMIC_DEPTH_BUFFER )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,ek=`#ifdef USE_LOGARITHMIC_DEPTH_BUFFER
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,tk=`#ifdef USE_LOGARITHMIC_DEPTH_BUFFER
	vFragDepth = 1.0 + gl_Position.w;
	vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
#endif`,nk=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = sRGBTransferEOTF( sampledDiffuseColor );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,ik=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,rk=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,sk=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,ok=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,ak=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,lk=`#ifdef USE_INSTANCING_MORPH
	float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;
	}
#endif`,uk=`#if defined( USE_MORPHCOLORS )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,ck=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,fk=`#ifdef USE_MORPHTARGETS
	#ifndef USE_INSTANCING_MORPH
		uniform float morphTargetBaseInfluence;
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	#endif
	uniform sampler2DArray morphTargetsTexture;
	uniform ivec2 morphTargetsTextureSize;
	vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
		int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
		int y = texelIndex / morphTargetsTextureSize.x;
		int x = texelIndex - y * morphTargetsTextureSize.x;
		ivec3 morphUV = ivec3( x, y, morphTargetIndex );
		return texelFetch( morphTargetsTexture, morphUV, 0 );
	}
#endif`,dk=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,hk=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,pk=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,mk=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,gk=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,vk=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,yk=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,_k=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,xk=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,Sk=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,bk=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,Mk=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,Ek=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;
const float Inv255 = 1. / 255.;
const vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );
const vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );
const vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );
const vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );
vec4 packDepthToRGBA( const in float v ) {
	if( v <= 0.0 )
		return vec4( 0., 0., 0., 0. );
	if( v >= 1.0 )
		return vec4( 1., 1., 1., 1. );
	float vuf;
	float af = modf( v * PackFactors.a, vuf );
	float bf = modf( vuf * ShiftRight8, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );
}
vec3 packDepthToRGB( const in float v ) {
	if( v <= 0.0 )
		return vec3( 0., 0., 0. );
	if( v >= 1.0 )
		return vec3( 1., 1., 1. );
	float vuf;
	float bf = modf( v * PackFactors.b, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec3( vuf * Inv255, gf * PackUpscale, bf );
}
vec2 packDepthToRG( const in float v ) {
	if( v <= 0.0 )
		return vec2( 0., 0. );
	if( v >= 1.0 )
		return vec2( 1., 1. );
	float vuf;
	float gf = modf( v * 256., vuf );
	return vec2( vuf * Inv255, gf );
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors4 );
}
float unpackRGBToDepth( const in vec3 v ) {
	return dot( v, UnpackFactors3 );
}
float unpackRGToDepth( const in vec2 v ) {
	return v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;
}
vec4 pack2HalfToRGBA( const in vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( const in vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,Tk=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,Ak=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,wk=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,Ck=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,Rk=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,Ik=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,Nk=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#if defined( SHADOWMAP_TYPE_PCF )
			uniform sampler2DShadow directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		#else
			uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		#endif
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		#if defined( SHADOWMAP_TYPE_PCF )
			uniform sampler2DShadow spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		#else
			uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		#endif
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#if defined( SHADOWMAP_TYPE_PCF )
			uniform samplerCubeShadow pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		#elif defined( SHADOWMAP_TYPE_BASIC )
			uniform samplerCube pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		#endif
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	#if defined( SHADOWMAP_TYPE_PCF )
		float interleavedGradientNoise( vec2 position ) {
			return fract( 52.9829189 * fract( dot( position, vec2( 0.06711056, 0.00583715 ) ) ) );
		}
		vec2 vogelDiskSample( int sampleIndex, int samplesCount, float phi ) {
			const float goldenAngle = 2.399963229728653;
			float r = sqrt( ( float( sampleIndex ) + 0.5 ) / float( samplesCount ) );
			float theta = float( sampleIndex ) * goldenAngle + phi;
			return vec2( cos( theta ), sin( theta ) ) * r;
		}
	#endif
	#if defined( SHADOWMAP_TYPE_PCF )
		float getShadow( sampler2DShadow shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
			float shadow = 1.0;
			shadowCoord.xyz /= shadowCoord.w;
			shadowCoord.z += shadowBias;
			bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
			bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
			if ( frustumTest ) {
				vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
				float radius = shadowRadius * texelSize.x;
				float phi = interleavedGradientNoise( gl_FragCoord.xy ) * 6.28318530718;
				shadow = (
					texture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 0, 5, phi ) * radius, shadowCoord.z ) ) +
					texture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 1, 5, phi ) * radius, shadowCoord.z ) ) +
					texture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 2, 5, phi ) * radius, shadowCoord.z ) ) +
					texture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 3, 5, phi ) * radius, shadowCoord.z ) ) +
					texture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 4, 5, phi ) * radius, shadowCoord.z ) )
				) * 0.2;
			}
			return mix( 1.0, shadow, shadowIntensity );
		}
	#elif defined( SHADOWMAP_TYPE_VSM )
		float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
			float shadow = 1.0;
			shadowCoord.xyz /= shadowCoord.w;
			shadowCoord.z += shadowBias;
			bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
			bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
			if ( frustumTest ) {
				vec2 distribution = texture2D( shadowMap, shadowCoord.xy ).rg;
				float mean = distribution.x;
				float variance = distribution.y * distribution.y;
				#ifdef USE_REVERSED_DEPTH_BUFFER
					float hard_shadow = step( mean, shadowCoord.z );
				#else
					float hard_shadow = step( shadowCoord.z, mean );
				#endif
				if ( hard_shadow == 1.0 ) {
					shadow = 1.0;
				} else {
					variance = max( variance, 0.0000001 );
					float d = shadowCoord.z - mean;
					float p_max = variance / ( variance + d * d );
					p_max = clamp( ( p_max - 0.3 ) / 0.65, 0.0, 1.0 );
					shadow = max( hard_shadow, p_max );
				}
			}
			return mix( 1.0, shadow, shadowIntensity );
		}
	#else
		float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
			float shadow = 1.0;
			shadowCoord.xyz /= shadowCoord.w;
			shadowCoord.z += shadowBias;
			bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
			bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
			if ( frustumTest ) {
				float depth = texture2D( shadowMap, shadowCoord.xy ).r;
				#ifdef USE_REVERSED_DEPTH_BUFFER
					shadow = step( depth, shadowCoord.z );
				#else
					shadow = step( shadowCoord.z, depth );
				#endif
			}
			return mix( 1.0, shadow, shadowIntensity );
		}
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	#if defined( SHADOWMAP_TYPE_PCF )
	float getPointShadow( samplerCubeShadow shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		vec3 bd3D = normalize( lightToPosition );
		vec3 absVec = abs( lightToPosition );
		float viewSpaceZ = max( max( absVec.x, absVec.y ), absVec.z );
		if ( viewSpaceZ - shadowCameraFar <= 0.0 && viewSpaceZ - shadowCameraNear >= 0.0 ) {
			float dp = ( shadowCameraFar * ( viewSpaceZ - shadowCameraNear ) ) / ( viewSpaceZ * ( shadowCameraFar - shadowCameraNear ) );
			dp += shadowBias;
			float texelSize = shadowRadius / shadowMapSize.x;
			vec3 absDir = abs( bd3D );
			vec3 tangent = absDir.x > absDir.z ? vec3( 0.0, 1.0, 0.0 ) : vec3( 1.0, 0.0, 0.0 );
			tangent = normalize( cross( bd3D, tangent ) );
			vec3 bitangent = cross( bd3D, tangent );
			float phi = interleavedGradientNoise( gl_FragCoord.xy ) * 6.28318530718;
			shadow = (
				texture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 0, 5, phi ).x + bitangent * vogelDiskSample( 0, 5, phi ).y ) * texelSize, dp ) ) +
				texture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 1, 5, phi ).x + bitangent * vogelDiskSample( 1, 5, phi ).y ) * texelSize, dp ) ) +
				texture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 2, 5, phi ).x + bitangent * vogelDiskSample( 2, 5, phi ).y ) * texelSize, dp ) ) +
				texture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 3, 5, phi ).x + bitangent * vogelDiskSample( 3, 5, phi ).y ) * texelSize, dp ) ) +
				texture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 4, 5, phi ).x + bitangent * vogelDiskSample( 4, 5, phi ).y ) * texelSize, dp ) )
			) * 0.2;
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
	#elif defined( SHADOWMAP_TYPE_BASIC )
	float getPointShadow( samplerCube shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		vec3 bd3D = normalize( lightToPosition );
		vec3 absVec = abs( lightToPosition );
		float viewSpaceZ = max( max( absVec.x, absVec.y ), absVec.z );
		if ( viewSpaceZ - shadowCameraFar <= 0.0 && viewSpaceZ - shadowCameraNear >= 0.0 ) {
			float dp = ( shadowCameraFar * ( viewSpaceZ - shadowCameraNear ) ) / ( viewSpaceZ * ( shadowCameraFar - shadowCameraNear ) );
			dp += shadowBias;
			float depth = textureCube( shadowMap, bd3D ).r;
			#ifdef USE_REVERSED_DEPTH_BUFFER
				shadow = step( depth, dp );
			#else
				shadow = step( dp, depth );
			#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
	#endif
	#endif
#endif`,Dk=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,Uk=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,Pk=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0 && ( defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_BASIC ) )
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,Lk=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,Fk=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,kk=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,Ok=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,zk=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,Bk=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,Vk=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,Hk=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 CineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 NeutralToneMapping( vec3 color ) {
	const float StartCompression = 0.8 - 0.04;
	const float Desaturation = 0.15;
	color *= toneMappingExposure;
	float x = min( color.r, min( color.g, color.b ) );
	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;
	color -= offset;
	float peak = max( color.r, max( color.g, color.b ) );
	if ( peak < StartCompression ) return color;
	float d = 1. - StartCompression;
	float newPeak = 1. - d * d / ( peak + d - StartCompression );
	color *= newPeak / peak;
	float g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );
	return mix( color, vec3( newPeak ), g );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,Gk=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseContribution, material.specularColorBlended, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,qk=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec4 transmittedLight;
		vec3 transmittance;
		#ifdef USE_DISPERSION
			float halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;
			vec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );
			for ( int i = 0; i < 3; i ++ ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;
				vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;
				vec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );
				transmittedLight[ i ] = transmissionSample[ i ];
				transmittedLight.a += transmissionSample.a;
				transmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];
			}
			transmittedLight.a /= 3.0;
		#else
			vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
			vec3 refractedRayExit = position + transmissionRay;
			vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
			vec2 refractionCoords = ndcPos.xy / ndcPos.w;
			refractionCoords += 1.0;
			refractionCoords /= 2.0;
			transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
			transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		#endif
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,Wk=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,Xk=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,Yk=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,Jk=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const Zk=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,$k=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,Kk=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,Qk=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3 backgroundRotation;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,jk=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,eO=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,tO=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,nO=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	#ifdef USE_REVERSED_DEPTH_BUFFER
		float fragCoordZ = vHighPrecisionZW[ 0 ] / vHighPrecisionZW[ 1 ];
	#else
		float fragCoordZ = 0.5 * vHighPrecisionZW[ 0 ] / vHighPrecisionZW[ 1 ] + 0.5;
	#endif
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#elif DEPTH_PACKING == 3202
		gl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );
	#elif DEPTH_PACKING == 3203
		gl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );
	#endif
}`,iO=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,rO=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = vec4( dist, 0.0, 0.0, 1.0 );
}`,sO=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,oO=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,aO=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,lO=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,uO=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,cO=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,fO=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,dO=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,hO=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,pO=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,mO=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,gO=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( normalize( normal ) * 0.5 + 0.5, diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,vO=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,yO=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,_O=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,xO=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_DISPERSION
	uniform float dispersion;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
 
		outgoingLight = outgoingLight + sheenSpecularDirect + sheenSpecularIndirect;
 
 	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,SO=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,bO=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,MO=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,EO=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,TO=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,AO=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,wO=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix[ 3 ];
	vec2 scale = vec2( length( modelMatrix[ 0 ].xyz ), length( modelMatrix[ 1 ].xyz ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,CO=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,Cn={alphahash_fragment:$L,alphahash_pars_fragment:KL,alphamap_fragment:QL,alphamap_pars_fragment:jL,alphatest_fragment:eF,alphatest_pars_fragment:tF,aomap_fragment:nF,aomap_pars_fragment:iF,batching_pars_vertex:rF,batching_vertex:sF,begin_vertex:oF,beginnormal_vertex:aF,bsdfs:lF,iridescence_fragment:uF,bumpmap_pars_fragment:cF,clipping_planes_fragment:fF,clipping_planes_pars_fragment:dF,clipping_planes_pars_vertex:hF,clipping_planes_vertex:pF,color_fragment:mF,color_pars_fragment:gF,color_pars_vertex:vF,color_vertex:yF,common:_F,cube_uv_reflection_fragment:xF,defaultnormal_vertex:SF,displacementmap_pars_vertex:bF,displacementmap_vertex:MF,emissivemap_fragment:EF,emissivemap_pars_fragment:TF,colorspace_fragment:AF,colorspace_pars_fragment:wF,envmap_fragment:CF,envmap_common_pars_fragment:RF,envmap_pars_fragment:IF,envmap_pars_vertex:NF,envmap_physical_pars_fragment:HF,envmap_vertex:DF,fog_vertex:UF,fog_pars_vertex:PF,fog_fragment:LF,fog_pars_fragment:FF,gradientmap_pars_fragment:kF,lightmap_pars_fragment:OF,lights_lambert_fragment:zF,lights_lambert_pars_fragment:BF,lights_pars_begin:VF,lights_toon_fragment:GF,lights_toon_pars_fragment:qF,lights_phong_fragment:WF,lights_phong_pars_fragment:XF,lights_physical_fragment:YF,lights_physical_pars_fragment:JF,lights_fragment_begin:ZF,lights_fragment_maps:$F,lights_fragment_end:KF,logdepthbuf_fragment:QF,logdepthbuf_pars_fragment:jF,logdepthbuf_pars_vertex:ek,logdepthbuf_vertex:tk,map_fragment:nk,map_pars_fragment:ik,map_particle_fragment:rk,map_particle_pars_fragment:sk,metalnessmap_fragment:ok,metalnessmap_pars_fragment:ak,morphinstance_vertex:lk,morphcolor_vertex:uk,morphnormal_vertex:ck,morphtarget_pars_vertex:fk,morphtarget_vertex:dk,normal_fragment_begin:hk,normal_fragment_maps:pk,normal_pars_fragment:mk,normal_pars_vertex:gk,normal_vertex:vk,normalmap_pars_fragment:yk,clearcoat_normal_fragment_begin:_k,clearcoat_normal_fragment_maps:xk,clearcoat_pars_fragment:Sk,iridescence_pars_fragment:bk,opaque_fragment:Mk,packing:Ek,premultiplied_alpha_fragment:Tk,project_vertex:Ak,dithering_fragment:wk,dithering_pars_fragment:Ck,roughnessmap_fragment:Rk,roughnessmap_pars_fragment:Ik,shadowmap_pars_fragment:Nk,shadowmap_pars_vertex:Dk,shadowmap_vertex:Uk,shadowmask_pars_fragment:Pk,skinbase_vertex:Lk,skinning_pars_vertex:Fk,skinning_vertex:kk,skinnormal_vertex:Ok,specularmap_fragment:zk,specularmap_pars_fragment:Bk,tonemapping_fragment:Vk,tonemapping_pars_fragment:Hk,transmission_fragment:Gk,transmission_pars_fragment:qk,uv_pars_fragment:Wk,uv_pars_vertex:Xk,uv_vertex:Yk,worldpos_vertex:Jk,background_vert:Zk,background_frag:$k,backgroundCube_vert:Kk,backgroundCube_frag:Qk,cube_vert:jk,cube_frag:eO,depth_vert:tO,depth_frag:nO,distance_vert:iO,distance_frag:rO,equirect_vert:sO,equirect_frag:oO,linedashed_vert:aO,linedashed_frag:lO,meshbasic_vert:uO,meshbasic_frag:cO,meshlambert_vert:fO,meshlambert_frag:dO,meshmatcap_vert:hO,meshmatcap_frag:pO,meshnormal_vert:mO,meshnormal_frag:gO,meshphong_vert:vO,meshphong_frag:yO,meshphysical_vert:_O,meshphysical_frag:xO,meshtoon_vert:SO,meshtoon_frag:bO,points_vert:MO,points_frag:EO,shadow_vert:TO,shadow_frag:AO,sprite_vert:wO,sprite_frag:CO},Rt={common:{diffuse:{value:new Pt(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new xn},alphaMap:{value:null},alphaMapTransform:{value:new xn},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new xn}},envmap:{envMap:{value:null},envMapRotation:{value:new xn},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98},dfgLUT:{value:null}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new xn}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new xn}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new xn},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new xn},normalScale:{value:new $e(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new xn},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new xn}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new xn}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new xn}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Pt(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Pt(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new xn},alphaTest:{value:0},uvTransform:{value:new xn}},sprite:{diffuse:{value:new Pt(16777215)},opacity:{value:1},center:{value:new $e(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new xn},alphaMap:{value:null},alphaMapTransform:{value:new xn},alphaTest:{value:0}}},Ca={basic:{uniforms:Is([Rt.common,Rt.specularmap,Rt.envmap,Rt.aomap,Rt.lightmap,Rt.fog]),vertexShader:Cn.meshbasic_vert,fragmentShader:Cn.meshbasic_frag},lambert:{uniforms:Is([Rt.common,Rt.specularmap,Rt.envmap,Rt.aomap,Rt.lightmap,Rt.emissivemap,Rt.bumpmap,Rt.normalmap,Rt.displacementmap,Rt.fog,Rt.lights,{emissive:{value:new Pt(0)}}]),vertexShader:Cn.meshlambert_vert,fragmentShader:Cn.meshlambert_frag},phong:{uniforms:Is([Rt.common,Rt.specularmap,Rt.envmap,Rt.aomap,Rt.lightmap,Rt.emissivemap,Rt.bumpmap,Rt.normalmap,Rt.displacementmap,Rt.fog,Rt.lights,{emissive:{value:new Pt(0)},specular:{value:new Pt(1118481)},shininess:{value:30}}]),vertexShader:Cn.meshphong_vert,fragmentShader:Cn.meshphong_frag},standard:{uniforms:Is([Rt.common,Rt.envmap,Rt.aomap,Rt.lightmap,Rt.emissivemap,Rt.bumpmap,Rt.normalmap,Rt.displacementmap,Rt.roughnessmap,Rt.metalnessmap,Rt.fog,Rt.lights,{emissive:{value:new Pt(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Cn.meshphysical_vert,fragmentShader:Cn.meshphysical_frag},toon:{uniforms:Is([Rt.common,Rt.aomap,Rt.lightmap,Rt.emissivemap,Rt.bumpmap,Rt.normalmap,Rt.displacementmap,Rt.gradientmap,Rt.fog,Rt.lights,{emissive:{value:new Pt(0)}}]),vertexShader:Cn.meshtoon_vert,fragmentShader:Cn.meshtoon_frag},matcap:{uniforms:Is([Rt.common,Rt.bumpmap,Rt.normalmap,Rt.displacementmap,Rt.fog,{matcap:{value:null}}]),vertexShader:Cn.meshmatcap_vert,fragmentShader:Cn.meshmatcap_frag},points:{uniforms:Is([Rt.points,Rt.fog]),vertexShader:Cn.points_vert,fragmentShader:Cn.points_frag},dashed:{uniforms:Is([Rt.common,Rt.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Cn.linedashed_vert,fragmentShader:Cn.linedashed_frag},depth:{uniforms:Is([Rt.common,Rt.displacementmap]),vertexShader:Cn.depth_vert,fragmentShader:Cn.depth_frag},normal:{uniforms:Is([Rt.common,Rt.bumpmap,Rt.normalmap,Rt.displacementmap,{opacity:{value:1}}]),vertexShader:Cn.meshnormal_vert,fragmentShader:Cn.meshnormal_frag},sprite:{uniforms:Is([Rt.sprite,Rt.fog]),vertexShader:Cn.sprite_vert,fragmentShader:Cn.sprite_frag},background:{uniforms:{uvTransform:{value:new xn},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Cn.background_vert,fragmentShader:Cn.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new xn}},vertexShader:Cn.backgroundCube_vert,fragmentShader:Cn.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Cn.cube_vert,fragmentShader:Cn.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Cn.equirect_vert,fragmentShader:Cn.equirect_frag},distance:{uniforms:Is([Rt.common,Rt.displacementmap,{referencePosition:{value:new Q},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Cn.distance_vert,fragmentShader:Cn.distance_frag},shadow:{uniforms:Is([Rt.lights,Rt.fog,{color:{value:new Pt(0)},opacity:{value:1}}]),vertexShader:Cn.shadow_vert,fragmentShader:Cn.shadow_frag}};Ca.physical={uniforms:Is([Ca.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new xn},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new xn},clearcoatNormalScale:{value:new $e(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new xn},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new xn},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new xn},sheen:{value:0},sheenColor:{value:new Pt(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new xn},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new xn},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new xn},transmissionSamplerSize:{value:new $e},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new xn},attenuationDistance:{value:0},attenuationColor:{value:new Pt(0)},specularColor:{value:new Pt(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new xn},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new xn},anisotropyVector:{value:new $e},anisotropyMap:{value:null},anisotropyMapTransform:{value:new xn}}]),vertexShader:Cn.meshphysical_vert,fragmentShader:Cn.meshphysical_frag};const wy={r:0,b:0,g:0},Cf=new Eo,RO=new an;function IO(i,e,t,n,r,s,a){const c=new Pt(0);let d=s===!0?0:1,p,m,v=null,_=0,b=null;function T(U){let L=U.isScene===!0?U.background:null;return L&&L.isTexture&&(L=(U.backgroundBlurriness>0?t:e).get(L)),L}function I(U){let L=!1;const z=T(U);z===null?A(c,d):z&&z.isColor&&(A(z,1),L=!0);const B=i.xr.getEnvironmentBlendMode();B==="additive"?n.buffers.color.setClear(0,0,0,1,a):B==="alpha-blend"&&n.buffers.color.setClear(0,0,0,0,a),(i.autoClear||L)&&(n.buffers.depth.setTest(!0),n.buffers.depth.setMask(!0),n.buffers.color.setMask(!0),i.clear(i.autoClearColor,i.autoClearDepth,i.autoClearStencil))}function C(U,L){const z=T(L);z&&(z.isCubeTexture||z.mapping===np)?(m===void 0&&(m=new Di(new $f(1,1,1),new Ar({name:"BackgroundCubeMaterial",uniforms:$h(Ca.backgroundCube.uniforms),vertexShader:Ca.backgroundCube.vertexShader,fragmentShader:Ca.backgroundCube.fragmentShader,side:gs,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),m.geometry.deleteAttribute("normal"),m.geometry.deleteAttribute("uv"),m.onBeforeRender=function(B,k,G){this.matrixWorld.copyPosition(G.matrixWorld)},Object.defineProperty(m.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(m)),Cf.copy(L.backgroundRotation),Cf.x*=-1,Cf.y*=-1,Cf.z*=-1,z.isCubeTexture&&z.isRenderTargetTexture===!1&&(Cf.y*=-1,Cf.z*=-1),m.material.uniforms.envMap.value=z,m.material.uniforms.flipEnvMap.value=z.isCubeTexture&&z.isRenderTargetTexture===!1?-1:1,m.material.uniforms.backgroundBlurriness.value=L.backgroundBlurriness,m.material.uniforms.backgroundIntensity.value=L.backgroundIntensity,m.material.uniforms.backgroundRotation.value.setFromMatrix4(RO.makeRotationFromEuler(Cf)),m.material.toneMapped=Gn.getTransfer(z.colorSpace)!==oi,(v!==z||_!==z.version||b!==i.toneMapping)&&(m.material.needsUpdate=!0,v=z,_=z.version,b=i.toneMapping),m.layers.enableAll(),U.unshift(m,m.geometry,m.material,0,0,null)):z&&z.isTexture&&(p===void 0&&(p=new Di(new gu(2,2),new Ar({name:"BackgroundMaterial",uniforms:$h(Ca.background.uniforms),vertexShader:Ca.background.vertexShader,fragmentShader:Ca.background.fragmentShader,side:hu,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),p.geometry.deleteAttribute("normal"),Object.defineProperty(p.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(p)),p.material.uniforms.t2D.value=z,p.material.uniforms.backgroundIntensity.value=L.backgroundIntensity,p.material.toneMapped=Gn.getTransfer(z.colorSpace)!==oi,z.matrixAutoUpdate===!0&&z.updateMatrix(),p.material.uniforms.uvTransform.value.copy(z.matrix),(v!==z||_!==z.version||b!==i.toneMapping)&&(p.material.needsUpdate=!0,v=z,_=z.version,b=i.toneMapping),p.layers.enableAll(),U.unshift(p,p.geometry,p.material,0,0,null))}function A(U,L){U.getRGB(wy,RR(i)),n.buffers.color.setClear(wy.r,wy.g,wy.b,L,a)}function D(){m!==void 0&&(m.geometry.dispose(),m.material.dispose(),m=void 0),p!==void 0&&(p.geometry.dispose(),p.material.dispose(),p=void 0)}return{getClearColor:function(){return c},setClearColor:function(U,L=1){c.set(U),d=L,A(c,d)},getClearAlpha:function(){return d},setClearAlpha:function(U){d=U,A(c,d)},render:I,addToRenderList:C,dispose:D}}function NO(i,e){const t=i.getParameter(i.MAX_VERTEX_ATTRIBS),n={},r=_(null);let s=r,a=!1;function c(O,Z,ie,ee,re){let de=!1;const J=v(ee,ie,Z);s!==J&&(s=J,p(s.object)),de=b(O,ee,ie,re),de&&T(O,ee,ie,re),re!==null&&e.update(re,i.ELEMENT_ARRAY_BUFFER),(de||a)&&(a=!1,L(O,Z,ie,ee),re!==null&&i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,e.get(re).buffer))}function d(){return i.createVertexArray()}function p(O){return i.bindVertexArray(O)}function m(O){return i.deleteVertexArray(O)}function v(O,Z,ie){const ee=ie.wireframe===!0;let re=n[O.id];re===void 0&&(re={},n[O.id]=re);let de=re[Z.id];de===void 0&&(de={},re[Z.id]=de);let J=de[ee];return J===void 0&&(J=_(d()),de[ee]=J),J}function _(O){const Z=[],ie=[],ee=[];for(let re=0;re<t;re++)Z[re]=0,ie[re]=0,ee[re]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:Z,enabledAttributes:ie,attributeDivisors:ee,object:O,attributes:{},index:null}}function b(O,Z,ie,ee){const re=s.attributes,de=Z.attributes;let J=0;const te=ie.getAttributes();for(const ye in te)if(te[ye].location>=0){const we=re[ye];let $=de[ye];if($===void 0&&(ye==="instanceMatrix"&&O.instanceMatrix&&($=O.instanceMatrix),ye==="instanceColor"&&O.instanceColor&&($=O.instanceColor)),we===void 0||we.attribute!==$||$&&we.data!==$.data)return!0;J++}return s.attributesNum!==J||s.index!==ee}function T(O,Z,ie,ee){const re={},de=Z.attributes;let J=0;const te=ie.getAttributes();for(const ye in te)if(te[ye].location>=0){let we=de[ye];we===void 0&&(ye==="instanceMatrix"&&O.instanceMatrix&&(we=O.instanceMatrix),ye==="instanceColor"&&O.instanceColor&&(we=O.instanceColor));const $={};$.attribute=we,we&&we.data&&($.data=we.data),re[ye]=$,J++}s.attributes=re,s.attributesNum=J,s.index=ee}function I(){const O=s.newAttributes;for(let Z=0,ie=O.length;Z<ie;Z++)O[Z]=0}function C(O){A(O,0)}function A(O,Z){const ie=s.newAttributes,ee=s.enabledAttributes,re=s.attributeDivisors;ie[O]=1,ee[O]===0&&(i.enableVertexAttribArray(O),ee[O]=1),re[O]!==Z&&(i.vertexAttribDivisor(O,Z),re[O]=Z)}function D(){const O=s.newAttributes,Z=s.enabledAttributes;for(let ie=0,ee=Z.length;ie<ee;ie++)Z[ie]!==O[ie]&&(i.disableVertexAttribArray(ie),Z[ie]=0)}function U(O,Z,ie,ee,re,de,J){J===!0?i.vertexAttribIPointer(O,Z,ie,re,de):i.vertexAttribPointer(O,Z,ie,ee,re,de)}function L(O,Z,ie,ee){I();const re=ee.attributes,de=ie.getAttributes(),J=Z.defaultAttributeValues;for(const te in de){const ye=de[te];if(ye.location>=0){let Ue=re[te];if(Ue===void 0&&(te==="instanceMatrix"&&O.instanceMatrix&&(Ue=O.instanceMatrix),te==="instanceColor"&&O.instanceColor&&(Ue=O.instanceColor)),Ue!==void 0){const we=Ue.normalized,$=Ue.itemSize,ce=e.get(Ue);if(ce===void 0)continue;const Ee=ce.buffer,Be=ce.type,St=ce.bytesPerElement,ve=Be===i.INT||Be===i.UNSIGNED_INT||Ue.gpuType===Og;if(Ue.isInterleavedBufferAttribute){const Re=Ue.data,ot=Re.stride,bt=Ue.offset;if(Re.isInstancedInterleavedBuffer){for(let Dt=0;Dt<ye.locationSize;Dt++)A(ye.location+Dt,Re.meshPerAttribute);O.isInstancedMesh!==!0&&ee._maxInstanceCount===void 0&&(ee._maxInstanceCount=Re.meshPerAttribute*Re.count)}else for(let Dt=0;Dt<ye.locationSize;Dt++)C(ye.location+Dt);i.bindBuffer(i.ARRAY_BUFFER,Ee);for(let Dt=0;Dt<ye.locationSize;Dt++)U(ye.location+Dt,$/ye.locationSize,Be,we,ot*St,(bt+$/ye.locationSize*Dt)*St,ve)}else{if(Ue.isInstancedBufferAttribute){for(let Re=0;Re<ye.locationSize;Re++)A(ye.location+Re,Ue.meshPerAttribute);O.isInstancedMesh!==!0&&ee._maxInstanceCount===void 0&&(ee._maxInstanceCount=Ue.meshPerAttribute*Ue.count)}else for(let Re=0;Re<ye.locationSize;Re++)C(ye.location+Re);i.bindBuffer(i.ARRAY_BUFFER,Ee);for(let Re=0;Re<ye.locationSize;Re++)U(ye.location+Re,$/ye.locationSize,Be,we,$*St,$/ye.locationSize*Re*St,ve)}}else if(J!==void 0){const we=J[te];if(we!==void 0)switch(we.length){case 2:i.vertexAttrib2fv(ye.location,we);break;case 3:i.vertexAttrib3fv(ye.location,we);break;case 4:i.vertexAttrib4fv(ye.location,we);break;default:i.vertexAttrib1fv(ye.location,we)}}}}D()}function z(){G();for(const O in n){const Z=n[O];for(const ie in Z){const ee=Z[ie];for(const re in ee)m(ee[re].object),delete ee[re];delete Z[ie]}delete n[O]}}function B(O){if(n[O.id]===void 0)return;const Z=n[O.id];for(const ie in Z){const ee=Z[ie];for(const re in ee)m(ee[re].object),delete ee[re];delete Z[ie]}delete n[O.id]}function k(O){for(const Z in n){const ie=n[Z];if(ie[O.id]===void 0)continue;const ee=ie[O.id];for(const re in ee)m(ee[re].object),delete ee[re];delete ie[O.id]}}function G(){P(),a=!0,s!==r&&(s=r,p(s.object))}function P(){r.geometry=null,r.program=null,r.wireframe=!1}return{setup:c,reset:G,resetDefaultState:P,dispose:z,releaseStatesOfGeometry:B,releaseStatesOfProgram:k,initAttributes:I,enableAttribute:C,disableUnusedAttributes:D}}function DO(i,e,t){let n;function r(p){n=p}function s(p,m){i.drawArrays(n,p,m),t.update(m,n,1)}function a(p,m,v){v!==0&&(i.drawArraysInstanced(n,p,m,v),t.update(m,n,v))}function c(p,m,v){if(v===0)return;e.get("WEBGL_multi_draw").multiDrawArraysWEBGL(n,p,0,m,0,v);let b=0;for(let T=0;T<v;T++)b+=m[T];t.update(b,n,1)}function d(p,m,v,_){if(v===0)return;const b=e.get("WEBGL_multi_draw");if(b===null)for(let T=0;T<p.length;T++)a(p[T],m[T],_[T]);else{b.multiDrawArraysInstancedWEBGL(n,p,0,m,0,_,0,v);let T=0;for(let I=0;I<v;I++)T+=m[I]*_[I];t.update(T,n,1)}}this.setMode=r,this.render=s,this.renderInstances=a,this.renderMultiDraw=c,this.renderMultiDrawInstances=d}function UO(i,e,t,n){let r;function s(){if(r!==void 0)return r;if(e.has("EXT_texture_filter_anisotropic")===!0){const k=e.get("EXT_texture_filter_anisotropic");r=i.getParameter(k.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else r=0;return r}function a(k){return!(k!==ur&&n.convert(k)!==i.getParameter(i.IMPLEMENTATION_COLOR_READ_FORMAT))}function c(k){const G=k===Wi&&(e.has("EXT_color_buffer_half_float")||e.has("EXT_color_buffer_float"));return!(k!==kr&&n.convert(k)!==i.getParameter(i.IMPLEMENTATION_COLOR_READ_TYPE)&&k!==Ni&&!G)}function d(k){if(k==="highp"){if(i.getShaderPrecisionFormat(i.VERTEX_SHADER,i.HIGH_FLOAT).precision>0&&i.getShaderPrecisionFormat(i.FRAGMENT_SHADER,i.HIGH_FLOAT).precision>0)return"highp";k="mediump"}return k==="mediump"&&i.getShaderPrecisionFormat(i.VERTEX_SHADER,i.MEDIUM_FLOAT).precision>0&&i.getShaderPrecisionFormat(i.FRAGMENT_SHADER,i.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let p=t.precision!==void 0?t.precision:"highp";const m=d(p);m!==p&&(It("WebGLRenderer:",p,"not supported, using",m,"instead."),p=m);const v=t.logarithmicDepthBuffer===!0,_=t.reversedDepthBuffer===!0&&e.has("EXT_clip_control"),b=i.getParameter(i.MAX_TEXTURE_IMAGE_UNITS),T=i.getParameter(i.MAX_VERTEX_TEXTURE_IMAGE_UNITS),I=i.getParameter(i.MAX_TEXTURE_SIZE),C=i.getParameter(i.MAX_CUBE_MAP_TEXTURE_SIZE),A=i.getParameter(i.MAX_VERTEX_ATTRIBS),D=i.getParameter(i.MAX_VERTEX_UNIFORM_VECTORS),U=i.getParameter(i.MAX_VARYING_VECTORS),L=i.getParameter(i.MAX_FRAGMENT_UNIFORM_VECTORS),z=i.getParameter(i.MAX_SAMPLES),B=i.getParameter(i.SAMPLES);return{isWebGL2:!0,getMaxAnisotropy:s,getMaxPrecision:d,textureFormatReadable:a,textureTypeReadable:c,precision:p,logarithmicDepthBuffer:v,reversedDepthBuffer:_,maxTextures:b,maxVertexTextures:T,maxTextureSize:I,maxCubemapSize:C,maxAttributes:A,maxVertexUniforms:D,maxVaryings:U,maxFragmentUniforms:L,maxSamples:z,samples:B}}function PO(i){const e=this;let t=null,n=0,r=!1,s=!1;const a=new uu,c=new xn,d={value:null,needsUpdate:!1};this.uniform=d,this.numPlanes=0,this.numIntersection=0,this.init=function(v,_){const b=v.length!==0||_||n!==0||r;return r=_,n=v.length,b},this.beginShadows=function(){s=!0,m(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(v,_){t=m(v,_,0)},this.setState=function(v,_,b){const T=v.clippingPlanes,I=v.clipIntersection,C=v.clipShadows,A=i.get(v);if(!r||T===null||T.length===0||s&&!C)s?m(null):p();else{const D=s?0:n,U=D*4;let L=A.clippingState||null;d.value=L,L=m(T,_,U,b);for(let z=0;z!==U;++z)L[z]=t[z];A.clippingState=L,this.numIntersection=I?this.numPlanes:0,this.numPlanes+=D}};function p(){d.value!==t&&(d.value=t,d.needsUpdate=n>0),e.numPlanes=n,e.numIntersection=0}function m(v,_,b,T){const I=v!==null?v.length:0;let C=null;if(I!==0){if(C=d.value,T!==!0||C===null){const A=b+I*4,D=_.matrixWorldInverse;c.getNormalMatrix(D),(C===null||C.length<A)&&(C=new Float32Array(A));for(let U=0,L=b;U!==I;++U,L+=4)a.copy(v[U]).applyMatrix4(D,c),a.normal.toArray(C,L),C[L+3]=a.constant}d.value=C,d.needsUpdate=!0}return e.numPlanes=I,e.numIntersection=0,C}}function LO(i){let e=new WeakMap;function t(a,c){return c===Gh?a.mapping=Ua:c===vg&&(a.mapping=Mc),a}function n(a){if(a&&a.isTexture){const c=a.mapping;if(c===Gh||c===vg)if(e.has(a)){const d=e.get(a).texture;return t(d,a.mapping)}else{const d=a.image;if(d&&d.height>0){const p=new gx(d.height);return p.fromEquirectangularTexture(i,a),e.set(a,p),a.addEventListener("dispose",r),t(p.texture,a.mapping)}else return null}}return a}function r(a){const c=a.target;c.removeEventListener("dispose",r);const d=e.get(c);d!==void 0&&(e.delete(c),d.dispose())}function s(){e=new WeakMap}return{get:n,dispose:s}}const _c=4,lA=[.125,.215,.35,.446,.526,.582],Df=20,FO=256,Ym=new jf,uA=new Pt;let Sb=null,bb=0,Mb=0,Eb=!1;const kO=new Q;class uM{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._sizeLods=[],this._sigmas=[],this._lodMeshes=[],this._backgroundBox=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._blurMaterial=null,this._ggxMaterial=null}fromScene(e,t=0,n=.1,r=100,s={}){const{size:a=256,position:c=kO}=s;Sb=this._renderer.getRenderTarget(),bb=this._renderer.getActiveCubeFace(),Mb=this._renderer.getActiveMipmapLevel(),Eb=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(a);const d=this._allocateTargets();return d.depthBuffer=!0,this._sceneToCubeUV(e,n,r,d,c),t>0&&this._blur(d,0,0,t),this._applyPMREM(d),this._cleanup(d),d}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=dA(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=fA(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose(),this._backgroundBox!==null&&(this._backgroundBox.geometry.dispose(),this._backgroundBox.material.dispose())}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._ggxMaterial!==null&&this._ggxMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodMeshes.length;e++)this._lodMeshes[e].geometry.dispose()}_cleanup(e){this._renderer.setRenderTarget(Sb,bb,Mb),this._renderer.xr.enabled=Eb,e.scissorTest=!1,Ch(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===Ua||e.mapping===Mc?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),Sb=this._renderer.getRenderTarget(),bb=this._renderer.getActiveCubeFace(),Mb=this._renderer.getActiveMipmapLevel(),Eb=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const n=t||this._allocateTargets();return this._textureToCubeUV(e,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,n={magFilter:Bn,minFilter:Bn,generateMipmaps:!1,type:Wi,format:ur,colorSpace:Pa,depthBuffer:!1},r=cA(e,t,n);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=cA(e,t,n);const{_lodMax:s}=this;({lodMeshes:this._lodMeshes,sizeLods:this._sizeLods,sigmas:this._sigmas}=OO(s)),this._blurMaterial=BO(s,e,t),this._ggxMaterial=zO(s,e,t)}return r}_compileMaterial(e){const t=new Di(new vn,e);this._renderer.compile(t,Ym)}_sceneToCubeUV(e,t,n,r,s){const d=new Fr(90,1,t,n),p=[1,-1,1,1,1,1],m=[1,1,1,-1,-1,-1],v=this._renderer,_=v.autoClear,b=v.toneMapping;v.getClearColor(uA),v.toneMapping=ta,v.autoClear=!1,v.state.buffers.depth.getReversed()&&(v.setRenderTarget(r),v.clearDepth(),v.setRenderTarget(null)),this._backgroundBox===null&&(this._backgroundBox=new Di(new $f,new mu({name:"PMREM.Background",side:gs,depthWrite:!1,depthTest:!1})));const I=this._backgroundBox,C=I.material;let A=!1;const D=e.background;D?D.isColor&&(C.color.copy(D),e.background=null,A=!0):(C.color.copy(uA),A=!0);for(let U=0;U<6;U++){const L=U%3;L===0?(d.up.set(0,p[U],0),d.position.set(s.x,s.y,s.z),d.lookAt(s.x+m[U],s.y,s.z)):L===1?(d.up.set(0,0,p[U]),d.position.set(s.x,s.y,s.z),d.lookAt(s.x,s.y+m[U],s.z)):(d.up.set(0,p[U],0),d.position.set(s.x,s.y,s.z),d.lookAt(s.x,s.y,s.z+m[U]));const z=this._cubeSize;Ch(r,L*z,U>2?z:0,z,z),v.setRenderTarget(r),A&&v.render(I,d),v.render(e,d)}v.toneMapping=b,v.autoClear=_,e.background=D}_textureToCubeUV(e,t){const n=this._renderer,r=e.mapping===Ua||e.mapping===Mc;r?(this._cubemapMaterial===null&&(this._cubemapMaterial=dA()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=fA());const s=r?this._cubemapMaterial:this._equirectMaterial,a=this._lodMeshes[0];a.material=s;const c=s.uniforms;c.envMap.value=e;const d=this._cubeSize;Ch(t,0,0,3*d,2*d),n.setRenderTarget(t),n.render(a,Ym)}_applyPMREM(e){const t=this._renderer,n=t.autoClear;t.autoClear=!1;const r=this._lodMeshes.length;for(let s=1;s<r;s++)this._applyGGXFilter(e,s-1,s);t.autoClear=n}_applyGGXFilter(e,t,n){const r=this._renderer,s=this._pingPongRenderTarget,a=this._ggxMaterial,c=this._lodMeshes[n];c.material=a;const d=a.uniforms,p=n/(this._lodMeshes.length-1),m=t/(this._lodMeshes.length-1),v=Math.sqrt(p*p-m*m),_=0+p*1.25,b=v*_,{_lodMax:T}=this,I=this._sizeLods[n],C=3*I*(n>T-_c?n-T+_c:0),A=4*(this._cubeSize-I);d.envMap.value=e.texture,d.roughness.value=b,d.mipInt.value=T-t,Ch(s,C,A,3*I,2*I),r.setRenderTarget(s),r.render(c,Ym),d.envMap.value=s.texture,d.roughness.value=0,d.mipInt.value=T-n,Ch(e,C,A,3*I,2*I),r.setRenderTarget(e),r.render(c,Ym)}_blur(e,t,n,r,s){const a=this._pingPongRenderTarget;this._halfBlur(e,a,t,n,r,"latitudinal",s),this._halfBlur(a,e,n,n,r,"longitudinal",s)}_halfBlur(e,t,n,r,s,a,c){const d=this._renderer,p=this._blurMaterial;a!=="latitudinal"&&a!=="longitudinal"&&Jt("blur direction must be either latitudinal or longitudinal!");const m=3,v=this._lodMeshes[r];v.material=p;const _=p.uniforms,b=this._sizeLods[n]-1,T=isFinite(s)?Math.PI/(2*b):2*Math.PI/(2*Df-1),I=s/T,C=isFinite(s)?1+Math.floor(m*I):Df;C>Df&&It(`sigmaRadians, ${s}, is too large and will clip, as it requested ${C} samples when the maximum is set to ${Df}`);const A=[];let D=0;for(let k=0;k<Df;++k){const G=k/I,P=Math.exp(-G*G/2);A.push(P),k===0?D+=P:k<C&&(D+=2*P)}for(let k=0;k<A.length;k++)A[k]=A[k]/D;_.envMap.value=e.texture,_.samples.value=C,_.weights.value=A,_.latitudinal.value=a==="latitudinal",c&&(_.poleAxis.value=c);const{_lodMax:U}=this;_.dTheta.value=T,_.mipInt.value=U-n;const L=this._sizeLods[r],z=3*L*(r>U-_c?r-U+_c:0),B=4*(this._cubeSize-L);Ch(t,z,B,3*L,2*L),d.setRenderTarget(t),d.render(v,Ym)}}function OO(i){const e=[],t=[],n=[];let r=i;const s=i-_c+1+lA.length;for(let a=0;a<s;a++){const c=Math.pow(2,r);e.push(c);let d=1/c;a>i-_c?d=lA[a-i+_c-1]:a===0&&(d=0),t.push(d);const p=1/(c-2),m=-p,v=1+p,_=[m,m,v,m,v,v,m,m,v,v,m,v],b=6,T=6,I=3,C=2,A=1,D=new Float32Array(I*T*b),U=new Float32Array(C*T*b),L=new Float32Array(A*T*b);for(let B=0;B<b;B++){const k=B%3*2/3-1,G=B>2?0:-1,P=[k,G,0,k+2/3,G,0,k+2/3,G+1,0,k,G,0,k+2/3,G+1,0,k,G+1,0];D.set(P,I*T*B),U.set(_,C*T*B);const O=[B,B,B,B,B,B];L.set(O,A*T*B)}const z=new vn;z.setAttribute("position",new pi(D,I)),z.setAttribute("uv",new pi(U,C)),z.setAttribute("faceIndex",new pi(L,A)),n.push(new Di(z,null)),r>_c&&r--}return{lodMeshes:n,sizeLods:e,sigmas:t}}function cA(i,e,t){const n=new Or(i,e,t);return n.texture.mapping=np,n.texture.name="PMREM.cubeUv",n.scissorTest=!0,n}function Ch(i,e,t,n,r){i.viewport.set(e,t,n,r),i.scissor.set(e,t,n,r)}function zO(i,e,t){return new Ar({name:"PMREMGGXConvolution",defines:{GGX_SAMPLES:FO,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${i}.0`},uniforms:{envMap:{value:null},roughness:{value:0},mipInt:{value:0}},vertexShader:zx(),fragmentShader:`

			precision highp float;
			precision highp int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform float roughness;
			uniform float mipInt;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			#define PI 3.14159265359

			// Van der Corput radical inverse
			float radicalInverse_VdC(uint bits) {
				bits = (bits << 16u) | (bits >> 16u);
				bits = ((bits & 0x55555555u) << 1u) | ((bits & 0xAAAAAAAAu) >> 1u);
				bits = ((bits & 0x33333333u) << 2u) | ((bits & 0xCCCCCCCCu) >> 2u);
				bits = ((bits & 0x0F0F0F0Fu) << 4u) | ((bits & 0xF0F0F0F0u) >> 4u);
				bits = ((bits & 0x00FF00FFu) << 8u) | ((bits & 0xFF00FF00u) >> 8u);
				return float(bits) * 2.3283064365386963e-10; // / 0x100000000
			}

			// Hammersley sequence
			vec2 hammersley(uint i, uint N) {
				return vec2(float(i) / float(N), radicalInverse_VdC(i));
			}

			// GGX VNDF importance sampling (Eric Heitz 2018)
			// "Sampling the GGX Distribution of Visible Normals"
			// https://jcgt.org/published/0007/04/01/
			vec3 importanceSampleGGX_VNDF(vec2 Xi, vec3 V, float roughness) {
				float alpha = roughness * roughness;

				// Section 3.2: Transform view direction to hemisphere configuration
				vec3 Vh = normalize(vec3(alpha * V.x, alpha * V.y, V.z));

				// Section 4.1: Orthonormal basis
				float lensq = Vh.x * Vh.x + Vh.y * Vh.y;
				vec3 T1 = lensq > 0.0 ? vec3(-Vh.y, Vh.x, 0.0) / sqrt(lensq) : vec3(1.0, 0.0, 0.0);
				vec3 T2 = cross(Vh, T1);

				// Section 4.2: Parameterization of projected area
				float r = sqrt(Xi.x);
				float phi = 2.0 * PI * Xi.y;
				float t1 = r * cos(phi);
				float t2 = r * sin(phi);
				float s = 0.5 * (1.0 + Vh.z);
				t2 = (1.0 - s) * sqrt(1.0 - t1 * t1) + s * t2;

				// Section 4.3: Reprojection onto hemisphere
				vec3 Nh = t1 * T1 + t2 * T2 + sqrt(max(0.0, 1.0 - t1 * t1 - t2 * t2)) * Vh;

				// Section 3.4: Transform back to ellipsoid configuration
				return normalize(vec3(alpha * Nh.x, alpha * Nh.y, max(0.0, Nh.z)));
			}

			void main() {
				vec3 N = normalize(vOutputDirection);
				vec3 V = N; // Assume view direction equals normal for pre-filtering

				vec3 prefilteredColor = vec3(0.0);
				float totalWeight = 0.0;

				// For very low roughness, just sample the environment directly
				if (roughness < 0.001) {
					gl_FragColor = vec4(bilinearCubeUV(envMap, N, mipInt), 1.0);
					return;
				}

				// Tangent space basis for VNDF sampling
				vec3 up = abs(N.z) < 0.999 ? vec3(0.0, 0.0, 1.0) : vec3(1.0, 0.0, 0.0);
				vec3 tangent = normalize(cross(up, N));
				vec3 bitangent = cross(N, tangent);

				for(uint i = 0u; i < uint(GGX_SAMPLES); i++) {
					vec2 Xi = hammersley(i, uint(GGX_SAMPLES));

					// For PMREM, V = N, so in tangent space V is always (0, 0, 1)
					vec3 H_tangent = importanceSampleGGX_VNDF(Xi, vec3(0.0, 0.0, 1.0), roughness);

					// Transform H back to world space
					vec3 H = normalize(tangent * H_tangent.x + bitangent * H_tangent.y + N * H_tangent.z);
					vec3 L = normalize(2.0 * dot(V, H) * H - V);

					float NdotL = max(dot(N, L), 0.0);

					if(NdotL > 0.0) {
						// Sample environment at fixed mip level
						// VNDF importance sampling handles the distribution filtering
						vec3 sampleColor = bilinearCubeUV(envMap, L, mipInt);

						// Weight by NdotL for the split-sum approximation
						// VNDF PDF naturally accounts for the visible microfacet distribution
						prefilteredColor += sampleColor * NdotL;
						totalWeight += NdotL;
					}
				}

				if (totalWeight > 0.0) {
					prefilteredColor = prefilteredColor / totalWeight;
				}

				gl_FragColor = vec4(prefilteredColor, 1.0);
			}
		`,blending:Ia,depthTest:!1,depthWrite:!1})}function BO(i,e,t){const n=new Float32Array(Df),r=new Q(0,1,0);return new Ar({name:"SphericalGaussianBlur",defines:{n:Df,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${i}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:n},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:zx(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:Ia,depthTest:!1,depthWrite:!1})}function fA(){return new Ar({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:zx(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:Ia,depthTest:!1,depthWrite:!1})}function dA(){return new Ar({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:zx(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:Ia,depthTest:!1,depthWrite:!1})}function zx(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function VO(i){let e=new WeakMap,t=null;function n(c){if(c&&c.isTexture){const d=c.mapping,p=d===Gh||d===vg,m=d===Ua||d===Mc;if(p||m){let v=e.get(c);const _=v!==void 0?v.texture.pmremVersion:0;if(c.isRenderTargetTexture&&c.pmremVersion!==_)return t===null&&(t=new uM(i)),v=p?t.fromEquirectangular(c,v):t.fromCubemap(c,v),v.texture.pmremVersion=c.pmremVersion,e.set(c,v),v.texture;if(v!==void 0)return v.texture;{const b=c.image;return p&&b&&b.height>0||m&&b&&r(b)?(t===null&&(t=new uM(i)),v=p?t.fromEquirectangular(c):t.fromCubemap(c),v.texture.pmremVersion=c.pmremVersion,e.set(c,v),c.addEventListener("dispose",s),v.texture):null}}}return c}function r(c){let d=0;const p=6;for(let m=0;m<p;m++)c[m]!==void 0&&d++;return d===p}function s(c){const d=c.target;d.removeEventListener("dispose",s);const p=e.get(d);p!==void 0&&(e.delete(d),p.dispose())}function a(){e=new WeakMap,t!==null&&(t.dispose(),t=null)}return{get:n,dispose:a}}function HO(i){const e={};function t(n){if(e[n]!==void 0)return e[n];const r=i.getExtension(n);return e[n]=r,r}return{has:function(n){return t(n)!==null},init:function(){t("EXT_color_buffer_float"),t("WEBGL_clip_cull_distance"),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture"),t("WEBGL_render_shared_exponent")},get:function(n){const r=t(n);return r===null&&Yh("WebGLRenderer: "+n+" extension not supported."),r}}}function GO(i,e,t,n){const r={},s=new WeakMap;function a(v){const _=v.target;_.index!==null&&e.remove(_.index);for(const T in _.attributes)e.remove(_.attributes[T]);_.removeEventListener("dispose",a),delete r[_.id];const b=s.get(_);b&&(e.remove(b),s.delete(_)),n.releaseStatesOfGeometry(_),_.isInstancedBufferGeometry===!0&&delete _._maxInstanceCount,t.memory.geometries--}function c(v,_){return r[_.id]===!0||(_.addEventListener("dispose",a),r[_.id]=!0,t.memory.geometries++),_}function d(v){const _=v.attributes;for(const b in _)e.update(_[b],i.ARRAY_BUFFER)}function p(v){const _=[],b=v.index,T=v.attributes.position;let I=0;if(b!==null){const D=b.array;I=b.version;for(let U=0,L=D.length;U<L;U+=3){const z=D[U+0],B=D[U+1],k=D[U+2];_.push(z,B,B,k,k,z)}}else if(T!==void 0){const D=T.array;I=T.version;for(let U=0,L=D.length/3-1;U<L;U+=3){const z=U+0,B=U+1,k=U+2;_.push(z,B,B,k,k,z)}}else return;const C=new(ER(_)?QM:KM)(_,1);C.version=I;const A=s.get(v);A&&e.remove(A),s.set(v,C)}function m(v){const _=s.get(v);if(_){const b=v.index;b!==null&&_.version<b.version&&p(v)}else p(v);return s.get(v)}return{get:c,update:d,getWireframeAttribute:m}}function qO(i,e,t){let n;function r(_){n=_}let s,a;function c(_){s=_.type,a=_.bytesPerElement}function d(_,b){i.drawElements(n,b,s,_*a),t.update(b,n,1)}function p(_,b,T){T!==0&&(i.drawElementsInstanced(n,b,s,_*a,T),t.update(b,n,T))}function m(_,b,T){if(T===0)return;e.get("WEBGL_multi_draw").multiDrawElementsWEBGL(n,b,0,s,_,0,T);let C=0;for(let A=0;A<T;A++)C+=b[A];t.update(C,n,1)}function v(_,b,T,I){if(T===0)return;const C=e.get("WEBGL_multi_draw");if(C===null)for(let A=0;A<_.length;A++)p(_[A]/a,b[A],I[A]);else{C.multiDrawElementsInstancedWEBGL(n,b,0,s,_,0,I,0,T);let A=0;for(let D=0;D<T;D++)A+=b[D]*I[D];t.update(A,n,1)}}this.setMode=r,this.setIndex=c,this.render=d,this.renderInstances=p,this.renderMultiDraw=m,this.renderMultiDrawInstances=v}function WO(i){const e={geometries:0,textures:0},t={frame:0,calls:0,triangles:0,points:0,lines:0};function n(s,a,c){switch(t.calls++,a){case i.TRIANGLES:t.triangles+=c*(s/3);break;case i.LINES:t.lines+=c*(s/2);break;case i.LINE_STRIP:t.lines+=c*(s-1);break;case i.LINE_LOOP:t.lines+=c*s;break;case i.POINTS:t.points+=c*s;break;default:Jt("WebGLInfo: Unknown draw mode:",a);break}}function r(){t.calls=0,t.triangles=0,t.points=0,t.lines=0}return{memory:e,render:t,programs:null,autoReset:!0,reset:r,update:n}}function XO(i,e,t){const n=new WeakMap,r=new $n;function s(a,c,d){const p=a.morphTargetInfluences,m=c.morphAttributes.position||c.morphAttributes.normal||c.morphAttributes.color,v=m!==void 0?m.length:0;let _=n.get(c);if(_===void 0||_.count!==v){let O=function(){G.dispose(),n.delete(c),c.removeEventListener("dispose",O)};var b=O;_!==void 0&&_.texture.dispose();const T=c.morphAttributes.position!==void 0,I=c.morphAttributes.normal!==void 0,C=c.morphAttributes.color!==void 0,A=c.morphAttributes.position||[],D=c.morphAttributes.normal||[],U=c.morphAttributes.color||[];let L=0;T===!0&&(L=1),I===!0&&(L=2),C===!0&&(L=3);let z=c.attributes.position.count*L,B=1;z>e.maxTextureSize&&(B=Math.ceil(z/e.maxTextureSize),z=e.maxTextureSize);const k=new Float32Array(z*B*4*v),G=new hx(k,z,B,v);G.type=Ni,G.needsUpdate=!0;const P=L*4;for(let Z=0;Z<v;Z++){const ie=A[Z],ee=D[Z],re=U[Z],de=z*B*4*Z;for(let J=0;J<ie.count;J++){const te=J*P;T===!0&&(r.fromBufferAttribute(ie,J),k[de+te+0]=r.x,k[de+te+1]=r.y,k[de+te+2]=r.z,k[de+te+3]=0),I===!0&&(r.fromBufferAttribute(ee,J),k[de+te+4]=r.x,k[de+te+5]=r.y,k[de+te+6]=r.z,k[de+te+7]=0),C===!0&&(r.fromBufferAttribute(re,J),k[de+te+8]=r.x,k[de+te+9]=r.y,k[de+te+10]=r.z,k[de+te+11]=re.itemSize===4?r.w:1)}}_={count:v,texture:G,size:new $e(z,B)},n.set(c,_),c.addEventListener("dispose",O)}if(a.isInstancedMesh===!0&&a.morphTexture!==null)d.getUniforms().setValue(i,"morphTexture",a.morphTexture,t);else{let T=0;for(let C=0;C<p.length;C++)T+=p[C];const I=c.morphTargetsRelative?1:1-T;d.getUniforms().setValue(i,"morphTargetBaseInfluence",I),d.getUniforms().setValue(i,"morphTargetInfluences",p)}d.getUniforms().setValue(i,"morphTargetsTexture",_.texture,t),d.getUniforms().setValue(i,"morphTargetsTextureSize",_.size)}return{update:s}}function YO(i,e,t,n){let r=new WeakMap;function s(d){const p=n.render.frame,m=d.geometry,v=e.get(d,m);if(r.get(v)!==p&&(e.update(v),r.set(v,p)),d.isInstancedMesh&&(d.hasEventListener("dispose",c)===!1&&d.addEventListener("dispose",c),r.get(d)!==p&&(t.update(d.instanceMatrix,i.ARRAY_BUFFER),d.instanceColor!==null&&t.update(d.instanceColor,i.ARRAY_BUFFER),r.set(d,p))),d.isSkinnedMesh){const _=d.skeleton;r.get(_)!==p&&(_.update(),r.set(_,p))}return v}function a(){r=new WeakMap}function c(d){const p=d.target;p.removeEventListener("dispose",c),t.remove(p.instanceMatrix),p.instanceColor!==null&&t.remove(p.instanceColor)}return{update:s,dispose:a}}const JO={[kM]:"LINEAR_TONE_MAPPING",[OM]:"REINHARD_TONE_MAPPING",[zM]:"CINEON_TONE_MAPPING",[ix]:"ACES_FILMIC_TONE_MAPPING",[VM]:"AGX_TONE_MAPPING",[HM]:"NEUTRAL_TONE_MAPPING",[BM]:"CUSTOM_TONE_MAPPING"};function ZO(i,e,t,n,r){const s=new Or(e,t,{type:i,depthBuffer:n,stencilBuffer:r}),a=new Or(e,t,{type:Wi,depthBuffer:!1,stencilBuffer:!1}),c=new vn;c.setAttribute("position",new zt([-1,3,0,-1,-1,0,3,-1,0],3)),c.setAttribute("uv",new zt([0,2,0,0,2,0],2));const d=new cE({uniforms:{tDiffuse:{value:null}},vertexShader:`
			precision highp float;

			uniform mat4 modelViewMatrix;
			uniform mat4 projectionMatrix;

			attribute vec3 position;
			attribute vec2 uv;

			varying vec2 vUv;

			void main() {
				vUv = uv;
				gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
			}`,fragmentShader:`
			precision highp float;

			uniform sampler2D tDiffuse;

			varying vec2 vUv;

			#include <tonemapping_pars_fragment>
			#include <colorspace_pars_fragment>

			void main() {
				gl_FragColor = texture2D( tDiffuse, vUv );

				#ifdef LINEAR_TONE_MAPPING
					gl_FragColor.rgb = LinearToneMapping( gl_FragColor.rgb );
				#elif defined( REINHARD_TONE_MAPPING )
					gl_FragColor.rgb = ReinhardToneMapping( gl_FragColor.rgb );
				#elif defined( CINEON_TONE_MAPPING )
					gl_FragColor.rgb = CineonToneMapping( gl_FragColor.rgb );
				#elif defined( ACES_FILMIC_TONE_MAPPING )
					gl_FragColor.rgb = ACESFilmicToneMapping( gl_FragColor.rgb );
				#elif defined( AGX_TONE_MAPPING )
					gl_FragColor.rgb = AgXToneMapping( gl_FragColor.rgb );
				#elif defined( NEUTRAL_TONE_MAPPING )
					gl_FragColor.rgb = NeutralToneMapping( gl_FragColor.rgb );
				#elif defined( CUSTOM_TONE_MAPPING )
					gl_FragColor.rgb = CustomToneMapping( gl_FragColor.rgb );
				#endif

				#ifdef SRGB_TRANSFER
					gl_FragColor = sRGBTransferOETF( gl_FragColor );
				#endif
			}`,depthTest:!1,depthWrite:!1}),p=new Di(c,d),m=new jf(-1,1,1,-1,0,1);let v=null,_=null,b=!1,T,I=null,C=[],A=!1;this.setSize=function(D,U){s.setSize(D,U),a.setSize(D,U);for(let L=0;L<C.length;L++){const z=C[L];z.setSize&&z.setSize(D,U)}},this.setEffects=function(D){C=D,A=C.length>0&&C[0].isRenderPass===!0;const U=s.width,L=s.height;for(let z=0;z<C.length;z++){const B=C[z];B.setSize&&B.setSize(U,L)}},this.begin=function(D,U){if(b||D.toneMapping===ta&&C.length===0)return!1;if(I=U,U!==null){const L=U.width,z=U.height;(s.width!==L||s.height!==z)&&this.setSize(L,z)}return A===!1&&D.setRenderTarget(s),T=D.toneMapping,D.toneMapping=ta,!0},this.hasRenderPass=function(){return A},this.end=function(D,U){D.toneMapping=T,b=!0;let L=s,z=a;for(let B=0;B<C.length;B++){const k=C[B];if(k.enabled!==!1&&(k.render(D,z,L,U),k.needsSwap!==!1)){const G=L;L=z,z=G}}if(v!==D.outputColorSpace||_!==D.toneMapping){v=D.outputColorSpace,_=D.toneMapping,d.defines={},Gn.getTransfer(v)===oi&&(d.defines.SRGB_TRANSFER="");const B=JO[_];B&&(d.defines[B]=""),d.needsUpdate=!0}d.uniforms.tDiffuse.value=L.texture,D.setRenderTarget(I),D.render(p,m),I=null,b=!1},this.isCompositing=function(){return b},this.dispose=function(){s.dispose(),a.dispose(),c.dispose(),d.dispose()}}const AI=new hi,cM=new Wf(1,1),wI=new hx,CI=new px,RI=new Vg,hA=[],pA=[],mA=new Float32Array(16),gA=new Float32Array(9),vA=new Float32Array(4);function sp(i,e,t){const n=i[0];if(n<=0||n>0)return i;const r=e*t;let s=hA[r];if(s===void 0&&(s=new Float32Array(r),hA[r]=s),e!==0){n.toArray(s,0);for(let a=1,c=0;a!==e;++a)c+=t,i[a].toArray(s,c)}return s}function wr(i,e){if(i.length!==e.length)return!1;for(let t=0,n=i.length;t<n;t++)if(i[t]!==e[t])return!1;return!0}function Cr(i,e){for(let t=0,n=e.length;t<n;t++)i[t]=e[t]}function Bx(i,e){let t=pA[e];t===void 0&&(t=new Int32Array(e),pA[e]=t);for(let n=0;n!==e;++n)t[n]=i.allocateTextureUnit();return t}function $O(i,e){const t=this.cache;t[0]!==e&&(i.uniform1f(this.addr,e),t[0]=e)}function KO(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(i.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(wr(t,e))return;i.uniform2fv(this.addr,e),Cr(t,e)}}function QO(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(i.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e.r!==void 0)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(i.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(wr(t,e))return;i.uniform3fv(this.addr,e),Cr(t,e)}}function jO(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(i.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(wr(t,e))return;i.uniform4fv(this.addr,e),Cr(t,e)}}function ez(i,e){const t=this.cache,n=e.elements;if(n===void 0){if(wr(t,e))return;i.uniformMatrix2fv(this.addr,!1,e),Cr(t,e)}else{if(wr(t,n))return;vA.set(n),i.uniformMatrix2fv(this.addr,!1,vA),Cr(t,n)}}function tz(i,e){const t=this.cache,n=e.elements;if(n===void 0){if(wr(t,e))return;i.uniformMatrix3fv(this.addr,!1,e),Cr(t,e)}else{if(wr(t,n))return;gA.set(n),i.uniformMatrix3fv(this.addr,!1,gA),Cr(t,n)}}function nz(i,e){const t=this.cache,n=e.elements;if(n===void 0){if(wr(t,e))return;i.uniformMatrix4fv(this.addr,!1,e),Cr(t,e)}else{if(wr(t,n))return;mA.set(n),i.uniformMatrix4fv(this.addr,!1,mA),Cr(t,n)}}function iz(i,e){const t=this.cache;t[0]!==e&&(i.uniform1i(this.addr,e),t[0]=e)}function rz(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(i.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(wr(t,e))return;i.uniform2iv(this.addr,e),Cr(t,e)}}function sz(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(i.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(wr(t,e))return;i.uniform3iv(this.addr,e),Cr(t,e)}}function oz(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(i.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(wr(t,e))return;i.uniform4iv(this.addr,e),Cr(t,e)}}function az(i,e){const t=this.cache;t[0]!==e&&(i.uniform1ui(this.addr,e),t[0]=e)}function lz(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(i.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(wr(t,e))return;i.uniform2uiv(this.addr,e),Cr(t,e)}}function uz(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(i.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(wr(t,e))return;i.uniform3uiv(this.addr,e),Cr(t,e)}}function cz(i,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(i.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(wr(t,e))return;i.uniform4uiv(this.addr,e),Cr(t,e)}}function fz(i,e,t){const n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r);let s;this.type===i.SAMPLER_2D_SHADOW?(cM.compareFunction=t.isReversedDepthBuffer()?dx:fx,s=cM):s=AI,t.setTexture2D(e||s,r)}function dz(i,e,t){const n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),t.setTexture3D(e||CI,r)}function hz(i,e,t){const n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),t.setTextureCube(e||RI,r)}function pz(i,e,t){const n=this.cache,r=t.allocateTextureUnit();n[0]!==r&&(i.uniform1i(this.addr,r),n[0]=r),t.setTexture2DArray(e||wI,r)}function mz(i){switch(i){case 5126:return $O;case 35664:return KO;case 35665:return QO;case 35666:return jO;case 35674:return ez;case 35675:return tz;case 35676:return nz;case 5124:case 35670:return iz;case 35667:case 35671:return rz;case 35668:case 35672:return sz;case 35669:case 35673:return oz;case 5125:return az;case 36294:return lz;case 36295:return uz;case 36296:return cz;case 35678:case 36198:case 36298:case 36306:case 35682:return fz;case 35679:case 36299:case 36307:return dz;case 35680:case 36300:case 36308:case 36293:return hz;case 36289:case 36303:case 36311:case 36292:return pz}}function gz(i,e){i.uniform1fv(this.addr,e)}function vz(i,e){const t=sp(e,this.size,2);i.uniform2fv(this.addr,t)}function yz(i,e){const t=sp(e,this.size,3);i.uniform3fv(this.addr,t)}function _z(i,e){const t=sp(e,this.size,4);i.uniform4fv(this.addr,t)}function xz(i,e){const t=sp(e,this.size,4);i.uniformMatrix2fv(this.addr,!1,t)}function Sz(i,e){const t=sp(e,this.size,9);i.uniformMatrix3fv(this.addr,!1,t)}function bz(i,e){const t=sp(e,this.size,16);i.uniformMatrix4fv(this.addr,!1,t)}function Mz(i,e){i.uniform1iv(this.addr,e)}function Ez(i,e){i.uniform2iv(this.addr,e)}function Tz(i,e){i.uniform3iv(this.addr,e)}function Az(i,e){i.uniform4iv(this.addr,e)}function wz(i,e){i.uniform1uiv(this.addr,e)}function Cz(i,e){i.uniform2uiv(this.addr,e)}function Rz(i,e){i.uniform3uiv(this.addr,e)}function Iz(i,e){i.uniform4uiv(this.addr,e)}function Nz(i,e,t){const n=this.cache,r=e.length,s=Bx(t,r);wr(n,s)||(i.uniform1iv(this.addr,s),Cr(n,s));let a;this.type===i.SAMPLER_2D_SHADOW?a=cM:a=AI;for(let c=0;c!==r;++c)t.setTexture2D(e[c]||a,s[c])}function Dz(i,e,t){const n=this.cache,r=e.length,s=Bx(t,r);wr(n,s)||(i.uniform1iv(this.addr,s),Cr(n,s));for(let a=0;a!==r;++a)t.setTexture3D(e[a]||CI,s[a])}function Uz(i,e,t){const n=this.cache,r=e.length,s=Bx(t,r);wr(n,s)||(i.uniform1iv(this.addr,s),Cr(n,s));for(let a=0;a!==r;++a)t.setTextureCube(e[a]||RI,s[a])}function Pz(i,e,t){const n=this.cache,r=e.length,s=Bx(t,r);wr(n,s)||(i.uniform1iv(this.addr,s),Cr(n,s));for(let a=0;a!==r;++a)t.setTexture2DArray(e[a]||wI,s[a])}function Lz(i){switch(i){case 5126:return gz;case 35664:return vz;case 35665:return yz;case 35666:return _z;case 35674:return xz;case 35675:return Sz;case 35676:return bz;case 5124:case 35670:return Mz;case 35667:case 35671:return Ez;case 35668:case 35672:return Tz;case 35669:case 35673:return Az;case 5125:return wz;case 36294:return Cz;case 36295:return Rz;case 36296:return Iz;case 35678:case 36198:case 36298:case 36306:case 35682:return Nz;case 35679:case 36299:case 36307:return Dz;case 35680:case 36300:case 36308:case 36293:return Uz;case 36289:case 36303:case 36311:case 36292:return Pz}}class Fz{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.type=t.type,this.setValue=mz(t.type)}}class kz{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=Lz(t.type)}}class Oz{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,n){const r=this.seq;for(let s=0,a=r.length;s!==a;++s){const c=r[s];c.setValue(e,t[c.id],n)}}}const Tb=/(\w+)(\])?(\[|\.)?/g;function yA(i,e){i.seq.push(e),i.map[e.id]=e}function zz(i,e,t){const n=i.name,r=n.length;for(Tb.lastIndex=0;;){const s=Tb.exec(n),a=Tb.lastIndex;let c=s[1];const d=s[2]==="]",p=s[3];if(d&&(c=c|0),p===void 0||p==="["&&a+2===r){yA(t,p===void 0?new Fz(c,i,e):new kz(c,i,e));break}else{let v=t.map[c];v===void 0&&(v=new Oz(c),yA(t,v)),t=v}}}class Wy{constructor(e,t){this.seq=[],this.map={};const n=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let a=0;a<n;++a){const c=e.getActiveUniform(t,a),d=e.getUniformLocation(t,c.name);zz(c,d,this)}const r=[],s=[];for(const a of this.seq)a.type===e.SAMPLER_2D_SHADOW||a.type===e.SAMPLER_CUBE_SHADOW||a.type===e.SAMPLER_2D_ARRAY_SHADOW?r.push(a):s.push(a);r.length>0&&(this.seq=r.concat(s))}setValue(e,t,n,r){const s=this.map[t];s!==void 0&&s.setValue(e,n,r)}setOptional(e,t,n){const r=t[n];r!==void 0&&this.setValue(e,n,r)}static upload(e,t,n,r){for(let s=0,a=t.length;s!==a;++s){const c=t[s],d=n[c.id];d.needsUpdate!==!1&&c.setValue(e,d.value,r)}}static seqWithValue(e,t){const n=[];for(let r=0,s=e.length;r!==s;++r){const a=e[r];a.id in t&&n.push(a)}return n}}function _A(i,e,t){const n=i.createShader(e);return i.shaderSource(n,t),i.compileShader(n),n}const Bz=37297;let Vz=0;function Hz(i,e){const t=i.split(`
`),n=[],r=Math.max(e-6,0),s=Math.min(e+6,t.length);for(let a=r;a<s;a++){const c=a+1;n.push(`${c===e?">":" "} ${c}: ${t[a]}`)}return n.join(`
`)}const xA=new xn;function Gz(i){Gn._getMatrix(xA,Gn.workingColorSpace,i);const e=`mat3( ${xA.elements.map(t=>t.toFixed(4))} )`;switch(Gn.getTransfer(i)){case bg:return[e,"LinearTransferOETF"];case oi:return[e,"sRGBTransferOETF"];default:return It("WebGLProgram: Unsupported color space: ",i),[e,"LinearTransferOETF"]}}function SA(i,e,t){const n=i.getShaderParameter(e,i.COMPILE_STATUS),s=(i.getShaderInfoLog(e)||"").trim();if(n&&s==="")return"";const a=/ERROR: 0:(\d+)/.exec(s);if(a){const c=parseInt(a[1]);return t.toUpperCase()+`

`+s+`

`+Hz(i.getShaderSource(e),c)}else return s}function qz(i,e){const t=Gz(e);return[`vec4 ${i}( vec4 value ) {`,`	return ${t[1]}( vec4( value.rgb * ${t[0]}, value.a ) );`,"}"].join(`
`)}const Wz={[kM]:"Linear",[OM]:"Reinhard",[zM]:"Cineon",[ix]:"ACESFilmic",[VM]:"AgX",[HM]:"Neutral",[BM]:"Custom"};function Xz(i,e){const t=Wz[e];return t===void 0?(It("WebGLProgram: Unsupported toneMapping:",e),"vec3 "+i+"( vec3 color ) { return LinearToneMapping( color ); }"):"vec3 "+i+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}const Cy=new Q;function Yz(){Gn.getLuminanceCoefficients(Cy);const i=Cy.x.toFixed(4),e=Cy.y.toFixed(4),t=Cy.z.toFixed(4);return["float luminance( const in vec3 rgb ) {",`	const vec3 weights = vec3( ${i}, ${e}, ${t} );`,"	return dot( weights, rgb );","}"].join(`
`)}function Jz(i){return[i.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",i.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(ng).join(`
`)}function Zz(i){const e=[];for(const t in i){const n=i[t];n!==!1&&e.push("#define "+t+" "+n)}return e.join(`
`)}function $z(i,e){const t={},n=i.getProgramParameter(e,i.ACTIVE_ATTRIBUTES);for(let r=0;r<n;r++){const s=i.getActiveAttrib(e,r),a=s.name;let c=1;s.type===i.FLOAT_MAT2&&(c=2),s.type===i.FLOAT_MAT3&&(c=3),s.type===i.FLOAT_MAT4&&(c=4),t[a]={type:s.type,location:i.getAttribLocation(e,a),locationSize:c}}return t}function ng(i){return i!==""}function bA(i,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return i.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function MA(i,e){return i.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const Kz=/^[ \t]*#include +<([\w\d./]+)>/gm;function fM(i){return i.replace(Kz,jz)}const Qz=new Map;function jz(i,e){let t=Cn[e];if(t===void 0){const n=Qz.get(e);if(n!==void 0)t=Cn[n],It('WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,n);else throw new Error("Can not resolve #include <"+e+">")}return fM(t)}const eB=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function EA(i){return i.replace(eB,tB)}function tB(i,e,t,n){let r="";for(let s=parseInt(e);s<parseInt(t);s++)r+=n.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return r}function TA(i){let e=`precision ${i.precision} float;
	precision ${i.precision} int;
	precision ${i.precision} sampler2D;
	precision ${i.precision} samplerCube;
	precision ${i.precision} sampler3D;
	precision ${i.precision} sampler2DArray;
	precision ${i.precision} sampler2DShadow;
	precision ${i.precision} samplerCubeShadow;
	precision ${i.precision} sampler2DArrayShadow;
	precision ${i.precision} isampler2D;
	precision ${i.precision} isampler3D;
	precision ${i.precision} isamplerCube;
	precision ${i.precision} isampler2DArray;
	precision ${i.precision} usampler2D;
	precision ${i.precision} usampler3D;
	precision ${i.precision} usamplerCube;
	precision ${i.precision} usampler2DArray;
	`;return i.precision==="highp"?e+=`
#define HIGH_PRECISION`:i.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:i.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}const nB={[Oh]:"SHADOWMAP_TYPE_PCF",[Uf]:"SHADOWMAP_TYPE_VSM"};function iB(i){return nB[i.shadowMapType]||"SHADOWMAP_TYPE_BASIC"}const rB={[Ua]:"ENVMAP_TYPE_CUBE",[Mc]:"ENVMAP_TYPE_CUBE",[np]:"ENVMAP_TYPE_CUBE_UV"};function sB(i){return i.envMap===!1?"ENVMAP_TYPE_CUBE":rB[i.envMapMode]||"ENVMAP_TYPE_CUBE"}const oB={[Mc]:"ENVMAP_MODE_REFRACTION"};function aB(i){return i.envMap===!1?"ENVMAP_MODE_REFLECTION":oB[i.envMapMode]||"ENVMAP_MODE_REFLECTION"}const lB={[kg]:"ENVMAP_BLENDING_MULTIPLY",[cR]:"ENVMAP_BLENDING_MIX",[fR]:"ENVMAP_BLENDING_ADD"};function uB(i){return i.envMap===!1?"ENVMAP_BLENDING_NONE":lB[i.combine]||"ENVMAP_BLENDING_NONE"}function cB(i){const e=i.envMapCubeUVHeight;if(e===null)return null;const t=Math.log2(e)-2,n=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),112)),texelHeight:n,maxMip:t}}function fB(i,e,t,n){const r=i.getContext(),s=t.defines;let a=t.vertexShader,c=t.fragmentShader;const d=iB(t),p=sB(t),m=aB(t),v=uB(t),_=cB(t),b=Jz(t),T=Zz(s),I=r.createProgram();let C,A,D=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?(C=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,T].filter(ng).join(`
`),C.length>0&&(C+=`
`),A=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,T].filter(ng).join(`
`),A.length>0&&(A+=`
`)):(C=[TA(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,T,t.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",t.batching?"#define USE_BATCHING":"",t.batchingColor?"#define USE_BATCHING_COLOR":"",t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.instancingMorph?"#define USE_INSTANCING_MORPH":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+m:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.morphColors?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+d:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.logarithmicDepthBuffer?"#define USE_LOGARITHMIC_DEPTH_BUFFER":"",t.reversedDepthBuffer?"#define USE_REVERSED_DEPTH_BUFFER":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","	uniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(ng).join(`
`),A=[TA(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,T,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+p:"",t.envMap?"#define "+m:"",t.envMap?"#define "+v:"",_?"#define CUBEUV_TEXEL_WIDTH "+_.texelWidth:"",_?"#define CUBEUV_TEXEL_HEIGHT "+_.texelHeight:"",_?"#define CUBEUV_MAX_MIP "+_.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.dispersion?"#define USE_DISPERSION":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor||t.batchingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+d:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.decodeVideoTextureEmissive?"#define DECODE_VIDEO_TEXTURE_EMISSIVE":"",t.logarithmicDepthBuffer?"#define USE_LOGARITHMIC_DEPTH_BUFFER":"",t.reversedDepthBuffer?"#define USE_REVERSED_DEPTH_BUFFER":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==ta?"#define TONE_MAPPING":"",t.toneMapping!==ta?Cn.tonemapping_pars_fragment:"",t.toneMapping!==ta?Xz("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",Cn.colorspace_pars_fragment,qz("linearToOutputTexel",t.outputColorSpace),Yz(),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(ng).join(`
`)),a=fM(a),a=bA(a,t),a=MA(a,t),c=fM(c),c=bA(c,t),c=MA(c,t),a=EA(a),c=EA(c),t.isRawShaderMaterial!==!0&&(D=`#version 300 es
`,C=[b,"#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+C,A=["#define varying in",t.glslVersion===tM?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===tM?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+A);const U=D+C+a,L=D+A+c,z=_A(r,r.VERTEX_SHADER,U),B=_A(r,r.FRAGMENT_SHADER,L);r.attachShader(I,z),r.attachShader(I,B),t.index0AttributeName!==void 0?r.bindAttribLocation(I,0,t.index0AttributeName):t.morphTargets===!0&&r.bindAttribLocation(I,0,"position"),r.linkProgram(I);function k(Z){if(i.debug.checkShaderErrors){const ie=r.getProgramInfoLog(I)||"",ee=r.getShaderInfoLog(z)||"",re=r.getShaderInfoLog(B)||"",de=ie.trim(),J=ee.trim(),te=re.trim();let ye=!0,Ue=!0;if(r.getProgramParameter(I,r.LINK_STATUS)===!1)if(ye=!1,typeof i.debug.onShaderError=="function")i.debug.onShaderError(r,I,z,B);else{const we=SA(r,z,"vertex"),$=SA(r,B,"fragment");Jt("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(I,r.VALIDATE_STATUS)+`

Material Name: `+Z.name+`
Material Type: `+Z.type+`

Program Info Log: `+de+`
`+we+`
`+$)}else de!==""?It("WebGLProgram: Program Info Log:",de):(J===""||te==="")&&(Ue=!1);Ue&&(Z.diagnostics={runnable:ye,programLog:de,vertexShader:{log:J,prefix:C},fragmentShader:{log:te,prefix:A}})}r.deleteShader(z),r.deleteShader(B),G=new Wy(r,I),P=$z(r,I)}let G;this.getUniforms=function(){return G===void 0&&k(this),G};let P;this.getAttributes=function(){return P===void 0&&k(this),P};let O=t.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return O===!1&&(O=r.getProgramParameter(I,Bz)),O},this.destroy=function(){n.releaseStatesOfProgram(this),r.deleteProgram(I),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=Vz++,this.cacheKey=e,this.usedTimes=1,this.program=I,this.vertexShader=z,this.fragmentShader=B,this}let dB=0;class hB{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,n=e.fragmentShader,r=this._getShaderStage(t),s=this._getShaderStage(n),a=this._getShaderCacheForMaterial(e);return a.has(r)===!1&&(a.add(r),r.usedTimes++),a.has(s)===!1&&(a.add(s),s.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const n of t)n.usedTimes--,n.usedTimes===0&&this.shaderCache.delete(n.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let n=t.get(e);return n===void 0&&(n=new Set,t.set(e,n)),n}_getShaderStage(e){const t=this.shaderCache;let n=t.get(e);return n===void 0&&(n=new pB(e),t.set(e,n)),n}}class pB{constructor(e){this.id=dB++,this.code=e,this.usedTimes=0}}function mB(i,e,t,n,r,s,a){const c=new Zh,d=new hB,p=new Set,m=[],v=new Map,_=r.logarithmicDepthBuffer;let b=r.precision;const T={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distance",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function I(P){return p.add(P),P===0?"uv":`uv${P}`}function C(P,O,Z,ie,ee){const re=ie.fog,de=ee.geometry,J=P.isMeshStandardMaterial?ie.environment:null,te=(P.isMeshStandardMaterial?t:e).get(P.envMap||J),ye=te&&te.mapping===np?te.image.height:null,Ue=T[P.type];P.precision!==null&&(b=r.getMaxPrecision(P.precision),b!==P.precision&&It("WebGLProgram.getParameters:",P.precision,"not supported, using",b,"instead."));const we=de.morphAttributes.position||de.morphAttributes.normal||de.morphAttributes.color,$=we!==void 0?we.length:0;let ce=0;de.morphAttributes.position!==void 0&&(ce=1),de.morphAttributes.normal!==void 0&&(ce=2),de.morphAttributes.color!==void 0&&(ce=3);let Ee,Be,St,ve;if(Ue){const Ln=Ca[Ue];Ee=Ln.vertexShader,Be=Ln.fragmentShader}else Ee=P.vertexShader,Be=P.fragmentShader,d.update(P),St=d.getVertexShaderID(P),ve=d.getFragmentShaderID(P);const Re=i.getRenderTarget(),ot=i.state.buffers.depth.getReversed(),bt=ee.isInstancedMesh===!0,Dt=ee.isBatchedMesh===!0,cn=!!P.map,Tn=!!P.matcap,Zt=!!te,Ve=!!P.aoMap,et=!!P.lightMap,qe=!!P.bumpMap,_t=!!P.normalMap,j=!!P.displacementMap,Ht=!!P.emissiveMap,Et=!!P.metalnessMap,Gt=!!P.roughnessMap,ut=P.anisotropy>0,K=P.clearcoat>0,V=P.dispersion>0,pe=P.iridescence>0,De=P.sheen>0,We=P.transmission>0,Ne=ut&&!!P.anisotropyMap,Ct=K&&!!P.clearcoatMap,ht=K&&!!P.clearcoatNormalMap,Ot=K&&!!P.clearcoatRoughnessMap,$t=pe&&!!P.iridescenceMap,Ze=pe&&!!P.iridescenceThicknessMap,Ke=De&&!!P.sheenColorMap,Nt=De&&!!P.sheenRoughnessMap,Tt=!!P.specularMap,at=!!P.specularColorMap,Xt=!!P.specularIntensityMap,me=We&&!!P.transmissionMap,Ce=We&&!!P.thicknessMap,nt=!!P.gradientMap,wt=!!P.alphaMap,tt=P.alphaTest>0,He=!!P.alphaHash,vt=!!P.extensions;let nn=ta;P.toneMapped&&(Re===null||Re.isXRRenderTarget===!0)&&(nn=i.toneMapping);const Nn={shaderID:Ue,shaderType:P.type,shaderName:P.name,vertexShader:Ee,fragmentShader:Be,defines:P.defines,customVertexShaderID:St,customFragmentShaderID:ve,isRawShaderMaterial:P.isRawShaderMaterial===!0,glslVersion:P.glslVersion,precision:b,batching:Dt,batchingColor:Dt&&ee._colorsTexture!==null,instancing:bt,instancingColor:bt&&ee.instanceColor!==null,instancingMorph:bt&&ee.morphTexture!==null,outputColorSpace:Re===null?i.outputColorSpace:Re.isXRRenderTarget===!0?Re.texture.colorSpace:Pa,alphaToCoverage:!!P.alphaToCoverage,map:cn,matcap:Tn,envMap:Zt,envMapMode:Zt&&te.mapping,envMapCubeUVHeight:ye,aoMap:Ve,lightMap:et,bumpMap:qe,normalMap:_t,displacementMap:j,emissiveMap:Ht,normalMapObjectSpace:_t&&P.normalMapType===vR,normalMapTangentSpace:_t&&P.normalMapType===Ac,metalnessMap:Et,roughnessMap:Gt,anisotropy:ut,anisotropyMap:Ne,clearcoat:K,clearcoatMap:Ct,clearcoatNormalMap:ht,clearcoatRoughnessMap:Ot,dispersion:V,iridescence:pe,iridescenceMap:$t,iridescenceThicknessMap:Ze,sheen:De,sheenColorMap:Ke,sheenRoughnessMap:Nt,specularMap:Tt,specularColorMap:at,specularIntensityMap:Xt,transmission:We,transmissionMap:me,thicknessMap:Ce,gradientMap:nt,opaque:P.transparent===!1&&P.blending===zf&&P.alphaToCoverage===!1,alphaMap:wt,alphaTest:tt,alphaHash:He,combine:P.combine,mapUv:cn&&I(P.map.channel),aoMapUv:Ve&&I(P.aoMap.channel),lightMapUv:et&&I(P.lightMap.channel),bumpMapUv:qe&&I(P.bumpMap.channel),normalMapUv:_t&&I(P.normalMap.channel),displacementMapUv:j&&I(P.displacementMap.channel),emissiveMapUv:Ht&&I(P.emissiveMap.channel),metalnessMapUv:Et&&I(P.metalnessMap.channel),roughnessMapUv:Gt&&I(P.roughnessMap.channel),anisotropyMapUv:Ne&&I(P.anisotropyMap.channel),clearcoatMapUv:Ct&&I(P.clearcoatMap.channel),clearcoatNormalMapUv:ht&&I(P.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:Ot&&I(P.clearcoatRoughnessMap.channel),iridescenceMapUv:$t&&I(P.iridescenceMap.channel),iridescenceThicknessMapUv:Ze&&I(P.iridescenceThicknessMap.channel),sheenColorMapUv:Ke&&I(P.sheenColorMap.channel),sheenRoughnessMapUv:Nt&&I(P.sheenRoughnessMap.channel),specularMapUv:Tt&&I(P.specularMap.channel),specularColorMapUv:at&&I(P.specularColorMap.channel),specularIntensityMapUv:Xt&&I(P.specularIntensityMap.channel),transmissionMapUv:me&&I(P.transmissionMap.channel),thicknessMapUv:Ce&&I(P.thicknessMap.channel),alphaMapUv:wt&&I(P.alphaMap.channel),vertexTangents:!!de.attributes.tangent&&(_t||ut),vertexColors:P.vertexColors,vertexAlphas:P.vertexColors===!0&&!!de.attributes.color&&de.attributes.color.itemSize===4,pointsUvs:ee.isPoints===!0&&!!de.attributes.uv&&(cn||wt),fog:!!re,useFog:P.fog===!0,fogExp2:!!re&&re.isFogExp2,flatShading:P.flatShading===!0&&P.wireframe===!1,sizeAttenuation:P.sizeAttenuation===!0,logarithmicDepthBuffer:_,reversedDepthBuffer:ot,skinning:ee.isSkinnedMesh===!0,morphTargets:de.morphAttributes.position!==void 0,morphNormals:de.morphAttributes.normal!==void 0,morphColors:de.morphAttributes.color!==void 0,morphTargetsCount:$,morphTextureStride:ce,numDirLights:O.directional.length,numPointLights:O.point.length,numSpotLights:O.spot.length,numSpotLightMaps:O.spotLightMap.length,numRectAreaLights:O.rectArea.length,numHemiLights:O.hemi.length,numDirLightShadows:O.directionalShadowMap.length,numPointLightShadows:O.pointShadowMap.length,numSpotLightShadows:O.spotShadowMap.length,numSpotLightShadowsWithMaps:O.numSpotLightShadowsWithMaps,numLightProbes:O.numLightProbes,numClippingPlanes:a.numPlanes,numClipIntersection:a.numIntersection,dithering:P.dithering,shadowMapEnabled:i.shadowMap.enabled&&Z.length>0,shadowMapType:i.shadowMap.type,toneMapping:nn,decodeVideoTexture:cn&&P.map.isVideoTexture===!0&&Gn.getTransfer(P.map.colorSpace)===oi,decodeVideoTextureEmissive:Ht&&P.emissiveMap.isVideoTexture===!0&&Gn.getTransfer(P.emissiveMap.colorSpace)===oi,premultipliedAlpha:P.premultipliedAlpha,doubleSided:P.side===vo,flipSided:P.side===gs,useDepthPacking:P.depthPacking>=0,depthPacking:P.depthPacking||0,index0AttributeName:P.index0AttributeName,extensionClipCullDistance:vt&&P.extensions.clipCullDistance===!0&&n.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(vt&&P.extensions.multiDraw===!0||Dt)&&n.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:n.has("KHR_parallel_shader_compile"),customProgramCacheKey:P.customProgramCacheKey()};return Nn.vertexUv1s=p.has(1),Nn.vertexUv2s=p.has(2),Nn.vertexUv3s=p.has(3),p.clear(),Nn}function A(P){const O=[];if(P.shaderID?O.push(P.shaderID):(O.push(P.customVertexShaderID),O.push(P.customFragmentShaderID)),P.defines!==void 0)for(const Z in P.defines)O.push(Z),O.push(P.defines[Z]);return P.isRawShaderMaterial===!1&&(D(O,P),U(O,P),O.push(i.outputColorSpace)),O.push(P.customProgramCacheKey),O.join()}function D(P,O){P.push(O.precision),P.push(O.outputColorSpace),P.push(O.envMapMode),P.push(O.envMapCubeUVHeight),P.push(O.mapUv),P.push(O.alphaMapUv),P.push(O.lightMapUv),P.push(O.aoMapUv),P.push(O.bumpMapUv),P.push(O.normalMapUv),P.push(O.displacementMapUv),P.push(O.emissiveMapUv),P.push(O.metalnessMapUv),P.push(O.roughnessMapUv),P.push(O.anisotropyMapUv),P.push(O.clearcoatMapUv),P.push(O.clearcoatNormalMapUv),P.push(O.clearcoatRoughnessMapUv),P.push(O.iridescenceMapUv),P.push(O.iridescenceThicknessMapUv),P.push(O.sheenColorMapUv),P.push(O.sheenRoughnessMapUv),P.push(O.specularMapUv),P.push(O.specularColorMapUv),P.push(O.specularIntensityMapUv),P.push(O.transmissionMapUv),P.push(O.thicknessMapUv),P.push(O.combine),P.push(O.fogExp2),P.push(O.sizeAttenuation),P.push(O.morphTargetsCount),P.push(O.morphAttributeCount),P.push(O.numDirLights),P.push(O.numPointLights),P.push(O.numSpotLights),P.push(O.numSpotLightMaps),P.push(O.numHemiLights),P.push(O.numRectAreaLights),P.push(O.numDirLightShadows),P.push(O.numPointLightShadows),P.push(O.numSpotLightShadows),P.push(O.numSpotLightShadowsWithMaps),P.push(O.numLightProbes),P.push(O.shadowMapType),P.push(O.toneMapping),P.push(O.numClippingPlanes),P.push(O.numClipIntersection),P.push(O.depthPacking)}function U(P,O){c.disableAll(),O.instancing&&c.enable(0),O.instancingColor&&c.enable(1),O.instancingMorph&&c.enable(2),O.matcap&&c.enable(3),O.envMap&&c.enable(4),O.normalMapObjectSpace&&c.enable(5),O.normalMapTangentSpace&&c.enable(6),O.clearcoat&&c.enable(7),O.iridescence&&c.enable(8),O.alphaTest&&c.enable(9),O.vertexColors&&c.enable(10),O.vertexAlphas&&c.enable(11),O.vertexUv1s&&c.enable(12),O.vertexUv2s&&c.enable(13),O.vertexUv3s&&c.enable(14),O.vertexTangents&&c.enable(15),O.anisotropy&&c.enable(16),O.alphaHash&&c.enable(17),O.batching&&c.enable(18),O.dispersion&&c.enable(19),O.batchingColor&&c.enable(20),O.gradientMap&&c.enable(21),P.push(c.mask),c.disableAll(),O.fog&&c.enable(0),O.useFog&&c.enable(1),O.flatShading&&c.enable(2),O.logarithmicDepthBuffer&&c.enable(3),O.reversedDepthBuffer&&c.enable(4),O.skinning&&c.enable(5),O.morphTargets&&c.enable(6),O.morphNormals&&c.enable(7),O.morphColors&&c.enable(8),O.premultipliedAlpha&&c.enable(9),O.shadowMapEnabled&&c.enable(10),O.doubleSided&&c.enable(11),O.flipSided&&c.enable(12),O.useDepthPacking&&c.enable(13),O.dithering&&c.enable(14),O.transmission&&c.enable(15),O.sheen&&c.enable(16),O.opaque&&c.enable(17),O.pointsUvs&&c.enable(18),O.decodeVideoTexture&&c.enable(19),O.decodeVideoTextureEmissive&&c.enable(20),O.alphaToCoverage&&c.enable(21),P.push(c.mask)}function L(P){const O=T[P.type];let Z;if(O){const ie=Ca[O];Z=Ag.clone(ie.uniforms)}else Z=P.uniforms;return Z}function z(P,O){let Z=v.get(O);return Z!==void 0?++Z.usedTimes:(Z=new fB(i,O,P,s),m.push(Z),v.set(O,Z)),Z}function B(P){if(--P.usedTimes===0){const O=m.indexOf(P);m[O]=m[m.length-1],m.pop(),v.delete(P.cacheKey),P.destroy()}}function k(P){d.remove(P)}function G(){d.dispose()}return{getParameters:C,getProgramCacheKey:A,getUniforms:L,acquireProgram:z,releaseProgram:B,releaseShaderCache:k,programs:m,dispose:G}}function gB(){let i=new WeakMap;function e(a){return i.has(a)}function t(a){let c=i.get(a);return c===void 0&&(c={},i.set(a,c)),c}function n(a){i.delete(a)}function r(a,c,d){i.get(a)[c]=d}function s(){i=new WeakMap}return{has:e,get:t,remove:n,update:r,dispose:s}}function vB(i,e){return i.groupOrder!==e.groupOrder?i.groupOrder-e.groupOrder:i.renderOrder!==e.renderOrder?i.renderOrder-e.renderOrder:i.material.id!==e.material.id?i.material.id-e.material.id:i.z!==e.z?i.z-e.z:i.id-e.id}function AA(i,e){return i.groupOrder!==e.groupOrder?i.groupOrder-e.groupOrder:i.renderOrder!==e.renderOrder?i.renderOrder-e.renderOrder:i.z!==e.z?e.z-i.z:i.id-e.id}function wA(){const i=[];let e=0;const t=[],n=[],r=[];function s(){e=0,t.length=0,n.length=0,r.length=0}function a(v,_,b,T,I,C){let A=i[e];return A===void 0?(A={id:v.id,object:v,geometry:_,material:b,groupOrder:T,renderOrder:v.renderOrder,z:I,group:C},i[e]=A):(A.id=v.id,A.object=v,A.geometry=_,A.material=b,A.groupOrder=T,A.renderOrder=v.renderOrder,A.z=I,A.group=C),e++,A}function c(v,_,b,T,I,C){const A=a(v,_,b,T,I,C);b.transmission>0?n.push(A):b.transparent===!0?r.push(A):t.push(A)}function d(v,_,b,T,I,C){const A=a(v,_,b,T,I,C);b.transmission>0?n.unshift(A):b.transparent===!0?r.unshift(A):t.unshift(A)}function p(v,_){t.length>1&&t.sort(v||vB),n.length>1&&n.sort(_||AA),r.length>1&&r.sort(_||AA)}function m(){for(let v=e,_=i.length;v<_;v++){const b=i[v];if(b.id===null)break;b.id=null,b.object=null,b.geometry=null,b.material=null,b.group=null}}return{opaque:t,transmissive:n,transparent:r,init:s,push:c,unshift:d,finish:m,sort:p}}function yB(){let i=new WeakMap;function e(n,r){const s=i.get(n);let a;return s===void 0?(a=new wA,i.set(n,[a])):r>=s.length?(a=new wA,s.push(a)):a=s[r],a}function t(){i=new WeakMap}return{get:e,dispose:t}}function _B(){const i={};return{get:function(e){if(i[e.id]!==void 0)return i[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new Q,color:new Pt};break;case"SpotLight":t={position:new Q,direction:new Q,color:new Pt,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new Q,color:new Pt,distance:0,decay:0};break;case"HemisphereLight":t={direction:new Q,skyColor:new Pt,groundColor:new Pt};break;case"RectAreaLight":t={color:new Pt,position:new Q,halfWidth:new Q,halfHeight:new Q};break}return i[e.id]=t,t}}}function xB(){const i={};return{get:function(e){if(i[e.id]!==void 0)return i[e.id];let t;switch(e.type){case"DirectionalLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new $e};break;case"SpotLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new $e};break;case"PointLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new $e,shadowCameraNear:1,shadowCameraFar:1e3};break}return i[e.id]=t,t}}}let SB=0;function bB(i,e){return(e.castShadow?2:0)-(i.castShadow?2:0)+(e.map?1:0)-(i.map?1:0)}function MB(i){const e=new _B,t=xB(),n={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let p=0;p<9;p++)n.probe.push(new Q);const r=new Q,s=new an,a=new an;function c(p){let m=0,v=0,_=0;for(let P=0;P<9;P++)n.probe[P].set(0,0,0);let b=0,T=0,I=0,C=0,A=0,D=0,U=0,L=0,z=0,B=0,k=0;p.sort(bB);for(let P=0,O=p.length;P<O;P++){const Z=p[P],ie=Z.color,ee=Z.intensity,re=Z.distance;let de=null;if(Z.shadow&&Z.shadow.map&&(Z.shadow.map.texture.format===qf?de=Z.shadow.map.texture:de=Z.shadow.map.depthTexture||Z.shadow.map.texture),Z.isAmbientLight)m+=ie.r*ee,v+=ie.g*ee,_+=ie.b*ee;else if(Z.isLightProbe){for(let J=0;J<9;J++)n.probe[J].addScaledVector(Z.sh.coefficients[J],ee);k++}else if(Z.isDirectionalLight){const J=e.get(Z);if(J.color.copy(Z.color).multiplyScalar(Z.intensity),Z.castShadow){const te=Z.shadow,ye=t.get(Z);ye.shadowIntensity=te.intensity,ye.shadowBias=te.bias,ye.shadowNormalBias=te.normalBias,ye.shadowRadius=te.radius,ye.shadowMapSize=te.mapSize,n.directionalShadow[b]=ye,n.directionalShadowMap[b]=de,n.directionalShadowMatrix[b]=Z.shadow.matrix,D++}n.directional[b]=J,b++}else if(Z.isSpotLight){const J=e.get(Z);J.position.setFromMatrixPosition(Z.matrixWorld),J.color.copy(ie).multiplyScalar(ee),J.distance=re,J.coneCos=Math.cos(Z.angle),J.penumbraCos=Math.cos(Z.angle*(1-Z.penumbra)),J.decay=Z.decay,n.spot[I]=J;const te=Z.shadow;if(Z.map&&(n.spotLightMap[z]=Z.map,z++,te.updateMatrices(Z),Z.castShadow&&B++),n.spotLightMatrix[I]=te.matrix,Z.castShadow){const ye=t.get(Z);ye.shadowIntensity=te.intensity,ye.shadowBias=te.bias,ye.shadowNormalBias=te.normalBias,ye.shadowRadius=te.radius,ye.shadowMapSize=te.mapSize,n.spotShadow[I]=ye,n.spotShadowMap[I]=de,L++}I++}else if(Z.isRectAreaLight){const J=e.get(Z);J.color.copy(ie).multiplyScalar(ee),J.halfWidth.set(Z.width*.5,0,0),J.halfHeight.set(0,Z.height*.5,0),n.rectArea[C]=J,C++}else if(Z.isPointLight){const J=e.get(Z);if(J.color.copy(Z.color).multiplyScalar(Z.intensity),J.distance=Z.distance,J.decay=Z.decay,Z.castShadow){const te=Z.shadow,ye=t.get(Z);ye.shadowIntensity=te.intensity,ye.shadowBias=te.bias,ye.shadowNormalBias=te.normalBias,ye.shadowRadius=te.radius,ye.shadowMapSize=te.mapSize,ye.shadowCameraNear=te.camera.near,ye.shadowCameraFar=te.camera.far,n.pointShadow[T]=ye,n.pointShadowMap[T]=de,n.pointShadowMatrix[T]=Z.shadow.matrix,U++}n.point[T]=J,T++}else if(Z.isHemisphereLight){const J=e.get(Z);J.skyColor.copy(Z.color).multiplyScalar(ee),J.groundColor.copy(Z.groundColor).multiplyScalar(ee),n.hemi[A]=J,A++}}C>0&&(i.has("OES_texture_float_linear")===!0?(n.rectAreaLTC1=Rt.LTC_FLOAT_1,n.rectAreaLTC2=Rt.LTC_FLOAT_2):(n.rectAreaLTC1=Rt.LTC_HALF_1,n.rectAreaLTC2=Rt.LTC_HALF_2)),n.ambient[0]=m,n.ambient[1]=v,n.ambient[2]=_;const G=n.hash;(G.directionalLength!==b||G.pointLength!==T||G.spotLength!==I||G.rectAreaLength!==C||G.hemiLength!==A||G.numDirectionalShadows!==D||G.numPointShadows!==U||G.numSpotShadows!==L||G.numSpotMaps!==z||G.numLightProbes!==k)&&(n.directional.length=b,n.spot.length=I,n.rectArea.length=C,n.point.length=T,n.hemi.length=A,n.directionalShadow.length=D,n.directionalShadowMap.length=D,n.pointShadow.length=U,n.pointShadowMap.length=U,n.spotShadow.length=L,n.spotShadowMap.length=L,n.directionalShadowMatrix.length=D,n.pointShadowMatrix.length=U,n.spotLightMatrix.length=L+z-B,n.spotLightMap.length=z,n.numSpotLightShadowsWithMaps=B,n.numLightProbes=k,G.directionalLength=b,G.pointLength=T,G.spotLength=I,G.rectAreaLength=C,G.hemiLength=A,G.numDirectionalShadows=D,G.numPointShadows=U,G.numSpotShadows=L,G.numSpotMaps=z,G.numLightProbes=k,n.version=SB++)}function d(p,m){let v=0,_=0,b=0,T=0,I=0;const C=m.matrixWorldInverse;for(let A=0,D=p.length;A<D;A++){const U=p[A];if(U.isDirectionalLight){const L=n.directional[v];L.direction.setFromMatrixPosition(U.matrixWorld),r.setFromMatrixPosition(U.target.matrixWorld),L.direction.sub(r),L.direction.transformDirection(C),v++}else if(U.isSpotLight){const L=n.spot[b];L.position.setFromMatrixPosition(U.matrixWorld),L.position.applyMatrix4(C),L.direction.setFromMatrixPosition(U.matrixWorld),r.setFromMatrixPosition(U.target.matrixWorld),L.direction.sub(r),L.direction.transformDirection(C),b++}else if(U.isRectAreaLight){const L=n.rectArea[T];L.position.setFromMatrixPosition(U.matrixWorld),L.position.applyMatrix4(C),a.identity(),s.copy(U.matrixWorld),s.premultiply(C),a.extractRotation(s),L.halfWidth.set(U.width*.5,0,0),L.halfHeight.set(0,U.height*.5,0),L.halfWidth.applyMatrix4(a),L.halfHeight.applyMatrix4(a),T++}else if(U.isPointLight){const L=n.point[_];L.position.setFromMatrixPosition(U.matrixWorld),L.position.applyMatrix4(C),_++}else if(U.isHemisphereLight){const L=n.hemi[I];L.direction.setFromMatrixPosition(U.matrixWorld),L.direction.transformDirection(C),I++}}}return{setup:c,setupView:d,state:n}}function CA(i){const e=new MB(i),t=[],n=[];function r(m){p.camera=m,t.length=0,n.length=0}function s(m){t.push(m)}function a(m){n.push(m)}function c(){e.setup(t)}function d(m){e.setupView(t,m)}const p={lightsArray:t,shadowsArray:n,camera:null,lights:e,transmissionRenderTarget:{}};return{init:r,state:p,setupLights:c,setupLightsView:d,pushLight:s,pushShadow:a}}function EB(i){let e=new WeakMap;function t(r,s=0){const a=e.get(r);let c;return a===void 0?(c=new CA(i),e.set(r,[c])):s>=a.length?(c=new CA(i),a.push(c)):c=a[s],c}function n(){e=new WeakMap}return{get:t,dispose:n}}const TB=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,AB=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ).rg;
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ).r;
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( max( 0.0, squared_mean - mean * mean ) );
	gl_FragColor = vec4( mean, std_dev, 0.0, 1.0 );
}`,wB=[new Q(1,0,0),new Q(-1,0,0),new Q(0,1,0),new Q(0,-1,0),new Q(0,0,1),new Q(0,0,-1)],CB=[new Q(0,-1,0),new Q(0,-1,0),new Q(0,0,1),new Q(0,0,-1),new Q(0,-1,0),new Q(0,-1,0)],RA=new an,Jm=new Q,Ab=new Q;function RB(i,e,t){let n=new rp;const r=new $e,s=new $e,a=new $n,c=new Lx,d=new dE,p={},m=t.maxTextureSize,v={[hu]:gs,[gs]:hu,[vo]:vo},_=new Ar({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new $e},radius:{value:4}},vertexShader:TB,fragmentShader:AB}),b=_.clone();b.defines.HORIZONTAL_PASS=1;const T=new vn;T.setAttribute("position",new pi(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const I=new Di(T,_),C=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=Oh;let A=this.type;this.render=function(B,k,G){if(C.enabled===!1||C.autoUpdate===!1&&C.needsUpdate===!1||B.length===0)return;B.type===rg&&(It("WebGLShadowMap: PCFSoftShadowMap has been deprecated. Using PCFShadowMap instead."),B.type=Oh);const P=i.getRenderTarget(),O=i.getActiveCubeFace(),Z=i.getActiveMipmapLevel(),ie=i.state;ie.setBlending(Ia),ie.buffers.depth.getReversed()===!0?ie.buffers.color.setClear(0,0,0,0):ie.buffers.color.setClear(1,1,1,1),ie.buffers.depth.setTest(!0),ie.setScissorTest(!1);const ee=A!==this.type;ee&&k.traverse(function(re){re.material&&(Array.isArray(re.material)?re.material.forEach(de=>de.needsUpdate=!0):re.material.needsUpdate=!0)});for(let re=0,de=B.length;re<de;re++){const J=B[re],te=J.shadow;if(te===void 0){It("WebGLShadowMap:",J,"has no shadow.");continue}if(te.autoUpdate===!1&&te.needsUpdate===!1)continue;r.copy(te.mapSize);const ye=te.getFrameExtents();if(r.multiply(ye),s.copy(te.mapSize),(r.x>m||r.y>m)&&(r.x>m&&(s.x=Math.floor(m/ye.x),r.x=s.x*ye.x,te.mapSize.x=s.x),r.y>m&&(s.y=Math.floor(m/ye.y),r.y=s.y*ye.y,te.mapSize.y=s.y)),te.map===null||ee===!0){if(te.map!==null&&(te.map.depthTexture!==null&&(te.map.depthTexture.dispose(),te.map.depthTexture=null),te.map.dispose()),this.type===Uf){if(J.isPointLight){It("WebGLShadowMap: VSM shadow maps are not supported for PointLights. Use PCF or BasicShadowMap instead.");continue}te.map=new Or(r.x,r.y,{format:qf,type:Wi,minFilter:Bn,magFilter:Bn,generateMipmaps:!1}),te.map.texture.name=J.name+".shadowMap",te.map.depthTexture=new Wf(r.x,r.y,Ni),te.map.depthTexture.name=J.name+".shadowMapDepth",te.map.depthTexture.format=Ml,te.map.depthTexture.compareFunction=null,te.map.depthTexture.minFilter=lr,te.map.depthTexture.magFilter=lr}else{J.isPointLight?(te.map=new gx(r.x),te.map.depthTexture=new BR(r.x,Mo)):(te.map=new Or(r.x,r.y),te.map.depthTexture=new Wf(r.x,r.y,Mo)),te.map.depthTexture.name=J.name+".shadowMap",te.map.depthTexture.format=Ml;const we=i.state.buffers.depth.getReversed();this.type===Oh?(te.map.depthTexture.compareFunction=we?dx:fx,te.map.depthTexture.minFilter=Bn,te.map.depthTexture.magFilter=Bn):(te.map.depthTexture.compareFunction=null,te.map.depthTexture.minFilter=lr,te.map.depthTexture.magFilter=lr)}te.camera.updateProjectionMatrix()}const Ue=te.map.isWebGLCubeRenderTarget?6:1;for(let we=0;we<Ue;we++){if(te.map.isWebGLCubeRenderTarget)i.setRenderTarget(te.map,we),i.clear();else{we===0&&(i.setRenderTarget(te.map),i.clear());const $=te.getViewport(we);a.set(s.x*$.x,s.y*$.y,s.x*$.z,s.y*$.w),ie.viewport(a)}if(J.isPointLight){const $=te.camera,ce=te.matrix,Ee=J.distance||$.far;Ee!==$.far&&($.far=Ee,$.updateProjectionMatrix()),Jm.setFromMatrixPosition(J.matrixWorld),$.position.copy(Jm),Ab.copy($.position),Ab.add(wB[we]),$.up.copy(CB[we]),$.lookAt(Ab),$.updateMatrixWorld(),ce.makeTranslation(-Jm.x,-Jm.y,-Jm.z),RA.multiplyMatrices($.projectionMatrix,$.matrixWorldInverse),te._frustum.setFromProjectionMatrix(RA,$.coordinateSystem,$.reversedDepth)}else te.updateMatrices(J);n=te.getFrustum(),L(k,G,te.camera,J,this.type)}te.isPointLightShadow!==!0&&this.type===Uf&&D(te,G),te.needsUpdate=!1}A=this.type,C.needsUpdate=!1,i.setRenderTarget(P,O,Z)};function D(B,k){const G=e.update(I);_.defines.VSM_SAMPLES!==B.blurSamples&&(_.defines.VSM_SAMPLES=B.blurSamples,b.defines.VSM_SAMPLES=B.blurSamples,_.needsUpdate=!0,b.needsUpdate=!0),B.mapPass===null&&(B.mapPass=new Or(r.x,r.y,{format:qf,type:Wi})),_.uniforms.shadow_pass.value=B.map.depthTexture,_.uniforms.resolution.value=B.mapSize,_.uniforms.radius.value=B.radius,i.setRenderTarget(B.mapPass),i.clear(),i.renderBufferDirect(k,null,G,_,I,null),b.uniforms.shadow_pass.value=B.mapPass.texture,b.uniforms.resolution.value=B.mapSize,b.uniforms.radius.value=B.radius,i.setRenderTarget(B.map),i.clear(),i.renderBufferDirect(k,null,G,b,I,null)}function U(B,k,G,P){let O=null;const Z=G.isPointLight===!0?B.customDistanceMaterial:B.customDepthMaterial;if(Z!==void 0)O=Z;else if(O=G.isPointLight===!0?d:c,i.localClippingEnabled&&k.clipShadows===!0&&Array.isArray(k.clippingPlanes)&&k.clippingPlanes.length!==0||k.displacementMap&&k.displacementScale!==0||k.alphaMap&&k.alphaTest>0||k.map&&k.alphaTest>0||k.alphaToCoverage===!0){const ie=O.uuid,ee=k.uuid;let re=p[ie];re===void 0&&(re={},p[ie]=re);let de=re[ee];de===void 0&&(de=O.clone(),re[ee]=de,k.addEventListener("dispose",z)),O=de}if(O.visible=k.visible,O.wireframe=k.wireframe,P===Uf?O.side=k.shadowSide!==null?k.shadowSide:k.side:O.side=k.shadowSide!==null?k.shadowSide:v[k.side],O.alphaMap=k.alphaMap,O.alphaTest=k.alphaToCoverage===!0?.5:k.alphaTest,O.map=k.map,O.clipShadows=k.clipShadows,O.clippingPlanes=k.clippingPlanes,O.clipIntersection=k.clipIntersection,O.displacementMap=k.displacementMap,O.displacementScale=k.displacementScale,O.displacementBias=k.displacementBias,O.wireframeLinewidth=k.wireframeLinewidth,O.linewidth=k.linewidth,G.isPointLight===!0&&O.isMeshDistanceMaterial===!0){const ie=i.properties.get(O);ie.light=G}return O}function L(B,k,G,P,O){if(B.visible===!1)return;if(B.layers.test(k.layers)&&(B.isMesh||B.isLine||B.isPoints)&&(B.castShadow||B.receiveShadow&&O===Uf)&&(!B.frustumCulled||n.intersectsObject(B))){B.modelViewMatrix.multiplyMatrices(G.matrixWorldInverse,B.matrixWorld);const ee=e.update(B),re=B.material;if(Array.isArray(re)){const de=ee.groups;for(let J=0,te=de.length;J<te;J++){const ye=de[J],Ue=re[ye.materialIndex];if(Ue&&Ue.visible){const we=U(B,Ue,P,O);B.onBeforeShadow(i,B,k,G,ee,we,ye),i.renderBufferDirect(G,null,ee,we,B,ye),B.onAfterShadow(i,B,k,G,ee,we,ye)}}}else if(re.visible){const de=U(B,re,P,O);B.onBeforeShadow(i,B,k,G,ee,de,null),i.renderBufferDirect(G,null,ee,de,B,null),B.onAfterShadow(i,B,k,G,ee,de,null)}}const ie=B.children;for(let ee=0,re=ie.length;ee<re;ee++)L(ie[ee],k,G,P,O)}function z(B){B.target.removeEventListener("dispose",z);for(const G in p){const P=p[G],O=B.target.uuid;O in P&&(P[O].dispose(),delete P[O])}}}const IB={[Ky]:Qy,[jy]:n_,[e_]:i_,[Gf]:t_,[Qy]:Ky,[n_]:jy,[i_]:e_,[t_]:Gf};function NB(i,e){function t(){let me=!1;const Ce=new $n;let nt=null;const wt=new $n(0,0,0,0);return{setMask:function(tt){nt!==tt&&!me&&(i.colorMask(tt,tt,tt,tt),nt=tt)},setLocked:function(tt){me=tt},setClear:function(tt,He,vt,nn,Nn){Nn===!0&&(tt*=nn,He*=nn,vt*=nn),Ce.set(tt,He,vt,nn),wt.equals(Ce)===!1&&(i.clearColor(tt,He,vt,nn),wt.copy(Ce))},reset:function(){me=!1,nt=null,wt.set(-1,0,0,0)}}}function n(){let me=!1,Ce=!1,nt=null,wt=null,tt=null;return{setReversed:function(He){if(Ce!==He){const vt=e.get("EXT_clip_control");He?vt.clipControlEXT(vt.LOWER_LEFT_EXT,vt.ZERO_TO_ONE_EXT):vt.clipControlEXT(vt.LOWER_LEFT_EXT,vt.NEGATIVE_ONE_TO_ONE_EXT),Ce=He;const nn=tt;tt=null,this.setClear(nn)}},getReversed:function(){return Ce},setTest:function(He){He?Re(i.DEPTH_TEST):ot(i.DEPTH_TEST)},setMask:function(He){nt!==He&&!me&&(i.depthMask(He),nt=He)},setFunc:function(He){if(Ce&&(He=IB[He]),wt!==He){switch(He){case Ky:i.depthFunc(i.NEVER);break;case Qy:i.depthFunc(i.ALWAYS);break;case jy:i.depthFunc(i.LESS);break;case Gf:i.depthFunc(i.LEQUAL);break;case e_:i.depthFunc(i.EQUAL);break;case t_:i.depthFunc(i.GEQUAL);break;case n_:i.depthFunc(i.GREATER);break;case i_:i.depthFunc(i.NOTEQUAL);break;default:i.depthFunc(i.LEQUAL)}wt=He}},setLocked:function(He){me=He},setClear:function(He){tt!==He&&(Ce&&(He=1-He),i.clearDepth(He),tt=He)},reset:function(){me=!1,nt=null,wt=null,tt=null,Ce=!1}}}function r(){let me=!1,Ce=null,nt=null,wt=null,tt=null,He=null,vt=null,nn=null,Nn=null;return{setTest:function(Ln){me||(Ln?Re(i.STENCIL_TEST):ot(i.STENCIL_TEST))},setMask:function(Ln){Ce!==Ln&&!me&&(i.stencilMask(Ln),Ce=Ln)},setFunc:function(Ln,ji,Rr){(nt!==Ln||wt!==ji||tt!==Rr)&&(i.stencilFunc(Ln,ji,Rr),nt=Ln,wt=ji,tt=Rr)},setOp:function(Ln,ji,Rr){(He!==Ln||vt!==ji||nn!==Rr)&&(i.stencilOp(Ln,ji,Rr),He=Ln,vt=ji,nn=Rr)},setLocked:function(Ln){me=Ln},setClear:function(Ln){Nn!==Ln&&(i.clearStencil(Ln),Nn=Ln)},reset:function(){me=!1,Ce=null,nt=null,wt=null,tt=null,He=null,vt=null,nn=null,Nn=null}}}const s=new t,a=new n,c=new r,d=new WeakMap,p=new WeakMap;let m={},v={},_=new WeakMap,b=[],T=null,I=!1,C=null,A=null,D=null,U=null,L=null,z=null,B=null,k=new Pt(0,0,0),G=0,P=!1,O=null,Z=null,ie=null,ee=null,re=null;const de=i.getParameter(i.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let J=!1,te=0;const ye=i.getParameter(i.VERSION);ye.indexOf("WebGL")!==-1?(te=parseFloat(/^WebGL (\d)/.exec(ye)[1]),J=te>=1):ye.indexOf("OpenGL ES")!==-1&&(te=parseFloat(/^OpenGL ES (\d)/.exec(ye)[1]),J=te>=2);let Ue=null,we={};const $=i.getParameter(i.SCISSOR_BOX),ce=i.getParameter(i.VIEWPORT),Ee=new $n().fromArray($),Be=new $n().fromArray(ce);function St(me,Ce,nt,wt){const tt=new Uint8Array(4),He=i.createTexture();i.bindTexture(me,He),i.texParameteri(me,i.TEXTURE_MIN_FILTER,i.NEAREST),i.texParameteri(me,i.TEXTURE_MAG_FILTER,i.NEAREST);for(let vt=0;vt<nt;vt++)me===i.TEXTURE_3D||me===i.TEXTURE_2D_ARRAY?i.texImage3D(Ce,0,i.RGBA,1,1,wt,0,i.RGBA,i.UNSIGNED_BYTE,tt):i.texImage2D(Ce+vt,0,i.RGBA,1,1,0,i.RGBA,i.UNSIGNED_BYTE,tt);return He}const ve={};ve[i.TEXTURE_2D]=St(i.TEXTURE_2D,i.TEXTURE_2D,1),ve[i.TEXTURE_CUBE_MAP]=St(i.TEXTURE_CUBE_MAP,i.TEXTURE_CUBE_MAP_POSITIVE_X,6),ve[i.TEXTURE_2D_ARRAY]=St(i.TEXTURE_2D_ARRAY,i.TEXTURE_2D_ARRAY,1,1),ve[i.TEXTURE_3D]=St(i.TEXTURE_3D,i.TEXTURE_3D,1,1),s.setClear(0,0,0,1),a.setClear(1),c.setClear(0),Re(i.DEPTH_TEST),a.setFunc(Gf),qe(!1),_t(Jb),Re(i.CULL_FACE),Ve(Ia);function Re(me){m[me]!==!0&&(i.enable(me),m[me]=!0)}function ot(me){m[me]!==!1&&(i.disable(me),m[me]=!1)}function bt(me,Ce){return v[me]!==Ce?(i.bindFramebuffer(me,Ce),v[me]=Ce,me===i.DRAW_FRAMEBUFFER&&(v[i.FRAMEBUFFER]=Ce),me===i.FRAMEBUFFER&&(v[i.DRAW_FRAMEBUFFER]=Ce),!0):!1}function Dt(me,Ce){let nt=b,wt=!1;if(me){nt=_.get(Ce),nt===void 0&&(nt=[],_.set(Ce,nt));const tt=me.textures;if(nt.length!==tt.length||nt[0]!==i.COLOR_ATTACHMENT0){for(let He=0,vt=tt.length;He<vt;He++)nt[He]=i.COLOR_ATTACHMENT0+He;nt.length=tt.length,wt=!0}}else nt[0]!==i.BACK&&(nt[0]=i.BACK,wt=!0);wt&&i.drawBuffers(nt)}function cn(me){return T!==me?(i.useProgram(me),T=me,!0):!1}const Tn={[gc]:i.FUNC_ADD,[YC]:i.FUNC_SUBTRACT,[JC]:i.FUNC_REVERSE_SUBTRACT};Tn[ZC]=i.MIN,Tn[$C]=i.MAX;const Zt={[KC]:i.ZERO,[QC]:i.ONE,[jC]:i.SRC_COLOR,[Zy]:i.SRC_ALPHA,[sR]:i.SRC_ALPHA_SATURATE,[iR]:i.DST_COLOR,[tR]:i.DST_ALPHA,[eR]:i.ONE_MINUS_SRC_COLOR,[$y]:i.ONE_MINUS_SRC_ALPHA,[rR]:i.ONE_MINUS_DST_COLOR,[nR]:i.ONE_MINUS_DST_ALPHA,[oR]:i.CONSTANT_COLOR,[aR]:i.ONE_MINUS_CONSTANT_COLOR,[lR]:i.CONSTANT_ALPHA,[uR]:i.ONE_MINUS_CONSTANT_ALPHA};function Ve(me,Ce,nt,wt,tt,He,vt,nn,Nn,Ln){if(me===Ia){I===!0&&(ot(i.BLEND),I=!1);return}if(I===!1&&(Re(i.BLEND),I=!0),me!==XC){if(me!==C||Ln!==P){if((A!==gc||L!==gc)&&(i.blendEquation(i.FUNC_ADD),A=gc,L=gc),Ln)switch(me){case zf:i.blendFuncSeparate(i.ONE,i.ONE_MINUS_SRC_ALPHA,i.ONE,i.ONE_MINUS_SRC_ALPHA);break;case Zb:i.blendFunc(i.ONE,i.ONE);break;case $b:i.blendFuncSeparate(i.ZERO,i.ONE_MINUS_SRC_COLOR,i.ZERO,i.ONE);break;case Kb:i.blendFuncSeparate(i.DST_COLOR,i.ONE_MINUS_SRC_ALPHA,i.ZERO,i.ONE);break;default:Jt("WebGLState: Invalid blending: ",me);break}else switch(me){case zf:i.blendFuncSeparate(i.SRC_ALPHA,i.ONE_MINUS_SRC_ALPHA,i.ONE,i.ONE_MINUS_SRC_ALPHA);break;case Zb:i.blendFuncSeparate(i.SRC_ALPHA,i.ONE,i.ONE,i.ONE);break;case $b:Jt("WebGLState: SubtractiveBlending requires material.premultipliedAlpha = true");break;case Kb:Jt("WebGLState: MultiplyBlending requires material.premultipliedAlpha = true");break;default:Jt("WebGLState: Invalid blending: ",me);break}D=null,U=null,z=null,B=null,k.set(0,0,0),G=0,C=me,P=Ln}return}tt=tt||Ce,He=He||nt,vt=vt||wt,(Ce!==A||tt!==L)&&(i.blendEquationSeparate(Tn[Ce],Tn[tt]),A=Ce,L=tt),(nt!==D||wt!==U||He!==z||vt!==B)&&(i.blendFuncSeparate(Zt[nt],Zt[wt],Zt[He],Zt[vt]),D=nt,U=wt,z=He,B=vt),(nn.equals(k)===!1||Nn!==G)&&(i.blendColor(nn.r,nn.g,nn.b,Nn),k.copy(nn),G=Nn),C=me,P=!1}function et(me,Ce){me.side===vo?ot(i.CULL_FACE):Re(i.CULL_FACE);let nt=me.side===gs;Ce&&(nt=!nt),qe(nt),me.blending===zf&&me.transparent===!1?Ve(Ia):Ve(me.blending,me.blendEquation,me.blendSrc,me.blendDst,me.blendEquationAlpha,me.blendSrcAlpha,me.blendDstAlpha,me.blendColor,me.blendAlpha,me.premultipliedAlpha),a.setFunc(me.depthFunc),a.setTest(me.depthTest),a.setMask(me.depthWrite),s.setMask(me.colorWrite);const wt=me.stencilWrite;c.setTest(wt),wt&&(c.setMask(me.stencilWriteMask),c.setFunc(me.stencilFunc,me.stencilRef,me.stencilFuncMask),c.setOp(me.stencilFail,me.stencilZFail,me.stencilZPass)),Ht(me.polygonOffset,me.polygonOffsetFactor,me.polygonOffsetUnits),me.alphaToCoverage===!0?Re(i.SAMPLE_ALPHA_TO_COVERAGE):ot(i.SAMPLE_ALPHA_TO_COVERAGE)}function qe(me){O!==me&&(me?i.frontFace(i.CW):i.frontFace(i.CCW),O=me)}function _t(me){me!==GC?(Re(i.CULL_FACE),me!==Z&&(me===Jb?i.cullFace(i.BACK):me===qC?i.cullFace(i.FRONT):i.cullFace(i.FRONT_AND_BACK))):ot(i.CULL_FACE),Z=me}function j(me){me!==ie&&(J&&i.lineWidth(me),ie=me)}function Ht(me,Ce,nt){me?(Re(i.POLYGON_OFFSET_FILL),(ee!==Ce||re!==nt)&&(i.polygonOffset(Ce,nt),ee=Ce,re=nt)):ot(i.POLYGON_OFFSET_FILL)}function Et(me){me?Re(i.SCISSOR_TEST):ot(i.SCISSOR_TEST)}function Gt(me){me===void 0&&(me=i.TEXTURE0+de-1),Ue!==me&&(i.activeTexture(me),Ue=me)}function ut(me,Ce,nt){nt===void 0&&(Ue===null?nt=i.TEXTURE0+de-1:nt=Ue);let wt=we[nt];wt===void 0&&(wt={type:void 0,texture:void 0},we[nt]=wt),(wt.type!==me||wt.texture!==Ce)&&(Ue!==nt&&(i.activeTexture(nt),Ue=nt),i.bindTexture(me,Ce||ve[me]),wt.type=me,wt.texture=Ce)}function K(){const me=we[Ue];me!==void 0&&me.type!==void 0&&(i.bindTexture(me.type,null),me.type=void 0,me.texture=void 0)}function V(){try{i.compressedTexImage2D(...arguments)}catch(me){Jt("WebGLState:",me)}}function pe(){try{i.compressedTexImage3D(...arguments)}catch(me){Jt("WebGLState:",me)}}function De(){try{i.texSubImage2D(...arguments)}catch(me){Jt("WebGLState:",me)}}function We(){try{i.texSubImage3D(...arguments)}catch(me){Jt("WebGLState:",me)}}function Ne(){try{i.compressedTexSubImage2D(...arguments)}catch(me){Jt("WebGLState:",me)}}function Ct(){try{i.compressedTexSubImage3D(...arguments)}catch(me){Jt("WebGLState:",me)}}function ht(){try{i.texStorage2D(...arguments)}catch(me){Jt("WebGLState:",me)}}function Ot(){try{i.texStorage3D(...arguments)}catch(me){Jt("WebGLState:",me)}}function $t(){try{i.texImage2D(...arguments)}catch(me){Jt("WebGLState:",me)}}function Ze(){try{i.texImage3D(...arguments)}catch(me){Jt("WebGLState:",me)}}function Ke(me){Ee.equals(me)===!1&&(i.scissor(me.x,me.y,me.z,me.w),Ee.copy(me))}function Nt(me){Be.equals(me)===!1&&(i.viewport(me.x,me.y,me.z,me.w),Be.copy(me))}function Tt(me,Ce){let nt=p.get(Ce);nt===void 0&&(nt=new WeakMap,p.set(Ce,nt));let wt=nt.get(me);wt===void 0&&(wt=i.getUniformBlockIndex(Ce,me.name),nt.set(me,wt))}function at(me,Ce){const wt=p.get(Ce).get(me);d.get(Ce)!==wt&&(i.uniformBlockBinding(Ce,wt,me.__bindingPointIndex),d.set(Ce,wt))}function Xt(){i.disable(i.BLEND),i.disable(i.CULL_FACE),i.disable(i.DEPTH_TEST),i.disable(i.POLYGON_OFFSET_FILL),i.disable(i.SCISSOR_TEST),i.disable(i.STENCIL_TEST),i.disable(i.SAMPLE_ALPHA_TO_COVERAGE),i.blendEquation(i.FUNC_ADD),i.blendFunc(i.ONE,i.ZERO),i.blendFuncSeparate(i.ONE,i.ZERO,i.ONE,i.ZERO),i.blendColor(0,0,0,0),i.colorMask(!0,!0,!0,!0),i.clearColor(0,0,0,0),i.depthMask(!0),i.depthFunc(i.LESS),a.setReversed(!1),i.clearDepth(1),i.stencilMask(4294967295),i.stencilFunc(i.ALWAYS,0,4294967295),i.stencilOp(i.KEEP,i.KEEP,i.KEEP),i.clearStencil(0),i.cullFace(i.BACK),i.frontFace(i.CCW),i.polygonOffset(0,0),i.activeTexture(i.TEXTURE0),i.bindFramebuffer(i.FRAMEBUFFER,null),i.bindFramebuffer(i.DRAW_FRAMEBUFFER,null),i.bindFramebuffer(i.READ_FRAMEBUFFER,null),i.useProgram(null),i.lineWidth(1),i.scissor(0,0,i.canvas.width,i.canvas.height),i.viewport(0,0,i.canvas.width,i.canvas.height),m={},Ue=null,we={},v={},_=new WeakMap,b=[],T=null,I=!1,C=null,A=null,D=null,U=null,L=null,z=null,B=null,k=new Pt(0,0,0),G=0,P=!1,O=null,Z=null,ie=null,ee=null,re=null,Ee.set(0,0,i.canvas.width,i.canvas.height),Be.set(0,0,i.canvas.width,i.canvas.height),s.reset(),a.reset(),c.reset()}return{buffers:{color:s,depth:a,stencil:c},enable:Re,disable:ot,bindFramebuffer:bt,drawBuffers:Dt,useProgram:cn,setBlending:Ve,setMaterial:et,setFlipSided:qe,setCullFace:_t,setLineWidth:j,setPolygonOffset:Ht,setScissorTest:Et,activeTexture:Gt,bindTexture:ut,unbindTexture:K,compressedTexImage2D:V,compressedTexImage3D:pe,texImage2D:$t,texImage3D:Ze,updateUBOMapping:Tt,uniformBlockBinding:at,texStorage2D:ht,texStorage3D:Ot,texSubImage2D:De,texSubImage3D:We,compressedTexSubImage2D:Ne,compressedTexSubImage3D:Ct,scissor:Ke,viewport:Nt,reset:Xt}}function DB(i,e,t,n,r,s,a){const c=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,d=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),p=new $e,m=new WeakMap;let v;const _=new WeakMap;let b=!1;try{b=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function T(K,V){return b?new OffscreenCanvas(K,V):Eg("canvas")}function I(K,V,pe){let De=1;const We=ut(K);if((We.width>pe||We.height>pe)&&(De=pe/Math.max(We.width,We.height)),De<1)if(typeof HTMLImageElement<"u"&&K instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&K instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&K instanceof ImageBitmap||typeof VideoFrame<"u"&&K instanceof VideoFrame){const Ne=Math.floor(De*We.width),Ct=Math.floor(De*We.height);v===void 0&&(v=T(Ne,Ct));const ht=V?T(Ne,Ct):v;return ht.width=Ne,ht.height=Ct,ht.getContext("2d").drawImage(K,0,0,Ne,Ct),It("WebGLRenderer: Texture has been resized from ("+We.width+"x"+We.height+") to ("+Ne+"x"+Ct+")."),ht}else return"data"in K&&It("WebGLRenderer: Image in DataTexture is too big ("+We.width+"x"+We.height+")."),K;return K}function C(K){return K.generateMipmaps}function A(K){i.generateMipmap(K)}function D(K){return K.isWebGLCubeRenderTarget?i.TEXTURE_CUBE_MAP:K.isWebGL3DRenderTarget?i.TEXTURE_3D:K.isWebGLArrayRenderTarget||K.isCompressedArrayTexture?i.TEXTURE_2D_ARRAY:i.TEXTURE_2D}function U(K,V,pe,De,We=!1){if(K!==null){if(i[K]!==void 0)return i[K];It("WebGLRenderer: Attempt to use non-existing WebGL internal format '"+K+"'")}let Ne=V;if(V===i.RED&&(pe===i.FLOAT&&(Ne=i.R32F),pe===i.HALF_FLOAT&&(Ne=i.R16F),pe===i.UNSIGNED_BYTE&&(Ne=i.R8)),V===i.RED_INTEGER&&(pe===i.UNSIGNED_BYTE&&(Ne=i.R8UI),pe===i.UNSIGNED_SHORT&&(Ne=i.R16UI),pe===i.UNSIGNED_INT&&(Ne=i.R32UI),pe===i.BYTE&&(Ne=i.R8I),pe===i.SHORT&&(Ne=i.R16I),pe===i.INT&&(Ne=i.R32I)),V===i.RG&&(pe===i.FLOAT&&(Ne=i.RG32F),pe===i.HALF_FLOAT&&(Ne=i.RG16F),pe===i.UNSIGNED_BYTE&&(Ne=i.RG8)),V===i.RG_INTEGER&&(pe===i.UNSIGNED_BYTE&&(Ne=i.RG8UI),pe===i.UNSIGNED_SHORT&&(Ne=i.RG16UI),pe===i.UNSIGNED_INT&&(Ne=i.RG32UI),pe===i.BYTE&&(Ne=i.RG8I),pe===i.SHORT&&(Ne=i.RG16I),pe===i.INT&&(Ne=i.RG32I)),V===i.RGB_INTEGER&&(pe===i.UNSIGNED_BYTE&&(Ne=i.RGB8UI),pe===i.UNSIGNED_SHORT&&(Ne=i.RGB16UI),pe===i.UNSIGNED_INT&&(Ne=i.RGB32UI),pe===i.BYTE&&(Ne=i.RGB8I),pe===i.SHORT&&(Ne=i.RGB16I),pe===i.INT&&(Ne=i.RGB32I)),V===i.RGBA_INTEGER&&(pe===i.UNSIGNED_BYTE&&(Ne=i.RGBA8UI),pe===i.UNSIGNED_SHORT&&(Ne=i.RGBA16UI),pe===i.UNSIGNED_INT&&(Ne=i.RGBA32UI),pe===i.BYTE&&(Ne=i.RGBA8I),pe===i.SHORT&&(Ne=i.RGBA16I),pe===i.INT&&(Ne=i.RGBA32I)),V===i.RGB&&(pe===i.UNSIGNED_INT_5_9_9_9_REV&&(Ne=i.RGB9_E5),pe===i.UNSIGNED_INT_10F_11F_11F_REV&&(Ne=i.R11F_G11F_B10F)),V===i.RGBA){const Ct=We?bg:Gn.getTransfer(De);pe===i.FLOAT&&(Ne=i.RGBA32F),pe===i.HALF_FLOAT&&(Ne=i.RGBA16F),pe===i.UNSIGNED_BYTE&&(Ne=Ct===oi?i.SRGB8_ALPHA8:i.RGBA8),pe===i.UNSIGNED_SHORT_4_4_4_4&&(Ne=i.RGBA4),pe===i.UNSIGNED_SHORT_5_5_5_1&&(Ne=i.RGB5_A1)}return(Ne===i.R16F||Ne===i.R32F||Ne===i.RG16F||Ne===i.RG32F||Ne===i.RGBA16F||Ne===i.RGBA32F)&&e.get("EXT_color_buffer_float"),Ne}function L(K,V){let pe;return K?V===null||V===Mo||V===Wh?pe=i.DEPTH24_STENCIL8:V===Ni?pe=i.DEPTH32F_STENCIL8:V===qh&&(pe=i.DEPTH24_STENCIL8,It("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):V===null||V===Mo||V===Wh?pe=i.DEPTH_COMPONENT24:V===Ni?pe=i.DEPTH_COMPONENT32F:V===qh&&(pe=i.DEPTH_COMPONENT16),pe}function z(K,V){return C(K)===!0||K.isFramebufferTexture&&K.minFilter!==lr&&K.minFilter!==Bn?Math.log2(Math.max(V.width,V.height))+1:K.mipmaps!==void 0&&K.mipmaps.length>0?K.mipmaps.length:K.isCompressedTexture&&Array.isArray(K.image)?V.mipmaps.length:1}function B(K){const V=K.target;V.removeEventListener("dispose",B),G(V),V.isVideoTexture&&m.delete(V)}function k(K){const V=K.target;V.removeEventListener("dispose",k),O(V)}function G(K){const V=n.get(K);if(V.__webglInit===void 0)return;const pe=K.source,De=_.get(pe);if(De){const We=De[V.__cacheKey];We.usedTimes--,We.usedTimes===0&&P(K),Object.keys(De).length===0&&_.delete(pe)}n.remove(K)}function P(K){const V=n.get(K);i.deleteTexture(V.__webglTexture);const pe=K.source,De=_.get(pe);delete De[V.__cacheKey],a.memory.textures--}function O(K){const V=n.get(K);if(K.depthTexture&&(K.depthTexture.dispose(),n.remove(K.depthTexture)),K.isWebGLCubeRenderTarget)for(let De=0;De<6;De++){if(Array.isArray(V.__webglFramebuffer[De]))for(let We=0;We<V.__webglFramebuffer[De].length;We++)i.deleteFramebuffer(V.__webglFramebuffer[De][We]);else i.deleteFramebuffer(V.__webglFramebuffer[De]);V.__webglDepthbuffer&&i.deleteRenderbuffer(V.__webglDepthbuffer[De])}else{if(Array.isArray(V.__webglFramebuffer))for(let De=0;De<V.__webglFramebuffer.length;De++)i.deleteFramebuffer(V.__webglFramebuffer[De]);else i.deleteFramebuffer(V.__webglFramebuffer);if(V.__webglDepthbuffer&&i.deleteRenderbuffer(V.__webglDepthbuffer),V.__webglMultisampledFramebuffer&&i.deleteFramebuffer(V.__webglMultisampledFramebuffer),V.__webglColorRenderbuffer)for(let De=0;De<V.__webglColorRenderbuffer.length;De++)V.__webglColorRenderbuffer[De]&&i.deleteRenderbuffer(V.__webglColorRenderbuffer[De]);V.__webglDepthRenderbuffer&&i.deleteRenderbuffer(V.__webglDepthRenderbuffer)}const pe=K.textures;for(let De=0,We=pe.length;De<We;De++){const Ne=n.get(pe[De]);Ne.__webglTexture&&(i.deleteTexture(Ne.__webglTexture),a.memory.textures--),n.remove(pe[De])}n.remove(K)}let Z=0;function ie(){Z=0}function ee(){const K=Z;return K>=r.maxTextures&&It("WebGLTextures: Trying to use "+K+" texture units while this GPU supports only "+r.maxTextures),Z+=1,K}function re(K){const V=[];return V.push(K.wrapS),V.push(K.wrapT),V.push(K.wrapR||0),V.push(K.magFilter),V.push(K.minFilter),V.push(K.anisotropy),V.push(K.internalFormat),V.push(K.format),V.push(K.type),V.push(K.generateMipmaps),V.push(K.premultiplyAlpha),V.push(K.flipY),V.push(K.unpackAlignment),V.push(K.colorSpace),V.join()}function de(K,V){const pe=n.get(K);if(K.isVideoTexture&&Et(K),K.isRenderTargetTexture===!1&&K.isExternalTexture!==!0&&K.version>0&&pe.__version!==K.version){const De=K.image;if(De===null)It("WebGLRenderer: Texture marked for update but no image data found.");else if(De.complete===!1)It("WebGLRenderer: Texture marked for update but image is incomplete");else{ve(pe,K,V);return}}else K.isExternalTexture&&(pe.__webglTexture=K.sourceTexture?K.sourceTexture:null);t.bindTexture(i.TEXTURE_2D,pe.__webglTexture,i.TEXTURE0+V)}function J(K,V){const pe=n.get(K);if(K.isRenderTargetTexture===!1&&K.version>0&&pe.__version!==K.version){ve(pe,K,V);return}else K.isExternalTexture&&(pe.__webglTexture=K.sourceTexture?K.sourceTexture:null);t.bindTexture(i.TEXTURE_2D_ARRAY,pe.__webglTexture,i.TEXTURE0+V)}function te(K,V){const pe=n.get(K);if(K.isRenderTargetTexture===!1&&K.version>0&&pe.__version!==K.version){ve(pe,K,V);return}t.bindTexture(i.TEXTURE_3D,pe.__webglTexture,i.TEXTURE0+V)}function ye(K,V){const pe=n.get(K);if(K.isCubeDepthTexture!==!0&&K.version>0&&pe.__version!==K.version){Re(pe,K,V);return}t.bindTexture(i.TEXTURE_CUBE_MAP,pe.__webglTexture,i.TEXTURE0+V)}const Ue={[yg]:i.REPEAT,[Qi]:i.CLAMP_TO_EDGE,[_g]:i.MIRRORED_REPEAT},we={[lr]:i.NEAREST,[GM]:i.NEAREST_MIPMAP_NEAREST,[Uh]:i.NEAREST_MIPMAP_LINEAR,[Bn]:i.LINEAR,[sg]:i.LINEAR_MIPMAP_NEAREST,[_l]:i.LINEAR_MIPMAP_LINEAR},$={[yR]:i.NEVER,[MR]:i.ALWAYS,[_R]:i.LESS,[fx]:i.LEQUAL,[xR]:i.EQUAL,[dx]:i.GEQUAL,[SR]:i.GREATER,[bR]:i.NOTEQUAL};function ce(K,V){if(V.type===Ni&&e.has("OES_texture_float_linear")===!1&&(V.magFilter===Bn||V.magFilter===sg||V.magFilter===Uh||V.magFilter===_l||V.minFilter===Bn||V.minFilter===sg||V.minFilter===Uh||V.minFilter===_l)&&It("WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),i.texParameteri(K,i.TEXTURE_WRAP_S,Ue[V.wrapS]),i.texParameteri(K,i.TEXTURE_WRAP_T,Ue[V.wrapT]),(K===i.TEXTURE_3D||K===i.TEXTURE_2D_ARRAY)&&i.texParameteri(K,i.TEXTURE_WRAP_R,Ue[V.wrapR]),i.texParameteri(K,i.TEXTURE_MAG_FILTER,we[V.magFilter]),i.texParameteri(K,i.TEXTURE_MIN_FILTER,we[V.minFilter]),V.compareFunction&&(i.texParameteri(K,i.TEXTURE_COMPARE_MODE,i.COMPARE_REF_TO_TEXTURE),i.texParameteri(K,i.TEXTURE_COMPARE_FUNC,$[V.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){if(V.magFilter===lr||V.minFilter!==Uh&&V.minFilter!==_l||V.type===Ni&&e.has("OES_texture_float_linear")===!1)return;if(V.anisotropy>1||n.get(V).__currentAnisotropy){const pe=e.get("EXT_texture_filter_anisotropic");i.texParameterf(K,pe.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(V.anisotropy,r.getMaxAnisotropy())),n.get(V).__currentAnisotropy=V.anisotropy}}}function Ee(K,V){let pe=!1;K.__webglInit===void 0&&(K.__webglInit=!0,V.addEventListener("dispose",B));const De=V.source;let We=_.get(De);We===void 0&&(We={},_.set(De,We));const Ne=re(V);if(Ne!==K.__cacheKey){We[Ne]===void 0&&(We[Ne]={texture:i.createTexture(),usedTimes:0},a.memory.textures++,pe=!0),We[Ne].usedTimes++;const Ct=We[K.__cacheKey];Ct!==void 0&&(We[K.__cacheKey].usedTimes--,Ct.usedTimes===0&&P(V)),K.__cacheKey=Ne,K.__webglTexture=We[Ne].texture}return pe}function Be(K,V,pe){return Math.floor(Math.floor(K/pe)/V)}function St(K,V,pe,De){const Ne=K.updateRanges;if(Ne.length===0)t.texSubImage2D(i.TEXTURE_2D,0,0,0,V.width,V.height,pe,De,V.data);else{Ne.sort((Ze,Ke)=>Ze.start-Ke.start);let Ct=0;for(let Ze=1;Ze<Ne.length;Ze++){const Ke=Ne[Ct],Nt=Ne[Ze],Tt=Ke.start+Ke.count,at=Be(Nt.start,V.width,4),Xt=Be(Ke.start,V.width,4);Nt.start<=Tt+1&&at===Xt&&Be(Nt.start+Nt.count-1,V.width,4)===at?Ke.count=Math.max(Ke.count,Nt.start+Nt.count-Ke.start):(++Ct,Ne[Ct]=Nt)}Ne.length=Ct+1;const ht=i.getParameter(i.UNPACK_ROW_LENGTH),Ot=i.getParameter(i.UNPACK_SKIP_PIXELS),$t=i.getParameter(i.UNPACK_SKIP_ROWS);i.pixelStorei(i.UNPACK_ROW_LENGTH,V.width);for(let Ze=0,Ke=Ne.length;Ze<Ke;Ze++){const Nt=Ne[Ze],Tt=Math.floor(Nt.start/4),at=Math.ceil(Nt.count/4),Xt=Tt%V.width,me=Math.floor(Tt/V.width),Ce=at,nt=1;i.pixelStorei(i.UNPACK_SKIP_PIXELS,Xt),i.pixelStorei(i.UNPACK_SKIP_ROWS,me),t.texSubImage2D(i.TEXTURE_2D,0,Xt,me,Ce,nt,pe,De,V.data)}K.clearUpdateRanges(),i.pixelStorei(i.UNPACK_ROW_LENGTH,ht),i.pixelStorei(i.UNPACK_SKIP_PIXELS,Ot),i.pixelStorei(i.UNPACK_SKIP_ROWS,$t)}}function ve(K,V,pe){let De=i.TEXTURE_2D;(V.isDataArrayTexture||V.isCompressedArrayTexture)&&(De=i.TEXTURE_2D_ARRAY),V.isData3DTexture&&(De=i.TEXTURE_3D);const We=Ee(K,V),Ne=V.source;t.bindTexture(De,K.__webglTexture,i.TEXTURE0+pe);const Ct=n.get(Ne);if(Ne.version!==Ct.__version||We===!0){t.activeTexture(i.TEXTURE0+pe);const ht=Gn.getPrimaries(Gn.workingColorSpace),Ot=V.colorSpace===cu?null:Gn.getPrimaries(V.colorSpace),$t=V.colorSpace===cu||ht===Ot?i.NONE:i.BROWSER_DEFAULT_WEBGL;i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,V.flipY),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,V.premultiplyAlpha),i.pixelStorei(i.UNPACK_ALIGNMENT,V.unpackAlignment),i.pixelStorei(i.UNPACK_COLORSPACE_CONVERSION_WEBGL,$t);let Ze=I(V.image,!1,r.maxTextureSize);Ze=Gt(V,Ze);const Ke=s.convert(V.format,V.colorSpace),Nt=s.convert(V.type);let Tt=U(V.internalFormat,Ke,Nt,V.colorSpace,V.isVideoTexture);ce(De,V);let at;const Xt=V.mipmaps,me=V.isVideoTexture!==!0,Ce=Ct.__version===void 0||We===!0,nt=Ne.dataReady,wt=z(V,Ze);if(V.isDepthTexture)Tt=L(V.format===vc,V.type),Ce&&(me?t.texStorage2D(i.TEXTURE_2D,1,Tt,Ze.width,Ze.height):t.texImage2D(i.TEXTURE_2D,0,Tt,Ze.width,Ze.height,0,Ke,Nt,null));else if(V.isDataTexture)if(Xt.length>0){me&&Ce&&t.texStorage2D(i.TEXTURE_2D,wt,Tt,Xt[0].width,Xt[0].height);for(let tt=0,He=Xt.length;tt<He;tt++)at=Xt[tt],me?nt&&t.texSubImage2D(i.TEXTURE_2D,tt,0,0,at.width,at.height,Ke,Nt,at.data):t.texImage2D(i.TEXTURE_2D,tt,Tt,at.width,at.height,0,Ke,Nt,at.data);V.generateMipmaps=!1}else me?(Ce&&t.texStorage2D(i.TEXTURE_2D,wt,Tt,Ze.width,Ze.height),nt&&St(V,Ze,Ke,Nt)):t.texImage2D(i.TEXTURE_2D,0,Tt,Ze.width,Ze.height,0,Ke,Nt,Ze.data);else if(V.isCompressedTexture)if(V.isCompressedArrayTexture){me&&Ce&&t.texStorage3D(i.TEXTURE_2D_ARRAY,wt,Tt,Xt[0].width,Xt[0].height,Ze.depth);for(let tt=0,He=Xt.length;tt<He;tt++)if(at=Xt[tt],V.format!==ur)if(Ke!==null)if(me){if(nt)if(V.layerUpdates.size>0){const vt=lM(at.width,at.height,V.format,V.type);for(const nn of V.layerUpdates){const Nn=at.data.subarray(nn*vt/at.data.BYTES_PER_ELEMENT,(nn+1)*vt/at.data.BYTES_PER_ELEMENT);t.compressedTexSubImage3D(i.TEXTURE_2D_ARRAY,tt,0,0,nn,at.width,at.height,1,Ke,Nn)}V.clearLayerUpdates()}else t.compressedTexSubImage3D(i.TEXTURE_2D_ARRAY,tt,0,0,0,at.width,at.height,Ze.depth,Ke,at.data)}else t.compressedTexImage3D(i.TEXTURE_2D_ARRAY,tt,Tt,at.width,at.height,Ze.depth,0,at.data,0,0);else It("WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else me?nt&&t.texSubImage3D(i.TEXTURE_2D_ARRAY,tt,0,0,0,at.width,at.height,Ze.depth,Ke,Nt,at.data):t.texImage3D(i.TEXTURE_2D_ARRAY,tt,Tt,at.width,at.height,Ze.depth,0,Ke,Nt,at.data)}else{me&&Ce&&t.texStorage2D(i.TEXTURE_2D,wt,Tt,Xt[0].width,Xt[0].height);for(let tt=0,He=Xt.length;tt<He;tt++)at=Xt[tt],V.format!==ur?Ke!==null?me?nt&&t.compressedTexSubImage2D(i.TEXTURE_2D,tt,0,0,at.width,at.height,Ke,at.data):t.compressedTexImage2D(i.TEXTURE_2D,tt,Tt,at.width,at.height,0,at.data):It("WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):me?nt&&t.texSubImage2D(i.TEXTURE_2D,tt,0,0,at.width,at.height,Ke,Nt,at.data):t.texImage2D(i.TEXTURE_2D,tt,Tt,at.width,at.height,0,Ke,Nt,at.data)}else if(V.isDataArrayTexture)if(me){if(Ce&&t.texStorage3D(i.TEXTURE_2D_ARRAY,wt,Tt,Ze.width,Ze.height,Ze.depth),nt)if(V.layerUpdates.size>0){const tt=lM(Ze.width,Ze.height,V.format,V.type);for(const He of V.layerUpdates){const vt=Ze.data.subarray(He*tt/Ze.data.BYTES_PER_ELEMENT,(He+1)*tt/Ze.data.BYTES_PER_ELEMENT);t.texSubImage3D(i.TEXTURE_2D_ARRAY,0,0,0,He,Ze.width,Ze.height,1,Ke,Nt,vt)}V.clearLayerUpdates()}else t.texSubImage3D(i.TEXTURE_2D_ARRAY,0,0,0,0,Ze.width,Ze.height,Ze.depth,Ke,Nt,Ze.data)}else t.texImage3D(i.TEXTURE_2D_ARRAY,0,Tt,Ze.width,Ze.height,Ze.depth,0,Ke,Nt,Ze.data);else if(V.isData3DTexture)me?(Ce&&t.texStorage3D(i.TEXTURE_3D,wt,Tt,Ze.width,Ze.height,Ze.depth),nt&&t.texSubImage3D(i.TEXTURE_3D,0,0,0,0,Ze.width,Ze.height,Ze.depth,Ke,Nt,Ze.data)):t.texImage3D(i.TEXTURE_3D,0,Tt,Ze.width,Ze.height,Ze.depth,0,Ke,Nt,Ze.data);else if(V.isFramebufferTexture){if(Ce)if(me)t.texStorage2D(i.TEXTURE_2D,wt,Tt,Ze.width,Ze.height);else{let tt=Ze.width,He=Ze.height;for(let vt=0;vt<wt;vt++)t.texImage2D(i.TEXTURE_2D,vt,Tt,tt,He,0,Ke,Nt,null),tt>>=1,He>>=1}}else if(Xt.length>0){if(me&&Ce){const tt=ut(Xt[0]);t.texStorage2D(i.TEXTURE_2D,wt,Tt,tt.width,tt.height)}for(let tt=0,He=Xt.length;tt<He;tt++)at=Xt[tt],me?nt&&t.texSubImage2D(i.TEXTURE_2D,tt,0,0,Ke,Nt,at):t.texImage2D(i.TEXTURE_2D,tt,Tt,Ke,Nt,at);V.generateMipmaps=!1}else if(me){if(Ce){const tt=ut(Ze);t.texStorage2D(i.TEXTURE_2D,wt,Tt,tt.width,tt.height)}nt&&t.texSubImage2D(i.TEXTURE_2D,0,0,0,Ke,Nt,Ze)}else t.texImage2D(i.TEXTURE_2D,0,Tt,Ke,Nt,Ze);C(V)&&A(De),Ct.__version=Ne.version,V.onUpdate&&V.onUpdate(V)}K.__version=V.version}function Re(K,V,pe){if(V.image.length!==6)return;const De=Ee(K,V),We=V.source;t.bindTexture(i.TEXTURE_CUBE_MAP,K.__webglTexture,i.TEXTURE0+pe);const Ne=n.get(We);if(We.version!==Ne.__version||De===!0){t.activeTexture(i.TEXTURE0+pe);const Ct=Gn.getPrimaries(Gn.workingColorSpace),ht=V.colorSpace===cu?null:Gn.getPrimaries(V.colorSpace),Ot=V.colorSpace===cu||Ct===ht?i.NONE:i.BROWSER_DEFAULT_WEBGL;i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,V.flipY),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,V.premultiplyAlpha),i.pixelStorei(i.UNPACK_ALIGNMENT,V.unpackAlignment),i.pixelStorei(i.UNPACK_COLORSPACE_CONVERSION_WEBGL,Ot);const $t=V.isCompressedTexture||V.image[0].isCompressedTexture,Ze=V.image[0]&&V.image[0].isDataTexture,Ke=[];for(let He=0;He<6;He++)!$t&&!Ze?Ke[He]=I(V.image[He],!0,r.maxCubemapSize):Ke[He]=Ze?V.image[He].image:V.image[He],Ke[He]=Gt(V,Ke[He]);const Nt=Ke[0],Tt=s.convert(V.format,V.colorSpace),at=s.convert(V.type),Xt=U(V.internalFormat,Tt,at,V.colorSpace),me=V.isVideoTexture!==!0,Ce=Ne.__version===void 0||De===!0,nt=We.dataReady;let wt=z(V,Nt);ce(i.TEXTURE_CUBE_MAP,V);let tt;if($t){me&&Ce&&t.texStorage2D(i.TEXTURE_CUBE_MAP,wt,Xt,Nt.width,Nt.height);for(let He=0;He<6;He++){tt=Ke[He].mipmaps;for(let vt=0;vt<tt.length;vt++){const nn=tt[vt];V.format!==ur?Tt!==null?me?nt&&t.compressedTexSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+He,vt,0,0,nn.width,nn.height,Tt,nn.data):t.compressedTexImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+He,vt,Xt,nn.width,nn.height,0,nn.data):It("WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):me?nt&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+He,vt,0,0,nn.width,nn.height,Tt,at,nn.data):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+He,vt,Xt,nn.width,nn.height,0,Tt,at,nn.data)}}}else{if(tt=V.mipmaps,me&&Ce){tt.length>0&&wt++;const He=ut(Ke[0]);t.texStorage2D(i.TEXTURE_CUBE_MAP,wt,Xt,He.width,He.height)}for(let He=0;He<6;He++)if(Ze){me?nt&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+He,0,0,0,Ke[He].width,Ke[He].height,Tt,at,Ke[He].data):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+He,0,Xt,Ke[He].width,Ke[He].height,0,Tt,at,Ke[He].data);for(let vt=0;vt<tt.length;vt++){const Nn=tt[vt].image[He].image;me?nt&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+He,vt+1,0,0,Nn.width,Nn.height,Tt,at,Nn.data):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+He,vt+1,Xt,Nn.width,Nn.height,0,Tt,at,Nn.data)}}else{me?nt&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+He,0,0,0,Tt,at,Ke[He]):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+He,0,Xt,Tt,at,Ke[He]);for(let vt=0;vt<tt.length;vt++){const nn=tt[vt];me?nt&&t.texSubImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+He,vt+1,0,0,Tt,at,nn.image[He]):t.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+He,vt+1,Xt,Tt,at,nn.image[He])}}}C(V)&&A(i.TEXTURE_CUBE_MAP),Ne.__version=We.version,V.onUpdate&&V.onUpdate(V)}K.__version=V.version}function ot(K,V,pe,De,We,Ne){const Ct=s.convert(pe.format,pe.colorSpace),ht=s.convert(pe.type),Ot=U(pe.internalFormat,Ct,ht,pe.colorSpace),$t=n.get(V),Ze=n.get(pe);if(Ze.__renderTarget=V,!$t.__hasExternalTextures){const Ke=Math.max(1,V.width>>Ne),Nt=Math.max(1,V.height>>Ne);We===i.TEXTURE_3D||We===i.TEXTURE_2D_ARRAY?t.texImage3D(We,Ne,Ot,Ke,Nt,V.depth,0,Ct,ht,null):t.texImage2D(We,Ne,Ot,Ke,Nt,0,Ct,ht,null)}t.bindFramebuffer(i.FRAMEBUFFER,K),Ht(V)?c.framebufferTexture2DMultisampleEXT(i.FRAMEBUFFER,De,We,Ze.__webglTexture,0,j(V)):(We===i.TEXTURE_2D||We>=i.TEXTURE_CUBE_MAP_POSITIVE_X&&We<=i.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&i.framebufferTexture2D(i.FRAMEBUFFER,De,We,Ze.__webglTexture,Ne),t.bindFramebuffer(i.FRAMEBUFFER,null)}function bt(K,V,pe){if(i.bindRenderbuffer(i.RENDERBUFFER,K),V.depthBuffer){const De=V.depthTexture,We=De&&De.isDepthTexture?De.type:null,Ne=L(V.stencilBuffer,We),Ct=V.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT;Ht(V)?c.renderbufferStorageMultisampleEXT(i.RENDERBUFFER,j(V),Ne,V.width,V.height):pe?i.renderbufferStorageMultisample(i.RENDERBUFFER,j(V),Ne,V.width,V.height):i.renderbufferStorage(i.RENDERBUFFER,Ne,V.width,V.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,Ct,i.RENDERBUFFER,K)}else{const De=V.textures;for(let We=0;We<De.length;We++){const Ne=De[We],Ct=s.convert(Ne.format,Ne.colorSpace),ht=s.convert(Ne.type),Ot=U(Ne.internalFormat,Ct,ht,Ne.colorSpace);Ht(V)?c.renderbufferStorageMultisampleEXT(i.RENDERBUFFER,j(V),Ot,V.width,V.height):pe?i.renderbufferStorageMultisample(i.RENDERBUFFER,j(V),Ot,V.width,V.height):i.renderbufferStorage(i.RENDERBUFFER,Ot,V.width,V.height)}}i.bindRenderbuffer(i.RENDERBUFFER,null)}function Dt(K,V,pe){const De=V.isWebGLCubeRenderTarget===!0;if(t.bindFramebuffer(i.FRAMEBUFFER,K),!(V.depthTexture&&V.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");const We=n.get(V.depthTexture);if(We.__renderTarget=V,(!We.__webglTexture||V.depthTexture.image.width!==V.width||V.depthTexture.image.height!==V.height)&&(V.depthTexture.image.width=V.width,V.depthTexture.image.height=V.height,V.depthTexture.needsUpdate=!0),De){if(We.__webglInit===void 0&&(We.__webglInit=!0,V.depthTexture.addEventListener("dispose",B)),We.__webglTexture===void 0){We.__webglTexture=i.createTexture(),t.bindTexture(i.TEXTURE_CUBE_MAP,We.__webglTexture),ce(i.TEXTURE_CUBE_MAP,V.depthTexture);const $t=s.convert(V.depthTexture.format),Ze=s.convert(V.depthTexture.type);let Ke;V.depthTexture.format===Ml?Ke=i.DEPTH_COMPONENT24:V.depthTexture.format===vc&&(Ke=i.DEPTH24_STENCIL8);for(let Nt=0;Nt<6;Nt++)i.texImage2D(i.TEXTURE_CUBE_MAP_POSITIVE_X+Nt,0,Ke,V.width,V.height,0,$t,Ze,null)}}else de(V.depthTexture,0);const Ne=We.__webglTexture,Ct=j(V),ht=De?i.TEXTURE_CUBE_MAP_POSITIVE_X+pe:i.TEXTURE_2D,Ot=V.depthTexture.format===vc?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT;if(V.depthTexture.format===Ml)Ht(V)?c.framebufferTexture2DMultisampleEXT(i.FRAMEBUFFER,Ot,ht,Ne,0,Ct):i.framebufferTexture2D(i.FRAMEBUFFER,Ot,ht,Ne,0);else if(V.depthTexture.format===vc)Ht(V)?c.framebufferTexture2DMultisampleEXT(i.FRAMEBUFFER,Ot,ht,Ne,0,Ct):i.framebufferTexture2D(i.FRAMEBUFFER,Ot,ht,Ne,0);else throw new Error("Unknown depthTexture format")}function cn(K){const V=n.get(K),pe=K.isWebGLCubeRenderTarget===!0;if(V.__boundDepthTexture!==K.depthTexture){const De=K.depthTexture;if(V.__depthDisposeCallback&&V.__depthDisposeCallback(),De){const We=()=>{delete V.__boundDepthTexture,delete V.__depthDisposeCallback,De.removeEventListener("dispose",We)};De.addEventListener("dispose",We),V.__depthDisposeCallback=We}V.__boundDepthTexture=De}if(K.depthTexture&&!V.__autoAllocateDepthBuffer)if(pe)for(let De=0;De<6;De++)Dt(V.__webglFramebuffer[De],K,De);else{const De=K.texture.mipmaps;De&&De.length>0?Dt(V.__webglFramebuffer[0],K,0):Dt(V.__webglFramebuffer,K,0)}else if(pe){V.__webglDepthbuffer=[];for(let De=0;De<6;De++)if(t.bindFramebuffer(i.FRAMEBUFFER,V.__webglFramebuffer[De]),V.__webglDepthbuffer[De]===void 0)V.__webglDepthbuffer[De]=i.createRenderbuffer(),bt(V.__webglDepthbuffer[De],K,!1);else{const We=K.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT,Ne=V.__webglDepthbuffer[De];i.bindRenderbuffer(i.RENDERBUFFER,Ne),i.framebufferRenderbuffer(i.FRAMEBUFFER,We,i.RENDERBUFFER,Ne)}}else{const De=K.texture.mipmaps;if(De&&De.length>0?t.bindFramebuffer(i.FRAMEBUFFER,V.__webglFramebuffer[0]):t.bindFramebuffer(i.FRAMEBUFFER,V.__webglFramebuffer),V.__webglDepthbuffer===void 0)V.__webglDepthbuffer=i.createRenderbuffer(),bt(V.__webglDepthbuffer,K,!1);else{const We=K.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT,Ne=V.__webglDepthbuffer;i.bindRenderbuffer(i.RENDERBUFFER,Ne),i.framebufferRenderbuffer(i.FRAMEBUFFER,We,i.RENDERBUFFER,Ne)}}t.bindFramebuffer(i.FRAMEBUFFER,null)}function Tn(K,V,pe){const De=n.get(K);V!==void 0&&ot(De.__webglFramebuffer,K,K.texture,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,0),pe!==void 0&&cn(K)}function Zt(K){const V=K.texture,pe=n.get(K),De=n.get(V);K.addEventListener("dispose",k);const We=K.textures,Ne=K.isWebGLCubeRenderTarget===!0,Ct=We.length>1;if(Ct||(De.__webglTexture===void 0&&(De.__webglTexture=i.createTexture()),De.__version=V.version,a.memory.textures++),Ne){pe.__webglFramebuffer=[];for(let ht=0;ht<6;ht++)if(V.mipmaps&&V.mipmaps.length>0){pe.__webglFramebuffer[ht]=[];for(let Ot=0;Ot<V.mipmaps.length;Ot++)pe.__webglFramebuffer[ht][Ot]=i.createFramebuffer()}else pe.__webglFramebuffer[ht]=i.createFramebuffer()}else{if(V.mipmaps&&V.mipmaps.length>0){pe.__webglFramebuffer=[];for(let ht=0;ht<V.mipmaps.length;ht++)pe.__webglFramebuffer[ht]=i.createFramebuffer()}else pe.__webglFramebuffer=i.createFramebuffer();if(Ct)for(let ht=0,Ot=We.length;ht<Ot;ht++){const $t=n.get(We[ht]);$t.__webglTexture===void 0&&($t.__webglTexture=i.createTexture(),a.memory.textures++)}if(K.samples>0&&Ht(K)===!1){pe.__webglMultisampledFramebuffer=i.createFramebuffer(),pe.__webglColorRenderbuffer=[],t.bindFramebuffer(i.FRAMEBUFFER,pe.__webglMultisampledFramebuffer);for(let ht=0;ht<We.length;ht++){const Ot=We[ht];pe.__webglColorRenderbuffer[ht]=i.createRenderbuffer(),i.bindRenderbuffer(i.RENDERBUFFER,pe.__webglColorRenderbuffer[ht]);const $t=s.convert(Ot.format,Ot.colorSpace),Ze=s.convert(Ot.type),Ke=U(Ot.internalFormat,$t,Ze,Ot.colorSpace,K.isXRRenderTarget===!0),Nt=j(K);i.renderbufferStorageMultisample(i.RENDERBUFFER,Nt,Ke,K.width,K.height),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+ht,i.RENDERBUFFER,pe.__webglColorRenderbuffer[ht])}i.bindRenderbuffer(i.RENDERBUFFER,null),K.depthBuffer&&(pe.__webglDepthRenderbuffer=i.createRenderbuffer(),bt(pe.__webglDepthRenderbuffer,K,!0)),t.bindFramebuffer(i.FRAMEBUFFER,null)}}if(Ne){t.bindTexture(i.TEXTURE_CUBE_MAP,De.__webglTexture),ce(i.TEXTURE_CUBE_MAP,V);for(let ht=0;ht<6;ht++)if(V.mipmaps&&V.mipmaps.length>0)for(let Ot=0;Ot<V.mipmaps.length;Ot++)ot(pe.__webglFramebuffer[ht][Ot],K,V,i.COLOR_ATTACHMENT0,i.TEXTURE_CUBE_MAP_POSITIVE_X+ht,Ot);else ot(pe.__webglFramebuffer[ht],K,V,i.COLOR_ATTACHMENT0,i.TEXTURE_CUBE_MAP_POSITIVE_X+ht,0);C(V)&&A(i.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(Ct){for(let ht=0,Ot=We.length;ht<Ot;ht++){const $t=We[ht],Ze=n.get($t);let Ke=i.TEXTURE_2D;(K.isWebGL3DRenderTarget||K.isWebGLArrayRenderTarget)&&(Ke=K.isWebGL3DRenderTarget?i.TEXTURE_3D:i.TEXTURE_2D_ARRAY),t.bindTexture(Ke,Ze.__webglTexture),ce(Ke,$t),ot(pe.__webglFramebuffer,K,$t,i.COLOR_ATTACHMENT0+ht,Ke,0),C($t)&&A(Ke)}t.unbindTexture()}else{let ht=i.TEXTURE_2D;if((K.isWebGL3DRenderTarget||K.isWebGLArrayRenderTarget)&&(ht=K.isWebGL3DRenderTarget?i.TEXTURE_3D:i.TEXTURE_2D_ARRAY),t.bindTexture(ht,De.__webglTexture),ce(ht,V),V.mipmaps&&V.mipmaps.length>0)for(let Ot=0;Ot<V.mipmaps.length;Ot++)ot(pe.__webglFramebuffer[Ot],K,V,i.COLOR_ATTACHMENT0,ht,Ot);else ot(pe.__webglFramebuffer,K,V,i.COLOR_ATTACHMENT0,ht,0);C(V)&&A(ht),t.unbindTexture()}K.depthBuffer&&cn(K)}function Ve(K){const V=K.textures;for(let pe=0,De=V.length;pe<De;pe++){const We=V[pe];if(C(We)){const Ne=D(K),Ct=n.get(We).__webglTexture;t.bindTexture(Ne,Ct),A(Ne),t.unbindTexture()}}}const et=[],qe=[];function _t(K){if(K.samples>0){if(Ht(K)===!1){const V=K.textures,pe=K.width,De=K.height;let We=i.COLOR_BUFFER_BIT;const Ne=K.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT,Ct=n.get(K),ht=V.length>1;if(ht)for(let $t=0;$t<V.length;$t++)t.bindFramebuffer(i.FRAMEBUFFER,Ct.__webglMultisampledFramebuffer),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+$t,i.RENDERBUFFER,null),t.bindFramebuffer(i.FRAMEBUFFER,Ct.__webglFramebuffer),i.framebufferTexture2D(i.DRAW_FRAMEBUFFER,i.COLOR_ATTACHMENT0+$t,i.TEXTURE_2D,null,0);t.bindFramebuffer(i.READ_FRAMEBUFFER,Ct.__webglMultisampledFramebuffer);const Ot=K.texture.mipmaps;Ot&&Ot.length>0?t.bindFramebuffer(i.DRAW_FRAMEBUFFER,Ct.__webglFramebuffer[0]):t.bindFramebuffer(i.DRAW_FRAMEBUFFER,Ct.__webglFramebuffer);for(let $t=0;$t<V.length;$t++){if(K.resolveDepthBuffer&&(K.depthBuffer&&(We|=i.DEPTH_BUFFER_BIT),K.stencilBuffer&&K.resolveStencilBuffer&&(We|=i.STENCIL_BUFFER_BIT)),ht){i.framebufferRenderbuffer(i.READ_FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.RENDERBUFFER,Ct.__webglColorRenderbuffer[$t]);const Ze=n.get(V[$t]).__webglTexture;i.framebufferTexture2D(i.DRAW_FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,Ze,0)}i.blitFramebuffer(0,0,pe,De,0,0,pe,De,We,i.NEAREST),d===!0&&(et.length=0,qe.length=0,et.push(i.COLOR_ATTACHMENT0+$t),K.depthBuffer&&K.resolveDepthBuffer===!1&&(et.push(Ne),qe.push(Ne),i.invalidateFramebuffer(i.DRAW_FRAMEBUFFER,qe)),i.invalidateFramebuffer(i.READ_FRAMEBUFFER,et))}if(t.bindFramebuffer(i.READ_FRAMEBUFFER,null),t.bindFramebuffer(i.DRAW_FRAMEBUFFER,null),ht)for(let $t=0;$t<V.length;$t++){t.bindFramebuffer(i.FRAMEBUFFER,Ct.__webglMultisampledFramebuffer),i.framebufferRenderbuffer(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0+$t,i.RENDERBUFFER,Ct.__webglColorRenderbuffer[$t]);const Ze=n.get(V[$t]).__webglTexture;t.bindFramebuffer(i.FRAMEBUFFER,Ct.__webglFramebuffer),i.framebufferTexture2D(i.DRAW_FRAMEBUFFER,i.COLOR_ATTACHMENT0+$t,i.TEXTURE_2D,Ze,0)}t.bindFramebuffer(i.DRAW_FRAMEBUFFER,Ct.__webglMultisampledFramebuffer)}else if(K.depthBuffer&&K.resolveDepthBuffer===!1&&d){const V=K.stencilBuffer?i.DEPTH_STENCIL_ATTACHMENT:i.DEPTH_ATTACHMENT;i.invalidateFramebuffer(i.DRAW_FRAMEBUFFER,[V])}}}function j(K){return Math.min(r.maxSamples,K.samples)}function Ht(K){const V=n.get(K);return K.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&V.__useRenderToTexture!==!1}function Et(K){const V=a.render.frame;m.get(K)!==V&&(m.set(K,V),K.update())}function Gt(K,V){const pe=K.colorSpace,De=K.format,We=K.type;return K.isCompressedTexture===!0||K.isVideoTexture===!0||pe!==Pa&&pe!==cu&&(Gn.getTransfer(pe)===oi?(De!==ur||We!==kr)&&It("WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):Jt("WebGLTextures: Unsupported texture color space:",pe)),V}function ut(K){return typeof HTMLImageElement<"u"&&K instanceof HTMLImageElement?(p.width=K.naturalWidth||K.width,p.height=K.naturalHeight||K.height):typeof VideoFrame<"u"&&K instanceof VideoFrame?(p.width=K.displayWidth,p.height=K.displayHeight):(p.width=K.width,p.height=K.height),p}this.allocateTextureUnit=ee,this.resetTextureUnits=ie,this.setTexture2D=de,this.setTexture2DArray=J,this.setTexture3D=te,this.setTextureCube=ye,this.rebindTextures=Tn,this.setupRenderTarget=Zt,this.updateRenderTargetMipmap=Ve,this.updateMultisampleRenderTarget=_t,this.setupDepthRenderbuffer=cn,this.setupFrameBufferTexture=ot,this.useMultisampledRTT=Ht,this.isReversedDepthBuffer=function(){return t.buffers.depth.getReversed()}}function II(i,e){function t(n,r=cu){let s;const a=Gn.getTransfer(r);if(n===kr)return i.UNSIGNED_BYTE;if(n===ox)return i.UNSIGNED_SHORT_4_4_4_4;if(n===ax)return i.UNSIGNED_SHORT_5_5_5_1;if(n===qM)return i.UNSIGNED_INT_5_9_9_9_REV;if(n===WM)return i.UNSIGNED_INT_10F_11F_11F_REV;if(n===rx)return i.BYTE;if(n===sx)return i.SHORT;if(n===qh)return i.UNSIGNED_SHORT;if(n===Og)return i.INT;if(n===Mo)return i.UNSIGNED_INT;if(n===Ni)return i.FLOAT;if(n===Wi)return i.HALF_FLOAT;if(n===XM)return i.ALPHA;if(n===YM)return i.RGB;if(n===ur)return i.RGBA;if(n===Ml)return i.DEPTH_COMPONENT;if(n===vc)return i.DEPTH_STENCIL;if(n===zg)return i.RED;if(n===Bg)return i.RED_INTEGER;if(n===qf)return i.RG;if(n===lx)return i.RG_INTEGER;if(n===ux)return i.RGBA_INTEGER;if(n===og||n===ag||n===lg||n===ug)if(a===oi)if(s=e.get("WEBGL_compressed_texture_s3tc_srgb"),s!==null){if(n===og)return s.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(n===ag)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(n===lg)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(n===ug)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(s=e.get("WEBGL_compressed_texture_s3tc"),s!==null){if(n===og)return s.COMPRESSED_RGB_S3TC_DXT1_EXT;if(n===ag)return s.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(n===lg)return s.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(n===ug)return s.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(n===r_||n===s_||n===o_||n===a_)if(s=e.get("WEBGL_compressed_texture_pvrtc"),s!==null){if(n===r_)return s.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(n===s_)return s.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(n===o_)return s.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(n===a_)return s.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(n===l_||n===u_||n===c_||n===f_||n===d_||n===h_||n===p_)if(s=e.get("WEBGL_compressed_texture_etc"),s!==null){if(n===l_||n===u_)return a===oi?s.COMPRESSED_SRGB8_ETC2:s.COMPRESSED_RGB8_ETC2;if(n===c_)return a===oi?s.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:s.COMPRESSED_RGBA8_ETC2_EAC;if(n===f_)return s.COMPRESSED_R11_EAC;if(n===d_)return s.COMPRESSED_SIGNED_R11_EAC;if(n===h_)return s.COMPRESSED_RG11_EAC;if(n===p_)return s.COMPRESSED_SIGNED_RG11_EAC}else return null;if(n===m_||n===g_||n===v_||n===y_||n===__||n===x_||n===S_||n===b_||n===M_||n===E_||n===T_||n===A_||n===w_||n===C_)if(s=e.get("WEBGL_compressed_texture_astc"),s!==null){if(n===m_)return a===oi?s.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:s.COMPRESSED_RGBA_ASTC_4x4_KHR;if(n===g_)return a===oi?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:s.COMPRESSED_RGBA_ASTC_5x4_KHR;if(n===v_)return a===oi?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:s.COMPRESSED_RGBA_ASTC_5x5_KHR;if(n===y_)return a===oi?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:s.COMPRESSED_RGBA_ASTC_6x5_KHR;if(n===__)return a===oi?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:s.COMPRESSED_RGBA_ASTC_6x6_KHR;if(n===x_)return a===oi?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:s.COMPRESSED_RGBA_ASTC_8x5_KHR;if(n===S_)return a===oi?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:s.COMPRESSED_RGBA_ASTC_8x6_KHR;if(n===b_)return a===oi?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:s.COMPRESSED_RGBA_ASTC_8x8_KHR;if(n===M_)return a===oi?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:s.COMPRESSED_RGBA_ASTC_10x5_KHR;if(n===E_)return a===oi?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:s.COMPRESSED_RGBA_ASTC_10x6_KHR;if(n===T_)return a===oi?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:s.COMPRESSED_RGBA_ASTC_10x8_KHR;if(n===A_)return a===oi?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:s.COMPRESSED_RGBA_ASTC_10x10_KHR;if(n===w_)return a===oi?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:s.COMPRESSED_RGBA_ASTC_12x10_KHR;if(n===C_)return a===oi?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:s.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(n===R_||n===I_||n===N_)if(s=e.get("EXT_texture_compression_bptc"),s!==null){if(n===R_)return a===oi?s.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:s.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(n===I_)return s.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(n===N_)return s.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(n===D_||n===U_||n===P_||n===L_)if(s=e.get("EXT_texture_compression_rgtc"),s!==null){if(n===D_)return s.COMPRESSED_RED_RGTC1_EXT;if(n===U_)return s.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(n===P_)return s.COMPRESSED_RED_GREEN_RGTC2_EXT;if(n===L_)return s.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return n===Wh?i.UNSIGNED_INT_24_8:i[n]!==void 0?i[n]:null}return{convert:t}}const UB=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,PB=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`;class LB{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,t){if(this.texture===null){const n=new nE(e.texture);(e.depthNear!==t.depthNear||e.depthFar!==t.depthFar)&&(this.depthNear=e.depthNear,this.depthFar=e.depthFar),this.texture=n}}getMesh(e){if(this.texture!==null&&this.mesh===null){const t=e.cameras[0].viewport,n=new Ar({vertexShader:UB,fragmentShader:PB,uniforms:{depthColor:{value:this.texture},depthWidth:{value:t.z},depthHeight:{value:t.w}}});this.mesh=new Di(new gu(20,20),n)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}}class FB extends Tl{constructor(e,t){super();const n=this;let r=null,s=1,a=null,c="local-floor",d=1,p=null,m=null,v=null,_=null,b=null,T=null;const I=typeof XRWebGLBinding<"u",C=new LB,A={},D=t.getContextAttributes();let U=null,L=null;const z=[],B=[],k=new $e;let G=null;const P=new Fr;P.viewport=new $n;const O=new Fr;O.viewport=new $n;const Z=[P,O],ie=new _I;let ee=null,re=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(ve){let Re=z[ve];return Re===void 0&&(Re=new qy,z[ve]=Re),Re.getTargetRaySpace()},this.getControllerGrip=function(ve){let Re=z[ve];return Re===void 0&&(Re=new qy,z[ve]=Re),Re.getGripSpace()},this.getHand=function(ve){let Re=z[ve];return Re===void 0&&(Re=new qy,z[ve]=Re),Re.getHandSpace()};function de(ve){const Re=B.indexOf(ve.inputSource);if(Re===-1)return;const ot=z[Re];ot!==void 0&&(ot.update(ve.inputSource,ve.frame,p||a),ot.dispatchEvent({type:ve.type,data:ve.inputSource}))}function J(){r.removeEventListener("select",de),r.removeEventListener("selectstart",de),r.removeEventListener("selectend",de),r.removeEventListener("squeeze",de),r.removeEventListener("squeezestart",de),r.removeEventListener("squeezeend",de),r.removeEventListener("end",J),r.removeEventListener("inputsourceschange",te);for(let ve=0;ve<z.length;ve++){const Re=B[ve];Re!==null&&(B[ve]=null,z[ve].disconnect(Re))}ee=null,re=null,C.reset();for(const ve in A)delete A[ve];e.setRenderTarget(U),b=null,_=null,v=null,r=null,L=null,St.stop(),n.isPresenting=!1,e.setPixelRatio(G),e.setSize(k.width,k.height,!1),n.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(ve){s=ve,n.isPresenting===!0&&It("WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(ve){c=ve,n.isPresenting===!0&&It("WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return p||a},this.setReferenceSpace=function(ve){p=ve},this.getBaseLayer=function(){return _!==null?_:b},this.getBinding=function(){return v===null&&I&&(v=new XRWebGLBinding(r,t)),v},this.getFrame=function(){return T},this.getSession=function(){return r},this.setSession=async function(ve){if(r=ve,r!==null){if(U=e.getRenderTarget(),r.addEventListener("select",de),r.addEventListener("selectstart",de),r.addEventListener("selectend",de),r.addEventListener("squeeze",de),r.addEventListener("squeezestart",de),r.addEventListener("squeezeend",de),r.addEventListener("end",J),r.addEventListener("inputsourceschange",te),D.xrCompatible!==!0&&await t.makeXRCompatible(),G=e.getPixelRatio(),e.getSize(k),I&&"createProjectionLayer"in XRWebGLBinding.prototype){let ot=null,bt=null,Dt=null;D.depth&&(Dt=D.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,ot=D.stencil?vc:Ml,bt=D.stencil?Wh:Mo);const cn={colorFormat:t.RGBA8,depthFormat:Dt,scaleFactor:s};v=this.getBinding(),_=v.createProjectionLayer(cn),r.updateRenderState({layers:[_]}),e.setPixelRatio(1),e.setSize(_.textureWidth,_.textureHeight,!1),L=new Or(_.textureWidth,_.textureHeight,{format:ur,type:kr,depthTexture:new Wf(_.textureWidth,_.textureHeight,bt,void 0,void 0,void 0,void 0,void 0,void 0,ot),stencilBuffer:D.stencil,colorSpace:e.outputColorSpace,samples:D.antialias?4:0,resolveDepthBuffer:_.ignoreDepthValues===!1,resolveStencilBuffer:_.ignoreDepthValues===!1})}else{const ot={antialias:D.antialias,alpha:!0,depth:D.depth,stencil:D.stencil,framebufferScaleFactor:s};b=new XRWebGLLayer(r,t,ot),r.updateRenderState({baseLayer:b}),e.setPixelRatio(1),e.setSize(b.framebufferWidth,b.framebufferHeight,!1),L=new Or(b.framebufferWidth,b.framebufferHeight,{format:ur,type:kr,colorSpace:e.outputColorSpace,stencilBuffer:D.stencil,resolveDepthBuffer:b.ignoreDepthValues===!1,resolveStencilBuffer:b.ignoreDepthValues===!1})}L.isXRRenderTarget=!0,this.setFoveation(d),p=null,a=await r.requestReferenceSpace(c),St.setContext(r),St.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(r!==null)return r.environmentBlendMode},this.getDepthTexture=function(){return C.getDepthTexture()};function te(ve){for(let Re=0;Re<ve.removed.length;Re++){const ot=ve.removed[Re],bt=B.indexOf(ot);bt>=0&&(B[bt]=null,z[bt].disconnect(ot))}for(let Re=0;Re<ve.added.length;Re++){const ot=ve.added[Re];let bt=B.indexOf(ot);if(bt===-1){for(let cn=0;cn<z.length;cn++)if(cn>=B.length){B.push(ot),bt=cn;break}else if(B[cn]===null){B[cn]=ot,bt=cn;break}if(bt===-1)break}const Dt=z[bt];Dt&&Dt.connect(ot)}}const ye=new Q,Ue=new Q;function we(ve,Re,ot){ye.setFromMatrixPosition(Re.matrixWorld),Ue.setFromMatrixPosition(ot.matrixWorld);const bt=ye.distanceTo(Ue),Dt=Re.projectionMatrix.elements,cn=ot.projectionMatrix.elements,Tn=Dt[14]/(Dt[10]-1),Zt=Dt[14]/(Dt[10]+1),Ve=(Dt[9]+1)/Dt[5],et=(Dt[9]-1)/Dt[5],qe=(Dt[8]-1)/Dt[0],_t=(cn[8]+1)/cn[0],j=Tn*qe,Ht=Tn*_t,Et=bt/(-qe+_t),Gt=Et*-qe;if(Re.matrixWorld.decompose(ve.position,ve.quaternion,ve.scale),ve.translateX(Gt),ve.translateZ(Et),ve.matrixWorld.compose(ve.position,ve.quaternion,ve.scale),ve.matrixWorldInverse.copy(ve.matrixWorld).invert(),Dt[10]===-1)ve.projectionMatrix.copy(Re.projectionMatrix),ve.projectionMatrixInverse.copy(Re.projectionMatrixInverse);else{const ut=Tn+Et,K=Zt+Et,V=j-Gt,pe=Ht+(bt-Gt),De=Ve*Zt/K*ut,We=et*Zt/K*ut;ve.projectionMatrix.makePerspective(V,pe,De,We,ut,K),ve.projectionMatrixInverse.copy(ve.projectionMatrix).invert()}}function $(ve,Re){Re===null?ve.matrixWorld.copy(ve.matrix):ve.matrixWorld.multiplyMatrices(Re.matrixWorld,ve.matrix),ve.matrixWorldInverse.copy(ve.matrixWorld).invert()}this.updateCamera=function(ve){if(r===null)return;let Re=ve.near,ot=ve.far;C.texture!==null&&(C.depthNear>0&&(Re=C.depthNear),C.depthFar>0&&(ot=C.depthFar)),ie.near=O.near=P.near=Re,ie.far=O.far=P.far=ot,(ee!==ie.near||re!==ie.far)&&(r.updateRenderState({depthNear:ie.near,depthFar:ie.far}),ee=ie.near,re=ie.far),ie.layers.mask=ve.layers.mask|6,P.layers.mask=ie.layers.mask&3,O.layers.mask=ie.layers.mask&5;const bt=ve.parent,Dt=ie.cameras;$(ie,bt);for(let cn=0;cn<Dt.length;cn++)$(Dt[cn],bt);Dt.length===2?we(ie,P,O):ie.projectionMatrix.copy(P.projectionMatrix),ce(ve,ie,bt)};function ce(ve,Re,ot){ot===null?ve.matrix.copy(Re.matrixWorld):(ve.matrix.copy(ot.matrixWorld),ve.matrix.invert(),ve.matrix.multiply(Re.matrixWorld)),ve.matrix.decompose(ve.position,ve.quaternion,ve.scale),ve.updateMatrixWorld(!0),ve.projectionMatrix.copy(Re.projectionMatrix),ve.projectionMatrixInverse.copy(Re.projectionMatrixInverse),ve.isPerspectiveCamera&&(ve.fov=Jh*2*Math.atan(1/ve.projectionMatrix.elements[5]),ve.zoom=1)}this.getCamera=function(){return ie},this.getFoveation=function(){if(!(_===null&&b===null))return d},this.setFoveation=function(ve){d=ve,_!==null&&(_.fixedFoveation=ve),b!==null&&b.fixedFoveation!==void 0&&(b.fixedFoveation=ve)},this.hasDepthSensing=function(){return C.texture!==null},this.getDepthSensingMesh=function(){return C.getMesh(ie)},this.getCameraTexture=function(ve){return A[ve]};let Ee=null;function Be(ve,Re){if(m=Re.getViewerPose(p||a),T=Re,m!==null){const ot=m.views;b!==null&&(e.setRenderTargetFramebuffer(L,b.framebuffer),e.setRenderTarget(L));let bt=!1;ot.length!==ie.cameras.length&&(ie.cameras.length=0,bt=!0);for(let Zt=0;Zt<ot.length;Zt++){const Ve=ot[Zt];let et=null;if(b!==null)et=b.getViewport(Ve);else{const _t=v.getViewSubImage(_,Ve);et=_t.viewport,Zt===0&&(e.setRenderTargetTextures(L,_t.colorTexture,_t.depthStencilTexture),e.setRenderTarget(L))}let qe=Z[Zt];qe===void 0&&(qe=new Fr,qe.layers.enable(Zt),qe.viewport=new $n,Z[Zt]=qe),qe.matrix.fromArray(Ve.transform.matrix),qe.matrix.decompose(qe.position,qe.quaternion,qe.scale),qe.projectionMatrix.fromArray(Ve.projectionMatrix),qe.projectionMatrixInverse.copy(qe.projectionMatrix).invert(),qe.viewport.set(et.x,et.y,et.width,et.height),Zt===0&&(ie.matrix.copy(qe.matrix),ie.matrix.decompose(ie.position,ie.quaternion,ie.scale)),bt===!0&&ie.cameras.push(qe)}const Dt=r.enabledFeatures;if(Dt&&Dt.includes("depth-sensing")&&r.depthUsage=="gpu-optimized"&&I){v=n.getBinding();const Zt=v.getDepthInformation(ot[0]);Zt&&Zt.isValid&&Zt.texture&&C.init(Zt,r.renderState)}if(Dt&&Dt.includes("camera-access")&&I){e.state.unbindTexture(),v=n.getBinding();for(let Zt=0;Zt<ot.length;Zt++){const Ve=ot[Zt].camera;if(Ve){let et=A[Ve];et||(et=new nE,A[Ve]=et);const qe=v.getCameraImage(Ve);et.sourceTexture=qe}}}}for(let ot=0;ot<z.length;ot++){const bt=B[ot],Dt=z[ot];bt!==null&&Dt!==void 0&&Dt.update(bt,Re,p||a)}Ee&&Ee(ve,Re),Re.detectedPlanes&&n.dispatchEvent({type:"planesdetected",data:Re}),T=null}const St=new TI;St.setAnimationLoop(Be),this.setAnimationLoop=function(ve){Ee=ve},this.dispose=function(){}}}const Rf=new Eo,kB=new an;function OB(i,e){function t(C,A){C.matrixAutoUpdate===!0&&C.updateMatrix(),A.value.copy(C.matrix)}function n(C,A){A.color.getRGB(C.fogColor.value,RR(i)),A.isFog?(C.fogNear.value=A.near,C.fogFar.value=A.far):A.isFogExp2&&(C.fogDensity.value=A.density)}function r(C,A,D,U,L){A.isMeshBasicMaterial||A.isMeshLambertMaterial?s(C,A):A.isMeshToonMaterial?(s(C,A),v(C,A)):A.isMeshPhongMaterial?(s(C,A),m(C,A)):A.isMeshStandardMaterial?(s(C,A),_(C,A),A.isMeshPhysicalMaterial&&b(C,A,L)):A.isMeshMatcapMaterial?(s(C,A),T(C,A)):A.isMeshDepthMaterial?s(C,A):A.isMeshDistanceMaterial?(s(C,A),I(C,A)):A.isMeshNormalMaterial?s(C,A):A.isLineBasicMaterial?(a(C,A),A.isLineDashedMaterial&&c(C,A)):A.isPointsMaterial?d(C,A,D,U):A.isSpriteMaterial?p(C,A):A.isShadowMaterial?(C.color.value.copy(A.color),C.opacity.value=A.opacity):A.isShaderMaterial&&(A.uniformsNeedUpdate=!1)}function s(C,A){C.opacity.value=A.opacity,A.color&&C.diffuse.value.copy(A.color),A.emissive&&C.emissive.value.copy(A.emissive).multiplyScalar(A.emissiveIntensity),A.map&&(C.map.value=A.map,t(A.map,C.mapTransform)),A.alphaMap&&(C.alphaMap.value=A.alphaMap,t(A.alphaMap,C.alphaMapTransform)),A.bumpMap&&(C.bumpMap.value=A.bumpMap,t(A.bumpMap,C.bumpMapTransform),C.bumpScale.value=A.bumpScale,A.side===gs&&(C.bumpScale.value*=-1)),A.normalMap&&(C.normalMap.value=A.normalMap,t(A.normalMap,C.normalMapTransform),C.normalScale.value.copy(A.normalScale),A.side===gs&&C.normalScale.value.negate()),A.displacementMap&&(C.displacementMap.value=A.displacementMap,t(A.displacementMap,C.displacementMapTransform),C.displacementScale.value=A.displacementScale,C.displacementBias.value=A.displacementBias),A.emissiveMap&&(C.emissiveMap.value=A.emissiveMap,t(A.emissiveMap,C.emissiveMapTransform)),A.specularMap&&(C.specularMap.value=A.specularMap,t(A.specularMap,C.specularMapTransform)),A.alphaTest>0&&(C.alphaTest.value=A.alphaTest);const D=e.get(A),U=D.envMap,L=D.envMapRotation;U&&(C.envMap.value=U,Rf.copy(L),Rf.x*=-1,Rf.y*=-1,Rf.z*=-1,U.isCubeTexture&&U.isRenderTargetTexture===!1&&(Rf.y*=-1,Rf.z*=-1),C.envMapRotation.value.setFromMatrix4(kB.makeRotationFromEuler(Rf)),C.flipEnvMap.value=U.isCubeTexture&&U.isRenderTargetTexture===!1?-1:1,C.reflectivity.value=A.reflectivity,C.ior.value=A.ior,C.refractionRatio.value=A.refractionRatio),A.lightMap&&(C.lightMap.value=A.lightMap,C.lightMapIntensity.value=A.lightMapIntensity,t(A.lightMap,C.lightMapTransform)),A.aoMap&&(C.aoMap.value=A.aoMap,C.aoMapIntensity.value=A.aoMapIntensity,t(A.aoMap,C.aoMapTransform))}function a(C,A){C.diffuse.value.copy(A.color),C.opacity.value=A.opacity,A.map&&(C.map.value=A.map,t(A.map,C.mapTransform))}function c(C,A){C.dashSize.value=A.dashSize,C.totalSize.value=A.dashSize+A.gapSize,C.scale.value=A.scale}function d(C,A,D,U){C.diffuse.value.copy(A.color),C.opacity.value=A.opacity,C.size.value=A.size*D,C.scale.value=U*.5,A.map&&(C.map.value=A.map,t(A.map,C.uvTransform)),A.alphaMap&&(C.alphaMap.value=A.alphaMap,t(A.alphaMap,C.alphaMapTransform)),A.alphaTest>0&&(C.alphaTest.value=A.alphaTest)}function p(C,A){C.diffuse.value.copy(A.color),C.opacity.value=A.opacity,C.rotation.value=A.rotation,A.map&&(C.map.value=A.map,t(A.map,C.mapTransform)),A.alphaMap&&(C.alphaMap.value=A.alphaMap,t(A.alphaMap,C.alphaMapTransform)),A.alphaTest>0&&(C.alphaTest.value=A.alphaTest)}function m(C,A){C.specular.value.copy(A.specular),C.shininess.value=Math.max(A.shininess,1e-4)}function v(C,A){A.gradientMap&&(C.gradientMap.value=A.gradientMap)}function _(C,A){C.metalness.value=A.metalness,A.metalnessMap&&(C.metalnessMap.value=A.metalnessMap,t(A.metalnessMap,C.metalnessMapTransform)),C.roughness.value=A.roughness,A.roughnessMap&&(C.roughnessMap.value=A.roughnessMap,t(A.roughnessMap,C.roughnessMapTransform)),A.envMap&&(C.envMapIntensity.value=A.envMapIntensity)}function b(C,A,D){C.ior.value=A.ior,A.sheen>0&&(C.sheenColor.value.copy(A.sheenColor).multiplyScalar(A.sheen),C.sheenRoughness.value=A.sheenRoughness,A.sheenColorMap&&(C.sheenColorMap.value=A.sheenColorMap,t(A.sheenColorMap,C.sheenColorMapTransform)),A.sheenRoughnessMap&&(C.sheenRoughnessMap.value=A.sheenRoughnessMap,t(A.sheenRoughnessMap,C.sheenRoughnessMapTransform))),A.clearcoat>0&&(C.clearcoat.value=A.clearcoat,C.clearcoatRoughness.value=A.clearcoatRoughness,A.clearcoatMap&&(C.clearcoatMap.value=A.clearcoatMap,t(A.clearcoatMap,C.clearcoatMapTransform)),A.clearcoatRoughnessMap&&(C.clearcoatRoughnessMap.value=A.clearcoatRoughnessMap,t(A.clearcoatRoughnessMap,C.clearcoatRoughnessMapTransform)),A.clearcoatNormalMap&&(C.clearcoatNormalMap.value=A.clearcoatNormalMap,t(A.clearcoatNormalMap,C.clearcoatNormalMapTransform),C.clearcoatNormalScale.value.copy(A.clearcoatNormalScale),A.side===gs&&C.clearcoatNormalScale.value.negate())),A.dispersion>0&&(C.dispersion.value=A.dispersion),A.iridescence>0&&(C.iridescence.value=A.iridescence,C.iridescenceIOR.value=A.iridescenceIOR,C.iridescenceThicknessMinimum.value=A.iridescenceThicknessRange[0],C.iridescenceThicknessMaximum.value=A.iridescenceThicknessRange[1],A.iridescenceMap&&(C.iridescenceMap.value=A.iridescenceMap,t(A.iridescenceMap,C.iridescenceMapTransform)),A.iridescenceThicknessMap&&(C.iridescenceThicknessMap.value=A.iridescenceThicknessMap,t(A.iridescenceThicknessMap,C.iridescenceThicknessMapTransform))),A.transmission>0&&(C.transmission.value=A.transmission,C.transmissionSamplerMap.value=D.texture,C.transmissionSamplerSize.value.set(D.width,D.height),A.transmissionMap&&(C.transmissionMap.value=A.transmissionMap,t(A.transmissionMap,C.transmissionMapTransform)),C.thickness.value=A.thickness,A.thicknessMap&&(C.thicknessMap.value=A.thicknessMap,t(A.thicknessMap,C.thicknessMapTransform)),C.attenuationDistance.value=A.attenuationDistance,C.attenuationColor.value.copy(A.attenuationColor)),A.anisotropy>0&&(C.anisotropyVector.value.set(A.anisotropy*Math.cos(A.anisotropyRotation),A.anisotropy*Math.sin(A.anisotropyRotation)),A.anisotropyMap&&(C.anisotropyMap.value=A.anisotropyMap,t(A.anisotropyMap,C.anisotropyMapTransform))),C.specularIntensity.value=A.specularIntensity,C.specularColor.value.copy(A.specularColor),A.specularColorMap&&(C.specularColorMap.value=A.specularColorMap,t(A.specularColorMap,C.specularColorMapTransform)),A.specularIntensityMap&&(C.specularIntensityMap.value=A.specularIntensityMap,t(A.specularIntensityMap,C.specularIntensityMapTransform))}function T(C,A){A.matcap&&(C.matcap.value=A.matcap)}function I(C,A){const D=e.get(A).light;C.referencePosition.value.setFromMatrixPosition(D.matrixWorld),C.nearDistance.value=D.shadow.camera.near,C.farDistance.value=D.shadow.camera.far}return{refreshFogUniforms:n,refreshMaterialUniforms:r}}function zB(i,e,t,n){let r={},s={},a=[];const c=i.getParameter(i.MAX_UNIFORM_BUFFER_BINDINGS);function d(D,U){const L=U.program;n.uniformBlockBinding(D,L)}function p(D,U){let L=r[D.id];L===void 0&&(T(D),L=m(D),r[D.id]=L,D.addEventListener("dispose",C));const z=U.program;n.updateUBOMapping(D,z);const B=e.render.frame;s[D.id]!==B&&(_(D),s[D.id]=B)}function m(D){const U=v();D.__bindingPointIndex=U;const L=i.createBuffer(),z=D.__size,B=D.usage;return i.bindBuffer(i.UNIFORM_BUFFER,L),i.bufferData(i.UNIFORM_BUFFER,z,B),i.bindBuffer(i.UNIFORM_BUFFER,null),i.bindBufferBase(i.UNIFORM_BUFFER,U,L),L}function v(){for(let D=0;D<c;D++)if(a.indexOf(D)===-1)return a.push(D),D;return Jt("WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function _(D){const U=r[D.id],L=D.uniforms,z=D.__cache;i.bindBuffer(i.UNIFORM_BUFFER,U);for(let B=0,k=L.length;B<k;B++){const G=Array.isArray(L[B])?L[B]:[L[B]];for(let P=0,O=G.length;P<O;P++){const Z=G[P];if(b(Z,B,P,z)===!0){const ie=Z.__offset,ee=Array.isArray(Z.value)?Z.value:[Z.value];let re=0;for(let de=0;de<ee.length;de++){const J=ee[de],te=I(J);typeof J=="number"||typeof J=="boolean"?(Z.__data[0]=J,i.bufferSubData(i.UNIFORM_BUFFER,ie+re,Z.__data)):J.isMatrix3?(Z.__data[0]=J.elements[0],Z.__data[1]=J.elements[1],Z.__data[2]=J.elements[2],Z.__data[3]=0,Z.__data[4]=J.elements[3],Z.__data[5]=J.elements[4],Z.__data[6]=J.elements[5],Z.__data[7]=0,Z.__data[8]=J.elements[6],Z.__data[9]=J.elements[7],Z.__data[10]=J.elements[8],Z.__data[11]=0):(J.toArray(Z.__data,re),re+=te.storage/Float32Array.BYTES_PER_ELEMENT)}i.bufferSubData(i.UNIFORM_BUFFER,ie,Z.__data)}}}i.bindBuffer(i.UNIFORM_BUFFER,null)}function b(D,U,L,z){const B=D.value,k=U+"_"+L;if(z[k]===void 0)return typeof B=="number"||typeof B=="boolean"?z[k]=B:z[k]=B.clone(),!0;{const G=z[k];if(typeof B=="number"||typeof B=="boolean"){if(G!==B)return z[k]=B,!0}else if(G.equals(B)===!1)return G.copy(B),!0}return!1}function T(D){const U=D.uniforms;let L=0;const z=16;for(let k=0,G=U.length;k<G;k++){const P=Array.isArray(U[k])?U[k]:[U[k]];for(let O=0,Z=P.length;O<Z;O++){const ie=P[O],ee=Array.isArray(ie.value)?ie.value:[ie.value];for(let re=0,de=ee.length;re<de;re++){const J=ee[re],te=I(J),ye=L%z,Ue=ye%te.boundary,we=ye+Ue;L+=Ue,we!==0&&z-we<te.storage&&(L+=z-we),ie.__data=new Float32Array(te.storage/Float32Array.BYTES_PER_ELEMENT),ie.__offset=L,L+=te.storage}}}const B=L%z;return B>0&&(L+=z-B),D.__size=L,D.__cache={},this}function I(D){const U={boundary:0,storage:0};return typeof D=="number"||typeof D=="boolean"?(U.boundary=4,U.storage=4):D.isVector2?(U.boundary=8,U.storage=8):D.isVector3||D.isColor?(U.boundary=16,U.storage=12):D.isVector4?(U.boundary=16,U.storage=16):D.isMatrix3?(U.boundary=48,U.storage=48):D.isMatrix4?(U.boundary=64,U.storage=64):D.isTexture?It("WebGLRenderer: Texture samplers can not be part of an uniforms group."):It("WebGLRenderer: Unsupported uniform value type.",D),U}function C(D){const U=D.target;U.removeEventListener("dispose",C);const L=a.indexOf(U.__bindingPointIndex);a.splice(L,1),i.deleteBuffer(r[U.id]),delete r[U.id],delete s[U.id]}function A(){for(const D in r)i.deleteBuffer(r[D]);a=[],r={},s={}}return{bind:d,update:p,dispose:A}}const BB=new Uint16Array([12469,15057,12620,14925,13266,14620,13807,14376,14323,13990,14545,13625,14713,13328,14840,12882,14931,12528,14996,12233,15039,11829,15066,11525,15080,11295,15085,10976,15082,10705,15073,10495,13880,14564,13898,14542,13977,14430,14158,14124,14393,13732,14556,13410,14702,12996,14814,12596,14891,12291,14937,11834,14957,11489,14958,11194,14943,10803,14921,10506,14893,10278,14858,9960,14484,14039,14487,14025,14499,13941,14524,13740,14574,13468,14654,13106,14743,12678,14818,12344,14867,11893,14889,11509,14893,11180,14881,10751,14852,10428,14812,10128,14765,9754,14712,9466,14764,13480,14764,13475,14766,13440,14766,13347,14769,13070,14786,12713,14816,12387,14844,11957,14860,11549,14868,11215,14855,10751,14825,10403,14782,10044,14729,9651,14666,9352,14599,9029,14967,12835,14966,12831,14963,12804,14954,12723,14936,12564,14917,12347,14900,11958,14886,11569,14878,11247,14859,10765,14828,10401,14784,10011,14727,9600,14660,9289,14586,8893,14508,8533,15111,12234,15110,12234,15104,12216,15092,12156,15067,12010,15028,11776,14981,11500,14942,11205,14902,10752,14861,10393,14812,9991,14752,9570,14682,9252,14603,8808,14519,8445,14431,8145,15209,11449,15208,11451,15202,11451,15190,11438,15163,11384,15117,11274,15055,10979,14994,10648,14932,10343,14871,9936,14803,9532,14729,9218,14645,8742,14556,8381,14461,8020,14365,7603,15273,10603,15272,10607,15267,10619,15256,10631,15231,10614,15182,10535,15118,10389,15042,10167,14963,9787,14883,9447,14800,9115,14710,8665,14615,8318,14514,7911,14411,7507,14279,7198,15314,9675,15313,9683,15309,9712,15298,9759,15277,9797,15229,9773,15166,9668,15084,9487,14995,9274,14898,8910,14800,8539,14697,8234,14590,7790,14479,7409,14367,7067,14178,6621,15337,8619,15337,8631,15333,8677,15325,8769,15305,8871,15264,8940,15202,8909,15119,8775,15022,8565,14916,8328,14804,8009,14688,7614,14569,7287,14448,6888,14321,6483,14088,6171,15350,7402,15350,7419,15347,7480,15340,7613,15322,7804,15287,7973,15229,8057,15148,8012,15046,7846,14933,7611,14810,7357,14682,7069,14552,6656,14421,6316,14251,5948,14007,5528,15356,5942,15356,5977,15353,6119,15348,6294,15332,6551,15302,6824,15249,7044,15171,7122,15070,7050,14949,6861,14818,6611,14679,6349,14538,6067,14398,5651,14189,5311,13935,4958,15359,4123,15359,4153,15356,4296,15353,4646,15338,5160,15311,5508,15263,5829,15188,6042,15088,6094,14966,6001,14826,5796,14678,5543,14527,5287,14377,4985,14133,4586,13869,4257,15360,1563,15360,1642,15358,2076,15354,2636,15341,3350,15317,4019,15273,4429,15203,4732,15105,4911,14981,4932,14836,4818,14679,4621,14517,4386,14359,4156,14083,3795,13808,3437,15360,122,15360,137,15358,285,15355,636,15344,1274,15322,2177,15281,2765,15215,3223,15120,3451,14995,3569,14846,3567,14681,3466,14511,3305,14344,3121,14037,2800,13753,2467,15360,0,15360,1,15359,21,15355,89,15346,253,15325,479,15287,796,15225,1148,15133,1492,15008,1749,14856,1882,14685,1886,14506,1783,14324,1608,13996,1398,13702,1183]);let pl=null;function VB(){return pl===null&&(pl=new na(BB,16,16,qf,Wi),pl.name="DFG_LUT",pl.minFilter=Bn,pl.magFilter=Bn,pl.wrapS=Qi,pl.wrapT=Qi,pl.generateMipmaps=!1,pl.needsUpdate=!0),pl}class AE{constructor(e={}){const{canvas:t=AR(),context:n=null,depth:r=!0,stencil:s=!1,alpha:a=!1,antialias:c=!1,premultipliedAlpha:d=!0,preserveDrawingBuffer:p=!1,powerPreference:m="default",failIfMajorPerformanceCaveat:v=!1,reversedDepthBuffer:_=!1,outputBufferType:b=kr}=e;this.isWebGLRenderer=!0;let T;if(n!==null){if(typeof WebGLRenderingContext<"u"&&n instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");T=n.getContextAttributes().alpha}else T=a;const I=b,C=new Set([ux,lx,Bg]),A=new Set([kr,Mo,qh,Wh,ox,ax]),D=new Uint32Array(4),U=new Int32Array(4);let L=null,z=null;const B=[],k=[];let G=null;this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.toneMapping=ta,this.toneMappingExposure=1,this.transmissionResolutionScale=1;const P=this;let O=!1;this._outputColorSpace=es;let Z=0,ie=0,ee=null,re=-1,de=null;const J=new $n,te=new $n;let ye=null;const Ue=new Pt(0);let we=0,$=t.width,ce=t.height,Ee=1,Be=null,St=null;const ve=new $n(0,0,$,ce),Re=new $n(0,0,$,ce);let ot=!1;const bt=new rp;let Dt=!1,cn=!1;const Tn=new an,Zt=new Q,Ve=new $n,et={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};let qe=!1;function _t(){return ee===null?Ee:1}let j=n;function Ht(q,ne){return t.getContext(q,ne)}try{const q={alpha:!0,depth:r,stencil:s,antialias:c,premultipliedAlpha:d,preserveDrawingBuffer:p,powerPreference:m,failIfMajorPerformanceCaveat:v};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${tp}`),t.addEventListener("webglcontextlost",nn,!1),t.addEventListener("webglcontextrestored",Nn,!1),t.addEventListener("webglcontextcreationerror",Ln,!1),j===null){const ne="webgl2";if(j=Ht(ne,q),j===null)throw Ht(ne)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(q){throw Jt("WebGLRenderer: "+q.message),q}let Et,Gt,ut,K,V,pe,De,We,Ne,Ct,ht,Ot,$t,Ze,Ke,Nt,Tt,at,Xt,me,Ce,nt,wt,tt;function He(){Et=new HO(j),Et.init(),nt=new II(j,Et),Gt=new UO(j,Et,e,nt),ut=new NB(j,Et),Gt.reversedDepthBuffer&&_&&ut.buffers.depth.setReversed(!0),K=new WO(j),V=new gB,pe=new DB(j,Et,ut,V,Gt,nt,K),De=new LO(P),We=new VO(P),Ne=new ZL(j),wt=new NO(j,Ne),Ct=new GO(j,Ne,K,wt),ht=new YO(j,Ct,Ne,K),Xt=new XO(j,Gt,pe),Nt=new PO(V),Ot=new mB(P,De,We,Et,Gt,wt,Nt),$t=new OB(P,V),Ze=new yB,Ke=new EB(Et),at=new IO(P,De,We,ut,ht,T,d),Tt=new RB(P,ht,Gt),tt=new zB(j,K,Gt,ut),me=new DO(j,Et,K),Ce=new qO(j,Et,K),K.programs=Ot.programs,P.capabilities=Gt,P.extensions=Et,P.properties=V,P.renderLists=Ze,P.shadowMap=Tt,P.state=ut,P.info=K}He(),I!==kr&&(G=new ZO(I,t.width,t.height,r,s));const vt=new FB(P,j);this.xr=vt,this.getContext=function(){return j},this.getContextAttributes=function(){return j.getContextAttributes()},this.forceContextLoss=function(){const q=Et.get("WEBGL_lose_context");q&&q.loseContext()},this.forceContextRestore=function(){const q=Et.get("WEBGL_lose_context");q&&q.restoreContext()},this.getPixelRatio=function(){return Ee},this.setPixelRatio=function(q){q!==void 0&&(Ee=q,this.setSize($,ce,!1))},this.getSize=function(q){return q.set($,ce)},this.setSize=function(q,ne,he=!0){if(vt.isPresenting){It("WebGLRenderer: Can't change size while VR device is presenting.");return}$=q,ce=ne,t.width=Math.floor(q*Ee),t.height=Math.floor(ne*Ee),he===!0&&(t.style.width=q+"px",t.style.height=ne+"px"),G!==null&&G.setSize(t.width,t.height),this.setViewport(0,0,q,ne)},this.getDrawingBufferSize=function(q){return q.set($*Ee,ce*Ee).floor()},this.setDrawingBufferSize=function(q,ne,he){$=q,ce=ne,Ee=he,t.width=Math.floor(q*he),t.height=Math.floor(ne*he),this.setViewport(0,0,q,ne)},this.setEffects=function(q){if(I===kr){console.error("THREE.WebGLRenderer: setEffects() requires outputBufferType set to HalfFloatType or FloatType.");return}if(q){for(let ne=0;ne<q.length;ne++)if(q[ne].isOutputPass===!0){console.warn("THREE.WebGLRenderer: OutputPass is not needed in setEffects(). Tone mapping and color space conversion are applied automatically.");break}}G.setEffects(q||[])},this.getCurrentViewport=function(q){return q.copy(J)},this.getViewport=function(q){return q.copy(ve)},this.setViewport=function(q,ne,he,ge){q.isVector4?ve.set(q.x,q.y,q.z,q.w):ve.set(q,ne,he,ge),ut.viewport(J.copy(ve).multiplyScalar(Ee).round())},this.getScissor=function(q){return q.copy(Re)},this.setScissor=function(q,ne,he,ge){q.isVector4?Re.set(q.x,q.y,q.z,q.w):Re.set(q,ne,he,ge),ut.scissor(te.copy(Re).multiplyScalar(Ee).round())},this.getScissorTest=function(){return ot},this.setScissorTest=function(q){ut.setScissorTest(ot=q)},this.setOpaqueSort=function(q){Be=q},this.setTransparentSort=function(q){St=q},this.getClearColor=function(q){return q.copy(at.getClearColor())},this.setClearColor=function(){at.setClearColor(...arguments)},this.getClearAlpha=function(){return at.getClearAlpha()},this.setClearAlpha=function(){at.setClearAlpha(...arguments)},this.clear=function(q=!0,ne=!0,he=!0){let ge=0;if(q){let le=!1;if(ee!==null){const Ge=ee.texture.format;le=C.has(Ge)}if(le){const Ge=ee.texture.type,rt=A.has(Ge),Xe=at.getClearColor(),Mt=at.getClearAlpha(),dt=Xe.r,Bt=Xe.g,gt=Xe.b;rt?(D[0]=dt,D[1]=Bt,D[2]=gt,D[3]=Mt,j.clearBufferuiv(j.COLOR,0,D)):(U[0]=dt,U[1]=Bt,U[2]=gt,U[3]=Mt,j.clearBufferiv(j.COLOR,0,U))}else ge|=j.COLOR_BUFFER_BIT}ne&&(ge|=j.DEPTH_BUFFER_BIT),he&&(ge|=j.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),j.clear(ge)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",nn,!1),t.removeEventListener("webglcontextrestored",Nn,!1),t.removeEventListener("webglcontextcreationerror",Ln,!1),at.dispose(),Ze.dispose(),Ke.dispose(),V.dispose(),De.dispose(),We.dispose(),ht.dispose(),wt.dispose(),tt.dispose(),Ot.dispose(),vt.dispose(),vt.removeEventListener("sessionstart",Br),vt.removeEventListener("sessionend",ys),jt.stop()};function nn(q){q.preventDefault(),Tg("WebGLRenderer: Context Lost."),O=!0}function Nn(){Tg("WebGLRenderer: Context Restored."),O=!1;const q=K.autoReset,ne=Tt.enabled,he=Tt.autoUpdate,ge=Tt.needsUpdate,le=Tt.type;He(),K.autoReset=q,Tt.enabled=ne,Tt.autoUpdate=he,Tt.needsUpdate=ge,Tt.type=le}function Ln(q){Jt("WebGLRenderer: A WebGL context could not be created. Reason: ",q.statusMessage)}function ji(q){const ne=q.target;ne.removeEventListener("dispose",ji),Rr(ne)}function Rr(q){To(q),V.remove(q)}function To(q){const ne=V.get(q).programs;ne!==void 0&&(ne.forEach(function(he){Ot.releaseProgram(he)}),q.isShaderMaterial&&Ot.releaseShaderCache(q))}this.renderBufferDirect=function(q,ne,he,ge,le,Ge){ne===null&&(ne=et);const rt=le.isMesh&&le.matrixWorld.determinant()<0,Xe=it(q,ne,he,ge,le);ut.setMaterial(ge,rt);let Mt=he.index,dt=1;if(ge.wireframe===!0){if(Mt=Ct.getWireframeAttribute(he),Mt===void 0)return;dt=2}const Bt=he.drawRange,gt=he.attributes.position;let kt=Bt.start*dt,fn=(Bt.start+Bt.count)*dt;Ge!==null&&(kt=Math.max(kt,Ge.start*dt),fn=Math.min(fn,(Ge.start+Ge.count)*dt)),Mt!==null?(kt=Math.max(kt,0),fn=Math.min(fn,Mt.count)):gt!=null&&(kt=Math.max(kt,0),fn=Math.min(fn,gt.count));const Xn=fn-kt;if(Xn<0||Xn===1/0)return;wt.setup(le,ge,Xe,he,Mt);let yn,Ut=me;if(Mt!==null&&(yn=Ne.get(Mt),Ut=Ce,Ut.setIndex(yn)),le.isMesh)ge.wireframe===!0?(ut.setLineWidth(ge.wireframeLinewidth*_t()),Ut.setMode(j.LINES)):Ut.setMode(j.TRIANGLES);else if(le.isLine){let lt=ge.linewidth;lt===void 0&&(lt=1),ut.setLineWidth(lt*_t()),le.isLineSegments?Ut.setMode(j.LINES):le.isLineLoop?Ut.setMode(j.LINE_LOOP):Ut.setMode(j.LINE_STRIP)}else le.isPoints?Ut.setMode(j.POINTS):le.isSprite&&Ut.setMode(j.TRIANGLES);if(le.isBatchedMesh)if(le._multiDrawInstances!==null)Yh("WebGLRenderer: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection."),Ut.renderMultiDrawInstances(le._multiDrawStarts,le._multiDrawCounts,le._multiDrawCount,le._multiDrawInstances);else if(Et.get("WEBGL_multi_draw"))Ut.renderMultiDraw(le._multiDrawStarts,le._multiDrawCounts,le._multiDrawCount);else{const lt=le._multiDrawStarts,qt=le._multiDrawCounts,At=le._multiDrawCount,qn=Mt?Ne.get(Mt).bytesPerElement:1,er=V.get(ge).currentProgram.getUniforms();for(let An=0;An<At;An++)er.setValue(j,"_gl_DrawID",An),Ut.render(lt[An]/qn,qt[An])}else if(le.isInstancedMesh)Ut.renderInstances(kt,Xn,le.count);else if(he.isInstancedBufferGeometry){const lt=he._maxInstanceCount!==void 0?he._maxInstanceCount:1/0,qt=Math.min(he.instanceCount,lt);Ut.renderInstances(kt,Xn,qt)}else Ut.render(kt,Xn)};function Ao(q,ne,he){q.transparent===!0&&q.side===vo&&q.forceSinglePass===!1?(q.side=gs,q.needsUpdate=!0,Se(q,ne,he),q.side=hu,q.needsUpdate=!0,Se(q,ne,he),q.side=vo):Se(q,ne,he)}this.compile=function(q,ne,he=null){he===null&&(he=q),z=Ke.get(he),z.init(ne),k.push(z),he.traverseVisible(function(le){le.isLight&&le.layers.test(ne.layers)&&(z.pushLight(le),le.castShadow&&z.pushShadow(le))}),q!==he&&q.traverseVisible(function(le){le.isLight&&le.layers.test(ne.layers)&&(z.pushLight(le),le.castShadow&&z.pushShadow(le))}),z.setupLights();const ge=new Set;return q.traverse(function(le){if(!(le.isMesh||le.isPoints||le.isLine||le.isSprite))return;const Ge=le.material;if(Ge)if(Array.isArray(Ge))for(let rt=0;rt<Ge.length;rt++){const Xe=Ge[rt];Ao(Xe,he,le),ge.add(Xe)}else Ao(Ge,he,le),ge.add(Ge)}),z=k.pop(),ge},this.compileAsync=function(q,ne,he=null){const ge=this.compile(q,ne,he);return new Promise(le=>{function Ge(){if(ge.forEach(function(rt){V.get(rt).currentProgram.isReady()&&ge.delete(rt)}),ge.size===0){le(q);return}setTimeout(Ge,10)}Et.get("KHR_parallel_shader_compile")!==null?Ge():setTimeout(Ge,10)})};let Os=null;function wo(q){Os&&Os(q)}function Br(){jt.stop()}function ys(){jt.start()}const jt=new TI;jt.setAnimationLoop(wo),typeof self<"u"&&jt.setContext(self),this.setAnimationLoop=function(q){Os=q,vt.setAnimationLoop(q),q===null?jt.stop():jt.start()},vt.addEventListener("sessionstart",Br),vt.addEventListener("sessionend",ys),this.render=function(q,ne){if(ne!==void 0&&ne.isCamera!==!0){Jt("WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(O===!0)return;const he=vt.enabled===!0&&vt.isPresenting===!0,ge=G!==null&&(ee===null||he)&&G.begin(P,ee);if(q.matrixWorldAutoUpdate===!0&&q.updateMatrixWorld(),ne.parent===null&&ne.matrixWorldAutoUpdate===!0&&ne.updateMatrixWorld(),vt.enabled===!0&&vt.isPresenting===!0&&(G===null||G.isCompositing()===!1)&&(vt.cameraAutoUpdate===!0&&vt.updateCamera(ne),ne=vt.getCamera()),q.isScene===!0&&q.onBeforeRender(P,q,ne,ee),z=Ke.get(q,k.length),z.init(ne),k.push(z),Tn.multiplyMatrices(ne.projectionMatrix,ne.matrixWorldInverse),bt.setFromProjectionMatrix(Tn,yo,ne.reversedDepth),cn=this.localClippingEnabled,Dt=Nt.init(this.clippingPlanes,cn),L=Ze.get(q,B.length),L.init(),B.push(L),vt.enabled===!0&&vt.isPresenting===!0){const rt=P.xr.getDepthSensingMesh();rt!==null&&Ir(rt,ne,-1/0,P.sortObjects)}Ir(q,ne,0,P.sortObjects),L.finish(),P.sortObjects===!0&&L.sort(Be,St),qe=vt.enabled===!1||vt.isPresenting===!1||vt.hasDepthSensing()===!1,qe&&at.addToRenderList(L,q),this.info.render.frame++,Dt===!0&&Nt.beginShadows();const le=z.state.shadowsArray;if(Tt.render(le,q,ne),Dt===!0&&Nt.endShadows(),this.info.autoReset===!0&&this.info.reset(),(ge&&G.hasRenderPass())===!1){const rt=L.opaque,Xe=L.transmissive;if(z.setupLights(),ne.isArrayCamera){const Mt=ne.cameras;if(Xe.length>0)for(let dt=0,Bt=Mt.length;dt<Bt;dt++){const gt=Mt[dt];H(rt,Xe,q,gt)}qe&&at.render(q);for(let dt=0,Bt=Mt.length;dt<Bt;dt++){const gt=Mt[dt];gi(L,q,gt,gt.viewport)}}else Xe.length>0&&H(rt,Xe,q,ne),qe&&at.render(q),gi(L,q,ne)}ee!==null&&ie===0&&(pe.updateMultisampleRenderTarget(ee),pe.updateRenderTargetMipmap(ee)),ge&&G.end(P),q.isScene===!0&&q.onAfterRender(P,q,ne),wt.resetDefaultState(),re=-1,de=null,k.pop(),k.length>0?(z=k[k.length-1],Dt===!0&&Nt.setGlobalState(P.clippingPlanes,z.state.camera)):z=null,B.pop(),B.length>0?L=B[B.length-1]:L=null};function Ir(q,ne,he,ge){if(q.visible===!1)return;if(q.layers.test(ne.layers)){if(q.isGroup)he=q.renderOrder;else if(q.isLOD)q.autoUpdate===!0&&q.update(ne);else if(q.isLight)z.pushLight(q),q.castShadow&&z.pushShadow(q);else if(q.isSprite){if(!q.frustumCulled||bt.intersectsSprite(q)){ge&&Ve.setFromMatrixPosition(q.matrixWorld).applyMatrix4(Tn);const rt=ht.update(q),Xe=q.material;Xe.visible&&L.push(q,rt,Xe,he,Ve.z,null)}}else if((q.isMesh||q.isLine||q.isPoints)&&(!q.frustumCulled||bt.intersectsObject(q))){const rt=ht.update(q),Xe=q.material;if(ge&&(q.boundingSphere!==void 0?(q.boundingSphere===null&&q.computeBoundingSphere(),Ve.copy(q.boundingSphere.center)):(rt.boundingSphere===null&&rt.computeBoundingSphere(),Ve.copy(rt.boundingSphere.center)),Ve.applyMatrix4(q.matrixWorld).applyMatrix4(Tn)),Array.isArray(Xe)){const Mt=rt.groups;for(let dt=0,Bt=Mt.length;dt<Bt;dt++){const gt=Mt[dt],kt=Xe[gt.materialIndex];kt&&kt.visible&&L.push(q,rt,kt,he,Ve.z,gt)}}else Xe.visible&&L.push(q,rt,Xe,he,Ve.z,null)}}const Ge=q.children;for(let rt=0,Xe=Ge.length;rt<Xe;rt++)Ir(Ge[rt],ne,he,ge)}function gi(q,ne,he,ge){const{opaque:le,transmissive:Ge,transparent:rt}=q;z.setupLightsView(he),Dt===!0&&Nt.setGlobalState(P.clippingPlanes,he),ge&&ut.viewport(J.copy(ge)),le.length>0&&Y(le,ne,he),Ge.length>0&&Y(Ge,ne,he),rt.length>0&&Y(rt,ne,he),ut.buffers.depth.setTest(!0),ut.buffers.depth.setMask(!0),ut.buffers.color.setMask(!0),ut.setPolygonOffset(!1)}function H(q,ne,he,ge){if((he.isScene===!0?he.overrideMaterial:null)!==null)return;if(z.state.transmissionRenderTarget[ge.id]===void 0){const kt=Et.has("EXT_color_buffer_half_float")||Et.has("EXT_color_buffer_float");z.state.transmissionRenderTarget[ge.id]=new Or(1,1,{generateMipmaps:!0,type:kt?Wi:kr,minFilter:_l,samples:Gt.samples,stencilBuffer:s,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:Gn.workingColorSpace})}const Ge=z.state.transmissionRenderTarget[ge.id],rt=ge.viewport||J;Ge.setSize(rt.z*P.transmissionResolutionScale,rt.w*P.transmissionResolutionScale);const Xe=P.getRenderTarget(),Mt=P.getActiveCubeFace(),dt=P.getActiveMipmapLevel();P.setRenderTarget(Ge),P.getClearColor(Ue),we=P.getClearAlpha(),we<1&&P.setClearColor(16777215,.5),P.clear(),qe&&at.render(he);const Bt=P.toneMapping;P.toneMapping=ta;const gt=ge.viewport;if(ge.viewport!==void 0&&(ge.viewport=void 0),z.setupLightsView(ge),Dt===!0&&Nt.setGlobalState(P.clippingPlanes,ge),Y(q,he,ge),pe.updateMultisampleRenderTarget(Ge),pe.updateRenderTargetMipmap(Ge),Et.has("WEBGL_multisampled_render_to_texture")===!1){let kt=!1;for(let fn=0,Xn=ne.length;fn<Xn;fn++){const yn=ne[fn],{object:Ut,geometry:lt,material:qt,group:At}=yn;if(qt.side===vo&&Ut.layers.test(ge.layers)){const qn=qt.side;qt.side=gs,qt.needsUpdate=!0,oe(Ut,he,ge,lt,qt,At),qt.side=qn,qt.needsUpdate=!0,kt=!0}}kt===!0&&(pe.updateMultisampleRenderTarget(Ge),pe.updateRenderTargetMipmap(Ge))}P.setRenderTarget(Xe,Mt,dt),P.setClearColor(Ue,we),gt!==void 0&&(ge.viewport=gt),P.toneMapping=Bt}function Y(q,ne,he){const ge=ne.isScene===!0?ne.overrideMaterial:null;for(let le=0,Ge=q.length;le<Ge;le++){const rt=q[le],{object:Xe,geometry:Mt,group:dt}=rt;let Bt=rt.material;Bt.allowOverride===!0&&ge!==null&&(Bt=ge),Xe.layers.test(he.layers)&&oe(Xe,ne,he,Mt,Bt,dt)}}function oe(q,ne,he,ge,le,Ge){q.onBeforeRender(P,ne,he,ge,le,Ge),q.modelViewMatrix.multiplyMatrices(he.matrixWorldInverse,q.matrixWorld),q.normalMatrix.getNormalMatrix(q.modelViewMatrix),le.onBeforeRender(P,ne,he,ge,q,Ge),le.transparent===!0&&le.side===vo&&le.forceSinglePass===!1?(le.side=gs,le.needsUpdate=!0,P.renderBufferDirect(he,ne,ge,le,q,Ge),le.side=hu,le.needsUpdate=!0,P.renderBufferDirect(he,ne,ge,le,q,Ge),le.side=vo):P.renderBufferDirect(he,ne,ge,le,q,Ge),q.onAfterRender(P,ne,he,ge,le,Ge)}function Se(q,ne,he){ne.isScene!==!0&&(ne=et);const ge=V.get(q),le=z.state.lights,Ge=z.state.shadowsArray,rt=le.state.version,Xe=Ot.getParameters(q,le.state,Ge,ne,he),Mt=Ot.getProgramCacheKey(Xe);let dt=ge.programs;ge.environment=q.isMeshStandardMaterial?ne.environment:null,ge.fog=ne.fog,ge.envMap=(q.isMeshStandardMaterial?We:De).get(q.envMap||ge.environment),ge.envMapRotation=ge.environment!==null&&q.envMap===null?ne.environmentRotation:q.envMapRotation,dt===void 0&&(q.addEventListener("dispose",ji),dt=new Map,ge.programs=dt);let Bt=dt.get(Mt);if(Bt!==void 0){if(ge.currentProgram===Bt&&ge.lightsStateVersion===rt)return ke(q,Xe),Bt}else Xe.uniforms=Ot.getUniforms(q),q.onBeforeCompile(Xe,P),Bt=Ot.acquireProgram(Xe,Mt),dt.set(Mt,Bt),ge.uniforms=Xe.uniforms;const gt=ge.uniforms;return(!q.isShaderMaterial&&!q.isRawShaderMaterial||q.clipping===!0)&&(gt.clippingPlanes=Nt.uniform),ke(q,Xe),ge.needsLights=pt(q),ge.lightsStateVersion=rt,ge.needsLights&&(gt.ambientLightColor.value=le.state.ambient,gt.lightProbe.value=le.state.probe,gt.directionalLights.value=le.state.directional,gt.directionalLightShadows.value=le.state.directionalShadow,gt.spotLights.value=le.state.spot,gt.spotLightShadows.value=le.state.spotShadow,gt.rectAreaLights.value=le.state.rectArea,gt.ltc_1.value=le.state.rectAreaLTC1,gt.ltc_2.value=le.state.rectAreaLTC2,gt.pointLights.value=le.state.point,gt.pointLightShadows.value=le.state.pointShadow,gt.hemisphereLights.value=le.state.hemi,gt.directionalShadowMap.value=le.state.directionalShadowMap,gt.directionalShadowMatrix.value=le.state.directionalShadowMatrix,gt.spotShadowMap.value=le.state.spotShadowMap,gt.spotLightMatrix.value=le.state.spotLightMatrix,gt.spotLightMap.value=le.state.spotLightMap,gt.pointShadowMap.value=le.state.pointShadowMap,gt.pointShadowMatrix.value=le.state.pointShadowMatrix),ge.currentProgram=Bt,ge.uniformsList=null,Bt}function Le(q){if(q.uniformsList===null){const ne=q.currentProgram.getUniforms();q.uniformsList=Wy.seqWithValue(ne.seq,q.uniforms)}return q.uniformsList}function ke(q,ne){const he=V.get(q);he.outputColorSpace=ne.outputColorSpace,he.batching=ne.batching,he.batchingColor=ne.batchingColor,he.instancing=ne.instancing,he.instancingColor=ne.instancingColor,he.instancingMorph=ne.instancingMorph,he.skinning=ne.skinning,he.morphTargets=ne.morphTargets,he.morphNormals=ne.morphNormals,he.morphColors=ne.morphColors,he.morphTargetsCount=ne.morphTargetsCount,he.numClippingPlanes=ne.numClippingPlanes,he.numIntersection=ne.numClipIntersection,he.vertexAlphas=ne.vertexAlphas,he.vertexTangents=ne.vertexTangents,he.toneMapping=ne.toneMapping}function it(q,ne,he,ge,le){ne.isScene!==!0&&(ne=et),pe.resetTextureUnits();const Ge=ne.fog,rt=ge.isMeshStandardMaterial?ne.environment:null,Xe=ee===null?P.outputColorSpace:ee.isXRRenderTarget===!0?ee.texture.colorSpace:Pa,Mt=(ge.isMeshStandardMaterial?We:De).get(ge.envMap||rt),dt=ge.vertexColors===!0&&!!he.attributes.color&&he.attributes.color.itemSize===4,Bt=!!he.attributes.tangent&&(!!ge.normalMap||ge.anisotropy>0),gt=!!he.morphAttributes.position,kt=!!he.morphAttributes.normal,fn=!!he.morphAttributes.color;let Xn=ta;ge.toneMapped&&(ee===null||ee.isXRRenderTarget===!0)&&(Xn=P.toneMapping);const yn=he.morphAttributes.position||he.morphAttributes.normal||he.morphAttributes.color,Ut=yn!==void 0?yn.length:0,lt=V.get(ge),qt=z.state.lights;if(Dt===!0&&(cn===!0||q!==de)){const cr=q===de&&ge.id===re;Nt.setState(ge,q,cr)}let At=!1;ge.version===lt.__version?(lt.needsLights&&lt.lightsStateVersion!==qt.state.version||lt.outputColorSpace!==Xe||le.isBatchedMesh&&lt.batching===!1||!le.isBatchedMesh&&lt.batching===!0||le.isBatchedMesh&&lt.batchingColor===!0&&le.colorTexture===null||le.isBatchedMesh&&lt.batchingColor===!1&&le.colorTexture!==null||le.isInstancedMesh&&lt.instancing===!1||!le.isInstancedMesh&&lt.instancing===!0||le.isSkinnedMesh&&lt.skinning===!1||!le.isSkinnedMesh&&lt.skinning===!0||le.isInstancedMesh&&lt.instancingColor===!0&&le.instanceColor===null||le.isInstancedMesh&&lt.instancingColor===!1&&le.instanceColor!==null||le.isInstancedMesh&&lt.instancingMorph===!0&&le.morphTexture===null||le.isInstancedMesh&&lt.instancingMorph===!1&&le.morphTexture!==null||lt.envMap!==Mt||ge.fog===!0&&lt.fog!==Ge||lt.numClippingPlanes!==void 0&&(lt.numClippingPlanes!==Nt.numPlanes||lt.numIntersection!==Nt.numIntersection)||lt.vertexAlphas!==dt||lt.vertexTangents!==Bt||lt.morphTargets!==gt||lt.morphNormals!==kt||lt.morphColors!==fn||lt.toneMapping!==Xn||lt.morphTargetsCount!==Ut)&&(At=!0):(At=!0,lt.__version=ge.version);let qn=lt.currentProgram;At===!0&&(qn=Se(ge,ne,le));let er=!1,An=!1,yi=!1;const Jn=qn.getUniforms(),tr=lt.uniforms;if(ut.useProgram(qn.program)&&(er=!0,An=!0,yi=!0),ge.id!==re&&(re=ge.id,An=!0),er||de!==q){ut.buffers.depth.getReversed()&&q.reversedDepth!==!0&&(q._reversedDepth=!0,q.updateProjectionMatrix()),Jn.setValue(j,"projectionMatrix",q.projectionMatrix),Jn.setValue(j,"viewMatrix",q.matrixWorldInverse);const fr=Jn.map.cameraPosition;fr!==void 0&&fr.setValue(j,Zt.setFromMatrixPosition(q.matrixWorld)),Gt.logarithmicDepthBuffer&&Jn.setValue(j,"logDepthBufFC",2/(Math.log(q.far+1)/Math.LN2)),(ge.isMeshPhongMaterial||ge.isMeshToonMaterial||ge.isMeshLambertMaterial||ge.isMeshBasicMaterial||ge.isMeshStandardMaterial||ge.isShaderMaterial)&&Jn.setValue(j,"isOrthographic",q.isOrthographicCamera===!0),de!==q&&(de=q,An=!0,yi=!0)}if(lt.needsLights&&(qt.state.directionalShadowMap.length>0&&Jn.setValue(j,"directionalShadowMap",qt.state.directionalShadowMap,pe),qt.state.spotShadowMap.length>0&&Jn.setValue(j,"spotShadowMap",qt.state.spotShadowMap,pe),qt.state.pointShadowMap.length>0&&Jn.setValue(j,"pointShadowMap",qt.state.pointShadowMap,pe)),le.isSkinnedMesh){Jn.setOptional(j,le,"bindMatrix"),Jn.setOptional(j,le,"bindMatrixInverse");const cr=le.skeleton;cr&&(cr.boneTexture===null&&cr.computeBoneTexture(),Jn.setValue(j,"boneTexture",cr.boneTexture,pe))}le.isBatchedMesh&&(Jn.setOptional(j,le,"batchingTexture"),Jn.setValue(j,"batchingTexture",le._matricesTexture,pe),Jn.setOptional(j,le,"batchingIdTexture"),Jn.setValue(j,"batchingIdTexture",le._indirectTexture,pe),Jn.setOptional(j,le,"batchingColorTexture"),le._colorsTexture!==null&&Jn.setValue(j,"batchingColorTexture",le._colorsTexture,pe));const Xi=he.morphAttributes;if((Xi.position!==void 0||Xi.normal!==void 0||Xi.color!==void 0)&&Xt.update(le,he,qn),(An||lt.receiveShadow!==le.receiveShadow)&&(lt.receiveShadow=le.receiveShadow,Jn.setValue(j,"receiveShadow",le.receiveShadow)),ge.isMeshGouraudMaterial&&ge.envMap!==null&&(tr.envMap.value=Mt,tr.flipEnvMap.value=Mt.isCubeTexture&&Mt.isRenderTargetTexture===!1?-1:1),ge.isMeshStandardMaterial&&ge.envMap===null&&ne.environment!==null&&(tr.envMapIntensity.value=ne.environmentIntensity),tr.dfgLUT!==void 0&&(tr.dfgLUT.value=VB()),An&&(Jn.setValue(j,"toneMappingExposure",P.toneMappingExposure),lt.needsLights&&Qe(tr,yi),Ge&&ge.fog===!0&&$t.refreshFogUniforms(tr,Ge),$t.refreshMaterialUniforms(tr,ge,Ee,ce,z.state.transmissionRenderTarget[q.id]),Wy.upload(j,Le(lt),tr,pe)),ge.isShaderMaterial&&ge.uniformsNeedUpdate===!0&&(Wy.upload(j,Le(lt),tr,pe),ge.uniformsNeedUpdate=!1),ge.isSpriteMaterial&&Jn.setValue(j,"center",le.center),Jn.setValue(j,"modelViewMatrix",le.modelViewMatrix),Jn.setValue(j,"normalMatrix",le.normalMatrix),Jn.setValue(j,"modelMatrix",le.matrixWorld),ge.isShaderMaterial||ge.isRawShaderMaterial){const cr=ge.uniformsGroups;for(let fr=0,wl=cr.length;fr<wl;fr++){const zs=cr[fr];tt.update(zs,qn),tt.bind(zs,qn)}}return qn}function Qe(q,ne){q.ambientLightColor.needsUpdate=ne,q.lightProbe.needsUpdate=ne,q.directionalLights.needsUpdate=ne,q.directionalLightShadows.needsUpdate=ne,q.pointLights.needsUpdate=ne,q.pointLightShadows.needsUpdate=ne,q.spotLights.needsUpdate=ne,q.spotLightShadows.needsUpdate=ne,q.rectAreaLights.needsUpdate=ne,q.hemisphereLights.needsUpdate=ne}function pt(q){return q.isMeshLambertMaterial||q.isMeshToonMaterial||q.isMeshPhongMaterial||q.isMeshStandardMaterial||q.isShadowMaterial||q.isShaderMaterial&&q.lights===!0}this.getActiveCubeFace=function(){return Z},this.getActiveMipmapLevel=function(){return ie},this.getRenderTarget=function(){return ee},this.setRenderTargetTextures=function(q,ne,he){const ge=V.get(q);ge.__autoAllocateDepthBuffer=q.resolveDepthBuffer===!1,ge.__autoAllocateDepthBuffer===!1&&(ge.__useRenderToTexture=!1),V.get(q.texture).__webglTexture=ne,V.get(q.depthTexture).__webglTexture=ge.__autoAllocateDepthBuffer?void 0:he,ge.__hasExternalTextures=!0},this.setRenderTargetFramebuffer=function(q,ne){const he=V.get(q);he.__webglFramebuffer=ne,he.__useDefaultFramebuffer=ne===void 0};const ft=j.createFramebuffer();this.setRenderTarget=function(q,ne=0,he=0){ee=q,Z=ne,ie=he;let ge=null,le=!1,Ge=!1;if(q){const Xe=V.get(q);if(Xe.__useDefaultFramebuffer!==void 0){ut.bindFramebuffer(j.FRAMEBUFFER,Xe.__webglFramebuffer),J.copy(q.viewport),te.copy(q.scissor),ye=q.scissorTest,ut.viewport(J),ut.scissor(te),ut.setScissorTest(ye),re=-1;return}else if(Xe.__webglFramebuffer===void 0)pe.setupRenderTarget(q);else if(Xe.__hasExternalTextures)pe.rebindTextures(q,V.get(q.texture).__webglTexture,V.get(q.depthTexture).__webglTexture);else if(q.depthBuffer){const Bt=q.depthTexture;if(Xe.__boundDepthTexture!==Bt){if(Bt!==null&&V.has(Bt)&&(q.width!==Bt.image.width||q.height!==Bt.image.height))throw new Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");pe.setupDepthRenderbuffer(q)}}const Mt=q.texture;(Mt.isData3DTexture||Mt.isDataArrayTexture||Mt.isCompressedArrayTexture)&&(Ge=!0);const dt=V.get(q).__webglFramebuffer;q.isWebGLCubeRenderTarget?(Array.isArray(dt[ne])?ge=dt[ne][he]:ge=dt[ne],le=!0):q.samples>0&&pe.useMultisampledRTT(q)===!1?ge=V.get(q).__webglMultisampledFramebuffer:Array.isArray(dt)?ge=dt[he]:ge=dt,J.copy(q.viewport),te.copy(q.scissor),ye=q.scissorTest}else J.copy(ve).multiplyScalar(Ee).floor(),te.copy(Re).multiplyScalar(Ee).floor(),ye=ot;if(he!==0&&(ge=ft),ut.bindFramebuffer(j.FRAMEBUFFER,ge)&&ut.drawBuffers(q,ge),ut.viewport(J),ut.scissor(te),ut.setScissorTest(ye),le){const Xe=V.get(q.texture);j.framebufferTexture2D(j.FRAMEBUFFER,j.COLOR_ATTACHMENT0,j.TEXTURE_CUBE_MAP_POSITIVE_X+ne,Xe.__webglTexture,he)}else if(Ge){const Xe=ne;for(let Mt=0;Mt<q.textures.length;Mt++){const dt=V.get(q.textures[Mt]);j.framebufferTextureLayer(j.FRAMEBUFFER,j.COLOR_ATTACHMENT0+Mt,dt.__webglTexture,he,Xe)}}else if(q!==null&&he!==0){const Xe=V.get(q.texture);j.framebufferTexture2D(j.FRAMEBUFFER,j.COLOR_ATTACHMENT0,j.TEXTURE_2D,Xe.__webglTexture,he)}re=-1},this.readRenderTargetPixels=function(q,ne,he,ge,le,Ge,rt,Xe=0){if(!(q&&q.isWebGLRenderTarget)){Jt("WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let Mt=V.get(q).__webglFramebuffer;if(q.isWebGLCubeRenderTarget&&rt!==void 0&&(Mt=Mt[rt]),Mt){ut.bindFramebuffer(j.FRAMEBUFFER,Mt);try{const dt=q.textures[Xe],Bt=dt.format,gt=dt.type;if(!Gt.textureFormatReadable(Bt)){Jt("WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(!Gt.textureTypeReadable(gt)){Jt("WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}ne>=0&&ne<=q.width-ge&&he>=0&&he<=q.height-le&&(q.textures.length>1&&j.readBuffer(j.COLOR_ATTACHMENT0+Xe),j.readPixels(ne,he,ge,le,nt.convert(Bt),nt.convert(gt),Ge))}finally{const dt=ee!==null?V.get(ee).__webglFramebuffer:null;ut.bindFramebuffer(j.FRAMEBUFFER,dt)}}},this.readRenderTargetPixelsAsync=async function(q,ne,he,ge,le,Ge,rt,Xe=0){if(!(q&&q.isWebGLRenderTarget))throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let Mt=V.get(q).__webglFramebuffer;if(q.isWebGLCubeRenderTarget&&rt!==void 0&&(Mt=Mt[rt]),Mt)if(ne>=0&&ne<=q.width-ge&&he>=0&&he<=q.height-le){ut.bindFramebuffer(j.FRAMEBUFFER,Mt);const dt=q.textures[Xe],Bt=dt.format,gt=dt.type;if(!Gt.textureFormatReadable(Bt))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!Gt.textureTypeReadable(gt))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");const kt=j.createBuffer();j.bindBuffer(j.PIXEL_PACK_BUFFER,kt),j.bufferData(j.PIXEL_PACK_BUFFER,Ge.byteLength,j.STREAM_READ),q.textures.length>1&&j.readBuffer(j.COLOR_ATTACHMENT0+Xe),j.readPixels(ne,he,ge,le,nt.convert(Bt),nt.convert(gt),0);const fn=ee!==null?V.get(ee).__webglFramebuffer:null;ut.bindFramebuffer(j.FRAMEBUFFER,fn);const Xn=j.fenceSync(j.SYNC_GPU_COMMANDS_COMPLETE,0);return j.flush(),await tU(j,Xn,4),j.bindBuffer(j.PIXEL_PACK_BUFFER,kt),j.getBufferSubData(j.PIXEL_PACK_BUFFER,0,Ge),j.deleteBuffer(kt),j.deleteSync(Xn),Ge}else throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")},this.copyFramebufferToTexture=function(q,ne=null,he=0){const ge=Math.pow(2,-he),le=Math.floor(q.image.width*ge),Ge=Math.floor(q.image.height*ge),rt=ne!==null?ne.x:0,Xe=ne!==null?ne.y:0;pe.setTexture2D(q,0),j.copyTexSubImage2D(j.TEXTURE_2D,he,0,0,rt,Xe,le,Ge),ut.unbindTexture()};const yt=j.createFramebuffer(),ct=j.createFramebuffer();this.copyTextureToTexture=function(q,ne,he=null,ge=null,le=0,Ge=null){Ge===null&&(le!==0?(Yh("WebGLRenderer: copyTextureToTexture function signature has changed to support src and dst mipmap levels."),Ge=le,le=0):Ge=0);let rt,Xe,Mt,dt,Bt,gt,kt,fn,Xn;const yn=q.isCompressedTexture?q.mipmaps[Ge]:q.image;if(he!==null)rt=he.max.x-he.min.x,Xe=he.max.y-he.min.y,Mt=he.isBox3?he.max.z-he.min.z:1,dt=he.min.x,Bt=he.min.y,gt=he.isBox3?he.min.z:0;else{const Xi=Math.pow(2,-le);rt=Math.floor(yn.width*Xi),Xe=Math.floor(yn.height*Xi),q.isDataArrayTexture?Mt=yn.depth:q.isData3DTexture?Mt=Math.floor(yn.depth*Xi):Mt=1,dt=0,Bt=0,gt=0}ge!==null?(kt=ge.x,fn=ge.y,Xn=ge.z):(kt=0,fn=0,Xn=0);const Ut=nt.convert(ne.format),lt=nt.convert(ne.type);let qt;ne.isData3DTexture?(pe.setTexture3D(ne,0),qt=j.TEXTURE_3D):ne.isDataArrayTexture||ne.isCompressedArrayTexture?(pe.setTexture2DArray(ne,0),qt=j.TEXTURE_2D_ARRAY):(pe.setTexture2D(ne,0),qt=j.TEXTURE_2D),j.pixelStorei(j.UNPACK_FLIP_Y_WEBGL,ne.flipY),j.pixelStorei(j.UNPACK_PREMULTIPLY_ALPHA_WEBGL,ne.premultiplyAlpha),j.pixelStorei(j.UNPACK_ALIGNMENT,ne.unpackAlignment);const At=j.getParameter(j.UNPACK_ROW_LENGTH),qn=j.getParameter(j.UNPACK_IMAGE_HEIGHT),er=j.getParameter(j.UNPACK_SKIP_PIXELS),An=j.getParameter(j.UNPACK_SKIP_ROWS),yi=j.getParameter(j.UNPACK_SKIP_IMAGES);j.pixelStorei(j.UNPACK_ROW_LENGTH,yn.width),j.pixelStorei(j.UNPACK_IMAGE_HEIGHT,yn.height),j.pixelStorei(j.UNPACK_SKIP_PIXELS,dt),j.pixelStorei(j.UNPACK_SKIP_ROWS,Bt),j.pixelStorei(j.UNPACK_SKIP_IMAGES,gt);const Jn=q.isDataArrayTexture||q.isData3DTexture,tr=ne.isDataArrayTexture||ne.isData3DTexture;if(q.isDepthTexture){const Xi=V.get(q),cr=V.get(ne),fr=V.get(Xi.__renderTarget),wl=V.get(cr.__renderTarget);ut.bindFramebuffer(j.READ_FRAMEBUFFER,fr.__webglFramebuffer),ut.bindFramebuffer(j.DRAW_FRAMEBUFFER,wl.__webglFramebuffer);for(let zs=0;zs<Mt;zs++)Jn&&(j.framebufferTextureLayer(j.READ_FRAMEBUFFER,j.COLOR_ATTACHMENT0,V.get(q).__webglTexture,le,gt+zs),j.framebufferTextureLayer(j.DRAW_FRAMEBUFFER,j.COLOR_ATTACHMENT0,V.get(ne).__webglTexture,Ge,Xn+zs)),j.blitFramebuffer(dt,Bt,rt,Xe,kt,fn,rt,Xe,j.DEPTH_BUFFER_BIT,j.NEAREST);ut.bindFramebuffer(j.READ_FRAMEBUFFER,null),ut.bindFramebuffer(j.DRAW_FRAMEBUFFER,null)}else if(le!==0||q.isRenderTargetTexture||V.has(q)){const Xi=V.get(q),cr=V.get(ne);ut.bindFramebuffer(j.READ_FRAMEBUFFER,yt),ut.bindFramebuffer(j.DRAW_FRAMEBUFFER,ct);for(let fr=0;fr<Mt;fr++)Jn?j.framebufferTextureLayer(j.READ_FRAMEBUFFER,j.COLOR_ATTACHMENT0,Xi.__webglTexture,le,gt+fr):j.framebufferTexture2D(j.READ_FRAMEBUFFER,j.COLOR_ATTACHMENT0,j.TEXTURE_2D,Xi.__webglTexture,le),tr?j.framebufferTextureLayer(j.DRAW_FRAMEBUFFER,j.COLOR_ATTACHMENT0,cr.__webglTexture,Ge,Xn+fr):j.framebufferTexture2D(j.DRAW_FRAMEBUFFER,j.COLOR_ATTACHMENT0,j.TEXTURE_2D,cr.__webglTexture,Ge),le!==0?j.blitFramebuffer(dt,Bt,rt,Xe,kt,fn,rt,Xe,j.COLOR_BUFFER_BIT,j.NEAREST):tr?j.copyTexSubImage3D(qt,Ge,kt,fn,Xn+fr,dt,Bt,rt,Xe):j.copyTexSubImage2D(qt,Ge,kt,fn,dt,Bt,rt,Xe);ut.bindFramebuffer(j.READ_FRAMEBUFFER,null),ut.bindFramebuffer(j.DRAW_FRAMEBUFFER,null)}else tr?q.isDataTexture||q.isData3DTexture?j.texSubImage3D(qt,Ge,kt,fn,Xn,rt,Xe,Mt,Ut,lt,yn.data):ne.isCompressedArrayTexture?j.compressedTexSubImage3D(qt,Ge,kt,fn,Xn,rt,Xe,Mt,Ut,yn.data):j.texSubImage3D(qt,Ge,kt,fn,Xn,rt,Xe,Mt,Ut,lt,yn):q.isDataTexture?j.texSubImage2D(j.TEXTURE_2D,Ge,kt,fn,rt,Xe,Ut,lt,yn.data):q.isCompressedTexture?j.compressedTexSubImage2D(j.TEXTURE_2D,Ge,kt,fn,yn.width,yn.height,Ut,yn.data):j.texSubImage2D(j.TEXTURE_2D,Ge,kt,fn,rt,Xe,Ut,lt,yn);j.pixelStorei(j.UNPACK_ROW_LENGTH,At),j.pixelStorei(j.UNPACK_IMAGE_HEIGHT,qn),j.pixelStorei(j.UNPACK_SKIP_PIXELS,er),j.pixelStorei(j.UNPACK_SKIP_ROWS,An),j.pixelStorei(j.UNPACK_SKIP_IMAGES,yi),Ge===0&&ne.generateMipmaps&&j.generateMipmap(qt),ut.unbindTexture()},this.initRenderTarget=function(q){V.get(q).__webglFramebuffer===void 0&&pe.setupRenderTarget(q)},this.initTexture=function(q){q.isCubeTexture?pe.setTextureCube(q,0):q.isData3DTexture?pe.setTexture3D(q,0):q.isDataArrayTexture||q.isCompressedArrayTexture?pe.setTexture2DArray(q,0):pe.setTexture2D(q,0),ut.unbindTexture()},this.resetState=function(){Z=0,ie=0,ee=null,ut.reset(),wt.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return yo}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const t=this.getContext();t.drawingBufferColorSpace=Gn._getDrawingBufferColorSpace(e),t.unpackColorSpace=Gn._getUnpackColorSpace()}}const HB=Object.freeze(Object.defineProperty({__proto__:null,ACESFilmicToneMapping:ix,AddEquation:gc,AddOperation:fR,AdditiveAnimationBlendMode:JM,AdditiveBlending:Zb,AgXToneMapping:VM,AlphaFormat:XM,AlwaysCompare:MR,AlwaysDepth:Qy,AlwaysStencilFunc:eM,AmbientLight:mI,AnimationAction:bI,AnimationClip:Dg,AnimationLoader:GP,AnimationMixer:gL,AnimationObjectGroup:pL,AnimationUtils:zP,ArcCurve:HR,ArrayCamera:_I,ArrowHelper:BL,AttachedBindMode:Qb,Audio:xI,AudioAnalyser:rL,AudioContext:xE,AudioListener:tL,AudioLoader:QP,AxesHelper:VL,BackSide:gs,BasicDepthPacking:gR,BasicShadowMap:WC,BatchedMesh:FR,Bone:eE,BooleanKeyframeTrack:Kf,Box2:TL,Box3:Er,Box3Helper:OL,BoxGeometry:$f,BoxHelper:kL,BufferAttribute:pi,BufferGeometry:vn,BufferGeometryLoader:yI,ByteType:rx,Cache:xl,Camera:mx,CameraHelper:FL,CanvasTexture:lP,CapsuleGeometry:Mx,CatmullRomCurve3:GR,CineonToneMapping:zM,CircleGeometry:Ex,ClampToEdgeWrapping:Qi,Clock:SE,Color:Pt,ColorKeyframeTrack:mE,ColorManagement:Gn,CompressedArrayTexture:oP,CompressedCubeTexture:aP,CompressedTexture:bx,CompressedTextureLoader:qP,ConeGeometry:qg,ConstantAlphaFactor:lR,ConstantColorFactor:oR,Controls:GL,CubeCamera:IR,CubeDepthTexture:BR,CubeReflectionMapping:Ua,CubeRefractionMapping:Mc,CubeTexture:Vg,CubeTextureLoader:cI,CubeUVReflectionMapping:np,CubicBezierCurve:rE,CubicBezierCurve3:qR,CubicInterpolant:oI,CullFaceBack:Jb,CullFaceFront:qC,CullFaceFrontBack:dD,CullFaceNone:GC,Curve:La,CurvePath:XR,CustomBlending:XC,CustomToneMapping:BM,CylinderGeometry:Gg,Cylindrical:EL,Data3DTexture:px,DataArrayTexture:hx,DataTexture:na,DataTextureLoader:gE,DataUtils:Ff,DecrementStencilOp:RD,DecrementWrapStencilOp:ND,DefaultLoadingManager:uI,DepthFormat:Ml,DepthStencilFormat:vc,DepthTexture:Wf,DetachedBindMode:dR,DirectionalLight:pI,DirectionalLightHelper:LL,DiscreteInterpolant:aI,DodecahedronGeometry:Tx,DoubleSide:vo,DstAlphaFactor:tR,DstColorFactor:iR,DynamicCopyUsage:XD,DynamicDrawUsage:BD,DynamicReadUsage:GD,EdgesGeometry:VR,EllipseCurve:Ax,EqualCompare:xR,EqualDepth:e_,EqualStencilFunc:LD,EquirectangularReflectionMapping:Gh,EquirectangularRefractionMapping:vg,Euler:Eo,EventDispatcher:Tl,ExternalTexture:nE,ExtrudeGeometry:wx,FileLoader:So,Float16BufferAttribute:OU,Float32BufferAttribute:zt,FloatType:Ni,Fog:yx,FogExp2:vx,FramebufferTexture:sP,FrontSide:hu,Frustum:rp,FrustumArray:Sx,GLBufferAttribute:xL,GLSL1:JD,GLSL3:tM,GreaterCompare:SR,GreaterDepth:n_,GreaterEqualCompare:dx,GreaterEqualDepth:t_,GreaterEqualStencilFunc:zD,GreaterStencilFunc:kD,GridHelper:UL,Group:Lh,HalfFloatType:Wi,HemisphereLight:fI,HemisphereLightHelper:DL,IcosahedronGeometry:Wg,ImageBitmapLoader:KP,ImageLoader:Ug,ImageUtils:wR,IncrementStencilOp:CD,IncrementWrapStencilOp:ID,InstancedBufferAttribute:Kh,InstancedBufferGeometry:_E,InstancedInterleavedBuffer:V_,InstancedMesh:LR,Int16BufferAttribute:FU,Int32BufferAttribute:kU,Int8BufferAttribute:UU,IntType:Og,InterleavedBuffer:_x,InterleavedBufferAttribute:_o,Interpolant:Jg,InterpolateDiscrete:xg,InterpolateLinear:F_,InterpolateSmooth:Gy,InterpolationSamplingMode:KD,InterpolationSamplingType:$D,InvertStencilOp:DD,KeepStencilOp:If,KeyframeTrack:sa,LOD:UR,LatheGeometry:Cx,Layers:Zh,LessCompare:_R,LessDepth:jy,LessEqualCompare:fx,LessEqualDepth:Gf,LessEqualStencilFunc:FD,LessStencilFunc:PD,Light:Cc,LightProbe:vI,Line:Tc,Line3:MI,LineBasicMaterial:Fs,LineCurve:sE,LineCurve3:WR,LineDashedMaterial:rI,LineLoop:kR,LineSegments:Al,LinearFilter:Bn,LinearInterpolant:pE,LinearMipMapLinearFilter:jb,LinearMipMapNearestFilter:mD,LinearMipmapLinearFilter:_l,LinearMipmapNearestFilter:sg,LinearSRGBColorSpace:Pa,LinearToneMapping:kM,LinearTransfer:bg,Loader:ks,LoaderUtils:oM,LoadingManager:Fx,LoopOnce:hR,LoopPingPong:mR,LoopRepeat:pR,MOUSE:cD,Material:vs,MaterialLoader:kx,MathUtils:Ps,Matrix2:TE,Matrix3:xn,Matrix4:an,MaxEquation:$C,Mesh:Di,MeshBasicMaterial:mu,MeshDepthMaterial:Lx,MeshDistanceMaterial:dE,MeshLambertMaterial:nI,MeshMatcapMaterial:iI,MeshNormalMaterial:tI,MeshPhongMaterial:jR,MeshPhysicalMaterial:QR,MeshStandardMaterial:fE,MeshToonMaterial:eI,MinEquation:ZC,MirroredRepeatWrapping:_g,MixOperation:cR,MultiplyBlending:Kb,MultiplyOperation:kg,NearestFilter:lr,NearestMipMapLinearFilter:pD,NearestMipMapNearestFilter:hD,NearestMipmapLinearFilter:Uh,NearestMipmapNearestFilter:GM,NeutralToneMapping:HM,NeverCompare:yR,NeverDepth:Ky,NeverStencilFunc:UD,NoBlending:Ia,NoColorSpace:cu,NoNormalPacking:MD,NoToneMapping:ta,NormalAnimationBlendMode:cx,NormalBlending:zf,NormalGAPacking:TD,NormalRGPacking:ED,NotEqualCompare:bR,NotEqualDepth:i_,NotEqualStencilFunc:OD,NumberKeyframeTrack:Ig,Object3D:Kn,ObjectLoader:ZP,ObjectSpaceNormalMap:vR,OctahedronGeometry:Xg,OneFactor:QC,OneMinusConstantAlphaFactor:uR,OneMinusConstantColorFactor:aR,OneMinusDstAlphaFactor:nR,OneMinusDstColorFactor:rR,OneMinusSrcAlphaFactor:$y,OneMinusSrcColorFactor:eR,OrthographicCamera:jf,PCFShadowMap:Oh,PCFSoftShadowMap:rg,PMREMGenerator:uM,Path:B_,PerspectiveCamera:Fr,Plane:uu,PlaneGeometry:gu,PlaneHelper:zL,PointLight:hI,PointLightHelper:IL,Points:OR,PointsMaterial:tE,PolarGridHelper:PL,PolyhedronGeometry:wc,PositionalAudio:iL,PropertyBinding:Zn,PropertyMixer:SI,QuadraticBezierCurve:oE,QuadraticBezierCurve3:aE,Quaternion:ao,QuaternionKeyframeTrack:Zg,QuaternionLinearInterpolant:lI,R11_EAC_Format:f_,RED_GREEN_RGTC2_Format:P_,RED_RGTC1_Format:D_,REVISION:tp,RG11_EAC_Format:h_,RGBADepthPacking:xD,RGBAFormat:ur,RGBAIntegerFormat:ux,RGBA_ASTC_10x10_Format:A_,RGBA_ASTC_10x5_Format:M_,RGBA_ASTC_10x6_Format:E_,RGBA_ASTC_10x8_Format:T_,RGBA_ASTC_12x10_Format:w_,RGBA_ASTC_12x12_Format:C_,RGBA_ASTC_4x4_Format:m_,RGBA_ASTC_5x4_Format:g_,RGBA_ASTC_5x5_Format:v_,RGBA_ASTC_6x5_Format:y_,RGBA_ASTC_6x6_Format:__,RGBA_ASTC_8x5_Format:x_,RGBA_ASTC_8x6_Format:S_,RGBA_ASTC_8x8_Format:b_,RGBA_BPTC_Format:R_,RGBA_ETC2_EAC_Format:c_,RGBA_PVRTC_2BPPV1_Format:a_,RGBA_PVRTC_4BPPV1_Format:o_,RGBA_S3TC_DXT1_Format:ag,RGBA_S3TC_DXT3_Format:lg,RGBA_S3TC_DXT5_Format:ug,RGBDepthPacking:SD,RGBFormat:YM,RGBIntegerFormat:gD,RGB_BPTC_SIGNED_Format:I_,RGB_BPTC_UNSIGNED_Format:N_,RGB_ETC1_Format:l_,RGB_ETC2_Format:u_,RGB_PVRTC_2BPPV1_Format:s_,RGB_PVRTC_4BPPV1_Format:r_,RGB_S3TC_DXT1_Format:og,RGDepthPacking:bD,RGFormat:qf,RGIntegerFormat:lx,RawShaderMaterial:cE,Ray:ip,Raycaster:EE,RectAreaLight:gI,RedFormat:zg,RedIntegerFormat:Bg,ReinhardToneMapping:OM,RenderTarget:$M,RenderTarget3D:vL,RepeatWrapping:yg,ReplaceStencilOp:wD,ReverseSubtractEquation:JC,RingGeometry:Rx,SIGNED_R11_EAC_Format:d_,SIGNED_RED_GREEN_RGTC2_Format:L_,SIGNED_RED_RGTC1_Format:U_,SIGNED_RG11_EAC_Format:p_,SRGBColorSpace:es,SRGBTransfer:oi,Scene:Hg,ShaderChunk:Cn,ShaderLib:Ca,ShaderMaterial:Ar,ShadowMaterial:KR,Shape:Vf,ShapeGeometry:Ix,ShapePath:HL,ShapeUtils:Ra,ShortType:sx,Skeleton:xx,SkeletonHelper:RL,SkinnedMesh:PR,Source:yc,Sphere:Tr,SphereGeometry:Yg,Spherical:ML,SphericalHarmonics3:yE,SplineCurve:lE,SpotLight:dI,SpotLightHelper:CL,Sprite:DR,SpriteMaterial:jM,SrcAlphaFactor:Zy,SrcAlphaSaturateFactor:sR,SrcColorFactor:jC,StaticCopyUsage:WD,StaticDrawUsage:Mg,StaticReadUsage:HD,StereoCamera:jP,StreamCopyUsage:YD,StreamDrawUsage:VD,StreamReadUsage:qD,StringKeyframeTrack:Qf,SubtractEquation:YC,SubtractiveBlending:$b,TOUCH:fD,TangentSpaceNormalMap:Ac,TetrahedronGeometry:Nx,Texture:hi,TextureLoader:WP,TextureUtils:JL,Timer:SL,TimestampQuery:ZD,TorusGeometry:Dx,TorusKnotGeometry:Ux,Triangle:oo,TriangleFanDrawMode:_D,TriangleStripDrawMode:yD,TrianglesDrawMode:vD,TubeGeometry:Px,UVMapping:bc,Uint16BufferAttribute:KM,Uint32BufferAttribute:QM,Uint8BufferAttribute:PU,Uint8ClampedBufferAttribute:LU,Uniform:Ox,UniformsGroup:_L,UniformsLib:Rt,UniformsUtils:Ag,UnsignedByteType:kr,UnsignedInt101111Type:WM,UnsignedInt248Type:Wh,UnsignedInt5999Type:qM,UnsignedIntType:Mo,UnsignedShort4444Type:ox,UnsignedShort5551Type:ax,UnsignedShortType:qh,VSMShadowMap:Uf,Vector2:$e,Vector3:Q,Vector4:$n,VectorKeyframeTrack:Ng,VideoFrameTexture:rP,VideoTexture:zR,WebGL3DRenderTarget:bU,WebGLArrayRenderTarget:SU,WebGLCoordinateSystem:yo,WebGLCubeRenderTarget:gx,WebGLRenderTarget:Or,WebGLRenderer:AE,WebGLUtils:II,WebGPUCoordinateSystem:Xh,WebXRController:qy,WireframeGeometry:uE,WrapAroundEnding:Sg,ZeroCurvatureEnding:Pf,ZeroFactor:KC,ZeroSlopeEnding:Lf,ZeroStencilOp:AD,createCanvasElement:AR,error:Jt,getConsoleFunction:eU,log:Tg,setConsoleFunction:jD,warn:It,warnOnce:Yh},Symbol.toStringTag,{value:"Module"}));var wb={exports:{}},Cb={},Rb={exports:{}},Ib={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var IA;function GB(){if(IA)return Ib;IA=1;var i=Fg();function e(v,_){return v===_&&(v!==0||1/v===1/_)||v!==v&&_!==_}var t=typeof Object.is=="function"?Object.is:e,n=i.useState,r=i.useEffect,s=i.useLayoutEffect,a=i.useDebugValue;function c(v,_){var b=_(),T=n({inst:{value:b,getSnapshot:_}}),I=T[0].inst,C=T[1];return s(function(){I.value=b,I.getSnapshot=_,d(I)&&C({inst:I})},[v,b,_]),r(function(){return d(I)&&C({inst:I}),v(function(){d(I)&&C({inst:I})})},[v]),a(b),b}function d(v){var _=v.getSnapshot;v=v.value;try{var b=_();return!t(v,b)}catch{return!0}}function p(v,_){return _()}var m=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?p:c;return Ib.useSyncExternalStore=i.useSyncExternalStore!==void 0?i.useSyncExternalStore:m,Ib}var NA;function qB(){return NA||(NA=1,Rb.exports=GB()),Rb.exports}/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var DA;function WB(){if(DA)return Cb;DA=1;var i=Fg(),e=qB();function t(p,m){return p===m&&(p!==0||1/p===1/m)||p!==p&&m!==m}var n=typeof Object.is=="function"?Object.is:t,r=e.useSyncExternalStore,s=i.useRef,a=i.useEffect,c=i.useMemo,d=i.useDebugValue;return Cb.useSyncExternalStoreWithSelector=function(p,m,v,_,b){var T=s(null);if(T.current===null){var I={hasValue:!1,value:null};T.current=I}else I=T.current;T=c(function(){function A(B){if(!D){if(D=!0,U=B,B=_(B),b!==void 0&&I.hasValue){var k=I.value;if(b(k,B))return L=k}return L=B}if(k=L,n(U,B))return k;var G=_(B);return b!==void 0&&b(k,G)?(U=B,k):(U=B,L=G)}var D=!1,U,L,z=v===void 0?null:v;return[function(){return A(m())},z===null?void 0:function(){return A(z())}]},[m,v,_,b]);var C=r(p,T[0],T[1]);return a(function(){I.hasValue=!0,I.value=C},[C]),d(C),C},Cb}var UA;function XB(){return UA||(UA=1,wb.exports=WB()),wb.exports}var YB=XB();const JB=nx(YB),PA=i=>{let e;const t=new Set,n=(p,m)=>{const v=typeof p=="function"?p(e):p;if(!Object.is(v,e)){const _=e;e=m??(typeof v!="object"||v===null)?v:Object.assign({},e,v),t.forEach(b=>b(e,_))}},r=()=>e,c={setState:n,getState:r,getInitialState:()=>d,subscribe:p=>(t.add(p),()=>t.delete(p))},d=e=i(n,r,c);return c},ZB=(i=>i?PA(i):PA),{useSyncExternalStoreWithSelector:$B}=JB,KB=i=>i;function QB(i,e=KB,t){const n=$B(i.subscribe,i.getState,i.getInitialState,e,t);return FM.useDebugValue(n),n}const LA=(i,e)=>{const t=ZB(i),n=(r,s=e)=>QB(t,r,s);return Object.assign(n,t),n},NI=((i,e)=>i?LA(i,e):LA),jB=i=>typeof i=="object"&&typeof i.then=="function",Of=[];function DI(i,e,t=(n,r)=>n===r){if(i===e)return!0;if(!i||!e)return!1;const n=i.length;if(e.length!==n)return!1;for(let r=0;r<n;r++)if(!t(i[r],e[r]))return!1;return!0}function UI(i,e=null,t=!1,n={}){e===null&&(e=[i]);for(const s of Of)if(DI(e,s.keys,s.equal)){if(t)return;if(Object.prototype.hasOwnProperty.call(s,"error"))throw s.error;if(Object.prototype.hasOwnProperty.call(s,"response"))return n.lifespan&&n.lifespan>0&&(s.timeout&&clearTimeout(s.timeout),s.timeout=setTimeout(s.remove,n.lifespan)),s.response;if(!t)throw s.promise}const r={keys:e,equal:n.equal,remove:()=>{const s=Of.indexOf(r);s!==-1&&Of.splice(s,1)},promise:(jB(i)?i:i(...e)).then(s=>{r.response=s,n.lifespan&&n.lifespan>0&&(r.timeout=setTimeout(r.remove,n.lifespan))}).catch(s=>r.error=s)};if(Of.push(r),!t)throw r.promise}const e4=(i,e,t)=>UI(i,e,!1,t),t4=(i,e,t)=>void UI(i,e,!0,t),n4=i=>{if(i===void 0||i.length===0)Of.splice(0,Of.length);else{const e=Of.find(t=>DI(i,t.keys,t.equal));e&&e.remove()}};var dM=HC();const i4=nx(dM);function wE(i,e,t){if(!i)return;if(t(i)===!0)return i;let n=e?i.return:i.child;for(;n;){const r=wE(n,e,t);if(r)return r;n=e?null:n.sibling}}function PI(i){try{return Object.defineProperties(i,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return i}}const CE=PI(Oe.createContext(null));class LI extends Oe.Component{render(){return Oe.createElement(CE.Provider,{value:this._reactInternals},this.props.children)}}function FI(){const i=Oe.useContext(CE);if(i===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const e=Oe.useId();return Oe.useMemo(()=>{for(const t of[i,i==null?void 0:i.alternate]){if(!t)continue;const n=wE(t,!1,r=>{let s=r.memoizedState;for(;s;){if(s.memoizedState===e)return!0;s=s.next}});if(n)return n}},[i,e])}const r4=Symbol.for("react.context"),s4=i=>i!==null&&typeof i=="object"&&"$$typeof"in i&&i.$$typeof===r4;function o4(){const i=FI(),[e]=Oe.useState(()=>new Map);e.clear();let t=i;for(;t;){const n=t.type;s4(n)&&n!==CE&&!e.has(n)&&e.set(n,Oe.use(PI(n))),t=t.return}return e}function a4(){const i=o4();return Oe.useMemo(()=>Array.from(i.keys()).reduce((e,t)=>n=>Oe.createElement(e,null,Oe.createElement(t.Provider,{...n,value:i.get(t)})),e=>Oe.createElement(LI,{...e})),[i])}function kI(i){let e=i.root;for(;e.getState().previousRoot;)e=e.getState().previousRoot;return e}const OI=i=>i&&i.isOrthographicCamera,l4=i=>i&&i.hasOwnProperty("current"),u4=i=>i!=null&&(typeof i=="string"||typeof i=="number"||i.isColor),$g=((i,e)=>typeof window<"u"&&(((i=window.document)==null?void 0:i.createElement)||((e=window.navigator)==null?void 0:e.product)==="ReactNative"))()?Oe.useLayoutEffect:Oe.useEffect;function RE(i){const e=Oe.useRef(i);return $g(()=>void(e.current=i),[i]),e}function c4(){const i=FI(),e=a4();return Oe.useMemo(()=>({children:t})=>{const r=!!wE(i,!0,s=>s.type===Oe.StrictMode)?Oe.StrictMode:Oe.Fragment;return ue.jsx(r,{children:ue.jsx(e,{children:t})})},[i,e])}function f4({set:i}){return $g(()=>(i(new Promise(()=>null)),()=>i(!1)),[i]),null}const d4=(i=>(i=class extends Oe.Component{constructor(...t){super(...t),this.state={error:!1}}componentDidCatch(t){this.props.set(t)}render(){return this.state.error?null:this.props.children}},i.getDerivedStateFromError=()=>({error:!0}),i))();function zI(i){var e;const t=typeof window<"u"?(e=window.devicePixelRatio)!=null?e:2:1;return Array.isArray(i)?Math.min(Math.max(i[0],t),i[1]):i}function Rh(i){var e;return(e=i.__r3f)==null?void 0:e.root.getState()}const ki={obj:i=>i===Object(i)&&!ki.arr(i)&&typeof i!="function",fun:i=>typeof i=="function",str:i=>typeof i=="string",num:i=>typeof i=="number",boo:i=>typeof i=="boolean",und:i=>i===void 0,nul:i=>i===null,arr:i=>Array.isArray(i),equ(i,e,{arrays:t="shallow",objects:n="reference",strict:r=!0}={}){if(typeof i!=typeof e||!!i!=!!e)return!1;if(ki.str(i)||ki.num(i)||ki.boo(i))return i===e;const s=ki.obj(i);if(s&&n==="reference")return i===e;const a=ki.arr(i);if(a&&t==="reference")return i===e;if((a||s)&&i===e)return!0;let c;for(c in i)if(!(c in e))return!1;if(s&&t==="shallow"&&n==="shallow"){for(c in r?e:i)if(!ki.equ(i[c],e[c],{strict:r,objects:"reference"}))return!1}else for(c in r?e:i)if(i[c]!==e[c])return!1;if(ki.und(c)){if(a&&i.length===0&&e.length===0||s&&Object.keys(i).length===0&&Object.keys(e).length===0)return!0;if(i!==e)return!1}return!0}};function h4(i){const e={nodes:{},materials:{},meshes:{}};return i&&i.traverse(t=>{t.name&&(e.nodes[t.name]=t),t.material&&!e.materials[t.material.name]&&(e.materials[t.material.name]=t.material),t.isMesh&&!e.meshes[t.name]&&(e.meshes[t.name]=t)}),e}function p4(i){i.type!=="Scene"&&(i.dispose==null||i.dispose());for(const e in i){const t=i[e];(t==null?void 0:t.type)!=="Scene"&&(t==null||t.dispose==null||t.dispose())}}const BI=["children","key","ref"];function m4(i){const e={};for(const t in i)BI.includes(t)||(e[t]=i[t]);return e}function H_(i,e,t,n){const r=i;let s=r==null?void 0:r.__r3f;return s||(s={root:e,type:t,parent:null,children:[],props:m4(n),object:r,eventCount:0,handlers:{},isHidden:!1},r&&(r.__r3f=s)),s}function Pg(i,e){if(!e.includes("-"))return{root:i,key:e,target:i[e]};if(e in i)return{root:i,key:e,target:i[e]};let t=i;const n=e.split("-");for(const r of n){if(typeof t!="object"||t===null){if(t!==void 0){const s=n.slice(n.indexOf(r)).join("-");return{root:t,key:s,target:void 0}}return{root:i,key:e,target:void 0}}e=r,i=t,t=t[e]}return{root:i,key:e,target:t}}const FA=/-\d+$/;function G_(i,e){if(ki.str(e.props.attach)){if(FA.test(e.props.attach)){const r=e.props.attach.replace(FA,""),{root:s,key:a}=Pg(i.object,r);Array.isArray(s[a])||(s[a]=[])}const{root:t,key:n}=Pg(i.object,e.props.attach);e.previousAttach=t[n],t[n]=e.object}else ki.fun(e.props.attach)&&(e.previousAttach=e.props.attach(i.object,e.object))}function q_(i,e){if(ki.str(e.props.attach)){const{root:t,key:n}=Pg(i.object,e.props.attach),r=e.previousAttach;r===void 0?delete t[n]:t[n]=r}else e.previousAttach==null||e.previousAttach(i.object,e.object);delete e.previousAttach}const hM=[...BI,"args","dispose","attach","object","onUpdate","dispose"],kA=new Map;function g4(i){let e=kA.get(i.constructor);try{e||(e=new i.constructor,kA.set(i.constructor,e))}catch{}return e}function v4(i,e){const t={};for(const n in e)if(!hM.includes(n)&&!ki.equ(e[n],i.props[n])){t[n]=e[n];for(const r in e)r.startsWith(`${n}-`)&&(t[r]=e[r])}for(const n in i.props){if(hM.includes(n)||e.hasOwnProperty(n))continue;const{root:r,key:s}=Pg(i.object,n);if(r.constructor&&r.constructor.length===0){const a=g4(r);ki.und(a)||(t[s]=a[s])}else t[s]=0}return t}const y4=["map","emissiveMap","sheenColorMap","specularColorMap","envMap"],_4=/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/;function vl(i,e){var t;const n=i.__r3f,r=n&&kI(n).getState(),s=n==null?void 0:n.eventCount;for(const c in e){let d=e[c];if(hM.includes(c))continue;if(n&&_4.test(c)){typeof d=="function"?n.handlers[c]=d:delete n.handlers[c],n.eventCount=Object.keys(n.handlers).length;continue}if(d===void 0)continue;let{root:p,key:m,target:v}=Pg(i,c);if(v===void 0&&(typeof p!="object"||p===null))throw Error(`R3F: Cannot set "${c}". Ensure it is an object before setting "${m}".`);if(v instanceof Zh&&d instanceof Zh)v.mask=d.mask;else if(v instanceof Pt&&u4(d))v.set(d);else if(v!==null&&typeof v=="object"&&typeof v.set=="function"&&typeof v.copy=="function"&&d!=null&&d.constructor&&v.constructor===d.constructor)v.copy(d);else if(v!==null&&typeof v=="object"&&typeof v.set=="function"&&Array.isArray(d))typeof v.fromArray=="function"?v.fromArray(d):v.set(...d);else if(v!==null&&typeof v=="object"&&typeof v.set=="function"&&typeof d=="number")typeof v.setScalar=="function"?v.setScalar(d):v.set(d);else{var a;p[m]=d,r&&!r.linear&&y4.includes(m)&&(a=p[m])!=null&&a.isTexture&&p[m].format===ur&&p[m].type===kr&&(p[m].colorSpace=es)}}if(n!=null&&n.parent&&r!=null&&r.internal&&(t=n.object)!=null&&t.isObject3D&&s!==n.eventCount){const c=n.object,d=r.internal.interaction.indexOf(c);d>-1&&r.internal.interaction.splice(d,1),n.eventCount&&c.raycast!==null&&r.internal.interaction.push(c)}return n&&n.props.attach===void 0&&(n.object.isBufferGeometry?n.props.attach="geometry":n.object.isMaterial&&(n.props.attach="material")),n&&op(n),i}function op(i){var e;if(!i.parent)return;i.props.onUpdate==null||i.props.onUpdate(i.object);const t=(e=i.root)==null||e.getState==null?void 0:e.getState();t&&t.internal.frames===0&&t.invalidate()}function VI(i,e){i.manual||(OI(i)?(i.left=e.width/-2,i.right=e.width/2,i.top=e.height/2,i.bottom=e.height/-2):i.aspect=e.width/e.height,i.updateProjectionMatrix())}const Ds=i=>i==null?void 0:i.isObject3D;function Ry(i){return(i.eventObject||i.object).uuid+"/"+i.index+i.instanceId}function HI(i,e,t,n){const r=t.get(e);r&&(t.delete(e),t.size===0&&(i.delete(n),r.target.releasePointerCapture(n)))}function x4(i,e){const{internal:t}=i.getState();t.interaction=t.interaction.filter(n=>n!==e),t.initialHits=t.initialHits.filter(n=>n!==e),t.hovered.forEach((n,r)=>{(n.eventObject===e||n.object===e)&&t.hovered.delete(r)}),t.capturedMap.forEach((n,r)=>{HI(t.capturedMap,e,n,r)})}function S4(i){function e(d){const{internal:p}=i.getState(),m=d.offsetX-p.initialClick[0],v=d.offsetY-p.initialClick[1];return Math.round(Math.sqrt(m*m+v*v))}function t(d){return d.filter(p=>["Move","Over","Enter","Out","Leave"].some(m=>{var v;return(v=p.__r3f)==null?void 0:v.handlers["onPointer"+m]}))}function n(d,p){const m=i.getState(),v=new Set,_=[],b=p?p(m.internal.interaction):m.internal.interaction;for(let A=0;A<b.length;A++){const D=Rh(b[A]);D&&(D.raycaster.camera=void 0)}m.previousRoot||m.events.compute==null||m.events.compute(d,m);function T(A){const D=Rh(A);if(!D||!D.events.enabled||D.raycaster.camera===null)return[];if(D.raycaster.camera===void 0){var U;D.events.compute==null||D.events.compute(d,D,(U=D.previousRoot)==null?void 0:U.getState()),D.raycaster.camera===void 0&&(D.raycaster.camera=null)}return D.raycaster.camera?D.raycaster.intersectObject(A,!0):[]}let I=b.flatMap(T).sort((A,D)=>{const U=Rh(A.object),L=Rh(D.object);return!U||!L?A.distance-D.distance:L.events.priority-U.events.priority||A.distance-D.distance}).filter(A=>{const D=Ry(A);return v.has(D)?!1:(v.add(D),!0)});m.events.filter&&(I=m.events.filter(I,m));for(const A of I){let D=A.object;for(;D;){var C;(C=D.__r3f)!=null&&C.eventCount&&_.push({...A,eventObject:D}),D=D.parent}}if("pointerId"in d&&m.internal.capturedMap.has(d.pointerId))for(let A of m.internal.capturedMap.get(d.pointerId).values())v.has(Ry(A.intersection))||_.push(A.intersection);return _}function r(d,p,m,v){if(d.length){const _={stopped:!1};for(const b of d){let T=Rh(b.object);if(T||b.object.traverseAncestors(I=>{const C=Rh(I);if(C)return T=C,!1}),T){const{raycaster:I,pointer:C,camera:A,internal:D}=T,U=new Q(C.x,C.y,0).unproject(A),L=P=>{var O,Z;return(O=(Z=D.capturedMap.get(P))==null?void 0:Z.has(b.eventObject))!=null?O:!1},z=P=>{const O={intersection:b,target:p.target};D.capturedMap.has(P)?D.capturedMap.get(P).set(b.eventObject,O):D.capturedMap.set(P,new Map([[b.eventObject,O]])),p.target.setPointerCapture(P)},B=P=>{const O=D.capturedMap.get(P);O&&HI(D.capturedMap,b.eventObject,O,P)};let k={};for(let P in p){let O=p[P];typeof O!="function"&&(k[P]=O)}let G={...b,...k,pointer:C,intersections:d,stopped:_.stopped,delta:m,unprojectedPoint:U,ray:I.ray,camera:A,stopPropagation(){const P="pointerId"in p&&D.capturedMap.get(p.pointerId);if((!P||P.has(b.eventObject))&&(G.stopped=_.stopped=!0,D.hovered.size&&Array.from(D.hovered.values()).find(O=>O.eventObject===b.eventObject))){const O=d.slice(0,d.indexOf(b));s([...O,b])}},target:{hasPointerCapture:L,setPointerCapture:z,releasePointerCapture:B},currentTarget:{hasPointerCapture:L,setPointerCapture:z,releasePointerCapture:B},nativeEvent:p};if(v(G),_.stopped===!0)break}}}return d}function s(d){const{internal:p}=i.getState();for(const m of p.hovered.values())if(!d.length||!d.find(v=>v.object===m.object&&v.index===m.index&&v.instanceId===m.instanceId)){const _=m.eventObject.__r3f;if(p.hovered.delete(Ry(m)),_!=null&&_.eventCount){const b=_.handlers,T={...m,intersections:d};b.onPointerOut==null||b.onPointerOut(T),b.onPointerLeave==null||b.onPointerLeave(T)}}}function a(d,p){for(let m=0;m<p.length;m++){const v=p[m].__r3f;v==null||v.handlers.onPointerMissed==null||v.handlers.onPointerMissed(d)}}function c(d){switch(d){case"onPointerLeave":case"onPointerCancel":return()=>s([]);case"onLostPointerCapture":return p=>{const{internal:m}=i.getState();"pointerId"in p&&m.capturedMap.has(p.pointerId)&&requestAnimationFrame(()=>{m.capturedMap.has(p.pointerId)&&(m.capturedMap.delete(p.pointerId),s([]))})}}return function(m){const{onPointerMissed:v,internal:_}=i.getState();_.lastEvent.current=m;const b=d==="onPointerMove",T=d==="onClick"||d==="onContextMenu"||d==="onDoubleClick",C=n(m,b?t:void 0),A=T?e(m):0;d==="onPointerDown"&&(_.initialClick=[m.offsetX,m.offsetY],_.initialHits=C.map(U=>U.eventObject)),T&&!C.length&&A<=2&&(a(m,_.interaction),v&&v(m)),b&&s(C);function D(U){const L=U.eventObject,z=L.__r3f;if(!(z!=null&&z.eventCount))return;const B=z.handlers;if(b){if(B.onPointerOver||B.onPointerEnter||B.onPointerOut||B.onPointerLeave){const k=Ry(U),G=_.hovered.get(k);G?G.stopped&&U.stopPropagation():(_.hovered.set(k,U),B.onPointerOver==null||B.onPointerOver(U),B.onPointerEnter==null||B.onPointerEnter(U))}B.onPointerMove==null||B.onPointerMove(U)}else{const k=B[d];k?(!T||_.initialHits.includes(L))&&(a(m,_.interaction.filter(G=>!_.initialHits.includes(G))),k(U)):T&&_.initialHits.includes(L)&&a(m,_.interaction.filter(G=>!_.initialHits.includes(G)))}}r(C,m,A,D)}}return{handlePointer:c}}const OA=i=>!!(i!=null&&i.render),IE=Oe.createContext(null),b4=(i,e)=>{const t=NI((c,d)=>{const p=new Q,m=new Q,v=new Q;function _(A=d().camera,D=m,U=d().size){const{width:L,height:z,top:B,left:k}=U,G=L/z;D.isVector3?v.copy(D):v.set(...D);const P=A.getWorldPosition(p).distanceTo(v);if(OI(A))return{width:L/A.zoom,height:z/A.zoom,top:B,left:k,factor:1,distance:P,aspect:G};{const O=A.fov*Math.PI/180,Z=2*Math.tan(O/2)*P,ie=Z*(L/z);return{width:ie,height:Z,top:B,left:k,factor:L/ie,distance:P,aspect:G}}}let b;const T=A=>c(D=>({performance:{...D.performance,current:A}})),I=new $e;return{set:c,get:d,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},scene:null,xr:null,invalidate:(A=1)=>i(d(),A),advance:(A,D)=>e(A,D,d()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new SE,pointer:I,mouse:I,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const A=d();b&&clearTimeout(b),A.performance.current!==A.performance.min&&T(A.performance.min),b=setTimeout(()=>T(d().performance.max),A.performance.debounce)}},size:{width:0,height:0,top:0,left:0},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:_},setEvents:A=>c(D=>({...D,events:{...D.events,...A}})),setSize:(A,D,U=0,L=0)=>{const z=d().camera,B={width:A,height:D,top:U,left:L};c(k=>({size:B,viewport:{...k.viewport,..._(z,m,B)}}))},setDpr:A=>c(D=>{const U=zI(A);return{viewport:{...D.viewport,dpr:U,initialDpr:D.viewport.initialDpr||U}}}),setFrameloop:(A="always")=>{const D=d().clock;D.stop(),D.elapsedTime=0,A!=="never"&&(D.start(),D.elapsedTime=0),c(()=>({frameloop:A}))},previousRoot:void 0,internal:{interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,lastEvent:Oe.createRef(),active:!1,frames:0,priority:0,subscribe:(A,D,U)=>{const L=d().internal;return L.priority=L.priority+(D>0?1:0),L.subscribers.push({ref:A,priority:D,store:U}),L.subscribers=L.subscribers.sort((z,B)=>z.priority-B.priority),()=>{const z=d().internal;z!=null&&z.subscribers&&(z.priority=z.priority-(D>0?1:0),z.subscribers=z.subscribers.filter(B=>B.ref!==A))}}}}}),n=t.getState();let r=n.size,s=n.viewport.dpr,a=n.camera;return t.subscribe(()=>{const{camera:c,size:d,viewport:p,gl:m,set:v}=t.getState();if(d.width!==r.width||d.height!==r.height||p.dpr!==s){r=d,s=p.dpr,VI(c,d),p.dpr>0&&m.setPixelRatio(p.dpr);const _=typeof HTMLCanvasElement<"u"&&m.domElement instanceof HTMLCanvasElement;m.setSize(d.width,d.height,_)}c!==a&&(a=c,v(_=>({viewport:{..._.viewport,..._.viewport.getCurrentViewport(c)}})))}),t.subscribe(c=>i(c)),t};function NE(){const i=Oe.useContext(IE);if(!i)throw new Error("R3F: Hooks can only be used within the Canvas component!");return i}function bo(i=t=>t,e){return NE()(i,e)}function Kg(i,e=0){const t=NE(),n=t.getState().internal.subscribe,r=RE(i);return $g(()=>n(r,e,t),[e,n,t]),null}const zA=new WeakMap,M4=i=>{var e;return typeof i=="function"&&(i==null||(e=i.prototype)==null?void 0:e.constructor)===i};function GI(i,e){return function(t,...n){let r;return M4(t)?(r=zA.get(t),r||(r=new t,zA.set(t,r))):r=t,i&&i(r),Promise.all(n.map(s=>new Promise((a,c)=>r.load(s,d=>{Ds(d==null?void 0:d.scene)&&Object.assign(d,h4(d.scene)),a(d)},e,d=>c(new Error(`Could not load ${s}: ${d==null?void 0:d.message}`))))))}}function jh(i,e,t,n){const r=Array.isArray(e)?e:[e],s=e4(GI(t,n),[i,...r],{equal:ki.equ});return Array.isArray(e)?s:s[0]}jh.preload=function(i,e,t){const n=Array.isArray(e)?e:[e];return t4(GI(t),[i,...n])};jh.clear=function(i,e){const t=Array.isArray(e)?e:[e];return n4([i,...t])};/**
 * @license React
 * react-reconciler-constants.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */const E4=1,T4=8,A4=32,w4=2;var C4={version:"9.5.0"};function R4(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var BA={exports:{}},VA={exports:{}},HA;function I4(){return HA||(HA=1,(function(i){i.exports=function(e){function t(u,f,y,M){return new Pp(u,f,y,M)}function n(){}function r(u){var f="https://react.dev/errors/"+u;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var y=2;y<arguments.length;y++)f+="&args[]="+encodeURIComponent(arguments[y])}return"Minified React error #"+u+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(u){var f=u,y=u;if(u.alternate)for(;f.return;)f=f.return;else{u=f;do f=u,(f.flags&4098)!==0&&(y=f.return),u=f.return;while(u)}return f.tag===3?y:null}function a(u){if(s(u)!==u)throw Error(r(188))}function c(u){var f=u.alternate;if(!f){if(f=s(u),f===null)throw Error(r(188));return f!==u?null:u}for(var y=u,M=f;;){var R=y.return;if(R===null)break;var N=R.alternate;if(N===null){if(M=R.return,M!==null){y=M;continue}break}if(R.child===N.child){for(N=R.child;N;){if(N===y)return a(R),u;if(N===M)return a(R),f;N=N.sibling}throw Error(r(188))}if(y.return!==M.return)y=R,M=N;else{for(var W=!1,ae=R.child;ae;){if(ae===y){W=!0,y=R,M=N;break}if(ae===M){W=!0,M=R,y=N;break}ae=ae.sibling}if(!W){for(ae=N.child;ae;){if(ae===y){W=!0,y=N,M=R;break}if(ae===M){W=!0,M=N,y=R;break}ae=ae.sibling}if(!W)throw Error(r(189))}}if(y.alternate!==M)throw Error(r(190))}if(y.tag!==3)throw Error(r(188));return y.stateNode.current===y?u:f}function d(u){var f=u.tag;if(f===5||f===26||f===27||f===6)return u;for(u=u.child;u!==null;){if(f=d(u),f!==null)return f;u=u.sibling}return null}function p(u){var f=u.tag;if(f===5||f===26||f===27||f===6)return u;for(u=u.child;u!==null;){if(u.tag!==4&&(f=p(u),f!==null))return f;u=u.sibling}return null}function m(u){return u===null||typeof u!="object"?null:(u=pa&&u[pa]||u["@@iterator"],typeof u=="function"?u:null)}function v(u){if(u==null)return null;if(typeof u=="function")return u.$$typeof===$a?null:u.displayName||u.name||null;if(typeof u=="string")return u;switch(u){case zl:return"Fragment";case Vl:return"Profiler";case Bl:return"StrictMode";case Id:return"Suspense";case ha:return"SuspenseList";case $c:return"Activity"}if(typeof u=="object")switch(u.$$typeof){case Ol:return"Portal";case Xs:return u.displayName||"Context";case Zc:return(u._context.displayName||"Context")+".Consumer";case zu:var f=u.render;return u=u.displayName,u||(u=f.displayName||f.name||"",u=u!==""?"ForwardRef("+u+")":"ForwardRef"),u;case Nd:return f=u.displayName||null,f!==null?f:v(u.type)||"Memo";case qr:f=u._payload,u=u._init;try{return v(u(f))}catch{}}return null}function _(u){return{current:u}}function b(u){0>Xl||(u.current=qd[Xl],qd[Xl]=null,Xl--)}function T(u,f){Xl++,qd[Xl]=u.current,u.current=f}function I(u){return u>>>=0,u===0?32:31-(Wd(u)/vv|0)|0}function C(u){var f=u&42;if(f!==0)return f;switch(u&-u){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return u&261888;case 262144:case 524288:case 1048576:case 2097152:return u&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return u&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return u}}function A(u,f,y){var M=u.pendingLanes;if(M===0)return 0;var R=0,N=u.suspendedLanes,W=u.pingedLanes;u=u.warmLanes;var ae=M&134217727;return ae!==0?(M=ae&~N,M!==0?R=C(M):(W&=ae,W!==0?R=C(W):y||(y=ae&~u,y!==0&&(R=C(y))))):(ae=M&~N,ae!==0?R=C(ae):W!==0?R=C(W):y||(y=M&~u,y!==0&&(R=C(y)))),R===0?0:f!==0&&f!==R&&(f&N)===0&&(N=R&-R,y=f&-f,N>=y||N===32&&(y&4194048)!==0)?f:R}function D(u,f){return(u.pendingLanes&~(u.suspendedLanes&~u.pingedLanes)&f)===0}function U(u,f){switch(u){case 1:case 2:case 4:case 8:case 64:return f+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return f+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function L(){var u=Xu;return Xu<<=1,(Xu&62914560)===0&&(Xu=4194304),u}function z(u){for(var f=[],y=0;31>y;y++)f.push(u);return f}function B(u,f){u.pendingLanes|=f,f!==268435456&&(u.suspendedLanes=0,u.pingedLanes=0,u.warmLanes=0)}function k(u,f,y,M,R,N){var W=u.pendingLanes;u.pendingLanes=y,u.suspendedLanes=0,u.pingedLanes=0,u.warmLanes=0,u.expiredLanes&=y,u.entangledLanes&=y,u.errorRecoveryDisabledLanes&=y,u.shellSuspendCounter=0;var ae=u.entanglements,Pe=u.expirationTimes,je=u.hiddenUpdates;for(y=W&~y;0<y;){var xt=31-os(y),st=1<<xt;ae[xt]=0,Pe[xt]=-1;var Lt=je[xt];if(Lt!==null)for(je[xt]=null,xt=0;xt<Lt.length;xt++){var dn=Lt[xt];dn!==null&&(dn.lane&=-536870913)}y&=~st}M!==0&&G(u,M,0),N!==0&&R===0&&u.tag!==0&&(u.suspendedLanes|=N&~(W&~f))}function G(u,f,y){u.pendingLanes|=f,u.suspendedLanes&=~f;var M=31-os(f);u.entangledLanes|=f,u.entanglements[M]=u.entanglements[M]|1073741824|y&261930}function P(u,f){var y=u.entangledLanes|=f;for(u=u.entanglements;y;){var M=31-os(y),R=1<<M;R&f|u[M]&f&&(u[M]|=f),y&=~R}}function O(u,f){var y=f&-f;return y=(y&42)!==0?1:Z(y),(y&(u.suspendedLanes|f))!==0?0:y}function Z(u){switch(u){case 2:u=1;break;case 8:u=4;break;case 32:u=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:u=128;break;case 268435456:u=134217728;break;default:u=0}return u}function ie(u){return u&=-u,2<u?8<u?(u&134217727)!==0?32:268435456:8:2}function ee(u){if(typeof _m=="function"&&xv(u),as&&typeof as.setStrictMode=="function")try{as.setStrictMode(Jl,u)}catch{}}function re(u,f){return u===f&&(u!==0||1/u===1/f)||u!==u&&f!==f}function de(u){if(Kd===void 0)try{throw Error()}catch(y){var f=y.stack.trim().match(/\n( *(at )?)/);Kd=f&&f[1]||"",Ho=-1<y.stack.indexOf(`
    at`)?" (<anonymous>)":-1<y.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Kd+u+Ho}function J(u,f){if(!u||of)return"";of=!0;var y=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var M={DetermineComponentFrameRoot:function(){try{if(f){var st=function(){throw Error()};if(Object.defineProperty(st.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(st,[])}catch(dn){var Lt=dn}Reflect.construct(u,[],st)}else{try{st.call()}catch(dn){Lt=dn}u.call(st.prototype)}}else{try{throw Error()}catch(dn){Lt=dn}(st=u())&&typeof st.catch=="function"&&st.catch(function(){})}}catch(dn){if(dn&&Lt&&typeof dn.stack=="string")return[dn.stack,Lt.stack]}return[null,null]}};M.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var R=Object.getOwnPropertyDescriptor(M.DetermineComponentFrameRoot,"name");R&&R.configurable&&Object.defineProperty(M.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var N=M.DetermineComponentFrameRoot(),W=N[0],ae=N[1];if(W&&ae){var Pe=W.split(`
`),je=ae.split(`
`);for(R=M=0;M<Pe.length&&!Pe[M].includes("DetermineComponentFrameRoot");)M++;for(;R<je.length&&!je[R].includes("DetermineComponentFrameRoot");)R++;if(M===Pe.length||R===je.length)for(M=Pe.length-1,R=je.length-1;1<=M&&0<=R&&Pe[M]!==je[R];)R--;for(;1<=M&&0<=R;M--,R--)if(Pe[M]!==je[R]){if(M!==1||R!==1)do if(M--,R--,0>R||Pe[M]!==je[R]){var xt=`
`+Pe[M].replace(" at new "," at ");return u.displayName&&xt.includes("<anonymous>")&&(xt=xt.replace("<anonymous>",u.displayName)),xt}while(1<=M&&0<=R);break}}}finally{of=!1,Error.prepareStackTrace=y}return(y=u?u.displayName||u.name:"")?de(y):""}function te(u,f){switch(u.tag){case 26:case 27:case 5:return de(u.type);case 16:return de("Lazy");case 13:return u.child!==f&&f!==null?de("Suspense Fallback"):de("Suspense");case 19:return de("SuspenseList");case 0:case 15:return J(u.type,!1);case 11:return J(u.type.render,!1);case 1:return J(u.type,!0);case 31:return de("Activity");default:return""}}function ye(u){try{var f="",y=null;do f+=te(u,y),y=u,u=u.return;while(u);return f}catch(M){return`
Error generating stack: `+M.message+`
`+M.stack}}function Ue(u,f){if(typeof u=="object"&&u!==null){var y=xm.get(u);return y!==void 0?y:(f={value:u,source:f,stack:ye(f)},xm.set(u,f),f)}return{value:u,source:f,stack:ye(f)}}function we(u,f){va[Go++]=af,va[Go++]=si,si=u,af=f}function $(u,f,y){Zs[Es++]=xr,Zs[Es++]=uo,Zs[Es++]=$s,$s=u;var M=xr;u=uo;var R=32-os(M)-1;M&=~(1<<R),y+=1;var N=32-os(f)+R;if(30<N){var W=R-R%5;N=(M&(1<<W)-1).toString(32),M>>=W,R-=W,xr=1<<32-os(f)+R|y<<R|M,uo=N+u}else xr=1<<N|y<<R|M,uo=u}function ce(u){u.return!==null&&(we(u,1),$(u,1,0))}function Ee(u){for(;u===si;)si=va[--Go],va[Go]=null,af=va[--Go],va[Go]=null;for(;u===$s;)$s=Zs[--Es],Zs[Es]=null,uo=Zs[--Es],Zs[Es]=null,xr=Zs[--Es],Zs[Es]=null}function Be(u,f){Zs[Es++]=xr,Zs[Es++]=uo,Zs[Es++]=$s,xr=f.id,uo=f.overflow,$s=u}function St(u,f){T(Sr,f),T(ya,u),T(mr,null),u=U0(f),b(mr),T(mr,u)}function ve(){b(mr),b(ya),b(Sr)}function Re(u){u.memoizedState!==null&&T(lf,u);var f=mr.current,y=Hu(f,u.type);f!==y&&(T(ya,u),T(mr,y))}function ot(u){ya.current===u&&(b(mr),b(ya)),lf.current===u&&(b(lf),Oi?ql._currentValue=Gl:ql._currentValue2=Gl)}function bt(u){var f=Error(r(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw et(Ue(f,u)),Qd}function Dt(u,f){if(!xi)throw Error(r(175));sv(u.stateNode,u.type,u.memoizedProps,f,u)||bt(u,!0)}function cn(u){for(rr=u.return;rr;)switch(rr.tag){case 5:case 31:case 13:Xr=!1;return;case 27:case 3:Xr=!0;return;default:rr=rr.return}}function Tn(u){if(!xi||u!==rr)return!1;if(!Un)return cn(u),Un=!0,!1;var f=u.tag;if(ir?f!==3&&f!==27&&(f!==5||Wu(u.type)&&!Wr(u.type,u.memoizedProps))&&Si&&bt(u):f!==3&&(f!==5||Wu(u.type)&&!Wr(u.type,u.memoizedProps))&&Si&&bt(u),cn(u),f===13){if(!xi)throw Error(r(316));if(u=u.memoizedState,u=u!==null?u.dehydrated:null,!u)throw Error(r(317));Si=lm(u)}else if(f===31){if(u=u.memoizedState,u=u!==null?u.dehydrated:null,!u)throw Error(r(317));Si=av(u)}else Si=ir&&f===27?K0(u.type,Si):rr?$0(u.stateNode):null;return!0}function Zt(){xi&&(Si=rr=null,Un=!1)}function Ve(){var u=qo;return u!==null&&(cs===null?cs=u:cs.push.apply(cs,u),qo=null),u}function et(u){qo===null?qo=[u]:qo.push(u)}function qe(u,f,y){Oi?(T(Ks,f._currentValue),f._currentValue=y):(T(Ks,f._currentValue2),f._currentValue2=y)}function _t(u){var f=Ks.current;Oi?u._currentValue=f:u._currentValue2=f,b(Ks)}function j(u,f,y){for(;u!==null;){var M=u.alternate;if((u.childLanes&f)!==f?(u.childLanes|=f,M!==null&&(M.childLanes|=f)):M!==null&&(M.childLanes&f)!==f&&(M.childLanes|=f),u===y)break;u=u.return}}function Ht(u,f,y,M){var R=u.child;for(R!==null&&(R.return=u);R!==null;){var N=R.dependencies;if(N!==null){var W=R.child;N=N.firstContext;e:for(;N!==null;){var ae=N;N=R;for(var Pe=0;Pe<f.length;Pe++)if(ae.context===f[Pe]){N.lanes|=y,ae=N.alternate,ae!==null&&(ae.lanes|=y),j(N.return,y,u),M||(W=null);break e}N=ae.next}}else if(R.tag===18){if(W=R.return,W===null)throw Error(r(341));W.lanes|=y,N=W.alternate,N!==null&&(N.lanes|=y),j(W,y,u),W=null}else W=R.child;if(W!==null)W.return=R;else for(W=R;W!==null;){if(W===u){W=null;break}if(R=W.sibling,R!==null){R.return=W.return,W=R;break}W=W.return}R=W}}function Et(u,f,y,M){u=null;for(var R=f,N=!1;R!==null;){if(!N){if((R.flags&524288)!==0)N=!0;else if((R.flags&262144)!==0)break}if(R.tag===10){var W=R.alternate;if(W===null)throw Error(r(387));if(W=W.memoizedProps,W!==null){var ae=R.type;Bi(R.pendingProps.value,W.value)||(u!==null?u.push(ae):u=[ae])}}else if(R===lf.current){if(W=R.alternate,W===null)throw Error(r(387));W.memoizedState.memoizedState!==R.memoizedState.memoizedState&&(u!==null?u.push(ql):u=[ql])}R=R.return}u!==null&&Ht(f,u,y,M),f.flags|=262144}function Gt(u){for(u=u.firstContext;u!==null;){var f=u.context;if(!Bi(Oi?f._currentValue:f._currentValue2,u.memoizedValue))return!0;u=u.next}return!1}function ut(u){ci=u,co=null,u=u.dependencies,u!==null&&(u.firstContext=null)}function K(u){return pe(ci,u)}function V(u,f){return ci===null&&ut(u),pe(u,f)}function pe(u,f){var y=Oi?f._currentValue:f._currentValue2;if(f={context:f,memoizedValue:y,next:null},co===null){if(u===null)throw Error(r(308));co=f,u.dependencies={lanes:0,firstContext:f},u.flags|=524288}else co=co.next=f;return y}function De(){return{controller:new Sv,data:new Map,refCount:0}}function We(u){u.refCount--,u.refCount===0&&gr(uS,function(){u.controller.abort()})}function Ne(){}function Ct(u){u!==ti&&u.next===null&&(ti===null?uf=ti=u:ti=ti.next=u),Qs=!0,Ur||(Ur=!0,Tt())}function ht(u,f){if(!jd&&Qs){jd=!0;do for(var y=!1,M=uf;M!==null;){if(u!==0){var R=M.pendingLanes;if(R===0)var N=0;else{var W=M.suspendedLanes,ae=M.pingedLanes;N=(1<<31-os(42|u)+1)-1,N&=R&~(W&~ae),N=N&201326741?N&201326741|1:N?N|2:0}N!==0&&(y=!0,Nt(M,N))}else N=Pn,N=A(M,M===Mn?N:0,M.cancelPendingCommit!==null||M.timeoutHandle!==ss),(N&3)===0||D(M,N)||(y=!0,Nt(M,N));M=M.next}while(y);jd=!1}}function Ot(){$t()}function $t(){Qs=Ur=!1;var u=0;tl!==0&&Hl()&&(u=tl);for(var f=Dr(),y=null,M=uf;M!==null;){var R=M.next,N=Ze(M,f);N===0?(M.next=null,y===null?uf=R:y.next=R,R===null&&(ti=y)):(y=M,(u!==0||(N&3)!==0)&&(Qs=!0)),M=R}$i!==0&&$i!==5||ht(u),tl!==0&&(tl=0)}function Ze(u,f){for(var y=u.suspendedLanes,M=u.pingedLanes,R=u.expirationTimes,N=u.pendingLanes&-62914561;0<N;){var W=31-os(N),ae=1<<W,Pe=R[W];Pe===-1?((ae&y)===0||(ae&M)!==0)&&(R[W]=U(ae,f)):Pe<=f&&(u.expiredLanes|=ae),N&=~ae}if(f=Mn,y=Pn,y=A(u,u===f?y:0,u.cancelPendingCommit!==null||u.timeoutHandle!==ss),M=u.callbackNode,y===0||u===f&&(ii===2||ii===9)||u.cancelPendingCommit!==null)return M!==null&&M!==null&&Yd(M),u.callbackNode=null,u.callbackPriority=0;if((y&3)===0||D(u,y)){if(f=y&-y,f===u.callbackPriority)return f;switch(M!==null&&Yd(M),ie(y)){case 2:case 8:y=_v;break;case 32:y=sf;break;case 268435456:y=Zd;break;default:y=sf}return M=Ke.bind(null,u),y=rf(y,M),u.callbackPriority=f,u.callbackNode=y,f}return M!==null&&M!==null&&Yd(M),u.callbackPriority=2,u.callbackNode=null,2}function Ke(u,f){if($i!==0&&$i!==5)return u.callbackNode=null,u.callbackPriority=0,null;var y=u.callbackNode;if(zo()&&u.callbackNode!==y)return null;var M=Pn;return M=A(u,u===Mn?M:0,u.cancelPendingCommit!==null||u.timeoutHandle!==ss),M===0?null:(lo(u,M,f),Ze(u,Dr()),u.callbackNode!=null&&u.callbackNode===y?Ke.bind(null,u):null)}function Nt(u,f){if(zo())return null;lo(u,f,!0)}function Tt(){Xp?Yp(function(){(Rn&6)!==0?rf(Jd,Ot):$t()}):rf(Jd,Ot)}function at(){if(tl===0){var u=_a;u===0&&(u=Xd,Xd<<=1,(Xd&261888)===0&&(Xd=256)),tl=u}return tl}function Xt(u,f){if(Yu===null){var y=Yu=[];Sm=0,_a=at(),sr={status:"pending",value:void 0,then:function(M){y.push(M)}}}return Sm++,f.then(me,me),f}function me(){if(--Sm===0&&Yu!==null){sr!==null&&(sr.status="fulfilled");var u=Yu;Yu=null,_a=0,sr=null;for(var f=0;f<u.length;f++)(0,u[f])()}}function Ce(u,f){var y=[],M={status:"pending",value:null,reason:null,then:function(R){y.push(R)}};return u.then(function(){M.status="fulfilled",M.value=f;for(var R=0;R<y.length;R++)(0,y[R])(f)},function(R){for(M.status="rejected",M.reason=R,R=0;R<y.length;R++)(0,y[R])(void 0)}),M}function nt(){var u=nl.current;return u!==null?u:Mn.pooledCache}function wt(u,f){f===null?T(nl,nl.current):T(nl,f.pool)}function tt(){var u=nt();return u===null?null:{parent:Oi?bi._currentValue:bi._currentValue2,pool:u}}function He(u,f){if(Bi(u,f))return!0;if(typeof u!="object"||u===null||typeof f!="object"||f===null)return!1;var y=Object.keys(u),M=Object.keys(f);if(y.length!==M.length)return!1;for(M=0;M<y.length;M++){var R=y[M];if(!lS.call(f,R)||!Bi(u[R],f[R]))return!1}return!0}function vt(u){return u=u.status,u==="fulfilled"||u==="rejected"}function nn(u,f,y){switch(y=u[y],y===void 0?u.push(f):y!==f&&(f.then(Ne,Ne),f=y),f.status){case"fulfilled":return f.value;case"rejected":throw u=f.reason,ji(u),u;default:if(typeof f.status=="string")f.then(Ne,Ne);else{if(u=Mn,u!==null&&100<u.shellSuspendCounter)throw Error(r(482));u=f,u.status="pending",u.then(function(M){if(f.status==="pending"){var R=f;R.status="fulfilled",R.value=M}},function(M){if(f.status==="pending"){var R=f;R.status="rejected",R.reason=M}})}switch(f.status){case"fulfilled":return f.value;case"rejected":throw u=f.reason,ji(u),u}throw Yr=f,or}}function Nn(u){try{var f=u._init;return f(u._payload)}catch(y){throw y!==null&&typeof y=="object"&&typeof y.then=="function"?(Yr=y,or):y}}function Ln(){if(Yr===null)throw Error(r(459));var u=Yr;return Yr=null,u}function ji(u){if(u===or||u===eo)throw Error(r(483))}function Rr(u){var f=Zl;return Zl+=1,il===null&&(il=[]),nn(il,u,f)}function To(u,f){f=f.props.ref,u.ref=f!==void 0?f:null}function Ao(u,f){throw f.$$typeof===kl?Error(r(525)):(u=Object.prototype.toString.call(f),Error(r(31,u==="[object Object]"?"object with keys {"+Object.keys(f).join(", ")+"}":u)))}function Os(u){function f(Te,xe){if(u){var Ie=Te.deletions;Ie===null?(Te.deletions=[xe],Te.flags|=16):Ie.push(xe)}}function y(Te,xe){if(!u)return null;for(;xe!==null;)f(Te,xe),xe=xe.sibling;return null}function M(Te){for(var xe=new Map;Te!==null;)Te.key!==null?xe.set(Te.key,Te):xe.set(Te.index,Te),Te=Te.sibling;return xe}function R(Te,xe){return Te=bs(Te,xe),Te.index=0,Te.sibling=null,Te}function N(Te,xe,Ie){return Te.index=Ie,u?(Ie=Te.alternate,Ie!==null?(Ie=Ie.index,Ie<xe?(Te.flags|=67108866,xe):Ie):(Te.flags|=67108866,xe)):(Te.flags|=1048576,xe)}function W(Te){return u&&Te.alternate===null&&(Te.flags|=67108866),Te}function ae(Te,xe,Ie,mt){return xe===null||xe.tag!==6?(xe=Lp(Ie,Te.mode,mt),xe.return=Te,xe):(xe=R(xe,Ie),xe.return=Te,xe)}function Pe(Te,xe,Ie,mt){var en=Ie.type;return en===zl?xt(Te,xe,Ie.props.children,mt,Ie.key):xe!==null&&(xe.elementType===en||typeof en=="object"&&en!==null&&en.$$typeof===qr&&Nn(en)===xe.type)?(xe=R(xe,Ie.props),To(xe,Ie),xe.return=Te,xe):(xe=da(Ie.type,Ie.key,Ie.props,null,Te.mode,mt),To(xe,Ie),xe.return=Te,xe)}function je(Te,xe,Ie,mt){return xe===null||xe.tag!==4||xe.stateNode.containerInfo!==Ie.containerInfo||xe.stateNode.implementation!==Ie.implementation?(xe=kp(Ie,Te.mode,mt),xe.return=Te,xe):(xe=R(xe,Ie.children||[]),xe.return=Te,xe)}function xt(Te,xe,Ie,mt,en){return xe===null||xe.tag!==7?(xe=Ws(Ie,Te.mode,mt,en),xe.return=Te,xe):(xe=R(xe,Ie),xe.return=Te,xe)}function st(Te,xe,Ie){if(typeof xe=="string"&&xe!==""||typeof xe=="number"||typeof xe=="bigint")return xe=Lp(""+xe,Te.mode,Ie),xe.return=Te,xe;if(typeof xe=="object"&&xe!==null){switch(xe.$$typeof){case Bo:return Ie=da(xe.type,xe.key,xe.props,null,Te.mode,Ie),To(Ie,xe),Ie.return=Te,Ie;case Ol:return xe=kp(xe,Te.mode,Ie),xe.return=Te,xe;case qr:return xe=Nn(xe),st(Te,xe,Ie)}if(Ka(xe)||m(xe))return xe=Ws(xe,Te.mode,Ie,null),xe.return=Te,xe;if(typeof xe.then=="function")return st(Te,Rr(xe),Ie);if(xe.$$typeof===Xs)return st(Te,V(Te,xe),Ie);Ao(Te,xe)}return null}function Lt(Te,xe,Ie,mt){var en=xe!==null?xe.key:null;if(typeof Ie=="string"&&Ie!==""||typeof Ie=="number"||typeof Ie=="bigint")return en!==null?null:ae(Te,xe,""+Ie,mt);if(typeof Ie=="object"&&Ie!==null){switch(Ie.$$typeof){case Bo:return Ie.key===en?Pe(Te,xe,Ie,mt):null;case Ol:return Ie.key===en?je(Te,xe,Ie,mt):null;case qr:return Ie=Nn(Ie),Lt(Te,xe,Ie,mt)}if(Ka(Ie)||m(Ie))return en!==null?null:xt(Te,xe,Ie,mt,null);if(typeof Ie.then=="function")return Lt(Te,xe,Rr(Ie),mt);if(Ie.$$typeof===Xs)return Lt(Te,xe,V(Te,Ie),mt);Ao(Te,Ie)}return null}function dn(Te,xe,Ie,mt,en){if(typeof mt=="string"&&mt!==""||typeof mt=="number"||typeof mt=="bigint")return Te=Te.get(Ie)||null,ae(xe,Te,""+mt,en);if(typeof mt=="object"&&mt!==null){switch(mt.$$typeof){case Bo:return Te=Te.get(mt.key===null?Ie:mt.key)||null,Pe(xe,Te,mt,en);case Ol:return Te=Te.get(mt.key===null?Ie:mt.key)||null,je(xe,Te,mt,en);case qr:return mt=Nn(mt),dn(Te,xe,Ie,mt,en)}if(Ka(mt)||m(mt))return Te=Te.get(Ie)||null,xt(xe,Te,mt,en,null);if(typeof mt.then=="function")return dn(Te,xe,Ie,Rr(mt),en);if(mt.$$typeof===Xs)return dn(Te,xe,Ie,V(xe,mt),en);Ao(xe,mt)}return null}function Gi(Te,xe,Ie,mt){for(var en=null,Ri=null,tn=xe,Vn=xe=0,vr=null;tn!==null&&Vn<Ie.length;Vn++){tn.index>Vn?(vr=tn,tn=null):vr=tn.sibling;var Yn=Lt(Te,tn,Ie[Vn],mt);if(Yn===null){tn===null&&(tn=vr);break}u&&tn&&Yn.alternate===null&&f(Te,tn),xe=N(Yn,xe,Vn),Ri===null?en=Yn:Ri.sibling=Yn,Ri=Yn,tn=vr}if(Vn===Ie.length)return y(Te,tn),Un&&we(Te,Vn),en;if(tn===null){for(;Vn<Ie.length;Vn++)tn=st(Te,Ie[Vn],mt),tn!==null&&(xe=N(tn,xe,Vn),Ri===null?en=tn:Ri.sibling=tn,Ri=tn);return Un&&we(Te,Vn),en}for(tn=M(tn);Vn<Ie.length;Vn++)vr=dn(tn,Te,Vn,Ie[Vn],mt),vr!==null&&(u&&vr.alternate!==null&&tn.delete(vr.key===null?Vn:vr.key),xe=N(vr,xe,Vn),Ri===null?en=vr:Ri.sibling=vr,Ri=vr);return u&&tn.forEach(function(io){return f(Te,io)}),Un&&we(Te,Vn),en}function tc(Te,xe,Ie,mt){if(Ie==null)throw Error(r(151));for(var en=null,Ri=null,tn=xe,Vn=xe=0,vr=null,Yn=Ie.next();tn!==null&&!Yn.done;Vn++,Yn=Ie.next()){tn.index>Vn?(vr=tn,tn=null):vr=tn.sibling;var io=Lt(Te,tn,Yn.value,mt);if(io===null){tn===null&&(tn=vr);break}u&&tn&&io.alternate===null&&f(Te,tn),xe=N(io,xe,Vn),Ri===null?en=io:Ri.sibling=io,Ri=io,tn=vr}if(Yn.done)return y(Te,tn),Un&&we(Te,Vn),en;if(tn===null){for(;!Yn.done;Vn++,Yn=Ie.next())Yn=st(Te,Yn.value,mt),Yn!==null&&(xe=N(Yn,xe,Vn),Ri===null?en=Yn:Ri.sibling=Yn,Ri=Yn);return Un&&we(Te,Vn),en}for(tn=M(tn);!Yn.done;Vn++,Yn=Ie.next())Yn=dn(tn,Te,Vn,Yn.value,mt),Yn!==null&&(u&&Yn.alternate!==null&&tn.delete(Yn.key===null?Vn:Yn.key),xe=N(Yn,xe,Vn),Ri===null?en=Yn:Ri.sibling=Yn,Ri=Yn);return u&&tn.forEach(function(cS){return f(Te,cS)}),Un&&we(Te,Vn),en}function fl(Te,xe,Ie,mt){if(typeof Ie=="object"&&Ie!==null&&Ie.type===zl&&Ie.key===null&&(Ie=Ie.props.children),typeof Ie=="object"&&Ie!==null){switch(Ie.$$typeof){case Bo:e:{for(var en=Ie.key;xe!==null;){if(xe.key===en){if(en=Ie.type,en===zl){if(xe.tag===7){y(Te,xe.sibling),mt=R(xe,Ie.props.children),mt.return=Te,Te=mt;break e}}else if(xe.elementType===en||typeof en=="object"&&en!==null&&en.$$typeof===qr&&Nn(en)===xe.type){y(Te,xe.sibling),mt=R(xe,Ie.props),To(mt,Ie),mt.return=Te,Te=mt;break e}y(Te,xe);break}else f(Te,xe);xe=xe.sibling}Ie.type===zl?(mt=Ws(Ie.props.children,Te.mode,mt,Ie.key),mt.return=Te,Te=mt):(mt=da(Ie.type,Ie.key,Ie.props,null,Te.mode,mt),To(mt,Ie),mt.return=Te,Te=mt)}return W(Te);case Ol:e:{for(en=Ie.key;xe!==null;){if(xe.key===en)if(xe.tag===4&&xe.stateNode.containerInfo===Ie.containerInfo&&xe.stateNode.implementation===Ie.implementation){y(Te,xe.sibling),mt=R(xe,Ie.children||[]),mt.return=Te,Te=mt;break e}else{y(Te,xe);break}else f(Te,xe);xe=xe.sibling}mt=kp(Ie,Te.mode,mt),mt.return=Te,Te=mt}return W(Te);case qr:return Ie=Nn(Ie),fl(Te,xe,Ie,mt)}if(Ka(Ie))return Gi(Te,xe,Ie,mt);if(m(Ie)){if(en=m(Ie),typeof en!="function")throw Error(r(150));return Ie=en.call(Ie),tc(Te,xe,Ie,mt)}if(typeof Ie.then=="function")return fl(Te,xe,Rr(Ie),mt);if(Ie.$$typeof===Xs)return fl(Te,xe,V(Te,Ie),mt);Ao(Te,Ie)}return typeof Ie=="string"&&Ie!==""||typeof Ie=="number"||typeof Ie=="bigint"?(Ie=""+Ie,xe!==null&&xe.tag===6?(y(Te,xe.sibling),mt=R(xe,Ie),mt.return=Te,Te=mt):(y(Te,xe),mt=Lp(Ie,Te.mode,mt),mt.return=Te,Te=mt),W(Te)):y(Te,xe)}return function(Te,xe,Ie,mt){try{Zl=0;var en=fl(Te,xe,Ie,mt);return il=null,en}catch(tn){if(tn===or||tn===eo)throw tn;var Ri=t(29,tn,null,Te.mode);return Ri.lanes=mt,Ri.return=Te,Ri}finally{}}}function wo(){for(var u=Xo,f=$l=Xo=0;f<u;){var y=Mr[f];Mr[f++]=null;var M=Mr[f];Mr[f++]=null;var R=Mr[f];Mr[f++]=null;var N=Mr[f];if(Mr[f++]=null,M!==null&&R!==null){var W=M.pending;W===null?R.next=R:(R.next=W.next,W.next=R),M.pending=R}N!==0&&Ir(y,R,N)}}function Br(u,f,y,M){Mr[Xo++]=u,Mr[Xo++]=f,Mr[Xo++]=y,Mr[Xo++]=M,$l|=M,u.lanes|=M,u=u.alternate,u!==null&&(u.lanes|=M)}function ys(u,f,y,M){return Br(u,f,y,M),gi(u)}function jt(u,f){return Br(u,null,null,f),gi(u)}function Ir(u,f,y){u.lanes|=y;var M=u.alternate;M!==null&&(M.lanes|=y);for(var R=!1,N=u.return;N!==null;)N.childLanes|=y,M=N.alternate,M!==null&&(M.childLanes|=y),N.tag===22&&(u=N.stateNode,u===null||u._visibility&1||(R=!0)),u=N,N=N.return;return u.tag===3?(N=u.stateNode,R&&f!==null&&(R=31-os(y),u=N.hiddenUpdates,M=u[R],M===null?u[R]=[f]:M.push(f),f.lane=y|536870912),N):null}function gi(u){if(50<Wn)throw Wn=0,mf=null,Error(r(185));for(var f=u.return;f!==null;)u=f,f=u.return;return u.tag===3?u.stateNode:null}function H(u){u.updateQueue={baseState:u.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Y(u,f){u=u.updateQueue,f.updateQueue===u&&(f.updateQueue={baseState:u.baseState,firstBaseUpdate:u.firstBaseUpdate,lastBaseUpdate:u.lastBaseUpdate,shared:u.shared,callbacks:null})}function oe(u){return{lane:u,tag:0,payload:null,callback:null,next:null}}function Se(u,f,y){var M=u.updateQueue;if(M===null)return null;if(M=M.shared,(Rn&2)!==0){var R=M.pending;return R===null?f.next=f:(f.next=R.next,R.next=f),M.pending=f,f=gi(u),Ir(u,null,y),f}return Br(u,M,f,y),gi(u)}function Le(u,f,y){if(f=f.updateQueue,f!==null&&(f=f.shared,(y&4194048)!==0)){var M=f.lanes;M&=u.pendingLanes,y|=M,f.lanes=y,P(u,y)}}function ke(u,f){var y=u.updateQueue,M=u.alternate;if(M!==null&&(M=M.updateQueue,y===M)){var R=null,N=null;if(y=y.firstBaseUpdate,y!==null){do{var W={lane:y.lane,tag:y.tag,payload:y.payload,callback:null,next:null};N===null?R=N=W:N=N.next=W,y=y.next}while(y!==null);N===null?R=N=f:N=N.next=f}else R=N=f;y={baseState:M.baseState,firstBaseUpdate:R,lastBaseUpdate:N,shared:M.shared,callbacks:M.callbacks},u.updateQueue=y;return}u=y.lastBaseUpdate,u===null?y.firstBaseUpdate=f:u.next=f,y.lastBaseUpdate=f}function it(){if(th){var u=sr;if(u!==null)throw u}}function Qe(u,f,y,M){th=!1;var R=u.updateQueue;Ts=!1;var N=R.firstBaseUpdate,W=R.lastBaseUpdate,ae=R.shared.pending;if(ae!==null){R.shared.pending=null;var Pe=ae,je=Pe.next;Pe.next=null,W===null?N=je:W.next=je,W=Pe;var xt=u.alternate;xt!==null&&(xt=xt.updateQueue,ae=xt.lastBaseUpdate,ae!==W&&(ae===null?xt.firstBaseUpdate=je:ae.next=je,xt.lastBaseUpdate=Pe))}if(N!==null){var st=R.baseState;W=0,xt=je=Pe=null,ae=N;do{var Lt=ae.lane&-536870913,dn=Lt!==ae.lane;if(dn?(Pn&Lt)===Lt:(M&Lt)===Lt){Lt!==0&&Lt===_a&&(th=!0),xt!==null&&(xt=xt.next={lane:0,tag:ae.tag,payload:ae.payload,callback:null,next:null});e:{var Gi=u,tc=ae;Lt=f;var fl=y;switch(tc.tag){case 1:if(Gi=tc.payload,typeof Gi=="function"){st=Gi.call(fl,st,Lt);break e}st=Gi;break e;case 3:Gi.flags=Gi.flags&-65537|128;case 0:if(Gi=tc.payload,Lt=typeof Gi=="function"?Gi.call(fl,st,Lt):Gi,Lt==null)break e;st=Rd({},st,Lt);break e;case 2:Ts=!0}}Lt=ae.callback,Lt!==null&&(u.flags|=64,dn&&(u.flags|=8192),dn=R.callbacks,dn===null?R.callbacks=[Lt]:dn.push(Lt))}else dn={lane:Lt,tag:ae.tag,payload:ae.payload,callback:ae.callback,next:null},xt===null?(je=xt=dn,Pe=st):xt=xt.next=dn,W|=Lt;if(ae=ae.next,ae===null){if(ae=R.shared.pending,ae===null)break;dn=ae,ae=dn.next,dn.next=null,R.lastBaseUpdate=dn,R.shared.pending=null}}while(!0);xt===null&&(Pe=st),R.baseState=Pe,R.firstBaseUpdate=je,R.lastBaseUpdate=xt,N===null&&(R.shared.lanes=0),Sa|=W,u.lanes=W,u.memoizedState=st}}function pt(u,f){if(typeof u!="function")throw Error(r(191,u));u.call(f)}function ft(u,f){var y=u.callbacks;if(y!==null)for(u.callbacks=null,u=0;u<y.length;u++)pt(y[u],f)}function yt(u,f){u=Jo,T(rl,u),T(Kl,f),Jo=u|f.baseLanes}function ct(){T(rl,Jo),T(Kl,Kl.current)}function q(){Jo=rl.current,b(Kl),b(rl)}function ne(u){var f=u.alternate;T(Pi,Pi.current&1),T(ls,u),us===null&&(f===null||Kl.current!==null||f.memoizedState!==null)&&(us=u)}function he(u){T(Pi,Pi.current),T(ls,u),us===null&&(us=u)}function ge(u){u.tag===22?(T(Pi,Pi.current),T(ls,u),us===null&&(us=u)):le()}function le(){T(Pi,Pi.current),T(ls,ls.current)}function Ge(u){b(ls),us===u&&(us=null),b(Pi)}function rt(u){for(var f=u;f!==null;){if(f.tag===13){var y=f.memoizedState;if(y!==null&&(y=y.dehydrated,y===null||ja(y)||kd(y)))return f}else if(f.tag===19&&(f.memoizedProps.revealOrder==="forwards"||f.memoizedProps.revealOrder==="backwards"||f.memoizedProps.revealOrder==="unstable_legacy-backwards"||f.memoizedProps.revealOrder==="together")){if((f.flags&128)!==0)return f}else if(f.child!==null){f.child.return=f,f=f.child;continue}if(f===u)break;for(;f.sibling===null;){if(f.return===null||f.return===u)return null;f=f.return}f.sibling.return=f.return,f=f.sibling}return null}function Xe(){throw Error(r(321))}function Mt(u,f){if(f===null)return!1;for(var y=0;y<f.length&&y<u.length;y++)if(!Bi(u[y],f[y]))return!1;return!0}function dt(u,f,y,M,R,N){return xa=N,mn=f,f.memoizedState=null,f.updateQueue=null,f.lanes=0,Kt.H=u===null||u.memoizedState===null?Ai:Yo,On=!1,N=y(M,R),On=!1,_n&&(N=gt(f,y,M,R)),Bt(u),N}function Bt(u){Kt.H=As;var f=Yt!==null&&Yt.next!==null;if(xa=0,ln=Yt=mn=null,bn=!1,to=0,fo=null,f)throw Error(r(300));u===null||vi||(u=u.dependencies,u!==null&&Gt(u)&&(vi=!0))}function gt(u,f,y,M){mn=u;var R=0;do{if(_n&&(fo=null),to=0,_n=!1,25<=R)throw Error(r(301));if(R+=1,ln=Yt=null,u.updateQueue!=null){var N=u.updateQueue;N.lastEffect=null,N.events=null,N.stores=null,N.memoCache!=null&&(N.memoCache.index=0)}Kt.H=sl,N=f(y,M)}while(_n);return N}function kt(){var u=Kt.H,f=u.useState()[0];return f=typeof f.then=="function"?At(f):f,u=u.useState()[0],(Yt!==null?Yt.memoizedState:null)!==u&&(mn.flags|=1024),f}function fn(){var u=Pr!==0;return Pr=0,u}function Xn(u,f,y){f.updateQueue=u.updateQueue,f.flags&=-2053,u.lanes&=~y}function yn(u){if(bn){for(u=u.memoizedState;u!==null;){var f=u.queue;f!==null&&(f.pending=null),u=u.next}bn=!1}xa=0,ln=Yt=mn=null,_n=!1,to=Pr=0,fo=null}function Ut(){var u={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ln===null?mn.memoizedState=ln=u:ln=ln.next=u,ln}function lt(){if(Yt===null){var u=mn.alternate;u=u!==null?u.memoizedState:null}else u=Yt.next;var f=ln===null?mn.memoizedState:ln.next;if(f!==null)ln=f,Yt=u;else{if(u===null)throw mn.alternate===null?Error(r(467)):Error(r(310));Yt=u,u={memoizedState:Yt.memoizedState,baseState:Yt.baseState,baseQueue:Yt.baseQueue,queue:Yt.queue,next:null},ln===null?mn.memoizedState=ln=u:ln=ln.next=u}return ln}function qt(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function At(u){var f=to;return to+=1,fo===null&&(fo=[]),u=nn(fo,u,f),f=mn,(ln===null?f.memoizedState:ln.next)===null&&(f=f.alternate,Kt.H=f===null||f.memoizedState===null?Ai:Yo),u}function qn(u){if(u!==null&&typeof u=="object"){if(typeof u.then=="function")return At(u);if(u.$$typeof===Xs)return K(u)}throw Error(r(438,String(u)))}function er(u){var f=null,y=mn.updateQueue;if(y!==null&&(f=y.memoCache),f==null){var M=mn.alternate;M!==null&&(M=M.updateQueue,M!==null&&(M=M.memoCache,M!=null&&(f={data:M.data.map(function(R){return R.slice()}),index:0})))}if(f==null&&(f={data:[],index:0}),y===null&&(y=qt(),mn.updateQueue=y),y.memoCache=f,y=f.data[f.index],y===void 0)for(y=f.data[f.index]=Array(u),M=0;M<u;M++)y[M]=zp;return f.index++,y}function An(u,f){return typeof f=="function"?f(u):f}function yi(u){var f=lt();return Jn(f,Yt,u)}function Jn(u,f,y){var M=u.queue;if(M===null)throw Error(r(311));M.lastRenderedReducer=y;var R=u.baseQueue,N=M.pending;if(N!==null){if(R!==null){var W=R.next;R.next=N.next,N.next=W}f.baseQueue=R=N,M.pending=null}if(N=u.baseState,R===null)u.memoizedState=N;else{f=R.next;var ae=W=null,Pe=null,je=f,xt=!1;do{var st=je.lane&-536870913;if(st!==je.lane?(Pn&st)===st:(xa&st)===st){var Lt=je.revertLane;if(Lt===0)Pe!==null&&(Pe=Pe.next={lane:0,revertLane:0,gesture:null,action:je.action,hasEagerState:je.hasEagerState,eagerState:je.eagerState,next:null}),st===_a&&(xt=!0);else if((xa&Lt)===Lt){je=je.next,Lt===_a&&(xt=!0);continue}else st={lane:0,revertLane:je.revertLane,gesture:null,action:je.action,hasEagerState:je.hasEagerState,eagerState:je.eagerState,next:null},Pe===null?(ae=Pe=st,W=N):Pe=Pe.next=st,mn.lanes|=Lt,Sa|=Lt;st=je.action,On&&y(N,st),N=je.hasEagerState?je.eagerState:y(N,st)}else Lt={lane:st,revertLane:je.revertLane,gesture:je.gesture,action:je.action,hasEagerState:je.hasEagerState,eagerState:je.eagerState,next:null},Pe===null?(ae=Pe=Lt,W=N):Pe=Pe.next=Lt,mn.lanes|=st,Sa|=st;je=je.next}while(je!==null&&je!==f);if(Pe===null?W=N:Pe.next=ae,!Bi(N,u.memoizedState)&&(vi=!0,xt&&(y=sr,y!==null)))throw y;u.memoizedState=N,u.baseState=W,u.baseQueue=Pe,M.lastRenderedState=N}return R===null&&(M.lanes=0),[u.memoizedState,M.dispatch]}function tr(u){var f=lt(),y=f.queue;if(y===null)throw Error(r(311));y.lastRenderedReducer=u;var M=y.dispatch,R=y.pending,N=f.memoizedState;if(R!==null){y.pending=null;var W=R=R.next;do N=u(N,W.action),W=W.next;while(W!==R);Bi(N,f.memoizedState)||(vi=!0),f.memoizedState=N,f.baseQueue===null&&(f.baseState=N),y.lastRenderedState=N}return[N,M]}function Xi(u,f,y){var M=mn,R=lt(),N=Un;if(N){if(y===void 0)throw Error(r(407));y=y()}else y=f();var W=!Bi((Yt||R).memoizedState,y);if(W&&(R.memoizedState=y,vi=!0),R=R.queue,Su(wl.bind(null,M,R,u),[u]),R.getSnapshot!==f||W||ln!==null&&ln.memoizedState.tag&1){if(M.flags|=2048,_s(9,{destroy:void 0},fr.bind(null,M,R,y,f),null),Mn===null)throw Error(r(349));N||(xa&127)!==0||cr(M,f,y)}return y}function cr(u,f,y){u.flags|=16384,u={getSnapshot:f,value:y},f=mn.updateQueue,f===null?(f=qt(),mn.updateQueue=f,f.stores=[u]):(y=f.stores,y===null?f.stores=[u]:y.push(u))}function fr(u,f,y,M){f.value=y,f.getSnapshot=M,zs(f)&&t0(u)}function wl(u,f,y){return y(function(){zs(f)&&t0(u)})}function zs(u){var f=u.getSnapshot;u=u.value;try{var y=f();return!Bi(u,y)}catch{return!0}}function t0(u){var f=jt(u,2);f!==null&&Ei(f,u,2)}function cp(u){var f=Ut();if(typeof u=="function"){var y=u;if(u=y(),On){ee(!0);try{y()}finally{ee(!1)}}}return f.memoizedState=f.baseState=u,f.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:An,lastRenderedState:u},f}function Ic(u,f,y,M){return u.baseState=y,Jn(u,Yt,typeof M=="function"?M:An)}function oa(u,f,y,M,R){if(ud(u))throw Error(r(485));if(u=f.action,u!==null){var N={payload:R,action:u,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(W){N.listeners.push(W)}};Kt.T!==null?y(!0):N.isTransition=!1,M(N),y=f.pending,y===null?(N.next=f.pending=N,nd(f,N)):(N.next=y.next,f.pending=y.next=N)}}function nd(u,f){var y=f.action,M=f.payload,R=u.state;if(f.isTransition){var N=Kt.T,W={};Kt.T=W;try{var ae=y(R,M),Pe=Kt.S;Pe!==null&&Pe(W,ae),id(u,f,ae)}catch(je){Oa(u,f,je)}finally{N!==null&&W.types!==null&&(N.types=W.types),Kt.T=N}}else try{N=y(R,M),id(u,f,N)}catch(je){Oa(u,f,je)}}function id(u,f,y){y!==null&&typeof y=="object"&&typeof y.then=="function"?y.then(function(M){Cl(u,f,M)},function(M){return Oa(u,f,M)}):Cl(u,f,y)}function Cl(u,f,y){f.status="fulfilled",f.value=y,fp(f),u.state=y,f=u.pending,f!==null&&(y=f.next,y===f?u.pending=null:(y=y.next,f.next=y,nd(u,y)))}function Oa(u,f,y){var M=u.pending;if(u.pending=null,M!==null){M=M.next;do f.status="rejected",f.reason=y,fp(f),f=f.next;while(f!==M)}u.action=null}function fp(u){u=u.listeners;for(var f=0;f<u.length;f++)(0,u[f])()}function rd(u,f){return f}function dp(u,f){if(Un){var y=Mn.formState;if(y!==null){e:{var M=mn;if(Un){if(Si){var R=Z0(Si,Xr);if(R){Si=$0(R),M=rm(R);break e}}bt(M)}M=!1}M&&(f=y[0])}}y=Ut(),y.memoizedState=y.baseState=f,M={pending:null,lanes:0,dispatch:null,lastRenderedReducer:rd,lastRenderedState:f},y.queue=M,y=a0.bind(null,mn,M),M.dispatch=y,M=cp(!1);var N=ld.bind(null,mn,!1,M.queue);return M=Ut(),R={state:f,dispatch:null,action:u,pending:null},M.queue=R,y=oa.bind(null,mn,R,N,y),R.dispatch=y,M.memoizedState=u,[f,y,!1]}function _u(u){var f=lt();return Co(f,Yt,u)}function Co(u,f,y){if(f=Jn(u,f,rd)[0],u=yi(An)[0],typeof f=="object"&&f!==null&&typeof f.then=="function")try{var M=At(f)}catch(W){throw W===or?eo:W}else M=f;f=lt();var R=f.queue,N=R.dispatch;return y!==f.memoizedState&&(mn.flags|=2048,_s(9,{destroy:void 0},hp.bind(null,R,y),null)),[M,N,u]}function hp(u,f){u.action=f}function xu(u){var f=lt(),y=Yt;if(y!==null)return Co(f,y,u);lt(),f=f.memoizedState,y=lt();var M=y.queue.dispatch;return y.memoizedState=u,[f,M,!1]}function _s(u,f,y,M){return u={tag:u,create:y,deps:M,inst:f,next:null},f=mn.updateQueue,f===null&&(f=qt(),mn.updateQueue=f),y=f.lastEffect,y===null?f.lastEffect=u.next=u:(M=y.next,y.next=u,u.next=M,f.lastEffect=u),u}function sd(){return lt().memoizedState}function Rl(u,f,y,M){var R=Ut();mn.flags|=u,R.memoizedState=_s(1|f,{destroy:void 0},y,M===void 0?null:M)}function Nc(u,f,y,M){var R=lt();M=M===void 0?null:M;var N=R.memoizedState.inst;Yt!==null&&M!==null&&Mt(M,Yt.memoizedState.deps)?R.memoizedState=_s(f,N,y,M):(mn.flags|=u,R.memoizedState=_s(1|f,N,y,M))}function Dc(u,f){Rl(8390656,8,u,f)}function Su(u,f){Nc(2048,8,u,f)}function n0(u){mn.flags|=4;var f=mn.updateQueue;if(f===null)f=qt(),mn.updateQueue=f,f.events=[u];else{var y=f.events;y===null?f.events=[u]:y.push(u)}}function Vr(u){var f=lt().memoizedState;return n0({ref:f,nextImpl:u}),function(){if((Rn&2)!==0)throw Error(r(440));return f.impl.apply(void 0,arguments)}}function za(u,f){return Nc(4,2,u,f)}function Uc(u,f){return Nc(4,4,u,f)}function bu(u,f){if(typeof f=="function"){u=u();var y=f(u);return function(){typeof y=="function"?y():f(null)}}if(f!=null)return u=u(),f.current=u,function(){f.current=null}}function i0(u,f,y){y=y!=null?y.concat([u]):null,Nc(4,4,bu.bind(null,f,u),y)}function Pc(){}function od(u,f){var y=lt();f=f===void 0?null:f;var M=y.memoizedState;return f!==null&&Mt(f,M[1])?M[0]:(y.memoizedState=[u,f],u)}function Mu(u,f){var y=lt();f=f===void 0?null:f;var M=y.memoizedState;if(f!==null&&Mt(f,M[1]))return M[0];if(M=u(),On){ee(!0);try{u()}finally{ee(!1)}}return y.memoizedState=[M,f],M}function Eu(u,f,y){return y===void 0||(xa&1073741824)!==0&&(Pn&261930)===0?u.memoizedState=f:(u.memoizedState=y,u=ua(),mn.lanes|=u,Sa|=u,y)}function pp(u,f,y,M){return Bi(y,f)?y:Kl.current!==null?(u=Eu(u,y,M),Bi(u,f)||(vi=!0),u):(xa&42)===0||(xa&1073741824)!==0&&(Pn&261930)===0?(vi=!0,u.memoizedState=y):(u=ua(),mn.lanes|=u,Sa|=u,f)}function r0(u,f,y,M,R){var N=Ys();Dn(N!==0&&8>N?N:8);var W=Kt.T,ae={};Kt.T=ae,ld(u,!1,f,y);try{var Pe=R(),je=Kt.S;if(je!==null&&je(ae,Pe),Pe!==null&&typeof Pe=="object"&&typeof Pe.then=="function"){var xt=Ce(Pe,M);Lc(u,f,xt,_i(u))}else Lc(u,f,M,_i(u))}catch(st){Lc(u,f,{then:function(){},status:"rejected",reason:st},_i())}finally{Dn(N),W!==null&&ae.types!==null&&(W.types=ae.types),Kt.T=W}}function s0(u){var f=u.memoizedState;if(f!==null)return f;f={memoizedState:Gl,baseState:Gl,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:An,lastRenderedState:Gl},next:null};var y={};return f.next={memoizedState:y,baseState:y,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:An,lastRenderedState:y},next:null},u.memoizedState=f,u=u.alternate,u!==null&&(u.memoizedState=f),f}function mp(){return K(ql)}function ad(){return lt().memoizedState}function o0(){return lt().memoizedState}function Qx(u){for(var f=u.return;f!==null;){switch(f.tag){case 24:case 3:var y=_i();u=oe(y);var M=Se(f,u,y);M!==null&&(Ei(M,f,y),Le(M,f,y)),f={cache:De()},u.payload=f;return}f=f.return}}function jx(u,f,y){var M=_i();y={lane:M,revertLane:0,gesture:null,action:y,hasEagerState:!1,eagerState:null,next:null},ud(u)?l0(f,y):(y=ys(u,f,y,M),y!==null&&(Ei(y,u,M),u0(y,f,M)))}function a0(u,f,y){var M=_i();Lc(u,f,y,M)}function Lc(u,f,y,M){var R={lane:M,revertLane:0,gesture:null,action:y,hasEagerState:!1,eagerState:null,next:null};if(ud(u))l0(f,R);else{var N=u.alternate;if(u.lanes===0&&(N===null||N.lanes===0)&&(N=f.lastRenderedReducer,N!==null))try{var W=f.lastRenderedState,ae=N(W,y);if(R.hasEagerState=!0,R.eagerState=ae,Bi(ae,W))return Br(u,f,R,0),Mn===null&&wo(),!1}catch{}finally{}if(y=ys(u,f,R,M),y!==null)return Ei(y,u,M),u0(y,f,M),!0}return!1}function ld(u,f,y,M){if(M={lane:2,revertLane:at(),gesture:null,action:M,hasEagerState:!1,eagerState:null,next:null},ud(u)){if(f)throw Error(r(479))}else f=ys(u,y,M,2),f!==null&&Ei(f,u,2)}function ud(u){var f=u.alternate;return u===mn||f!==null&&f===mn}function l0(u,f){_n=bn=!0;var y=u.pending;y===null?f.next=f:(f.next=y.next,y.next=f),u.pending=f}function u0(u,f,y){if((y&4194048)!==0){var M=f.lanes;M&=u.pendingLanes,y|=M,f.lanes=y,P(u,y)}}function gp(u,f,y,M){f=u.memoizedState,y=y(M,f),y=y==null?f:Rd({},f,y),u.memoizedState=y,u.lanes===0&&(u.updateQueue.baseState=y)}function cd(u,f,y,M,R,N,W){return u=u.stateNode,typeof u.shouldComponentUpdate=="function"?u.shouldComponentUpdate(M,N,W):f.prototype&&f.prototype.isPureReactComponent?!He(y,M)||!He(R,N):!0}function c0(u,f,y,M){u=f.state,typeof f.componentWillReceiveProps=="function"&&f.componentWillReceiveProps(y,M),typeof f.UNSAFE_componentWillReceiveProps=="function"&&f.UNSAFE_componentWillReceiveProps(y,M),f.state!==u&&cf.enqueueReplaceState(f,f.state,null)}function Il(u,f){var y=f;if("ref"in f){y={};for(var M in f)M!=="ref"&&(y[M]=f[M])}if(u=u.defaultProps){y===f&&(y=Rd({},y));for(var R in u)y[R]===void 0&&(y[R]=u[R])}return y}function fd(u,f){try{var y=u.onUncaughtError;y(f.value,{componentStack:f.stack})}catch(M){setTimeout(function(){throw M})}}function vp(u,f,y){try{var M=u.onCaughtError;M(y.value,{componentStack:y.stack,errorBoundary:f.tag===1?f.stateNode:null})}catch(R){setTimeout(function(){throw R})}}function yp(u,f,y){return y=oe(y),y.tag=3,y.payload={element:null},y.callback=function(){fd(u,f)},y}function f0(u){return u=oe(u),u.tag=3,u}function d0(u,f,y,M){var R=y.type.getDerivedStateFromError;if(typeof R=="function"){var N=M.value;u.payload=function(){return R(N)},u.callback=function(){vp(f,y,M)}}var W=y.stateNode;W!==null&&typeof W.componentDidCatch=="function"&&(u.callback=function(){vp(f,y,M),typeof R!="function"&&(ba===null?ba=new Set([this]):ba.add(this));var ae=M.stack;this.componentDidCatch(M.value,{componentStack:ae!==null?ae:""})})}function eS(u,f,y,M,R){if(y.flags|=32768,M!==null&&typeof M=="object"&&typeof M.then=="function"){if(f=y.alternate,f!==null&&Et(f,y,R,!0),y=ls.current,y!==null){switch(y.tag){case 31:case 13:return us===null?Lu():y.alternate===null&&Ci===0&&(Ci=3),y.flags&=-257,y.flags|=65536,y.lanes=R,M===Wo?y.flags|=16384:(f=y.updateQueue,f===null?y.updateQueue=new Set([M]):f.add(M),Ou(u,M,R)),!1;case 22:return y.flags|=65536,M===Wo?y.flags|=16384:(f=y.updateQueue,f===null?(f={transitions:null,markerInstances:null,retryQueue:new Set([M])},y.updateQueue=f):(y=f.retryQueue,y===null?f.retryQueue=new Set([M]):y.add(M)),Ou(u,M,R)),!1}throw Error(r(435,y.tag))}return Ou(u,M,R),Lu(),!1}if(Un)return f=ls.current,f!==null?((f.flags&65536)===0&&(f.flags|=256),f.flags|=65536,f.lanes=R,M!==Qd&&(u=Error(r(422),{cause:M}),et(Ue(u,y)))):(M!==Qd&&(f=Error(r(423),{cause:M}),et(Ue(f,y))),u=u.current.alternate,u.flags|=65536,R&=-R,u.lanes|=R,M=Ue(M,y),R=yp(u.stateNode,M,R),ke(u,R),Ci!==4&&(Ci=2)),!1;var N=Error(r(520),{cause:M});if(N=Ue(N,y),df===null?df=[N]:df.push(N),Ci!==4&&(Ci=2),f===null)return!0;M=Ue(M,y),y=f;do{switch(y.tag){case 3:return y.flags|=65536,u=R&-R,y.lanes|=u,u=yp(y.stateNode,M,u),ke(y,u),!1;case 1:if(f=y.type,N=y.stateNode,(y.flags&128)===0&&(typeof f.getDerivedStateFromError=="function"||N!==null&&typeof N.componentDidCatch=="function"&&(ba===null||!ba.has(N))))return y.flags|=65536,R&=-R,y.lanes|=R,R=f0(R),d0(R,u,y,M),ke(y,R),!1}y=y.return}while(y!==null);return!1}function _r(u,f,y,M){f.child=u===null?bm(f,null,y,M):br(f,u.child,y,M)}function h0(u,f,y,M,R){y=y.render;var N=f.ref;if("ref"in M){var W={};for(var ae in M)ae!=="ref"&&(W[ae]=M[ae])}else W=M;return ut(f),M=dt(u,f,y,W,N,R),ae=fn(),u!==null&&!vi?(Xn(u,f,R),Ro(u,f,R)):(Un&&ae&&ce(f),f.flags|=1,_r(u,f,M,R),f.child)}function p0(u,f,y,M,R){if(u===null){var N=y.type;return typeof N=="function"&&!Ll(N)&&N.defaultProps===void 0&&y.compare===null?(f.tag=15,f.type=N,m0(u,f,N,M,R)):(u=da(y.type,null,M,f,f.mode,R),u.ref=f.ref,u.return=f,f.child=u)}if(N=u.child,!kc(u,R)){var W=N.memoizedProps;if(y=y.compare,y=y!==null?y:He,y(W,M)&&u.ref===f.ref)return Ro(u,f,R)}return f.flags|=1,u=bs(N,M),u.ref=f.ref,u.return=f,f.child=u}function m0(u,f,y,M,R){if(u!==null){var N=u.memoizedProps;if(He(N,M)&&u.ref===f.ref)if(vi=!1,f.pendingProps=M=N,kc(u,R))(u.flags&131072)!==0&&(vi=!0);else return f.lanes=u.lanes,Ro(u,f,R)}return hd(u,f,y,M,R)}function g0(u,f,y,M){var R=M.children,N=u!==null?u.memoizedState:null;if(u===null&&f.stateNode===null&&(f.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),M.mode==="hidden"){if((f.flags&128)!==0){if(N=N!==null?N.baseLanes|y:y,u!==null){for(M=f.child=u.child,R=0;M!==null;)R=R|M.lanes|M.childLanes,M=M.sibling;M=R&~N}else M=0,f.child=null;return Tu(u,f,N,y,M)}if((y&536870912)!==0)f.memoizedState={baseLanes:0,cachePool:null},u!==null&&wt(f,N!==null?N.cachePool:null),N!==null?yt(f,N):ct(),ge(f);else return M=f.lanes=536870912,Tu(u,f,N!==null?N.baseLanes|y:y,y,M)}else N!==null?(wt(f,N.cachePool),yt(f,N),le(),f.memoizedState=null):(u!==null&&wt(f,null),ct(),le());return _r(u,f,R,y),f.child}function Nl(u,f){return u!==null&&u.tag===22||f.stateNode!==null||(f.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),f.sibling}function Tu(u,f,y,M,R){var N=nt();return N=N===null?null:{parent:Oi?bi._currentValue:bi._currentValue2,pool:N},f.memoizedState={baseLanes:y,cachePool:N},u!==null&&wt(f,null),ct(),ge(f),u!==null&&Et(u,f,M,!0),f.childLanes=R,null}function dd(u,f){return f=Ba({mode:f.mode,children:f.children},u.mode),f.ref=u.ref,u.child=f,f.return=u,f}function _p(u,f,y){return br(f,u.child,null,y),u=dd(f,f.pendingProps),u.flags|=2,Ge(f),f.memoizedState=null,u}function v0(u,f,y){var M=f.pendingProps,R=(f.flags&128)!==0;if(f.flags&=-129,u===null){if(Un){if(M.mode==="hidden")return u=dd(f,M),f.lanes=536870912,Nl(null,u);if(he(f),(u=Si)?(u=om(u,Xr),u!==null&&(f.memoizedState={dehydrated:u,treeContext:$s!==null?{id:xr,overflow:uo}:null,retryLane:536870912,hydrationErrors:null},y=Fp(u),y.return=f,f.child=y,rr=f,Si=null)):u=null,u===null)throw bt(f);return f.lanes=536870912,null}return dd(f,M)}var N=u.memoizedState;if(N!==null){var W=N.dehydrated;if(he(f),R)if(f.flags&256)f.flags&=-257,f=_p(u,f,y);else if(f.memoizedState!==null)f.child=u.child,f.flags|=128,f=null;else throw Error(r(558));else if(vi||Et(u,f,y,!1),R=(y&u.childLanes)!==0,vi||R){if(M=Mn,M!==null&&(W=O(M,y),W!==0&&W!==N.retryLane))throw N.retryLane=W,jt(u,W),Ei(M,u,W),Jr;Lu(),f=_p(u,f,y)}else u=N.treeContext,xi&&(Si=ev(W),rr=f,Un=!0,qo=null,Xr=!1,u!==null&&Be(f,u)),f=dd(f,M),f.flags|=4096;return f}return u=bs(u.child,{mode:M.mode,children:M.children}),u.ref=f.ref,f.child=u,u.return=f,u}function Fc(u,f){var y=f.ref;if(y===null)u!==null&&u.ref!==null&&(f.flags|=4194816);else{if(typeof y!="function"&&typeof y!="object")throw Error(r(284));(u===null||u.ref!==y)&&(f.flags|=4194816)}}function hd(u,f,y,M,R){return ut(f),y=dt(u,f,y,M,void 0,R),M=fn(),u!==null&&!vi?(Xn(u,f,R),Ro(u,f,R)):(Un&&M&&ce(f),f.flags|=1,_r(u,f,y,R),f.child)}function xp(u,f,y,M,R,N){return ut(f),f.updateQueue=null,y=gt(f,M,y,R),Bt(u),M=fn(),u!==null&&!vi?(Xn(u,f,N),Ro(u,f,N)):(Un&&M&&ce(f),f.flags|=1,_r(u,f,y,N),f.child)}function Dl(u,f,y,M,R){if(ut(f),f.stateNode===null){var N=Vo,W=y.contextType;typeof W=="object"&&W!==null&&(N=K(W)),N=new y(M,N),f.memoizedState=N.state!==null&&N.state!==void 0?N.state:null,N.updater=cf,f.stateNode=N,N._reactInternals=f,N=f.stateNode,N.props=M,N.state=f.memoizedState,N.refs={},H(f),W=y.contextType,N.context=typeof W=="object"&&W!==null?K(W):Vo,N.state=f.memoizedState,W=y.getDerivedStateFromProps,typeof W=="function"&&(gp(f,y,W,M),N.state=f.memoizedState),typeof y.getDerivedStateFromProps=="function"||typeof N.getSnapshotBeforeUpdate=="function"||typeof N.UNSAFE_componentWillMount!="function"&&typeof N.componentWillMount!="function"||(W=N.state,typeof N.componentWillMount=="function"&&N.componentWillMount(),typeof N.UNSAFE_componentWillMount=="function"&&N.UNSAFE_componentWillMount(),W!==N.state&&cf.enqueueReplaceState(N,N.state,null),Qe(f,M,N,R),it(),N.state=f.memoizedState),typeof N.componentDidMount=="function"&&(f.flags|=4194308),M=!0}else if(u===null){N=f.stateNode;var ae=f.memoizedProps,Pe=Il(y,ae);N.props=Pe;var je=N.context,xt=y.contextType;W=Vo,typeof xt=="object"&&xt!==null&&(W=K(xt));var st=y.getDerivedStateFromProps;xt=typeof st=="function"||typeof N.getSnapshotBeforeUpdate=="function",ae=f.pendingProps!==ae,xt||typeof N.UNSAFE_componentWillReceiveProps!="function"&&typeof N.componentWillReceiveProps!="function"||(ae||je!==W)&&c0(f,N,M,W),Ts=!1;var Lt=f.memoizedState;N.state=Lt,Qe(f,M,N,R),it(),je=f.memoizedState,ae||Lt!==je||Ts?(typeof st=="function"&&(gp(f,y,st,M),je=f.memoizedState),(Pe=Ts||cd(f,y,Pe,M,Lt,je,W))?(xt||typeof N.UNSAFE_componentWillMount!="function"&&typeof N.componentWillMount!="function"||(typeof N.componentWillMount=="function"&&N.componentWillMount(),typeof N.UNSAFE_componentWillMount=="function"&&N.UNSAFE_componentWillMount()),typeof N.componentDidMount=="function"&&(f.flags|=4194308)):(typeof N.componentDidMount=="function"&&(f.flags|=4194308),f.memoizedProps=M,f.memoizedState=je),N.props=M,N.state=je,N.context=W,M=Pe):(typeof N.componentDidMount=="function"&&(f.flags|=4194308),M=!1)}else{N=f.stateNode,Y(u,f),W=f.memoizedProps,xt=Il(y,W),N.props=xt,st=f.pendingProps,Lt=N.context,je=y.contextType,Pe=Vo,typeof je=="object"&&je!==null&&(Pe=K(je)),ae=y.getDerivedStateFromProps,(je=typeof ae=="function"||typeof N.getSnapshotBeforeUpdate=="function")||typeof N.UNSAFE_componentWillReceiveProps!="function"&&typeof N.componentWillReceiveProps!="function"||(W!==st||Lt!==Pe)&&c0(f,N,M,Pe),Ts=!1,Lt=f.memoizedState,N.state=Lt,Qe(f,M,N,R),it();var dn=f.memoizedState;W!==st||Lt!==dn||Ts||u!==null&&u.dependencies!==null&&Gt(u.dependencies)?(typeof ae=="function"&&(gp(f,y,ae,M),dn=f.memoizedState),(xt=Ts||cd(f,y,xt,M,Lt,dn,Pe)||u!==null&&u.dependencies!==null&&Gt(u.dependencies))?(je||typeof N.UNSAFE_componentWillUpdate!="function"&&typeof N.componentWillUpdate!="function"||(typeof N.componentWillUpdate=="function"&&N.componentWillUpdate(M,dn,Pe),typeof N.UNSAFE_componentWillUpdate=="function"&&N.UNSAFE_componentWillUpdate(M,dn,Pe)),typeof N.componentDidUpdate=="function"&&(f.flags|=4),typeof N.getSnapshotBeforeUpdate=="function"&&(f.flags|=1024)):(typeof N.componentDidUpdate!="function"||W===u.memoizedProps&&Lt===u.memoizedState||(f.flags|=4),typeof N.getSnapshotBeforeUpdate!="function"||W===u.memoizedProps&&Lt===u.memoizedState||(f.flags|=1024),f.memoizedProps=M,f.memoizedState=dn),N.props=M,N.state=dn,N.context=Pe,M=xt):(typeof N.componentDidUpdate!="function"||W===u.memoizedProps&&Lt===u.memoizedState||(f.flags|=4),typeof N.getSnapshotBeforeUpdate!="function"||W===u.memoizedProps&&Lt===u.memoizedState||(f.flags|=1024),M=!1)}return N=M,Fc(u,f),M=(f.flags&128)!==0,N||M?(N=f.stateNode,y=M&&typeof y.getDerivedStateFromError!="function"?null:N.render(),f.flags|=1,u!==null&&M?(f.child=br(f,u.child,null,R),f.child=br(f,null,y,R)):_r(u,f,y,R),f.memoizedState=N.state,u=f.child):u=Ro(u,f,R),u}function y0(u,f,y,M){return Zt(),f.flags|=256,_r(u,f,y,M),f.child}function Sp(u){return{baseLanes:u,cachePool:tt()}}function bp(u,f,y){return u=u!==null?u.childLanes&~y:0,f&&(u|=Zr),u}function Mp(u,f,y){var M=f.pendingProps,R=!1,N=(f.flags&128)!==0,W;if((W=N)||(W=u!==null&&u.memoizedState===null?!1:(Pi.current&2)!==0),W&&(R=!0,f.flags&=-129),W=(f.flags&32)!==0,f.flags&=-33,u===null){if(Un){if(R?ne(f):le(),(u=Si)?(u=rv(u,Xr),u!==null&&(f.memoizedState={dehydrated:u,treeContext:$s!==null?{id:xr,overflow:uo}:null,retryLane:536870912,hydrationErrors:null},y=Fp(u),y.return=f,f.child=y,rr=f,Si=null)):u=null,u===null)throw bt(f);return kd(u)?f.lanes=32:f.lanes=536870912,null}var ae=M.children;return M=M.fallback,R?(le(),R=f.mode,ae=Ba({mode:"hidden",children:ae},R),M=Ws(M,R,y,null),ae.return=f,M.return=f,ae.sibling=M,f.child=ae,M=f.child,M.memoizedState=Sp(y),M.childLanes=bp(u,W,y),f.memoizedState=Ql,Nl(null,M)):(ne(f),pd(f,ae))}var Pe=u.memoizedState;if(Pe!==null&&(ae=Pe.dehydrated,ae!==null)){if(N)f.flags&256?(ne(f),f.flags&=-257,f=Ul(u,f,y)):f.memoizedState!==null?(le(),f.child=u.child,f.flags|=128,f=null):(le(),ae=M.fallback,R=f.mode,M=Ba({mode:"visible",children:M.children},R),ae=Ws(ae,R,y,null),ae.flags|=2,M.return=f,ae.return=f,M.sibling=ae,f.child=M,br(f,u.child,null,y),M=f.child,M.memoizedState=Sp(y),M.childLanes=bp(u,W,y),f.memoizedState=Ql,f=Nl(null,M));else if(ne(f),kd(ae))W=Od(ae).digest,M=Error(r(419)),M.stack="",M.digest=W,et({value:M,source:null,stack:null}),f=Ul(u,f,y);else if(vi||Et(u,f,y,!1),W=(y&u.childLanes)!==0,vi||W){if(W=Mn,W!==null&&(M=O(W,y),M!==0&&M!==Pe.retryLane))throw Pe.retryLane=M,jt(u,M),Ei(W,u,M),Jr;ja(ae)||Lu(),f=Ul(u,f,y)}else ja(ae)?(f.flags|=192,f.child=u.child,f=null):(u=Pe.treeContext,xi&&(Si=tv(ae),rr=f,Un=!0,qo=null,Xr=!1,u!==null&&Be(f,u)),f=pd(f,M.children),f.flags|=4096);return f}return R?(le(),ae=M.fallback,R=f.mode,Pe=u.child,N=Pe.sibling,M=bs(Pe,{mode:"hidden",children:M.children}),M.subtreeFlags=Pe.subtreeFlags&65011712,N!==null?ae=bs(N,ae):(ae=Ws(ae,R,y,null),ae.flags|=2),ae.return=f,M.return=f,M.sibling=ae,f.child=M,Nl(null,M),M=f.child,ae=u.child.memoizedState,ae===null?ae=Sp(y):(R=ae.cachePool,R!==null?(Pe=Oi?bi._currentValue:bi._currentValue2,R=R.parent!==Pe?{parent:Pe,pool:Pe}:R):R=tt(),ae={baseLanes:ae.baseLanes|y,cachePool:R}),M.memoizedState=ae,M.childLanes=bp(u,W,y),f.memoizedState=Ql,Nl(u.child,M)):(ne(f),y=u.child,u=y.sibling,y=bs(y,{mode:"visible",children:M.children}),y.return=f,y.sibling=null,u!==null&&(W=f.deletions,W===null?(f.deletions=[u],f.flags|=16):W.push(u)),f.child=y,f.memoizedState=null,y)}function pd(u,f){return f=Ba({mode:"visible",children:f},u.mode),f.return=u,u.child=f}function Ba(u,f){return u=t(22,u,null,f),u.lanes=0,u}function Ul(u,f,y){return br(f,u.child,null,y),u=pd(f,f.pendingProps.children),u.flags|=2,f.memoizedState=null,u}function _0(u,f,y){u.lanes|=f;var M=u.alternate;M!==null&&(M.lanes|=f),j(u.return,f,y)}function Au(u,f,y,M,R,N){var W=u.memoizedState;W===null?u.memoizedState={isBackwards:f,rendering:null,renderingStartTime:0,last:M,tail:y,tailMode:R,treeForkCount:N}:(W.isBackwards=f,W.rendering=null,W.renderingStartTime=0,W.last=M,W.tail=y,W.tailMode=R,W.treeForkCount=N)}function Ep(u,f,y){var M=f.pendingProps,R=M.revealOrder,N=M.tail;M=M.children;var W=Pi.current,ae=(W&2)!==0;if(ae?(W=W&1|2,f.flags|=128):W&=1,T(Pi,W),_r(u,f,M,y),M=Un?af:0,!ae&&u!==null&&(u.flags&128)!==0)e:for(u=f.child;u!==null;){if(u.tag===13)u.memoizedState!==null&&_0(u,y,f);else if(u.tag===19)_0(u,y,f);else if(u.child!==null){u.child.return=u,u=u.child;continue}if(u===f)break e;for(;u.sibling===null;){if(u.return===null||u.return===f)break e;u=u.return}u.sibling.return=u.return,u=u.sibling}switch(R){case"forwards":for(y=f.child,R=null;y!==null;)u=y.alternate,u!==null&&rt(u)===null&&(R=y),y=y.sibling;y=R,y===null?(R=f.child,f.child=null):(R=y.sibling,y.sibling=null),Au(f,!1,R,y,N,M);break;case"backwards":case"unstable_legacy-backwards":for(y=null,R=f.child,f.child=null;R!==null;){if(u=R.alternate,u!==null&&rt(u)===null){f.child=R;break}u=R.sibling,R.sibling=y,y=R,R=u}Au(f,!0,y,null,N,M);break;case"together":Au(f,!1,null,null,void 0,M);break;default:f.memoizedState=null}return f.child}function Ro(u,f,y){if(u!==null&&(f.dependencies=u.dependencies),Sa|=f.lanes,(y&f.childLanes)===0)if(u!==null){if(Et(u,f,y,!1),(y&f.childLanes)===0)return null}else return null;if(u!==null&&f.child!==u.child)throw Error(r(153));if(f.child!==null){for(u=f.child,y=bs(u,u.pendingProps),f.child=y,y.return=f;u.sibling!==null;)u=u.sibling,y=y.sibling=bs(u,u.pendingProps),y.return=f;y.sibling=null}return f.child}function kc(u,f){return(u.lanes&f)!==0?!0:(u=u.dependencies,!!(u!==null&&Gt(u)))}function Tp(u,f,y){switch(f.tag){case 3:St(f,f.stateNode.containerInfo),qe(f,bi,u.memoizedState.cache),Zt();break;case 27:case 5:Re(f);break;case 4:St(f,f.stateNode.containerInfo);break;case 10:qe(f,f.type,f.memoizedProps.value);break;case 31:if(f.memoizedState!==null)return f.flags|=128,he(f),null;break;case 13:var M=f.memoizedState;if(M!==null)return M.dehydrated!==null?(ne(f),f.flags|=128,null):(y&f.child.childLanes)!==0?Mp(u,f,y):(ne(f),u=Ro(u,f,y),u!==null?u.sibling:null);ne(f);break;case 19:var R=(u.flags&128)!==0;if(M=(y&f.childLanes)!==0,M||(Et(u,f,y,!1),M=(y&f.childLanes)!==0),R){if(M)return Ep(u,f,y);f.flags|=128}if(R=f.memoizedState,R!==null&&(R.rendering=null,R.tail=null,R.lastEffect=null),T(Pi,Pi.current),M)break;return null;case 22:return f.lanes=0,g0(u,f,y,f.pendingProps);case 24:qe(f,bi,u.memoizedState.cache)}return Ro(u,f,y)}function Ap(u,f,y){if(u!==null)if(u.memoizedProps!==f.pendingProps)vi=!0;else{if(!kc(u,y)&&(f.flags&128)===0)return vi=!1,Tp(u,f,y);vi=(u.flags&131072)!==0}else vi=!1,Un&&(f.flags&1048576)!==0&&$(f,af,f.index);switch(f.lanes=0,f.tag){case 16:e:{var M=f.pendingProps;if(u=Nn(f.elementType),f.type=u,typeof u=="function")Ll(u)?(M=Il(u,M),f.tag=1,f=Dl(null,f,u,M,y)):(f.tag=0,f=hd(null,f,u,M,y));else{if(u!=null){var R=u.$$typeof;if(R===zu){f.tag=11,f=h0(null,f,u,M,y);break e}else if(R===Nd){f.tag=14,f=p0(null,f,u,M,y);break e}}throw f=v(u)||u,Error(r(306,f,""))}}return f;case 0:return hd(u,f,f.type,f.pendingProps,y);case 1:return M=f.type,R=Il(M,f.pendingProps),Dl(u,f,M,R,y);case 3:e:{if(St(f,f.stateNode.containerInfo),u===null)throw Error(r(387));var N=f.pendingProps;R=f.memoizedState,M=R.element,Y(u,f),Qe(f,N,null,y);var W=f.memoizedState;if(N=W.cache,qe(f,bi,N),N!==R.cache&&Ht(f,[bi],y,!0),it(),N=W.element,xi&&R.isDehydrated)if(R={element:N,isDehydrated:!1,cache:W.cache},f.updateQueue.baseState=R,f.memoizedState=R,f.flags&256){f=y0(u,f,N,y);break e}else if(N!==M){M=Ue(Error(r(424)),f),et(M),f=y0(u,f,N,y);break e}else for(xi&&(Si=j0(f.stateNode.containerInfo),rr=f,Un=!0,qo=null,Xr=!0),y=bm(f,null,N,y),f.child=y;y;)y.flags=y.flags&-3|4096,y=y.sibling;else{if(Zt(),N===M){f=Ro(u,f,y);break e}_r(u,f,N,y)}f=f.child}return f;case 26:if(Js)return Fc(u,f),u===null?(y=fm(f.type,null,f.pendingProps,null))?f.memoizedState=y:Un||(f.stateNode=Hd(f.type,f.pendingProps,Sr.current,f)):f.memoizedState=fm(f.type,u.memoizedProps,f.pendingProps,u.memoizedState),null;case 27:if(ir)return Re(f),u===null&&ir&&Un&&(M=f.stateNode=Gd(f.type,f.pendingProps,Sr.current,mr.current,!1),rr=f,Xr=!0,Si=sm(f.type,M,Si)),_r(u,f,f.pendingProps.children,y),Fc(u,f),u===null&&(f.flags|=4194304),f.child;case 5:return u===null&&Un&&(hv(f.type,f.pendingProps,mr.current),(R=M=Si)&&(M=nv(M,f.type,f.pendingProps,Xr),M!==null?(f.stateNode=M,rr=f,Si=Q0(M),Xr=!1,R=!0):R=!1),R||bt(f)),Re(f),R=f.type,N=f.pendingProps,W=u!==null?u.memoizedProps:null,M=N.children,Wr(R,N)?M=null:W!==null&&Wr(R,W)&&(f.flags|=32),f.memoizedState!==null&&(R=dt(u,f,kt,null,null,y),Oi?ql._currentValue=R:ql._currentValue2=R),Fc(u,f),_r(u,f,M,y),f.child;case 6:return u===null&&Un&&(cm(f.pendingProps,mr.current),(u=y=Si)&&(y=iv(y,f.pendingProps,Xr),y!==null?(f.stateNode=y,rr=f,Si=null,u=!0):u=!1),u||bt(f)),null;case 13:return Mp(u,f,y);case 4:return St(f,f.stateNode.containerInfo),M=f.pendingProps,u===null?f.child=br(f,null,M,y):_r(u,f,M,y),f.child;case 11:return h0(u,f,f.type,f.pendingProps,y);case 7:return _r(u,f,f.pendingProps,y),f.child;case 8:return _r(u,f,f.pendingProps.children,y),f.child;case 12:return _r(u,f,f.pendingProps.children,y),f.child;case 10:return M=f.pendingProps,qe(f,f.type,M.value),_r(u,f,M.children,y),f.child;case 9:return R=f.type._context,M=f.pendingProps.children,ut(f),R=K(R),M=M(R),f.flags|=1,_r(u,f,M,y),f.child;case 14:return p0(u,f,f.type,f.pendingProps,y);case 15:return m0(u,f,f.type,f.pendingProps,y);case 19:return Ep(u,f,y);case 31:return v0(u,f,y);case 22:return g0(u,f,y,f.pendingProps);case 24:return ut(f),M=K(bi),u===null?(R=nt(),R===null&&(R=Mn,N=De(),R.pooledCache=N,N.refCount++,N!==null&&(R.pooledCacheLanes|=y),R=N),f.memoizedState={parent:M,cache:R},H(f),qe(f,bi,R)):((u.lanes&y)!==0&&(Y(u,f),Qe(f,null,null,y),it()),R=u.memoizedState,N=f.memoizedState,R.parent!==M?(R={parent:M,cache:M},f.memoizedState=R,f.lanes===0&&(f.memoizedState=f.updateQueue.baseState=R),qe(f,bi,M)):(M=N.cache,qe(f,bi,M),M!==R.cache&&Ht(f,[bi],y,!0))),_r(u,f,f.pendingProps.children,y),f.child;case 29:throw f.pendingProps}throw Error(r(156,f.tag))}function Bs(u){u.flags|=4}function Oc(u){Ms&&(u.flags|=8)}function x0(u,f){if(u!==null&&u.child===f.child)return!1;if((f.flags&16)!==0)return!0;for(u=f.child;u!==null;){if((u.flags&8218)!==0||(u.subtreeFlags&8218)!==0)return!0;u=u.sibling}return!1}function wp(u,f,y,M){if(kn)for(y=f.child;y!==null;){if(y.tag===5||y.tag===6)Qc(u,y.stateNode);else if(!(y.tag===4||ir&&y.tag===27)&&y.child!==null){y.child.return=y,y=y.child;continue}if(y===f)break;for(;y.sibling===null;){if(y.return===null||y.return===f)return;y=y.return}y.sibling.return=y.return,y=y.sibling}else if(Ms)for(var R=f.child;R!==null;){if(R.tag===5){var N=R.stateNode;y&&M&&(N=J0(N,R.type,R.memoizedProps)),Qc(u,N)}else if(R.tag===6)N=R.stateNode,y&&M&&(N=im(N,R.memoizedProps)),Qc(u,N);else if(R.tag!==4){if(R.tag===22&&R.memoizedState!==null)N=R.child,N!==null&&(N.return=R),wp(u,R,!0,!0);else if(R.child!==null){R.child.return=R,R=R.child;continue}}if(R===f)break;for(;R.sibling===null;){if(R.return===null||R.return===f)return;R=R.return}R.sibling.return=R.return,R=R.sibling}}function S0(u,f,y,M){var R=!1;if(Ms)for(var N=f.child;N!==null;){if(N.tag===5){var W=N.stateNode;y&&M&&(W=J0(W,N.type,N.memoizedProps)),tm(u,W)}else if(N.tag===6)W=N.stateNode,y&&M&&(W=im(W,N.memoizedProps)),tm(u,W);else if(N.tag!==4){if(N.tag===22&&N.memoizedState!==null)R=N.child,R!==null&&(R.return=N),S0(u,N,!0,!0),R=!0;else if(N.child!==null){N.child.return=N,N=N.child;continue}}if(N===f)break;for(;N.sibling===null;){if(N.return===null||N.return===f)return R;N=N.return}N.sibling.return=N.return,N=N.sibling}return R}function b0(u,f){if(Ms&&x0(u,f)){u=f.stateNode;var y=u.containerInfo,M=em();S0(M,f,!1,!1),u.pendingChildren=M,Bs(f),Y0(y,M)}}function Cp(u,f,y,M){if(kn)u.memoizedProps!==M&&Bs(f);else if(Ms){var R=u.stateNode,N=u.memoizedProps;if((u=x0(u,f))||N!==M){var W=mr.current;N=X0(R,y,N,M,!u,null),N===R?f.stateNode=R:(Oc(f),rs(N,y,M,W)&&Bs(f),f.stateNode=N,u&&wp(N,f,!1,!1))}else f.stateNode=R}}function Hr(u,f,y,M,R){if((u.mode&32)!==0&&(y===null?jc(f,M):qu(f,y,M))){if(u.flags|=16777216,(R&335544128)===R||Gp(f,M))if(Ti(u.stateNode,f,M))u.flags|=8192;else if(Fn())u.flags|=8192;else throw Yr=Wo,eh}else u.flags&=-16777217}function wu(u,f){if(mm(f)){if(u.flags|=16777216,!gm(f))if(Fn())u.flags|=8192;else throw Yr=Wo,eh}else u.flags&=-16777217}function zc(u,f){f!==null&&(u.flags|=4),u.flags&16384&&(f=u.tag!==22?L():536870912,u.lanes|=f,ju|=f)}function Cu(u,f){if(!Un)switch(u.tailMode){case"hidden":f=u.tail;for(var y=null;f!==null;)f.alternate!==null&&(y=f),f=f.sibling;y===null?u.tail=null:y.sibling=null;break;case"collapsed":y=u.tail;for(var M=null;y!==null;)y.alternate!==null&&(M=y),y=y.sibling;M===null?f||u.tail===null?u.tail=null:u.tail.sibling=null:M.sibling=null}}function li(u){var f=u.alternate!==null&&u.alternate.child===u.child,y=0,M=0;if(f)for(var R=u.child;R!==null;)y|=R.lanes|R.childLanes,M|=R.subtreeFlags&65011712,M|=R.flags&65011712,R.return=u,R=R.sibling;else for(R=u.child;R!==null;)y|=R.lanes|R.childLanes,M|=R.subtreeFlags,M|=R.flags,R.return=u,R=R.sibling;return u.subtreeFlags|=M,u.childLanes=y,f}function M0(u,f,y){var M=f.pendingProps;switch(Ee(f),f.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return li(f),null;case 1:return li(f),null;case 3:return y=f.stateNode,M=null,u!==null&&(M=u.memoizedState.cache),f.memoizedState.cache!==M&&(f.flags|=2048),_t(bi),ve(),y.pendingContext&&(y.context=y.pendingContext,y.pendingContext=null),(u===null||u.child===null)&&(Tn(f)?Bs(f):u===null||u.memoizedState.isDehydrated&&(f.flags&256)===0||(f.flags|=1024,Ve())),b0(u,f),li(f),null;case 26:if(Js){var R=f.type,N=f.memoizedState;return u===null?(Bs(f),N!==null?(li(f),wu(f,N)):(li(f),Hr(f,R,null,M,y))):N?N!==u.memoizedState?(Bs(f),li(f),wu(f,N)):(li(f),f.flags&=-16777217):(N=u.memoizedProps,kn?N!==M&&Bs(f):Cp(u,f,R,M),li(f),Hr(f,R,N,M,y)),null}case 27:if(ir){if(ot(f),y=Sr.current,R=f.type,u!==null&&f.stateNode!=null)kn?u.memoizedProps!==M&&Bs(f):Cp(u,f,R,M);else{if(!M){if(f.stateNode===null)throw Error(r(166));return li(f),null}u=mr.current,Tn(f)?Dt(f,u):(u=Gd(R,M,y,u,!0),f.stateNode=u,Bs(f))}return li(f),null}case 5:if(ot(f),R=f.type,u!==null&&f.stateNode!=null)Cp(u,f,R,M);else{if(!M){if(f.stateNode===null)throw Error(r(166));return li(f),null}if(N=mr.current,Tn(f))Dt(f,N),cv(f.stateNode,R,M,N)&&(f.flags|=64);else{var W=Vp(R,M,Sr.current,N,f);Oc(f),wp(W,f,!1,!1),f.stateNode=W,rs(W,R,M,N)&&Bs(f)}}return li(f),Hr(f,f.type,u===null?null:u.memoizedProps,f.pendingProps,y),null;case 6:if(u&&f.stateNode!=null)y=u.memoizedProps,kn?y!==M&&Bs(f):Ms&&(y!==M?(u=Sr.current,y=mr.current,Oc(f),f.stateNode=ma(M,u,y,f)):f.stateNode=u.stateNode);else{if(typeof M!="string"&&f.stateNode===null)throw Error(r(166));if(u=Sr.current,y=mr.current,Tn(f)){if(!xi)throw Error(r(176));if(u=f.stateNode,y=f.memoizedProps,M=null,R=rr,R!==null)switch(R.tag){case 27:case 5:M=R.memoizedProps}sS(u,y,f,M)||bt(f,!0)}else Oc(f),f.stateNode=ma(M,u,y,f)}return li(f),null;case 31:if(y=f.memoizedState,u===null||u.memoizedState!==null){if(M=Tn(f),y!==null){if(u===null){if(!M)throw Error(r(318));if(!xi)throw Error(r(556));if(u=f.memoizedState,u=u!==null?u.dehydrated:null,!u)throw Error(r(557));am(u,f)}else Zt(),(f.flags&128)===0&&(f.memoizedState=null),f.flags|=4;li(f),u=!1}else y=Ve(),u!==null&&u.memoizedState!==null&&(u.memoizedState.hydrationErrors=y),u=!0;if(!u)return f.flags&256?(Ge(f),f):(Ge(f),null);if((f.flags&128)!==0)throw Error(r(558))}return li(f),null;case 13:if(M=f.memoizedState,u===null||u.memoizedState!==null&&u.memoizedState.dehydrated!==null){if(R=Tn(f),M!==null&&M.dehydrated!==null){if(u===null){if(!R)throw Error(r(318));if(!xi)throw Error(r(344));if(R=f.memoizedState,R=R!==null?R.dehydrated:null,!R)throw Error(r(317));ov(R,f)}else Zt(),(f.flags&128)===0&&(f.memoizedState=null),f.flags|=4;li(f),R=!1}else R=Ve(),u!==null&&u.memoizedState!==null&&(u.memoizedState.hydrationErrors=R),R=!0;if(!R)return f.flags&256?(Ge(f),f):(Ge(f),null)}return Ge(f),(f.flags&128)!==0?(f.lanes=y,f):(y=M!==null,u=u!==null&&u.memoizedState!==null,y&&(M=f.child,R=null,M.alternate!==null&&M.alternate.memoizedState!==null&&M.alternate.memoizedState.cachePool!==null&&(R=M.alternate.memoizedState.cachePool.pool),N=null,M.memoizedState!==null&&M.memoizedState.cachePool!==null&&(N=M.memoizedState.cachePool.pool),N!==R&&(M.flags|=2048)),y!==u&&y&&(f.child.flags|=8192),zc(f,f.updateQueue),li(f),null);case 4:return ve(),b0(u,f),u===null&&ri(f.stateNode.containerInfo),li(f),null;case 10:return _t(f.type),li(f),null;case 19:if(b(Pi),M=f.memoizedState,M===null)return li(f),null;if(R=(f.flags&128)!==0,N=M.rendering,N===null)if(R)Cu(M,!1);else{if(Ci!==0||u!==null&&(u.flags&128)!==0)for(u=f.child;u!==null;){if(N=rt(u),N!==null){for(f.flags|=128,Cu(M,!1),u=N.updateQueue,f.updateQueue=u,zc(f,u),f.subtreeFlags=0,u=y,y=f.child;y!==null;)Ad(y,u),y=y.sibling;return T(Pi,Pi.current&1|2),Un&&we(f,M.treeForkCount),f.child}u=u.sibling}M.tail!==null&&Dr()>cl&&(f.flags|=128,R=!0,Cu(M,!1),f.lanes=4194304)}else{if(!R)if(u=rt(N),u!==null){if(f.flags|=128,R=!0,u=u.updateQueue,f.updateQueue=u,zc(f,u),Cu(M,!0),M.tail===null&&M.tailMode==="hidden"&&!N.alternate&&!Un)return li(f),null}else 2*Dr()-M.renderingStartTime>cl&&y!==536870912&&(f.flags|=128,R=!0,Cu(M,!1),f.lanes=4194304);M.isBackwards?(N.sibling=f.child,f.child=N):(u=M.last,u!==null?u.sibling=N:f.child=N,M.last=N)}return M.tail!==null?(u=M.tail,M.rendering=u,M.tail=u.sibling,M.renderingStartTime=Dr(),u.sibling=null,y=Pi.current,T(Pi,R?y&1|2:y&1),Un&&we(f,M.treeForkCount),u):(li(f),null);case 22:case 23:return Ge(f),q(),M=f.memoizedState!==null,u!==null?u.memoizedState!==null!==M&&(f.flags|=8192):M&&(f.flags|=8192),M?(y&536870912)!==0&&(f.flags&128)===0&&(li(f),f.subtreeFlags&6&&(f.flags|=8192)):li(f),y=f.updateQueue,y!==null&&zc(f,y.retryQueue),y=null,u!==null&&u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(y=u.memoizedState.cachePool.pool),M=null,f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(M=f.memoizedState.cachePool.pool),M!==y&&(f.flags|=2048),u!==null&&b(nl),null;case 24:return y=null,u!==null&&(y=u.memoizedState.cache),f.memoizedState.cache!==y&&(f.flags|=2048),_t(bi),li(f),null;case 25:return null;case 30:return null}throw Error(r(156,f.tag))}function Rp(u,f){switch(Ee(f),f.tag){case 1:return u=f.flags,u&65536?(f.flags=u&-65537|128,f):null;case 3:return _t(bi),ve(),u=f.flags,(u&65536)!==0&&(u&128)===0?(f.flags=u&-65537|128,f):null;case 26:case 27:case 5:return ot(f),null;case 31:if(f.memoizedState!==null){if(Ge(f),f.alternate===null)throw Error(r(340));Zt()}return u=f.flags,u&65536?(f.flags=u&-65537|128,f):null;case 13:if(Ge(f),u=f.memoizedState,u!==null&&u.dehydrated!==null){if(f.alternate===null)throw Error(r(340));Zt()}return u=f.flags,u&65536?(f.flags=u&-65537|128,f):null;case 19:return b(Pi),null;case 4:return ve(),null;case 10:return _t(f.type),null;case 22:case 23:return Ge(f),q(),u!==null&&b(nl),u=f.flags,u&65536?(f.flags=u&-65537|128,f):null;case 24:return _t(bi),null;case 25:return null;default:return null}}function E0(u,f){switch(Ee(f),f.tag){case 3:_t(bi),ve();break;case 26:case 27:case 5:ot(f);break;case 4:ve();break;case 31:f.memoizedState!==null&&Ge(f);break;case 13:Ge(f);break;case 19:b(Pi);break;case 10:_t(f.type);break;case 22:case 23:Ge(f),q(),u!==null&&b(nl);break;case 24:_t(bi)}}function Io(u,f){try{var y=f.updateQueue,M=y!==null?y.lastEffect:null;if(M!==null){var R=M.next;y=R;do{if((y.tag&u)===u){M=void 0;var N=y.create,W=y.inst;M=N(),W.destroy=M}y=y.next}while(y!==R)}}catch(ae){sn(f,f.return,ae)}}function No(u,f,y){try{var M=f.updateQueue,R=M!==null?M.lastEffect:null;if(R!==null){var N=R.next;M=N;do{if((M.tag&u)===u){var W=M.inst,ae=W.destroy;if(ae!==void 0){W.destroy=void 0,R=f;var Pe=y,je=ae;try{je()}catch(xt){sn(R,Pe,xt)}}}M=M.next}while(M!==N)}}catch(xt){sn(f,f.return,xt)}}function Ru(u){var f=u.updateQueue;if(f!==null){var y=u.stateNode;try{ft(f,y)}catch(M){sn(u,u.return,M)}}}function md(u,f,y){y.props=Il(u.type,u.memoizedProps),y.state=u.memoizedState;try{y.componentWillUnmount()}catch(M){sn(u,f,M)}}function Iu(u,f){try{var y=u.ref;if(y!==null){switch(u.tag){case 26:case 27:case 5:var M=Vu(u.stateNode);break;case 30:M=u.stateNode;break;default:M=u.stateNode}typeof y=="function"?u.refCleanup=y(M):y.current=M}}catch(R){sn(u,f,R)}}function Nr(u,f){var y=u.ref,M=u.refCleanup;if(y!==null)if(typeof M=="function")try{M()}catch(R){sn(u,f,R)}finally{u.refCleanup=null,u=u.alternate,u!=null&&(u.refCleanup=null)}else if(typeof y=="function")try{y(null)}catch(R){sn(u,f,R)}else y.current=null}function Pl(u){var f=u.type,y=u.memoizedProps,M=u.stateNode;try{O0(M,f,y,u)}catch(R){sn(u,u.return,R)}}function Bc(u,f,y){try{z0(u.stateNode,u.type,y,f,u)}catch(M){sn(u,u.return,M)}}function Ip(u){return u.tag===5||u.tag===3||(Js?u.tag===26:!1)||(ir?u.tag===27&&Wl(u.type):!1)||u.tag===4}function aa(u){e:for(;;){for(;u.sibling===null;){if(u.return===null||Ip(u.return))return null;u=u.return}for(u.sibling.return=u.return,u=u.sibling;u.tag!==5&&u.tag!==6&&u.tag!==18;){if(ir&&u.tag===27&&Wl(u.type)||u.flags&2||u.child===null||u.tag===4)continue e;u.child.return=u,u=u.child}if(!(u.flags&2))return u.stateNode}}function gd(u,f,y){var M=u.tag;if(M===5||M===6)u=u.stateNode,f?V0(y,u,f):$p(y,u);else if(M!==4&&(ir&&M===27&&Wl(u.type)&&(y=u.stateNode,f=null),u=u.child,u!==null))for(gd(u,f,y),u=u.sibling;u!==null;)gd(u,f,y),u=u.sibling}function Vc(u,f,y){var M=u.tag;if(M===5||M===6)u=u.stateNode,f?B0(y,u,f):Zp(y,u);else if(M!==4&&(ir&&M===27&&Wl(u.type)&&(y=u.stateNode),u=u.child,u!==null))for(Vc(u,f,y),u=u.sibling;u!==null;)Vc(u,f,y),u=u.sibling}function Np(u,f,y){u=u.containerInfo;try{nm(u,y)}catch(M){sn(f,f.return,M)}}function T0(u){var f=u.stateNode,y=u.memoizedProps;try{Ji(u.type,y,f,u)}catch(M){sn(u,u.return,M)}}function tS(u,f){for(Dd(u.containerInfo),Vi=f;Vi!==null;)if(u=Vi,f=u.child,(u.subtreeFlags&1028)!==0&&f!==null)f.return=u,Vi=f;else for(;Vi!==null;){u=Vi;var y=u.alternate;switch(f=u.flags,u.tag){case 0:if((f&4)!==0&&(f=u.updateQueue,f=f!==null?f.events:null,f!==null))for(var M=0;M<f.length;M++){var R=f[M];R.ref.impl=R.nextImpl}break;case 11:case 15:break;case 1:if((f&1024)!==0&&y!==null){f=void 0,M=u,R=y.memoizedProps,y=y.memoizedState;var N=M.stateNode;try{var W=Il(M.type,R);f=N.getSnapshotBeforeUpdate(W,y),N.__reactInternalSnapshotBeforeUpdate=f}catch(ae){sn(M,M.return,ae)}}break;case 3:(f&1024)!==0&&kn&&jp(u.stateNode.containerInfo);break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((f&1024)!==0)throw Error(r(163))}if(f=u.sibling,f!==null){f.return=u.return,Vi=f;break}Vi=u.return}}function A0(u,f,y){var M=y.flags;switch(y.tag){case 0:case 11:case 15:Gr(u,y),M&4&&Io(5,y);break;case 1:if(Gr(u,y),M&4)if(u=y.stateNode,f===null)try{u.componentDidMount()}catch(W){sn(y,y.return,W)}else{var R=Il(y.type,f.memoizedProps);f=f.memoizedState;try{u.componentDidUpdate(R,f,u.__reactInternalSnapshotBeforeUpdate)}catch(W){sn(y,y.return,W)}}M&64&&Ru(y),M&512&&Iu(y,y.return);break;case 3:if(Gr(u,y),M&64&&(M=y.updateQueue,M!==null)){if(u=null,y.child!==null)switch(y.child.tag){case 27:case 5:u=Vu(y.child.stateNode);break;case 1:u=y.child.stateNode}try{ft(M,u)}catch(W){sn(y,y.return,W)}}break;case 27:ir&&f===null&&M&4&&T0(y);case 26:case 5:if(Gr(u,y),f===null){if(M&4)Pl(y);else if(M&64){u=y.type,f=y.memoizedProps,R=y.stateNode;try{lv(R,u,f,y)}catch(W){sn(y,y.return,W)}}}M&512&&Iu(y,y.return);break;case 12:Gr(u,y);break;case 31:Gr(u,y),M&4&&Hs(u,y);break;case 13:Gr(u,y),M&4&&Gc(u,y),M&64&&(M=y.memoizedState,M!==null&&(M=M.dehydrated,M!==null&&(y=nS.bind(null,y),zd(M,y))));break;case 22:if(M=y.memoizedState!==null||Li,!M){f=f!==null&&f.memoizedState!==null||Fi,R=Li;var N=Fi;Li=M,(Fi=f)&&!N?qs(u,y,(y.subtreeFlags&8772)!==0):Gr(u,y),Li=R,Fi=N}break;case 30:break;default:Gr(u,y)}}function Dp(u){var f=u.alternate;f!==null&&(u.alternate=null,Dp(f)),u.child=null,u.deletions=null,u.sibling=null,u.tag===5&&(f=u.stateNode,f!==null&&Ud(f)),u.stateNode=null,u.return=null,u.dependencies=null,u.memoizedProps=null,u.memoizedState=null,u.pendingProps=null,u.stateNode=null,u.updateQueue=null}function Vs(u,f,y){for(y=y.child;y!==null;)Hc(u,f,y),y=y.sibling}function Hc(u,f,y){if(as&&typeof as.onCommitFiberUnmount=="function")try{as.onCommitFiberUnmount(Jl,y)}catch{}switch(y.tag){case 26:if(Js){Fi||Nr(y,f),Vs(u,f,y),y.memoizedState?el(y.memoizedState):y.stateNode&&pm(y.stateNode);break}case 27:if(ir){Fi||Nr(y,f);var M=wi,R=Hi;Wl(y.type)&&(wi=y.stateNode,Hi=!1),Vs(u,f,y),pr(y.stateNode),wi=M,Hi=R;break}case 5:Fi||Nr(y,f);case 6:if(kn){if(M=wi,R=Hi,wi=null,Vs(u,f,y),wi=M,Hi=R,wi!==null)if(Hi)try{Kp(wi,y.stateNode)}catch(N){sn(y,f,N)}else try{H0(wi,y.stateNode)}catch(N){sn(y,f,N)}}else Vs(u,f,y);break;case 18:kn&&wi!==null&&(Hi?Bd(wi,y.stateNode):um(wi,y.stateNode));break;case 4:kn?(M=wi,R=Hi,wi=y.stateNode.containerInfo,Hi=!0,Vs(u,f,y),wi=M,Hi=R):(Ms&&Np(y.stateNode,y,em()),Vs(u,f,y));break;case 0:case 11:case 14:case 15:No(2,y,f),Fi||No(4,y,f),Vs(u,f,y);break;case 1:Fi||(Nr(y,f),M=y.stateNode,typeof M.componentWillUnmount=="function"&&md(y,f,M)),Vs(u,f,y);break;case 21:Vs(u,f,y);break;case 22:Fi=(M=Fi)||y.memoizedState!==null,Vs(u,f,y),Fi=M;break;default:Vs(u,f,y)}}function Hs(u,f){if(xi&&f.memoizedState===null&&(u=f.alternate,u!==null&&(u=u.memoizedState,u!==null))){u=u.dehydrated;try{oS(u)}catch(y){sn(f,f.return,y)}}}function Gc(u,f){if(xi&&f.memoizedState===null&&(u=f.alternate,u!==null&&(u=u.memoizedState,u!==null&&(u=u.dehydrated,u!==null))))try{aS(u)}catch(y){sn(f,f.return,y)}}function Gs(u){switch(u.tag){case 31:case 13:case 19:var f=u.stateNode;return f===null&&(f=u.stateNode=new Em),f;case 22:return u=u.stateNode,f=u._retryCache,f===null&&(f=u._retryCache=new Em),f;default:throw Error(r(435,u.tag))}}function la(u,f){var y=Gs(u);f.forEach(function(M){if(!y.has(M)){y.add(M);var R=iS.bind(null,u,M);M.then(R,R)}})}function dr(u,f){var y=f.deletions;if(y!==null)for(var M=0;M<y.length;M++){var R=y[M],N=u,W=f;if(kn){var ae=W;e:for(;ae!==null;){switch(ae.tag){case 27:if(ir){if(Wl(ae.type)){wi=ae.stateNode,Hi=!1;break e}break}case 5:wi=ae.stateNode,Hi=!1;break e;case 3:case 4:wi=ae.stateNode.containerInfo,Hi=!0;break e}ae=ae.return}if(wi===null)throw Error(r(160));Hc(N,W,R),wi=null,Hi=!1}else Hc(N,W,R);N=R.alternate,N!==null&&(N.return=null),R.return=null}if(f.subtreeFlags&13886)for(f=f.child;f!==null;)qc(f,u),f=f.sibling}function qc(u,f){var y=u.alternate,M=u.flags;switch(u.tag){case 0:case 11:case 14:case 15:dr(f,u),hr(u),M&4&&(No(3,u,u.return),Io(3,u),No(5,u,u.return));break;case 1:dr(f,u),hr(u),M&512&&(Fi||y===null||Nr(y,y.return)),M&64&&Li&&(u=u.updateQueue,u!==null&&(M=u.callbacks,M!==null&&(y=u.shared.hiddenCallbacks,u.shared.hiddenCallbacks=y===null?M:y.concat(M))));break;case 26:if(Js){var R=ni;if(dr(f,u),hr(u),M&512&&(Fi||y===null||Nr(y,y.return)),M&4){M=y!==null?y.memoizedState:null;var N=u.memoizedState;y===null?N===null?u.stateNode===null?u.stateNode=pv(R,u.type,u.memoizedProps,u):hm(R,u.type,u.stateNode):u.stateNode=dm(R,N,u.memoizedProps):M!==N?(M===null?y.stateNode!==null&&pm(y.stateNode):el(M),N===null?hm(R,u.type,u.stateNode):dm(R,N,u.memoizedProps)):N===null&&u.stateNode!==null&&Bc(u,u.memoizedProps,y.memoizedProps)}break}case 27:if(ir){dr(f,u),hr(u),M&512&&(Fi||y===null||Nr(y,y.return)),y!==null&&M&4&&Bc(u,u.memoizedProps,y.memoizedProps);break}case 5:if(dr(f,u),hr(u),M&512&&(Fi||y===null||Nr(y,y.return)),kn){if(u.flags&32){R=u.stateNode;try{Qp(R)}catch(st){sn(u,u.return,st)}}M&4&&u.stateNode!=null&&(R=u.memoizedProps,Bc(u,R,y!==null?y.memoizedProps:R)),M&1024&&(Ju=!0)}else Ms&&u.alternate!==null&&(u.alternate.stateNode=u.stateNode);break;case 6:if(dr(f,u),hr(u),M&4&&kn){if(u.stateNode===null)throw Error(r(162));M=u.memoizedProps,y=y!==null?y.memoizedProps:M,R=u.stateNode;try{k0(R,y,M)}catch(st){sn(u,u.return,st)}}break;case 3:if(Js?(mv(),R=ni,ni=nf(f.containerInfo),dr(f,u),ni=R):dr(f,u),hr(u),M&4){if(kn&&xi&&y!==null&&y.memoizedState.isDehydrated)try{uv(f.containerInfo)}catch(st){sn(u,u.return,st)}if(Ms){M=f.containerInfo,y=f.pendingChildren;try{nm(M,y)}catch(st){sn(u,u.return,st)}}}Ju&&(Ju=!1,vd(u));break;case 4:Js?(y=ni,ni=nf(u.stateNode.containerInfo),dr(f,u),hr(u),ni=y):(dr(f,u),hr(u)),M&4&&Ms&&Np(u.stateNode,u,u.stateNode.pendingChildren);break;case 12:dr(f,u),hr(u);break;case 31:dr(f,u),hr(u),M&4&&(M=u.updateQueue,M!==null&&(u.updateQueue=null,la(u,M)));break;case 13:dr(f,u),hr(u),u.child.flags&8192&&u.memoizedState!==null!=(y!==null&&y.memoizedState!==null)&&(hf=Dr()),M&4&&(M=u.updateQueue,M!==null&&(u.updateQueue=null,la(u,M)));break;case 22:R=u.memoizedState!==null;var W=y!==null&&y.memoizedState!==null,ae=Li,Pe=Fi;if(Li=ae||R,Fi=Pe||W,dr(f,u),Fi=Pe,Li=ae,hr(u),M&8192&&(f=u.stateNode,f._visibility=R?f._visibility&-2:f._visibility|1,R&&(y===null||W||Li||Fi||Va(u)),kn)){e:if(y=null,kn)for(f=u;;){if(f.tag===5||Js&&f.tag===26){if(y===null){W=y=f;try{N=W.stateNode,R?rS(N):q0(W.stateNode,W.memoizedProps)}catch(st){sn(W,W.return,st)}}}else if(f.tag===6){if(y===null){W=f;try{var je=W.stateNode;R?G0(je):W0(je,W.memoizedProps)}catch(st){sn(W,W.return,st)}}}else if(f.tag===18){if(y===null){W=f;try{var xt=W.stateNode;R?fv(xt):dv(W.stateNode)}catch(st){sn(W,W.return,st)}}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===u)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===u)break e;for(;f.sibling===null;){if(f.return===null||f.return===u)break e;y===f&&(y=null),f=f.return}y===f&&(y=null),f.sibling.return=f.return,f=f.sibling}}M&4&&(M=u.updateQueue,M!==null&&(y=M.retryQueue,y!==null&&(M.retryQueue=null,la(u,y))));break;case 19:dr(f,u),hr(u),M&4&&(M=u.updateQueue,M!==null&&(u.updateQueue=null,la(u,M)));break;case 30:break;case 21:break;default:dr(f,u),hr(u)}}function hr(u){var f=u.flags;if(f&2){try{for(var y,M=u.return;M!==null;){if(Ip(M)){y=M;break}M=M.return}if(kn){if(y==null)throw Error(r(160));switch(y.tag){case 27:if(ir){var R=y.stateNode,N=aa(u);Vc(u,N,R);break}case 5:var W=y.stateNode;y.flags&32&&(Qp(W),y.flags&=-33);var ae=aa(u);Vc(u,ae,W);break;case 3:case 4:var Pe=y.stateNode.containerInfo,je=aa(u);gd(u,je,Pe);break;default:throw Error(r(161))}}}catch(xt){sn(u,u.return,xt)}u.flags&=-3}f&4096&&(u.flags&=-4097)}function vd(u){if(u.subtreeFlags&1024)for(u=u.child;u!==null;){var f=u;vd(f),f.tag===5&&f.flags&1024&&Wp(f.stateNode),u=u.sibling}}function Gr(u,f){if(f.subtreeFlags&8772)for(f=f.child;f!==null;)A0(u,f.alternate,f),f=f.sibling}function Va(u){for(u=u.child;u!==null;){var f=u;switch(f.tag){case 0:case 11:case 14:case 15:No(4,f,f.return),Va(f);break;case 1:Nr(f,f.return);var y=f.stateNode;typeof y.componentWillUnmount=="function"&&md(f,f.return,y),Va(f);break;case 27:ir&&pr(f.stateNode);case 26:case 5:Nr(f,f.return),Va(f);break;case 22:f.memoizedState===null&&Va(f);break;case 30:Va(f);break;default:Va(f)}u=u.sibling}}function qs(u,f,y){for(y=y&&(f.subtreeFlags&8772)!==0,f=f.child;f!==null;){var M=f.alternate,R=u,N=f,W=N.flags;switch(N.tag){case 0:case 11:case 15:qs(R,N,y),Io(4,N);break;case 1:if(qs(R,N,y),M=N,R=M.stateNode,typeof R.componentDidMount=="function")try{R.componentDidMount()}catch(je){sn(M,M.return,je)}if(M=N,R=M.updateQueue,R!==null){var ae=M.stateNode;try{var Pe=R.shared.hiddenCallbacks;if(Pe!==null)for(R.shared.hiddenCallbacks=null,R=0;R<Pe.length;R++)pt(Pe[R],ae)}catch(je){sn(M,M.return,je)}}y&&W&64&&Ru(N),Iu(N,N.return);break;case 27:ir&&T0(N);case 26:case 5:qs(R,N,y),y&&M===null&&W&4&&Pl(N),Iu(N,N.return);break;case 12:qs(R,N,y);break;case 31:qs(R,N,y),y&&W&4&&Hs(R,N);break;case 13:qs(R,N,y),y&&W&4&&Gc(R,N);break;case 22:N.memoizedState===null&&qs(R,N,y),Iu(N,N.return);break;case 30:break;default:qs(R,N,y)}f=f.sibling}}function Ha(u,f){var y=null;u!==null&&u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(y=u.memoizedState.cachePool.pool),u=null,f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(u=f.memoizedState.cachePool.pool),u!==y&&(u!=null&&u.refCount++,y!=null&&We(y))}function Up(u,f){u=null,f.alternate!==null&&(u=f.alternate.memoizedState.cache),f=f.memoizedState.cache,f!==u&&(f.refCount++,u!=null&&We(u))}function Mi(u,f,y,M){if(f.subtreeFlags&10256)for(f=f.child;f!==null;)yd(u,f,y,M),f=f.sibling}function yd(u,f,y,M){var R=f.flags;switch(f.tag){case 0:case 11:case 15:Mi(u,f,y,M),R&2048&&Io(9,f);break;case 1:Mi(u,f,y,M);break;case 3:Mi(u,f,y,M),R&2048&&(u=null,f.alternate!==null&&(u=f.alternate.memoizedState.cache),f=f.memoizedState.cache,f!==u&&(f.refCount++,u!=null&&We(u)));break;case 12:if(R&2048){Mi(u,f,y,M),u=f.stateNode;try{var N=f.memoizedProps,W=N.id,ae=N.onPostCommit;typeof ae=="function"&&ae(W,f.alternate===null?"mount":"update",u.passiveEffectDuration,-0)}catch(Pe){sn(f,f.return,Pe)}}else Mi(u,f,y,M);break;case 31:Mi(u,f,y,M);break;case 13:Mi(u,f,y,M);break;case 23:break;case 22:N=f.stateNode,W=f.alternate,f.memoizedState!==null?N._visibility&2?Mi(u,f,y,M):Nu(u,f):N._visibility&2?Mi(u,f,y,M):(N._visibility|=2,ts(u,f,y,M,(f.subtreeFlags&10256)!==0||!1)),R&2048&&Ha(W,f);break;case 24:Mi(u,f,y,M),R&2048&&Up(f.alternate,f);break;default:Mi(u,f,y,M)}}function ts(u,f,y,M,R){for(R=R&&((f.subtreeFlags&10256)!==0||!1),f=f.child;f!==null;){var N=u,W=f,ae=y,Pe=M,je=W.flags;switch(W.tag){case 0:case 11:case 15:ts(N,W,ae,Pe,R),Io(8,W);break;case 23:break;case 22:var xt=W.stateNode;W.memoizedState!==null?xt._visibility&2?ts(N,W,ae,Pe,R):Nu(N,W):(xt._visibility|=2,ts(N,W,ae,Pe,R)),R&&je&2048&&Ha(W.alternate,W);break;case 24:ts(N,W,ae,Pe,R),R&&je&2048&&Up(W.alternate,W);break;default:ts(N,W,ae,Pe,R)}f=f.sibling}}function Nu(u,f){if(f.subtreeFlags&10256)for(f=f.child;f!==null;){var y=u,M=f,R=M.flags;switch(M.tag){case 22:Nu(y,M),R&2048&&Ha(M.alternate,M);break;case 24:Nu(y,M),R&2048&&Up(M.alternate,M);break;default:Nu(y,M)}f=f.sibling}}function Do(u,f,y){if(u.subtreeFlags&ws)for(u=u.child;u!==null;)Ga(u,f,y),u=u.sibling}function Ga(u,f,y){switch(u.tag){case 26:if(Do(u,f,y),u.flags&ws)if(u.memoizedState!==null)gv(y,ni,u.memoizedState,u.memoizedProps);else{var M=u.stateNode,R=u.type;u=u.memoizedProps,((f&335544128)===f||Gp(R,u))&&Pd(y,M,R,u)}break;case 5:Do(u,f,y),u.flags&ws&&(M=u.stateNode,R=u.type,u=u.memoizedProps,((f&335544128)===f||Gp(R,u))&&Pd(y,M,R,u));break;case 3:case 4:Js?(M=ni,ni=nf(u.stateNode.containerInfo),Do(u,f,y),ni=M):Do(u,f,y);break;case 22:u.memoizedState===null&&(M=u.alternate,M!==null&&M.memoizedState!==null?(M=ws,ws=16777216,Do(u,f,y),ws=M):Do(u,f,y));break;default:Do(u,f,y)}}function _d(u){var f=u.alternate;if(f!==null&&(u=f.child,u!==null)){f.child=null;do f=u.sibling,u.sibling=null,u=f;while(u!==null)}}function Du(u){var f=u.deletions;if((u.flags&16)!==0){if(f!==null)for(var y=0;y<f.length;y++){var M=f[y];Vi=M,xs(M,u)}_d(u)}if(u.subtreeFlags&10256)for(u=u.child;u!==null;)xd(u),u=u.sibling}function xd(u){switch(u.tag){case 0:case 11:case 15:Du(u),u.flags&2048&&No(9,u,u.return);break;case 3:Du(u);break;case 12:Du(u);break;case 22:var f=u.stateNode;u.memoizedState!==null&&f._visibility&2&&(u.return===null||u.return.tag!==13)?(f._visibility&=-3,Wc(u)):Du(u);break;default:Du(u)}}function Wc(u){var f=u.deletions;if((u.flags&16)!==0){if(f!==null)for(var y=0;y<f.length;y++){var M=f[y];Vi=M,xs(M,u)}_d(u)}for(u=u.child;u!==null;){switch(f=u,f.tag){case 0:case 11:case 15:No(8,f,f.return),Wc(f);break;case 22:y=f.stateNode,y._visibility&2&&(y._visibility&=-3,Wc(f));break;default:Wc(f)}u=u.sibling}}function xs(u,f){for(;Vi!==null;){var y=Vi;switch(y.tag){case 0:case 11:case 15:No(8,y,f);break;case 23:case 22:if(y.memoizedState!==null&&y.memoizedState.cachePool!==null){var M=y.memoizedState.cachePool.pool;M!=null&&M.refCount++}break;case 24:We(y.memoizedState.cache)}if(M=y.child,M!==null)M.return=y,Vi=M;else e:for(y=u;Vi!==null;){M=Vi;var R=M.sibling,N=M.return;if(Dp(M),M===y){Vi=null;break e}if(R!==null){R.return=N,Vi=R;break e}Vi=N}}}function qa(u){var f=pn(u);if(f!=null){if(typeof f.memoizedProps["data-testname"]!="string")throw Error(r(364));return f}if(u=zi(u),u===null)throw Error(r(362));return u.stateNode.current}function Wa(u,f){var y=u.tag;switch(f.$$typeof){case no:if(u.type===f.value)return!0;break;case $u:e:{for(f=f.value,u=[u,0],y=0;y<u.length;){var M=u[y++],R=M.tag,N=u[y++],W=f[N];if(R!==5&&R!==26&&R!==27||!Qa(M)){for(;W!=null&&Wa(M,W);)N++,W=f[N];if(N===f.length){f=!0;break e}else for(M=M.child;M!==null;)u.push(M,N),M=M.sibling}}f=!1}return f;case Ku:if((y===5||y===26||y===27)&&Jp(u.stateNode,f.value))return!0;break;case ol:if((y===5||y===6||y===26||y===27)&&(u=ef(u),u!==null&&0<=u.indexOf(f.value)))return!0;break;case ff:if((y===5||y===26||y===27)&&(u=u.memoizedProps["data-testname"],typeof u=="string"&&u.toLowerCase()===f.value.toLowerCase()))return!0;break;default:throw Error(r(365))}return!1}function Uu(u){switch(u.$$typeof){case no:return"<"+(v(u.value)||"Unknown")+">";case $u:return":has("+(Uu(u)||"")+")";case Ku:return'[role="'+u.value+'"]';case ol:return'"'+u.value+'"';case ff:return'[data-testname="'+u.value+'"]';default:throw Error(r(365))}}function Pu(u,f){var y=[];u=[u,0];for(var M=0;M<u.length;){var R=u[M++],N=R.tag,W=u[M++],ae=f[W];if(N!==5&&N!==26&&N!==27||!Qa(R)){for(;ae!=null&&Wa(R,ae);)W++,ae=f[W];if(W===f.length)y.push(R);else for(R=R.child;R!==null;)u.push(R,W),R=R.sibling}}return y}function ns(u,f){if(!nr)throw Error(r(363));u=qa(u),u=Pu(u,f),f=[],u=Array.from(u);for(var y=0;y<u.length;){var M=u[y++],R=M.tag;if(R===5||R===26||R===27)Qa(M)||f.push(M.stateNode);else for(M=M.child;M!==null;)u.push(M),M=M.sibling}return f}function _i(){return(Rn&2)!==0&&Pn!==0?Pn&-Pn:Kt.T!==null?at():Gu()}function ua(){if(Zr===0)if((Pn&536870912)===0||Un){var u=Yl;Yl<<=1,(Yl&3932160)===0&&(Yl=262144),Zr=u}else Zr=536870912;return u=ls.current,u!==null&&(u.flags|=32),Zr}function Ei(u,f,y){(u===Mn&&(ii===2||ii===9)||u.cancelPendingCommit!==null)&&(Ui(u,0),Po(u,Pn,Zr,!1)),B(u,y),((Rn&2)===0||u!==Mn)&&(u===Mn&&((Rn&2)===0&&(ul|=y),Ci===4&&Po(u,Pn,Zr,!1)),Ct(u))}function lo(u,f,y){if((Rn&6)!==0)throw Error(r(327));var M=!y&&(f&127)===0&&(f&u.expiredLanes)===0||D(u,f),R=M?R0(u,f):Lo(u,f,!0),N=M;do{if(R===0){al&&!M&&Po(u,f,0,!1);break}else{if(y=u.current.alternate,N&&!w0(y)){R=Lo(u,f,!1),N=!1;continue}if(R===2){if(N=f,u.errorRecoveryDisabledLanes&N)var W=0;else W=u.pendingLanes&-536870913,W=W!==0?W:W&536870912?536870912:0;if(W!==0){f=W;e:{var ae=u;R=df;var Pe=xi&&ae.current.memoizedState.isDehydrated;if(Pe&&(Ui(ae,W).flags|=256),W=Lo(ae,W,!1),W!==2){if(ll&&!Pe){ae.errorRecoveryDisabledLanes|=N,ul|=N,R=4;break e}N=cs,cs=R,N!==null&&(cs===null?cs=N:cs.push.apply(cs,N))}R=W}if(N=!1,R!==2)continue}}if(R===1){Ui(u,0),Po(u,f,0,!0);break}e:{switch(M=u,N=R,N){case 0:case 1:throw Error(r(345));case 4:if((f&4194048)!==f)break;case 6:Po(M,f,Zr,!ho);break e;case 2:cs=null;break;case 3:case 5:break;default:throw Error(r(329))}if((f&62914560)===f&&(R=hf+300-Dr(),10<R)){if(Po(M,f,Zr,!ho),A(M,0,!0)!==0)break e;Zo=f,M.timeoutHandle=Hp(Uo.bind(null,M,y,cs,pf,nh,f,Zr,ul,ju,ho,N,"Throttled",-0,0),R);break e}Uo(M,y,cs,pf,nh,f,Zr,ul,ju,ho,N,null,-0,0)}}break}while(!0);Ct(u)}function Uo(u,f,y,M,R,N,W,ae,Pe,je,xt,st,Lt,dn){if(u.timeoutHandle=ss,st=f.subtreeFlags,st&8192||(st&16785408)===16785408){st=qp(),Ga(f,N,st);var Gi=(N&62914560)===N?hf-Dr():(N&4194048)===N?eu-Dr():0;if(Gi=F0(st,Gi),Gi!==null){Zo=N,u.cancelPendingCommit=Gi(ko.bind(null,u,f,N,y,M,R,W,ae,Pe,xt,st,null,Lt,dn)),Po(u,N,W,!je);return}}ko(u,f,N,y,M,R,W,ae,Pe)}function w0(u){for(var f=u;;){var y=f.tag;if((y===0||y===11||y===15)&&f.flags&16384&&(y=f.updateQueue,y!==null&&(y=y.stores,y!==null)))for(var M=0;M<y.length;M++){var R=y[M],N=R.getSnapshot;R=R.value;try{if(!Bi(N(),R))return!1}catch{return!1}}if(y=f.child,f.subtreeFlags&16384&&y!==null)y.return=f,f=y;else{if(f===u)break;for(;f.sibling===null;){if(f.return===null||f.return===u)return!0;f=f.return}f.sibling.return=f.return,f=f.sibling}}return!0}function Po(u,f,y,M){f&=~Qu,f&=~ul,u.suspendedLanes|=f,u.pingedLanes&=~f,M&&(u.warmLanes|=f),M=u.expirationTimes;for(var R=f;0<R;){var N=31-os(R),W=1<<N;M[N]=-1,R&=~W}y!==0&&G(u,y,f)}function Sd(){return(Rn&6)===0?(ht(0),!1):!0}function bd(){if(In!==null){if(ii===0)var u=In.return;else u=In,co=ci=null,yn(u),il=null,Zl=0,u=In;for(;u!==null;)E0(u.alternate,u),u=u.return;In=null}}function Ui(u,f){var y=u.timeoutHandle;y!==ss&&(u.timeoutHandle=ss,L0(y)),y=u.cancelPendingCommit,y!==null&&(u.cancelPendingCommit=null,y()),Zo=0,bd(),Mn=u,In=y=bs(u.current,null),Pn=f,ii=0,Zi=null,ho=!1,al=D(u,f),ll=!1,ju=Zr=Qu=ul=Sa=Ci=0,cs=df=null,nh=!1,(f&8)!==0&&(f|=f&32);var M=u.entangledLanes;if(M!==0)for(u=u.entanglements,M&=f;0<M;){var R=31-os(M),N=1<<R;f|=u[R],M&=~N}return Jo=f,wo(),y}function ui(u,f){mn=null,Kt.H=As,f===or||f===eo?(f=Ln(),ii=3):f===eh?(f=Ln(),ii=4):ii=f===Jr?8:f!==null&&typeof f=="object"&&typeof f.then=="function"?6:1,Zi=f,In===null&&(Ci=1,fd(u,Ue(f,u.current)))}function Fn(){var u=ls.current;return u===null?!0:(Pn&4194048)===Pn?us===null:(Pn&62914560)===Pn||(Pn&536870912)!==0?u===us:!1}function ca(){var u=Kt.H;return Kt.H=As,u===null?As:u}function Ss(){var u=Kt.A;return Kt.A=Zu,u}function Lu(){Ci=4,ho||(Pn&4194048)!==Pn&&ls.current!==null||(al=!0),(Sa&134217727)===0&&(ul&134217727)===0||Mn===null||Po(Mn,Pn,Zr,!1)}function Lo(u,f,y){var M=Rn;Rn|=2;var R=ca(),N=Ss();(Mn!==u||Pn!==f)&&(pf=null,Ui(u,f)),f=!1;var W=Ci;e:do try{if(ii!==0&&In!==null){var ae=In,Pe=Zi;switch(ii){case 8:bd(),W=6;break e;case 3:case 2:case 9:case 6:ls.current===null&&(f=!0);var je=ii;if(ii=0,Zi=null,Fo(u,ae,Pe,je),y&&al){W=0;break e}break;default:je=ii,ii=0,Zi=null,Fo(u,ae,Pe,je)}}C0(),W=Ci;break}catch(xt){ui(u,xt)}while(!0);return f&&u.shellSuspendCounter++,co=ci=null,Rn=M,Kt.H=R,Kt.A=N,In===null&&(Mn=null,Pn=0,wo()),W}function C0(){for(;In!==null;)Xa(In)}function R0(u,f){var y=Rn;Rn|=2;var M=ca(),R=Ss();Mn!==u||Pn!==f?(pf=null,cl=Dr()+500,Ui(u,f)):al=D(u,f);e:do try{if(ii!==0&&In!==null){f=In;var N=Zi;t:switch(ii){case 1:ii=0,Zi=null,Fo(u,f,N,1);break;case 2:case 9:if(vt(N)){ii=0,Zi=null,Md(f);break}f=function(){ii!==2&&ii!==9||Mn!==u||(ii=7),Ct(u)},N.then(f,f);break e;case 3:ii=7;break e;case 4:ii=5;break e;case 7:vt(N)?(ii=0,Zi=null,Md(f)):(ii=0,Zi=null,Fo(u,f,N,7));break;case 5:var W=null;switch(In.tag){case 26:W=In.memoizedState;case 5:case 27:var ae=In,Pe=ae.type,je=ae.pendingProps;if(W?gm(W):Ti(ae.stateNode,Pe,je)){ii=0,Zi=null;var xt=ae.sibling;if(xt!==null)In=xt;else{var st=ae.return;st!==null?(In=st,ku(st)):In=null}break t}}ii=0,Zi=null,Fo(u,f,N,5);break;case 6:ii=0,Zi=null,Fo(u,f,N,6);break;case 8:bd(),Ci=6;break e;default:throw Error(r(462))}}Fu();break}catch(Lt){ui(u,Lt)}while(!0);return co=ci=null,Kt.H=M,Kt.A=R,Rn=y,In!==null?0:(Mn=null,Pn=0,wo(),Ci)}function Fu(){for(;In!==null&&!yv();)Xa(In)}function Xa(u){var f=Ap(u.alternate,u,Jo);u.memoizedProps=u.pendingProps,f===null?ku(u):In=f}function Md(u){var f=u,y=f.alternate;switch(f.tag){case 15:case 0:f=xp(y,f,f.pendingProps,f.type,void 0,Pn);break;case 11:f=xp(y,f,f.pendingProps,f.type.render,f.ref,Pn);break;case 5:yn(f);default:E0(y,f),f=In=Ad(f,Jo),f=Ap(y,f,Jo)}u.memoizedProps=u.pendingProps,f===null?ku(u):In=f}function Fo(u,f,y,M){co=ci=null,yn(f),il=null,Zl=0;var R=f.return;try{if(eS(u,R,f,y,Pn)){Ci=1,fd(u,Ue(y,u.current)),In=null;return}}catch(N){if(R!==null)throw In=R,N;Ci=1,fd(u,Ue(y,u.current)),In=null;return}f.flags&32768?(Un||M===1?u=!0:al||(Pn&536870912)!==0?u=!1:(ho=u=!0,(M===2||M===9||M===3||M===6)&&(M=ls.current,M!==null&&M.tag===13&&(M.flags|=16384))),Ya(f,u)):ku(f)}function ku(u){var f=u;do{if((f.flags&32768)!==0){Ya(f,ho);return}u=f.return;var y=M0(f.alternate,f,Jo);if(y!==null){In=y;return}if(f=f.sibling,f!==null){In=f;return}In=f=u}while(f!==null);Ci===0&&(Ci=5)}function Ya(u,f){do{var y=Rp(u.alternate,u);if(y!==null){y.flags&=32767,In=y;return}if(y=u.return,y!==null&&(y.flags|=32768,y.subtreeFlags=0,y.deletions=null),!f&&(u=u.sibling,u!==null)){In=u;return}In=u=y}while(u!==null);Ci=6,In=null}function ko(u,f,y,M,R,N,W,ae,Pe){u.cancelPendingCommit=null;do zo();while($i!==0);if((Rn&6)!==0)throw Error(r(327));if(f!==null){if(f===u.current)throw Error(r(177));if(N=f.lanes|f.childLanes,N|=$l,k(u,y,N,W,ae,Pe),u===Mn&&(In=Mn=null,Pn=0),tu=f,Ma=u,Zo=y,ec=N,ih=R,Tm=M,(f.subtreeFlags&10256)!==0||(f.flags&10256)!==0?(u.callbackNode=null,u.callbackPriority=0,Yi(sf,function(){return Xc(),null})):(u.callbackNode=null,u.callbackPriority=0),M=(f.flags&13878)!==0,(f.subtreeFlags&13878)!==0||M){M=Kt.T,Kt.T=null,R=Ys(),Dn(2),W=Rn,Rn|=4;try{tS(u,f,y)}finally{Rn=W,Dn(R),Kt.T=M}}$i=1,fa(),Oo(),Ed()}}function fa(){if($i===1){$i=0;var u=Ma,f=tu,y=(f.flags&13878)!==0;if((f.subtreeFlags&13878)!==0||y){y=Kt.T,Kt.T=null;var M=Ys();Dn(2);var R=Rn;Rn|=4;try{qc(f,u),P0(u.containerInfo)}finally{Rn=R,Dn(M),Kt.T=y}}u.current=f,$i=2}}function Oo(){if($i===2){$i=0;var u=Ma,f=tu,y=(f.flags&8772)!==0;if((f.subtreeFlags&8772)!==0||y){y=Kt.T,Kt.T=null;var M=Ys();Dn(2);var R=Rn;Rn|=4;try{A0(u,f.alternate,f)}finally{Rn=R,Dn(M),Kt.T=y}}$i=3}}function Ed(){if($i===4||$i===3){$i=0,ym();var u=Ma,f=tu,y=Zo,M=Tm;(f.subtreeFlags&10256)!==0||(f.flags&10256)!==0?$i=5:($i=0,tu=Ma=null,Td(u,u.pendingLanes));var R=u.pendingLanes;if(R===0&&(ba=null),ie(y),f=f.stateNode,as&&typeof as.onCommitFiberRoot=="function")try{as.onCommitFiberRoot(Jl,f,void 0,(f.current.flags&128)===128)}catch{}if(M!==null){f=Kt.T,R=Ys(),Dn(2),Kt.T=null;try{for(var N=u.onRecoverableError,W=0;W<M.length;W++){var ae=M[W];N(ae.value,{componentStack:ae.stack})}}finally{Kt.T=f,Dn(R)}}(Zo&3)!==0&&zo(),Ct(u),R=u.pendingLanes,(y&261930)!==0&&(R&42)!==0?u===mf?Wn++:(Wn=0,mf=u):Wn=0,xi&&tf(),ht(0)}}function Td(u,f){(u.pooledCacheLanes&=f)===0&&(f=u.pooledCache,f!=null&&(u.pooledCache=null,We(f)))}function zo(){return fa(),Oo(),Ed(),Xc()}function Xc(){if($i!==5)return!1;var u=Ma,f=ec;ec=0;var y=ie(Zo),M=32>y?32:y;y=Kt.T;var R=Ys();try{Dn(M),Kt.T=null,M=ih,ih=null;var N=Ma,W=Zo;if($i=0,tu=Ma=null,Zo=0,(Rn&6)!==0)throw Error(r(331));var ae=Rn;if(Rn|=4,xd(N.current),yd(N,N.current,W,M),Rn=ae,ht(0,!1),as&&typeof as.onPostCommitFiberRoot=="function")try{as.onPostCommitFiberRoot(Jl,N)}catch{}return!0}finally{Dn(R),Kt.T=y,Td(u,f)}}function Ja(u,f,y){f=Ue(y,f),f=yp(u.stateNode,f,2),u=Se(u,f,2),u!==null&&(B(u,2),Ct(u))}function sn(u,f,y){if(u.tag===3)Ja(u,u,y);else for(;f!==null;){if(f.tag===3){Ja(f,u,y);break}else if(f.tag===1){var M=f.stateNode;if(typeof f.type.getDerivedStateFromError=="function"||typeof M.componentDidCatch=="function"&&(ba===null||!ba.has(M))){u=Ue(y,u),y=f0(2),M=Se(f,y,2),M!==null&&(d0(y,M,f,u),B(M,2),Ct(M));break}}f=f.return}}function Ou(u,f,y){var M=u.pingCache;if(M===null){M=u.pingCache=new Cs;var R=new Set;M.set(f,R)}else R=M.get(f),R===void 0&&(R=new Set,M.set(f,R));R.has(y)||(ll=!0,R.add(y),u=I0.bind(null,u,f,y),f.then(u,u))}function I0(u,f,y){var M=u.pingCache;M!==null&&M.delete(f),u.pingedLanes|=u.suspendedLanes&y,u.warmLanes&=~y,Mn===u&&(Pn&y)===y&&(Ci===4||Ci===3&&(Pn&62914560)===Pn&&300>Dr()-hf?(Rn&2)===0&&Ui(u,0):Qu|=y,ju===Pn&&(ju=0)),Ct(u)}function N0(u,f){f===0&&(f=L()),u=jt(u,f),u!==null&&(B(u,f),Ct(u))}function nS(u){var f=u.memoizedState,y=0;f!==null&&(y=f.retryLane),N0(u,y)}function iS(u,f){var y=0;switch(u.tag){case 31:case 13:var M=u.stateNode,R=u.memoizedState;R!==null&&(y=R.retryLane);break;case 19:M=u.stateNode;break;case 22:M=u.stateNode._retryCache;break;default:throw Error(r(314))}M!==null&&M.delete(f),N0(u,y)}function Yi(u,f){return rf(u,f)}function Pp(u,f,y,M){this.tag=u,this.key=y,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=f,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=M,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ll(u){return u=u.prototype,!(!u||!u.isReactComponent)}function bs(u,f){var y=u.alternate;return y===null?(y=t(u.tag,f,u.key,u.mode),y.elementType=u.elementType,y.type=u.type,y.stateNode=u.stateNode,y.alternate=u,u.alternate=y):(y.pendingProps=f,y.type=u.type,y.flags=0,y.subtreeFlags=0,y.deletions=null),y.flags=u.flags&65011712,y.childLanes=u.childLanes,y.lanes=u.lanes,y.child=u.child,y.memoizedProps=u.memoizedProps,y.memoizedState=u.memoizedState,y.updateQueue=u.updateQueue,f=u.dependencies,y.dependencies=f===null?null:{lanes:f.lanes,firstContext:f.firstContext},y.sibling=u.sibling,y.index=u.index,y.ref=u.ref,y.refCleanup=u.refCleanup,y}function Ad(u,f){u.flags&=65011714;var y=u.alternate;return y===null?(u.childLanes=0,u.lanes=f,u.child=null,u.subtreeFlags=0,u.memoizedProps=null,u.memoizedState=null,u.updateQueue=null,u.dependencies=null,u.stateNode=null):(u.childLanes=y.childLanes,u.lanes=y.lanes,u.child=y.child,u.subtreeFlags=0,u.deletions=null,u.memoizedProps=y.memoizedProps,u.memoizedState=y.memoizedState,u.updateQueue=y.updateQueue,u.type=y.type,f=y.dependencies,u.dependencies=f===null?null:{lanes:f.lanes,firstContext:f.firstContext}),u}function da(u,f,y,M,R,N){var W=0;if(M=u,typeof u=="function")Ll(u)&&(W=1);else if(typeof u=="string")W=Js&&ir?Vd(u,y,mr.current)?26:vm(u)?27:5:Js?Vd(u,y,mr.current)?26:5:ir&&vm(u)?27:5;else e:switch(u){case $c:return u=t(31,y,f,R),u.elementType=$c,u.lanes=N,u;case zl:return Ws(y.children,R,N,f);case Bl:W=8,R|=24;break;case Vl:return u=t(12,y,f,R|2),u.elementType=Vl,u.lanes=N,u;case Id:return u=t(13,y,f,R),u.elementType=Id,u.lanes=N,u;case ha:return u=t(19,y,f,R),u.elementType=ha,u.lanes=N,u;default:if(typeof u=="object"&&u!==null)switch(u.$$typeof){case Xs:W=10;break e;case Zc:W=9;break e;case zu:W=11;break e;case Nd:W=14;break e;case qr:W=16,M=null;break e}W=29,y=Error(r(130,u===null?"null":typeof u,"")),M=null}return f=t(W,y,f,R),f.elementType=u,f.type=M,f.lanes=N,f}function Ws(u,f,y,M){return u=t(7,u,M,f),u.lanes=y,u}function Lp(u,f,y){return u=t(6,u,null,f),u.lanes=y,u}function Fp(u){var f=t(18,null,null,0);return f.stateNode=u,f}function kp(u,f,y){return f=t(4,u.children!==null?u.children:[],u.key,f),f.lanes=y,f.stateNode={containerInfo:u.containerInfo,pendingChildren:null,implementation:u.implementation},f}function D0(u,f,y,M,R,N,W,ae,Pe){this.tag=1,this.containerInfo=u,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=ss,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=z(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=z(0),this.hiddenUpdates=z(null),this.identifierPrefix=M,this.onUncaughtError=R,this.onCaughtError=N,this.onRecoverableError=W,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Pe,this.incompleteTransitions=new Map}function Za(u,f,y,M,R,N,W,ae,Pe,je,xt,st){return u=new D0(u,f,y,W,Pe,je,xt,st,ae),f=1,N===!0&&(f|=24),N=t(3,null,null,f),u.current=N,N.stateNode=u,f=De(),f.refCount++,u.pooledCache=f,f.refCount++,N.memoizedState={element:M,isDehydrated:y,cache:f},H(N),u}function wd(u){return u?(u=Vo,u):Vo}function Yc(u){var f=u._reactInternals;if(f===void 0)throw typeof u.render=="function"?Error(r(188)):(u=Object.keys(u).join(","),Error(r(268,u)));return u=c(f),u=u!==null?d(u):null,u===null?null:Vu(u.stateNode)}function Op(u,f,y,M,R,N){R=wd(R),M.context===null?M.context=R:M.pendingContext=R,M=oe(f),M.payload={element:y},N=N===void 0?null:N,N!==null&&(M.callback=N),y=Se(u,M,f),y!==null&&(Ei(y,u,f),Le(y,u,f))}function Fl(u,f){if(u=u.memoizedState,u!==null&&u.dehydrated!==null){var y=u.retryLane;u.retryLane=y!==0&&y<f?y:f}}function Jc(u,f){Fl(u,f),(u=u.alternate)&&Fl(u,f)}var Sn={},Cd=FM,is=i4,Rd=Object.assign,kl=Symbol.for("react.element"),Bo=Symbol.for("react.transitional.element"),Ol=Symbol.for("react.portal"),zl=Symbol.for("react.fragment"),Bl=Symbol.for("react.strict_mode"),Vl=Symbol.for("react.profiler"),Zc=Symbol.for("react.consumer"),Xs=Symbol.for("react.context"),zu=Symbol.for("react.forward_ref"),Id=Symbol.for("react.suspense"),ha=Symbol.for("react.suspense_list"),Nd=Symbol.for("react.memo"),qr=Symbol.for("react.lazy"),$c=Symbol.for("react.activity"),zp=Symbol.for("react.memo_cache_sentinel"),pa=Symbol.iterator,$a=Symbol.for("react.client.reference"),Ka=Array.isArray,Kt=Cd.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Bp=e.rendererVersion,Kc=e.rendererPackageName,Bu=e.extraDevToolsConfig,Vu=e.getPublicInstance,U0=e.getRootHostContext,Hu=e.getChildHostContext,Dd=e.prepareForCommit,P0=e.resetAfterCommit,Vp=e.createInstance;e.cloneMutableInstance;var Qc=e.appendInitialChild,rs=e.finalizeInitialChildren,Wr=e.shouldSetTextContent,ma=e.createTextInstance;e.cloneMutableTextInstance;var Hp=e.scheduleTimeout,L0=e.cancelTimeout,ss=e.noTimeout,Oi=e.isPrimaryRenderer;e.warnsIfNotActing;var kn=e.supportsMutation,Ms=e.supportsPersistence,xi=e.supportsHydration,pn=e.getInstanceFromNode;e.beforeActiveInstanceBlur;var ri=e.preparePortalMount;e.prepareScopeUpdate,e.getInstanceFromScope;var Dn=e.setCurrentUpdatePriority,Ys=e.getCurrentUpdatePriority,Gu=e.resolveUpdatePriority;e.trackSchedulerEvent,e.resolveEventType,e.resolveEventTimeStamp;var Hl=e.shouldAttemptEagerTransition,Ud=e.detachDeletedInstance;e.requestPostPaintCallback;var jc=e.maySuspendCommit,qu=e.maySuspendCommitOnUpdate,Gp=e.maySuspendCommitInSyncRender,Ti=e.preloadInstance,qp=e.startSuspendingCommit,Pd=e.suspendInstance;e.suspendOnActiveViewTransition;var F0=e.waitForCommitToBeReady;e.getSuspendedCommitReason;var Gl=e.NotPendingTransition,ql=e.HostTransitionContext,Wp=e.resetFormInstance;e.bindToConsole;var Xp=e.supportsMicrotasks,Yp=e.scheduleMicrotask,nr=e.supportsTestSelectors,zi=e.findFiberRoot,Ld=e.getBoundingRect,ef=e.getTextContent,Qa=e.isHiddenSubtree,Jp=e.matchAccessibilityRole,ga=e.setFocusIfFocusable,Fd=e.setupIntersectionObserver,Zp=e.appendChild,$p=e.appendChildToContainer,k0=e.commitTextUpdate,O0=e.commitMount,z0=e.commitUpdate,B0=e.insertBefore,V0=e.insertInContainerBefore,H0=e.removeChild,Kp=e.removeChildFromContainer,Qp=e.resetTextContent,rS=e.hideInstance,G0=e.hideTextInstance,q0=e.unhideInstance,W0=e.unhideTextInstance;e.cancelViewTransitionName,e.cancelRootViewTransitionName,e.restoreRootViewTransitionName,e.cloneRootViewTransitionContainer,e.removeRootViewTransitionClone,e.measureClonedInstance,e.hasInstanceChanged,e.hasInstanceAffectedParent,e.startViewTransition,e.startGestureTransition,e.stopViewTransition,e.getCurrentGestureOffset,e.createViewTransitionInstance;var jp=e.clearContainer;e.createFragmentInstance,e.updateFragmentInstanceFiber,e.commitNewChildToFragmentInstance,e.deleteChildFromFragmentInstance;var X0=e.cloneInstance,em=e.createContainerChildSet,tm=e.appendChildToContainerChildSet,Y0=e.finalizeContainerChildren,nm=e.replaceContainerChildren,J0=e.cloneHiddenInstance,im=e.cloneHiddenTextInstance,ja=e.isSuspenseInstancePending,kd=e.isSuspenseInstanceFallback,Od=e.getSuspenseInstanceFallbackErrorDetails,zd=e.registerSuspenseInstanceRetry,Z0=e.canHydrateFormStateMarker,rm=e.isFormStateMarkerMatching,$0=e.getNextHydratableSibling,K0=e.getNextHydratableSiblingAfterSingleton,Q0=e.getFirstHydratableChild,j0=e.getFirstHydratableChildWithinContainer,ev=e.getFirstHydratableChildWithinActivityInstance,tv=e.getFirstHydratableChildWithinSuspenseInstance,sm=e.getFirstHydratableChildWithinSingleton,nv=e.canHydrateInstance,iv=e.canHydrateTextInstance,om=e.canHydrateActivityInstance,rv=e.canHydrateSuspenseInstance,sv=e.hydrateInstance,sS=e.hydrateTextInstance,am=e.hydrateActivityInstance,ov=e.hydrateSuspenseInstance,av=e.getNextHydratableInstanceAfterActivityInstance,lm=e.getNextHydratableInstanceAfterSuspenseInstance,lv=e.commitHydratedInstance,uv=e.commitHydratedContainer,oS=e.commitHydratedActivityInstance,aS=e.commitHydratedSuspenseInstance,cv=e.finalizeHydratedChildren,tf=e.flushHydrationEvents;e.clearActivityBoundary;var um=e.clearSuspenseBoundary;e.clearActivityBoundaryFromContainer;var Bd=e.clearSuspenseBoundaryFromContainer,fv=e.hideDehydratedBoundary,dv=e.unhideDehydratedBoundary,Wu=e.shouldDeleteUnhydratedTailInstances;e.diffHydratedPropsForDevWarnings,e.diffHydratedTextForDevWarnings,e.describeHydratableInstanceForDevWarnings;var hv=e.validateHydratableInstance,cm=e.validateHydratableTextInstance,Js=e.supportsResources,Vd=e.isHostHoistableType,nf=e.getHoistableRoot,fm=e.getResource,dm=e.acquireResource,el=e.releaseResource,pv=e.hydrateHoistable,hm=e.mountHoistable,pm=e.unmountHoistable,Hd=e.createHoistableInstance,mv=e.prepareToCommitHoistables,mm=e.mayResourceSuspendCommit,gm=e.preloadResource,gv=e.suspendResource,ir=e.supportsSingletons,Gd=e.resolveSingletonInstance,Ji=e.acquireSingletonInstance,pr=e.releaseSingletonInstance,vm=e.isHostSingletonType,Wl=e.isSingletonScope,qd=[],Xl=-1,Vo={},os=Math.clz32?Math.clz32:I,Wd=Math.log,vv=Math.LN2,Xd=256,Yl=262144,Xu=4194304,rf=is.unstable_scheduleCallback,Yd=is.unstable_cancelCallback,yv=is.unstable_shouldYield,ym=is.unstable_requestPaint,Dr=is.unstable_now,Jd=is.unstable_ImmediatePriority,_v=is.unstable_UserBlockingPriority,sf=is.unstable_NormalPriority,Zd=is.unstable_IdlePriority,_m=is.log,xv=is.unstable_setDisableYieldValue,Jl=null,as=null,Bi=typeof Object.is=="function"?Object.is:re,$d=typeof reportError=="function"?reportError:function(u){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var f=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof u=="object"&&u!==null&&typeof u.message=="string"?String(u.message):String(u),error:u});if(!window.dispatchEvent(f))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",u);return}console.error(u)},lS=Object.prototype.hasOwnProperty,Kd,Ho,of=!1,xm=new WeakMap,va=[],Go=0,si=null,af=0,Zs=[],Es=0,$s=null,xr=1,uo="",mr=_(null),ya=_(null),Sr=_(null),lf=_(null),rr=null,Si=null,Un=!1,qo=null,Xr=!1,Qd=Error(r(519)),Ks=_(null),ci=null,co=null,Sv=typeof AbortController<"u"?AbortController:function(){var u=[],f=this.signal={aborted:!1,addEventListener:function(y,M){u.push(M)}};this.abort=function(){f.aborted=!0,u.forEach(function(y){return y()})}},gr=is.unstable_scheduleCallback,uS=is.unstable_NormalPriority,bi={$$typeof:Xs,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0},uf=null,ti=null,Ur=!1,Qs=!1,jd=!1,tl=0,Yu=null,Sm=0,_a=0,sr=null,js=Kt.S;Kt.S=function(u,f){eu=Dr(),typeof f=="object"&&f!==null&&typeof f.then=="function"&&Xt(u,f),js!==null&&js(u,f)};var nl=_(null),or=Error(r(460)),eh=Error(r(474)),eo=Error(r(542)),Wo={then:function(){}},Yr=null,il=null,Zl=0,br=Os(!0),bm=Os(!1),Mr=[],Xo=0,$l=0,Ts=!1,th=!1,Kl=_(null),rl=_(0),ls=_(null),us=null,Pi=_(0),xa=0,mn=null,Yt=null,ln=null,bn=!1,_n=!1,On=!1,Pr=0,to=0,fo=null,Mm=0,As={readContext:K,use:qn,useCallback:Xe,useContext:Xe,useEffect:Xe,useImperativeHandle:Xe,useLayoutEffect:Xe,useInsertionEffect:Xe,useMemo:Xe,useReducer:Xe,useRef:Xe,useState:Xe,useDebugValue:Xe,useDeferredValue:Xe,useTransition:Xe,useSyncExternalStore:Xe,useId:Xe,useHostTransitionStatus:Xe,useFormState:Xe,useActionState:Xe,useOptimistic:Xe,useMemoCache:Xe,useCacheRefresh:Xe};As.useEffectEvent=Xe;var Ai={readContext:K,use:qn,useCallback:function(u,f){return Ut().memoizedState=[u,f===void 0?null:f],u},useContext:K,useEffect:Dc,useImperativeHandle:function(u,f,y){y=y!=null?y.concat([u]):null,Rl(4194308,4,bu.bind(null,f,u),y)},useLayoutEffect:function(u,f){return Rl(4194308,4,u,f)},useInsertionEffect:function(u,f){Rl(4,2,u,f)},useMemo:function(u,f){var y=Ut();f=f===void 0?null:f;var M=u();if(On){ee(!0);try{u()}finally{ee(!1)}}return y.memoizedState=[M,f],M},useReducer:function(u,f,y){var M=Ut();if(y!==void 0){var R=y(f);if(On){ee(!0);try{y(f)}finally{ee(!1)}}}else R=f;return M.memoizedState=M.baseState=R,u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:u,lastRenderedState:R},M.queue=u,u=u.dispatch=jx.bind(null,mn,u),[M.memoizedState,u]},useRef:function(u){var f=Ut();return u={current:u},f.memoizedState=u},useState:function(u){u=cp(u);var f=u.queue,y=a0.bind(null,mn,f);return f.dispatch=y,[u.memoizedState,y]},useDebugValue:Pc,useDeferredValue:function(u,f){var y=Ut();return Eu(y,u,f)},useTransition:function(){var u=cp(!1);return u=r0.bind(null,mn,u.queue,!0,!1),Ut().memoizedState=u,[!1,u]},useSyncExternalStore:function(u,f,y){var M=mn,R=Ut();if(Un){if(y===void 0)throw Error(r(407));y=y()}else{if(y=f(),Mn===null)throw Error(r(349));(Pn&127)!==0||cr(M,f,y)}R.memoizedState=y;var N={value:y,getSnapshot:f};return R.queue=N,Dc(wl.bind(null,M,N,u),[u]),M.flags|=2048,_s(9,{destroy:void 0},fr.bind(null,M,N,y,f),null),y},useId:function(){var u=Ut(),f=Mn.identifierPrefix;if(Un){var y=uo,M=xr;y=(M&~(1<<32-os(M)-1)).toString(32)+y,f="_"+f+"R_"+y,y=Pr++,0<y&&(f+="H"+y.toString(32)),f+="_"}else y=Mm++,f="_"+f+"r_"+y.toString(32)+"_";return u.memoizedState=f},useHostTransitionStatus:mp,useFormState:dp,useActionState:dp,useOptimistic:function(u){var f=Ut();f.memoizedState=f.baseState=u;var y={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return f.queue=y,f=ld.bind(null,mn,!0,y),y.dispatch=f,[u,f]},useMemoCache:er,useCacheRefresh:function(){return Ut().memoizedState=Qx.bind(null,mn)},useEffectEvent:function(u){var f=Ut(),y={impl:u};return f.memoizedState=y,function(){if((Rn&2)!==0)throw Error(r(440));return y.impl.apply(void 0,arguments)}}},Yo={readContext:K,use:qn,useCallback:od,useContext:K,useEffect:Su,useImperativeHandle:i0,useInsertionEffect:za,useLayoutEffect:Uc,useMemo:Mu,useReducer:yi,useRef:sd,useState:function(){return yi(An)},useDebugValue:Pc,useDeferredValue:function(u,f){var y=lt();return pp(y,Yt.memoizedState,u,f)},useTransition:function(){var u=yi(An)[0],f=lt().memoizedState;return[typeof u=="boolean"?u:At(u),f]},useSyncExternalStore:Xi,useId:ad,useHostTransitionStatus:mp,useFormState:_u,useActionState:_u,useOptimistic:function(u,f){var y=lt();return Ic(y,Yt,u,f)},useMemoCache:er,useCacheRefresh:o0};Yo.useEffectEvent=Vr;var sl={readContext:K,use:qn,useCallback:od,useContext:K,useEffect:Su,useImperativeHandle:i0,useInsertionEffect:za,useLayoutEffect:Uc,useMemo:Mu,useReducer:tr,useRef:sd,useState:function(){return tr(An)},useDebugValue:Pc,useDeferredValue:function(u,f){var y=lt();return Yt===null?Eu(y,u,f):pp(y,Yt.memoizedState,u,f)},useTransition:function(){var u=tr(An)[0],f=lt().memoizedState;return[typeof u=="boolean"?u:At(u),f]},useSyncExternalStore:Xi,useId:ad,useHostTransitionStatus:mp,useFormState:xu,useActionState:xu,useOptimistic:function(u,f){var y=lt();return Yt!==null?Ic(y,Yt,u,f):(y.baseState=u,[u,y.queue.dispatch])},useMemoCache:er,useCacheRefresh:o0};sl.useEffectEvent=Vr;var cf={enqueueSetState:function(u,f,y){u=u._reactInternals;var M=_i(),R=oe(M);R.payload=f,y!=null&&(R.callback=y),f=Se(u,R,M),f!==null&&(Ei(f,u,M),Le(f,u,M))},enqueueReplaceState:function(u,f,y){u=u._reactInternals;var M=_i(),R=oe(M);R.tag=1,R.payload=f,y!=null&&(R.callback=y),f=Se(u,R,M),f!==null&&(Ei(f,u,M),Le(f,u,M))},enqueueForceUpdate:function(u,f){u=u._reactInternals;var y=_i(),M=oe(y);M.tag=2,f!=null&&(M.callback=f),f=Se(u,M,y),f!==null&&(Ei(f,u,y),Le(f,u,y))}},Jr=Error(r(461)),vi=!1,Ql={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null},Li=!1,Fi=!1,Ju=!1,Em=typeof WeakSet=="function"?WeakSet:Set,Vi=null,wi=null,Hi=!1,ni=null,ws=8192,Zu={getCacheForType:function(u){var f=K(bi),y=f.data.get(u);return y===void 0&&(y=u(),f.data.set(u,y)),y},cacheSignal:function(){return K(bi).controller.signal}},no=0,$u=1,Ku=2,ff=3,ol=4;if(typeof Symbol=="function"&&Symbol.for){var jl=Symbol.for;no=jl("selector.component"),$u=jl("selector.has_pseudo_class"),Ku=jl("selector.role"),ff=jl("selector.test_id"),ol=jl("selector.text")}var Cs=typeof WeakMap=="function"?WeakMap:Map,Rn=0,Mn=null,In=null,Pn=0,ii=0,Zi=null,ho=!1,al=!1,ll=!1,Jo=0,Ci=0,Sa=0,ul=0,Qu=0,Zr=0,ju=0,df=null,cs=null,nh=!1,hf=0,eu=0,cl=1/0,pf=null,ba=null,$i=0,Ma=null,tu=null,Zo=0,ec=0,ih=null,Tm=null,Wn=0,mf=null;return Sn.attemptContinuousHydration=function(u){if(u.tag===13||u.tag===31){var f=jt(u,67108864);f!==null&&Ei(f,u,67108864),Jc(u,67108864)}},Sn.attemptHydrationAtCurrentPriority=function(u){if(u.tag===13||u.tag===31){var f=_i();f=Z(f);var y=jt(u,f);y!==null&&Ei(y,u,f),Jc(u,f)}},Sn.attemptSynchronousHydration=function(u){switch(u.tag){case 3:if(u=u.stateNode,u.current.memoizedState.isDehydrated){var f=C(u.pendingLanes);if(f!==0){for(u.pendingLanes|=2,u.entangledLanes|=2;f;){var y=1<<31-os(f);u.entanglements[1]|=y,f&=~y}Ct(u),(Rn&6)===0&&(cl=Dr()+500,ht(0))}}break;case 31:case 13:f=jt(u,2),f!==null&&Ei(f,u,2),Sd(),Jc(u,2)}},Sn.batchedUpdates=function(u,f){return u(f)},Sn.createComponentSelector=function(u){return{$$typeof:no,value:u}},Sn.createContainer=function(u,f,y,M,R,N,W,ae,Pe,je){return Za(u,f,!1,null,y,M,N,null,W,ae,Pe,je)},Sn.createHasPseudoClassSelector=function(u){return{$$typeof:$u,value:u}},Sn.createHydrationContainer=function(u,f,y,M,R,N,W,ae,Pe,je,xt,st,Lt,dn){var Gi;return u=Za(y,M,!0,u,R,N,ae,dn,Pe,je,xt,st),u.context=wd(null),y=u.current,M=_i(),M=Z(M),R=oe(M),R.callback=(Gi=f)!=null?Gi:null,Se(y,R,M),f=M,u.current.lanes=f,B(u,f),Ct(u),u},Sn.createPortal=function(u,f,y){var M=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ol,key:M==null?null:""+M,children:u,containerInfo:f,implementation:y}},Sn.createRoleSelector=function(u){return{$$typeof:Ku,value:u}},Sn.createTestNameSelector=function(u){return{$$typeof:ff,value:u}},Sn.createTextSelector=function(u){return{$$typeof:ol,value:u}},Sn.defaultOnCaughtError=function(u){console.error(u)},Sn.defaultOnRecoverableError=function(u){$d(u)},Sn.defaultOnUncaughtError=function(u){$d(u)},Sn.deferredUpdates=function(u){var f=Kt.T,y=Ys();try{return Dn(32),Kt.T=null,u()}finally{Dn(y),Kt.T=f}},Sn.discreteUpdates=function(u,f,y,M,R){var N=Kt.T,W=Ys();try{return Dn(2),Kt.T=null,u(f,y,M,R)}finally{Dn(W),Kt.T=N,Rn===0&&(cl=Dr()+500)}},Sn.findAllNodes=ns,Sn.findBoundingRects=function(u,f){if(!nr)throw Error(r(363));f=ns(u,f),u=[];for(var y=0;y<f.length;y++)u.push(Ld(f[y]));for(f=u.length-1;0<f;f--){y=u[f];for(var M=y.x,R=M+y.width,N=y.y,W=N+y.height,ae=f-1;0<=ae;ae--)if(f!==ae){var Pe=u[ae],je=Pe.x,xt=je+Pe.width,st=Pe.y,Lt=st+Pe.height;if(M>=je&&N>=st&&R<=xt&&W<=Lt){u.splice(f,1);break}else if(M!==je||y.width!==Pe.width||Lt<N||st>W){if(!(N!==st||y.height!==Pe.height||xt<M||je>R)){je>M&&(Pe.width+=je-M,Pe.x=M),xt<R&&(Pe.width=R-je),u.splice(f,1);break}}else{st>N&&(Pe.height+=st-N,Pe.y=N),Lt<W&&(Pe.height=W-st),u.splice(f,1);break}}}return u},Sn.findHostInstance=Yc,Sn.findHostInstanceWithNoPortals=function(u){return u=c(u),u=u!==null?p(u):null,u===null?null:Vu(u.stateNode)},Sn.findHostInstanceWithWarning=function(u){return Yc(u)},Sn.flushPassiveEffects=zo,Sn.flushSyncFromReconciler=function(u){var f=Rn;Rn|=1;var y=Kt.T,M=Ys();try{if(Dn(2),Kt.T=null,u)return u()}finally{Dn(M),Kt.T=y,Rn=f,(Rn&6)===0&&ht(0)}},Sn.flushSyncWork=Sd,Sn.focusWithin=function(u,f){if(!nr)throw Error(r(363));for(u=qa(u),f=Pu(u,f),f=Array.from(f),u=0;u<f.length;){var y=f[u++],M=y.tag;if(!Qa(y)){if((M===5||M===26||M===27)&&ga(y.stateNode))return!0;for(y=y.child;y!==null;)f.push(y),y=y.sibling}}return!1},Sn.getFindAllNodesFailureDescription=function(u,f){if(!nr)throw Error(r(363));var y=0,M=[];u=[qa(u),0];for(var R=0;R<u.length;){var N=u[R++],W=N.tag,ae=u[R++],Pe=f[ae];if((W!==5&&W!==26&&W!==27||!Qa(N))&&(Wa(N,Pe)&&(M.push(Uu(Pe)),ae++,ae>y&&(y=ae)),ae<f.length))for(N=N.child;N!==null;)u.push(N,ae),N=N.sibling}if(y<f.length){for(u=[];y<f.length;y++)u.push(Uu(f[y]));return`findAllNodes was able to match part of the selector:
  `+(M.join(" > ")+`

No matching component was found for:
  `)+u.join(" > ")}return null},Sn.getPublicRootInstance=function(u){if(u=u.current,!u.child)return null;switch(u.child.tag){case 27:case 5:return Vu(u.child.stateNode);default:return u.child.stateNode}},Sn.injectIntoDevTools=function(){var u={bundleType:0,version:Bp,rendererPackageName:Kc,currentDispatcherRef:Kt,reconcilerVersion:"19.2.0"};if(Bu!==null&&(u.rendererConfig=Bu),typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")u=!1;else{var f=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(f.isDisabled||!f.supportsFiber)u=!0;else{try{Jl=f.inject(u),as=f}catch{}u=!!f.checkDCE}}return u},Sn.isAlreadyRendering=function(){return(Rn&6)!==0},Sn.observeVisibleRects=function(u,f,y,M){if(!nr)throw Error(r(363));u=ns(u,f);var R=Fd(u,y,M).disconnect;return{disconnect:function(){R()}}},Sn.shouldError=function(){return null},Sn.shouldSuspend=function(){return!1},Sn.startHostTransition=function(u,f,y,M){if(u.tag!==5)throw Error(r(476));var R=s0(u).queue;r0(u,R,f,Gl,y===null?n:function(){var N=s0(u);return N.next===null&&(N=u.alternate.memoizedState),Lc(u,N.next.queue,{},_i()),y(M)})},Sn.updateContainer=function(u,f,y,M){var R=f.current,N=_i();return Op(R,N,u,f,y,M),N},Sn.updateContainerSync=function(u,f,y,M){return Op(f.current,2,u,f,y,M),2},Sn},i.exports.default=i.exports,Object.defineProperty(i.exports,"__esModule",{value:!0})})(VA)),VA.exports}var GA;function N4(){return GA||(GA=1,BA.exports=I4()),BA.exports}var D4=N4();const U4=R4(D4);function P4(i){const e=U4(i);return e.injectIntoDevTools(),e}const qI=0,ep={},L4=/^three(?=[A-Z])/,Vx=i=>`${i[0].toUpperCase()}${i.slice(1)}`;let F4=0;const k4=i=>typeof i=="function";function DE(i){if(k4(i)){const e=`${F4++}`;return ep[e]=i,e}else Object.assign(ep,i)}function WI(i,e){const t=Vx(i),n=ep[t];if(i!=="primitive"&&!n)throw new Error(`R3F: ${t} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if(i==="primitive"&&!e.object)throw new Error("R3F: Primitives without 'object' are invalid!");if(e.args!==void 0&&!Array.isArray(e.args))throw new Error("R3F: The args prop must be an array!")}function O4(i,e,t){var n;return i=Vx(i)in ep?i:i.replace(L4,""),WI(i,e),i==="primitive"&&(n=e.object)!=null&&n.__r3f&&delete e.object.__r3f,H_(e.object,t,i,e)}function z4(i){if(!i.isHidden){var e;i.props.attach&&(e=i.parent)!=null&&e.object?q_(i.parent,i):Ds(i.object)&&(i.object.visible=!1),i.isHidden=!0,op(i)}}function XI(i){if(i.isHidden){var e;i.props.attach&&(e=i.parent)!=null&&e.object?G_(i.parent,i):Ds(i.object)&&i.props.visible!==!1&&(i.object.visible=!0),i.isHidden=!1,op(i)}}function UE(i,e,t){const n=e.root.getState();if(!(!i.parent&&i.object!==n.scene)){if(!e.object){var r,s;const a=ep[Vx(e.type)];e.object=(r=e.props.object)!=null?r:new a(...(s=e.props.args)!=null?s:[]),e.object.__r3f=e}if(vl(e.object,e.props),e.props.attach)G_(i,e);else if(Ds(e.object)&&Ds(i.object)){const a=i.object.children.indexOf(t==null?void 0:t.object);if(t&&a!==-1){const c=i.object.children.indexOf(e.object);if(c!==-1){i.object.children.splice(c,1);const d=c<a?a-1:a;i.object.children.splice(d,0,e.object)}else e.object.parent=i.object,i.object.children.splice(a,0,e.object),e.object.dispatchEvent({type:"added"}),i.object.dispatchEvent({type:"childadded",child:e.object})}else i.object.add(e.object)}for(const a of e.children)UE(e,a);op(e)}}function Nb(i,e){e&&(e.parent=i,i.children.push(e),UE(i,e))}function qA(i,e,t){if(!e||!t)return;e.parent=i;const n=i.children.indexOf(t);n!==-1?i.children.splice(n,0,e):i.children.push(e),UE(i,e,t)}function YI(i){if(typeof i.dispose=="function"){const e=()=>{try{i.dispose()}catch{}};typeof IS_REACT_ACT_ENVIRONMENT<"u"?e():dM.unstable_scheduleCallback(dM.unstable_IdlePriority,e)}}function pM(i,e,t){if(!e)return;e.parent=null;const n=i.children.indexOf(e);n!==-1&&i.children.splice(n,1),e.props.attach?q_(i,e):Ds(e.object)&&Ds(i.object)&&(i.object.remove(e.object),x4(kI(e),e.object));const r=e.props.dispose!==null&&t!==!1;for(let s=e.children.length-1;s>=0;s--){const a=e.children[s];pM(e,a,r)}e.children.length=0,delete e.object.__r3f,r&&e.type!=="primitive"&&e.object.type!=="Scene"&&YI(e.object),t===void 0&&op(e)}function B4(i,e){for(const t of[i,i.alternate])if(t!==null)if(typeof t.ref=="function"){t.refCleanup==null||t.refCleanup();const n=t.ref(e);typeof n=="function"&&(t.refCleanup=n)}else t.ref&&(t.ref.current=e)}const Xy=[];function V4(){for(const[t]of Xy){const n=t.parent;if(n){t.props.attach?q_(n,t):Ds(t.object)&&Ds(n.object)&&n.object.remove(t.object);for(const r of t.children)r.props.attach?q_(t,r):Ds(r.object)&&Ds(t.object)&&t.object.remove(r.object)}t.isHidden&&XI(t),t.object.__r3f&&delete t.object.__r3f,t.type!=="primitive"&&YI(t.object)}for(const[t,n,r]of Xy){t.props=n;const s=t.parent;if(s){var i,e;const a=ep[Vx(t.type)];t.object=(i=t.props.object)!=null?i:new a(...(e=t.props.args)!=null?e:[]),t.object.__r3f=t,B4(r,t.object),vl(t.object,t.props),t.props.attach?G_(s,t):Ds(t.object)&&Ds(s.object)&&s.object.add(t.object);for(const c of t.children)c.props.attach?G_(t,c):Ds(c.object)&&Ds(t.object)&&t.object.add(c.object);op(t)}}Xy.length=0}const Db=()=>{},WA={};let Iy=qI;const H4=0,G4=4,W_=P4({isPrimaryRenderer:!1,warnsIfNotActing:!1,supportsMutation:!0,supportsPersistence:!1,supportsHydration:!1,createInstance:O4,removeChild:pM,appendChild:Nb,appendInitialChild:Nb,insertBefore:qA,appendChildToContainer(i,e){const t=i.getState().scene.__r3f;!e||!t||Nb(t,e)},removeChildFromContainer(i,e){const t=i.getState().scene.__r3f;!e||!t||pM(t,e)},insertInContainerBefore(i,e,t){const n=i.getState().scene.__r3f;!e||!t||!n||qA(n,e,t)},getRootHostContext:()=>WA,getChildHostContext:()=>WA,commitUpdate(i,e,t,n,r){var s,a,c;WI(e,n);let d=!1;if((i.type==="primitive"&&t.object!==n.object||((s=n.args)==null?void 0:s.length)!==((a=t.args)==null?void 0:a.length)||(c=n.args)!=null&&c.some((m,v)=>{var _;return m!==((_=t.args)==null?void 0:_[v])}))&&(d=!0),d)Xy.push([i,{...n},r]);else{const m=v4(i,n);Object.keys(m).length&&(Object.assign(i.props,m),vl(i.object,m))}(r.sibling===null||(r.flags&G4)===H4)&&V4()},finalizeInitialChildren:()=>!1,commitMount(){},getPublicInstance:i=>i==null?void 0:i.object,prepareForCommit:()=>null,preparePortalMount:i=>H_(i.getState().scene,i,"",{}),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance:z4,unhideInstance:XI,createTextInstance:Db,hideTextInstance:Db,unhideTextInstance:Db,scheduleTimeout:typeof setTimeout=="function"?setTimeout:void 0,cancelTimeout:typeof clearTimeout=="function"?clearTimeout:void 0,noTimeout:-1,getInstanceFromNode:()=>null,beforeActiveInstanceBlur(){},afterActiveInstanceBlur(){},detachDeletedInstance(){},prepareScopeUpdate(){},getInstanceFromScope:()=>null,shouldAttemptEagerTransition:()=>!1,trackSchedulerEvent:()=>{},resolveEventType:()=>null,resolveEventTimeStamp:()=>-1.1,requestPostPaintCallback(){},maySuspendCommit:()=>!1,preloadInstance:()=>!0,suspendInstance(){},waitForCommitToBeReady:()=>null,NotPendingTransition:null,HostTransitionContext:Oe.createContext(null),setCurrentUpdatePriority(i){Iy=i},getCurrentUpdatePriority(){return Iy},resolveUpdatePriority(){var i;if(Iy!==qI)return Iy;switch(typeof window<"u"&&((i=window.event)==null?void 0:i.type)){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return w4;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return T4;default:return A4}},resetFormInstance(){},rendererPackageName:"@react-three/fiber",rendererVersion:C4.version,applyViewTransitionName(i,e,t){},restoreViewTransitionName(i,e){},cancelViewTransitionName(i,e,t){},cancelRootViewTransitionName(i){},restoreRootViewTransitionName(i){},InstanceMeasurement:null,measureInstance:i=>null,wasInstanceInViewport:i=>!0,hasInstanceChanged:(i,e)=>!1,hasInstanceAffectedParent:(i,e)=>!1,suspendOnActiveViewTransition(i,e){},startGestureTransition:()=>null,startViewTransition:()=>null,stopViewTransition(i){},createViewTransitionInstance:i=>null,getCurrentGestureOffset(i){throw new Error("startGestureTransition is not yet supported in react-three-fiber.")},cloneMutableInstance(i,e){return i},cloneMutableTextInstance(i){return i},cloneRootViewTransitionContainer(i){throw new Error("Not implemented.")},removeRootViewTransitionClone(i,e){throw new Error("Not implemented.")},createFragmentInstance:i=>null,updateFragmentInstanceFiber(i,e){},commitNewChildToFragmentInstance(i,e){},deleteChildFromFragmentInstance(i,e){},measureClonedInstance:i=>null,maySuspendCommitOnUpdate:(i,e,t)=>!1,maySuspendCommitInSyncRender:(i,e)=>!1,startSuspendingCommit:()=>null,getSuspendedCommitReason:(i,e)=>null}),Yf=new Map,Ih={objects:"shallow",strict:!1};function q4(i,e){if(!e&&typeof HTMLCanvasElement<"u"&&i instanceof HTMLCanvasElement&&i.parentElement){const{width:t,height:n,top:r,left:s}=i.parentElement.getBoundingClientRect();return{width:t,height:n,top:r,left:s}}else if(!e&&typeof OffscreenCanvas<"u"&&i instanceof OffscreenCanvas)return{width:i.width,height:i.height,top:0,left:0};return{width:0,height:0,top:0,left:0,...e}}function W4(i){const e=Yf.get(i),t=e==null?void 0:e.fiber,n=e==null?void 0:e.store;e&&console.warn("R3F.createRoot should only be called once!");const r=typeof reportError=="function"?reportError:console.error,s=n||b4(vM,YA),a=t||W_.createContainer(s,E4,null,!1,null,"",r,r,r,null);e||Yf.set(i,{fiber:a,store:s});let c,d,p=!1,m=null;return{async configure(v={}){let _;m=new Promise($=>_=$);let{gl:b,size:T,scene:I,events:C,onCreated:A,shadows:D=!1,linear:U=!1,flat:L=!1,legacy:z=!1,orthographic:B=!1,frameloop:k="always",dpr:G=[1,2],performance:P,raycaster:O,camera:Z,onPointerMissed:ie}=v,ee=s.getState(),re=ee.gl;if(!ee.gl){const $={canvas:i,powerPreference:"high-performance",antialias:!0,alpha:!0},ce=typeof b=="function"?await b($):b;OA(ce)?re=ce:re=new AE({...$,...b}),ee.set({gl:re})}let de=ee.raycaster;de||ee.set({raycaster:de=new EE});const{params:J,...te}=O||{};if(ki.equ(te,de,Ih)||vl(de,{...te}),ki.equ(J,de.params,Ih)||vl(de,{params:{...de.params,...J}}),!ee.camera||ee.camera===d&&!ki.equ(d,Z,Ih)){d=Z;const $=Z==null?void 0:Z.isCamera,ce=$?Z:B?new jf(0,0,0,0,.1,1e3):new Fr(75,0,.1,1e3);$||(ce.position.z=5,Z&&(vl(ce,Z),ce.manual||("aspect"in Z||"left"in Z||"right"in Z||"bottom"in Z||"top"in Z)&&(ce.manual=!0,ce.updateProjectionMatrix())),!ee.camera&&!(Z!=null&&Z.rotation)&&ce.lookAt(0,0,0)),ee.set({camera:ce}),de.camera=ce}if(!ee.scene){let $;I!=null&&I.isScene?($=I,H_($,s,"",{})):($=new Hg,H_($,s,"",{}),I&&vl($,I)),ee.set({scene:$})}C&&!ee.events.handlers&&ee.set({events:C(s)});const ye=q4(i,T);if(ki.equ(ye,ee.size,Ih)||ee.setSize(ye.width,ye.height,ye.top,ye.left),G&&ee.viewport.dpr!==zI(G)&&ee.setDpr(G),ee.frameloop!==k&&ee.setFrameloop(k),ee.onPointerMissed||ee.set({onPointerMissed:ie}),P&&!ki.equ(P,ee.performance,Ih)&&ee.set($=>({performance:{...$.performance,...P}})),!ee.xr){var Ue;const $=(Be,St)=>{const ve=s.getState();ve.frameloop!=="never"&&YA(Be,!0,ve,St)},ce=()=>{const Be=s.getState();Be.gl.xr.enabled=Be.gl.xr.isPresenting,Be.gl.xr.setAnimationLoop(Be.gl.xr.isPresenting?$:null),Be.gl.xr.isPresenting||vM(Be)},Ee={connect(){const Be=s.getState().gl;Be.xr.addEventListener("sessionstart",ce),Be.xr.addEventListener("sessionend",ce)},disconnect(){const Be=s.getState().gl;Be.xr.removeEventListener("sessionstart",ce),Be.xr.removeEventListener("sessionend",ce)}};typeof((Ue=re.xr)==null?void 0:Ue.addEventListener)=="function"&&Ee.connect(),ee.set({xr:Ee})}if(re.shadowMap){const $=re.shadowMap.enabled,ce=re.shadowMap.type;if(re.shadowMap.enabled=!!D,ki.boo(D))re.shadowMap.type=rg;else if(ki.str(D)){var we;const Ee={basic:WC,percentage:Oh,soft:rg,variance:Uf};re.shadowMap.type=(we=Ee[D])!=null?we:rg}else ki.obj(D)&&Object.assign(re.shadowMap,D);($!==re.shadowMap.enabled||ce!==re.shadowMap.type)&&(re.shadowMap.needsUpdate=!0)}return Gn.enabled=!z,p||(re.outputColorSpace=U?Pa:es,re.toneMapping=L?ta:ix),ee.legacy!==z&&ee.set(()=>({legacy:z})),ee.linear!==U&&ee.set(()=>({linear:U})),ee.flat!==L&&ee.set(()=>({flat:L})),b&&!ki.fun(b)&&!OA(b)&&!ki.equ(b,re,Ih)&&vl(re,b),c=A,p=!0,_(),this},render(v){return!p&&!m&&this.configure(),m.then(()=>{W_.updateContainer(ue.jsx(X4,{store:s,children:v,onCreated:c,rootElement:i}),a,null,()=>{})}),s},unmount(){JI(i)}}}function X4({store:i,children:e,onCreated:t,rootElement:n}){return $g(()=>{const r=i.getState();r.set(s=>({internal:{...s.internal,active:!0}})),t&&t(r),i.getState().events.connected||r.events.connect==null||r.events.connect(n)},[]),ue.jsx(IE.Provider,{value:i,children:e})}function JI(i,e){const t=Yf.get(i),n=t==null?void 0:t.fiber;if(n){const r=t==null?void 0:t.store.getState();r&&(r.internal.active=!1),W_.updateContainer(null,n,null,()=>{r&&setTimeout(()=>{try{var s,a,c,d;r.events.disconnect==null||r.events.disconnect(),(s=r.gl)==null||(a=s.renderLists)==null||a.dispose==null||a.dispose(),(c=r.gl)==null||c.forceContextLoss==null||c.forceContextLoss(),(d=r.gl)!=null&&d.xr&&r.xr.disconnect(),p4(r.scene),Yf.delete(i)}catch{}},500)})}}function Y4(i,e,t){return ue.jsx(J4,{children:i,container:e,state:t})}function J4({state:i={},children:e,container:t}){const{events:n,size:r,...s}=i,a=NE(),[c]=Oe.useState(()=>new EE),[d]=Oe.useState(()=>new $e),p=RE((v,_)=>{let b;if(_.camera&&r){const T=_.camera;b=v.viewport.getCurrentViewport(T,new Q,r),T!==v.camera&&VI(T,r)}return{...v,..._,scene:t,raycaster:c,pointer:d,mouse:d,previousRoot:a,events:{...v.events,..._.events,...n},size:{...v.size,...r},viewport:{...v.viewport,...b},setEvents:T=>_.set(I=>({...I,events:{...I.events,...T}}))}}),m=Oe.useMemo(()=>{const v=NI((b,T)=>({...s,set:b,get:T})),_=b=>v.setState(T=>p.current(b,T));return _(a.getState()),a.subscribe(_),v},[a,t]);return ue.jsx(ue.Fragment,{children:W_.createPortal(ue.jsx(IE.Provider,{value:m,children:e}),m,null)})}const Z4=new Set,$4=new Set,K4=new Set;function Ub(i,e){if(i.size)for(const{callback:t}of i.values())t(e)}function hg(i,e){switch(i){case"before":return Ub(Z4,e);case"after":return Ub($4,e);case"tail":return Ub(K4,e)}}let Pb,Lb;function mM(i,e,t){let n=e.clock.getDelta();e.frameloop==="never"&&typeof i=="number"&&(n=i-e.clock.elapsedTime,e.clock.oldTime=e.clock.elapsedTime,e.clock.elapsedTime=i),Pb=e.internal.subscribers;for(let r=0;r<Pb.length;r++)Lb=Pb[r],Lb.ref.current(Lb.store.getState(),n,t);return!e.internal.priority&&e.gl.render&&e.gl.render(e.scene,e.camera),e.internal.frames=Math.max(0,e.internal.frames-1),e.frameloop==="always"?1:e.internal.frames}let X_=!1,gM=!1,Fb,XA,Nh;function ZI(i){XA=requestAnimationFrame(ZI),X_=!0,Fb=0,hg("before",i),gM=!0;for(const t of Yf.values()){var e;Nh=t.store.getState(),Nh.internal.active&&(Nh.frameloop==="always"||Nh.internal.frames>0)&&!((e=Nh.gl.xr)!=null&&e.isPresenting)&&(Fb+=mM(i,Nh))}if(gM=!1,hg("after",i),Fb===0)return hg("tail",i),X_=!1,cancelAnimationFrame(XA)}function vM(i,e=1){var t;if(!i)return Yf.forEach(n=>vM(n.store.getState(),e));(t=i.gl.xr)!=null&&t.isPresenting||!i.internal.active||i.frameloop==="never"||(e>1?i.internal.frames=Math.min(60,i.internal.frames+e):gM?i.internal.frames=2:i.internal.frames=1,X_||(X_=!0,requestAnimationFrame(ZI)))}function YA(i,e=!0,t,n){if(e&&hg("before",i),t)mM(i,t,n);else for(const r of Yf.values())mM(i,r.store.getState());e&&hg("after",i)}const kb={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function Q4(i){const{handlePointer:e}=S4(i);return{priority:1,enabled:!0,compute(t,n,r){n.pointer.set(t.offsetX/n.size.width*2-1,-(t.offsetY/n.size.height)*2+1),n.raycaster.setFromCamera(n.pointer,n.camera)},connected:void 0,handlers:Object.keys(kb).reduce((t,n)=>({...t,[n]:e(n)}),{}),update:()=>{var t;const{events:n,internal:r}=i.getState();(t=r.lastEvent)!=null&&t.current&&n.handlers&&n.handlers.onPointerMove(r.lastEvent.current)},connect:t=>{const{set:n,events:r}=i.getState();if(r.disconnect==null||r.disconnect(),n(s=>({events:{...s.events,connected:t}})),r.handlers)for(const s in r.handlers){const a=r.handlers[s],[c,d]=kb[s];t.addEventListener(c,a,{passive:d})}},disconnect:()=>{const{set:t,events:n}=i.getState();if(n.connected){if(n.handlers)for(const r in n.handlers){const s=n.handlers[r],[a]=kb[r];n.connected.removeEventListener(a,s)}t(r=>({events:{...r.events,connected:void 0}}))}}}}function JA(i,e){let t;return(...n)=>{window.clearTimeout(t),t=window.setTimeout(()=>i(...n),e)}}function j4({debounce:i,scroll:e,polyfill:t,offsetSize:n}={debounce:0,scroll:!1,offsetSize:!1}){const r=t||(typeof window>"u"?class{}:window.ResizeObserver);if(!r)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");const[s,a]=Oe.useState({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),c=Oe.useRef({element:null,scrollContainers:null,resizeObserver:null,lastBounds:s,orientationHandler:null}),d=i?typeof i=="number"?i:i.scroll:null,p=i?typeof i=="number"?i:i.resize:null,m=Oe.useRef(!1);Oe.useEffect(()=>(m.current=!0,()=>void(m.current=!1)));const[v,_,b]=Oe.useMemo(()=>{const A=()=>{if(!c.current.element)return;const{left:D,top:U,width:L,height:z,bottom:B,right:k,x:G,y:P}=c.current.element.getBoundingClientRect(),O={left:D,top:U,width:L,height:z,bottom:B,right:k,x:G,y:P};c.current.element instanceof HTMLElement&&n&&(O.height=c.current.element.offsetHeight,O.width=c.current.element.offsetWidth),Object.freeze(O),m.current&&!i5(c.current.lastBounds,O)&&a(c.current.lastBounds=O)};return[A,p?JA(A,p):A,d?JA(A,d):A]},[a,n,d,p]);function T(){c.current.scrollContainers&&(c.current.scrollContainers.forEach(A=>A.removeEventListener("scroll",b,!0)),c.current.scrollContainers=null),c.current.resizeObserver&&(c.current.resizeObserver.disconnect(),c.current.resizeObserver=null),c.current.orientationHandler&&("orientation"in screen&&"removeEventListener"in screen.orientation?screen.orientation.removeEventListener("change",c.current.orientationHandler):"onorientationchange"in window&&window.removeEventListener("orientationchange",c.current.orientationHandler))}function I(){c.current.element&&(c.current.resizeObserver=new r(b),c.current.resizeObserver.observe(c.current.element),e&&c.current.scrollContainers&&c.current.scrollContainers.forEach(A=>A.addEventListener("scroll",b,{capture:!0,passive:!0})),c.current.orientationHandler=()=>{b()},"orientation"in screen&&"addEventListener"in screen.orientation?screen.orientation.addEventListener("change",c.current.orientationHandler):"onorientationchange"in window&&window.addEventListener("orientationchange",c.current.orientationHandler))}const C=A=>{!A||A===c.current.element||(T(),c.current.element=A,c.current.scrollContainers=$I(A),I())};return t5(b,!!e),e5(_),Oe.useEffect(()=>{T(),I()},[e,b,_]),Oe.useEffect(()=>T,[]),[C,s,v]}function e5(i){Oe.useEffect(()=>{const e=i;return window.addEventListener("resize",e),()=>void window.removeEventListener("resize",e)},[i])}function t5(i,e){Oe.useEffect(()=>{if(e){const t=i;return window.addEventListener("scroll",t,{capture:!0,passive:!0}),()=>void window.removeEventListener("scroll",t,!0)}},[i,e])}function $I(i){const e=[];if(!i||i===document.body)return e;const{overflow:t,overflowX:n,overflowY:r}=window.getComputedStyle(i);return[t,n,r].some(s=>s==="auto"||s==="scroll")&&e.push(i),[...e,...$I(i.parentElement)]}const n5=["x","y","top","bottom","left","right","width","height"],i5=(i,e)=>n5.every(t=>i[t]===e[t]);function r5({ref:i,children:e,fallback:t,resize:n,style:r,gl:s,events:a=Q4,eventSource:c,eventPrefix:d,shadows:p,linear:m,flat:v,legacy:_,orthographic:b,frameloop:T,dpr:I,performance:C,raycaster:A,camera:D,scene:U,onPointerMissed:L,onCreated:z,...B}){Oe.useMemo(()=>DE(HB),[]);const k=c4(),[G,P]=j4({scroll:!0,debounce:{scroll:50,resize:0},...n}),O=Oe.useRef(null),Z=Oe.useRef(null);Oe.useImperativeHandle(i,()=>O.current);const ie=RE(L),[ee,re]=Oe.useState(!1),[de,J]=Oe.useState(!1);if(ee)throw ee;if(de)throw de;const te=Oe.useRef(null);$g(()=>{const Ue=O.current;if(P.width>0&&P.height>0&&Ue){te.current||(te.current=W4(Ue));async function we(){await te.current.configure({gl:s,scene:U,events:a,shadows:p,linear:m,flat:v,legacy:_,orthographic:b,frameloop:T,dpr:I,performance:C,raycaster:A,camera:D,size:P,onPointerMissed:(...$)=>ie.current==null?void 0:ie.current(...$),onCreated:$=>{$.events.connect==null||$.events.connect(c?l4(c)?c.current:c:Z.current),d&&$.setEvents({compute:(ce,Ee)=>{const Be=ce[d+"X"],St=ce[d+"Y"];Ee.pointer.set(Be/Ee.size.width*2-1,-(St/Ee.size.height)*2+1),Ee.raycaster.setFromCamera(Ee.pointer,Ee.camera)}}),z==null||z($)}}),te.current.render(ue.jsx(k,{children:ue.jsx(d4,{set:J,children:ue.jsx(Oe.Suspense,{fallback:ue.jsx(f4,{set:re}),children:e??null})})}))}we()}}),Oe.useEffect(()=>{const Ue=O.current;if(Ue)return()=>JI(Ue)},[]);const ye=c?"none":"auto";return ue.jsx("div",{ref:Z,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:ye,...r},...B,children:ue.jsx("div",{ref:G,style:{width:"100%",height:"100%"},children:ue.jsx("canvas",{ref:O,style:{display:"block"},children:t})})})}function s5(i){return ue.jsx(LI,{children:ue.jsx(r5,{...i})})}function El(){return El=Object.assign?Object.assign.bind():function(i){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)({}).hasOwnProperty.call(t,n)&&(i[n]=t[n])}return i},El.apply(null,arguments)}const Hx=parseInt(tp.replace(/\D+/g,"")),KI=Hx>=125?"uv1":"uv2";var ea=Uint8Array,xc=Uint16Array,yM=Uint32Array,QI=new ea([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),jI=new ea([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),o5=new ea([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),e3=function(i,e){for(var t=new xc(31),n=0;n<31;++n)t[n]=e+=1<<i[n-1];for(var r=new yM(t[30]),n=1;n<30;++n)for(var s=t[n];s<t[n+1];++s)r[s]=s-t[n]<<5|n;return[t,r]},t3=e3(QI,2),n3=t3[0],a5=t3[1];n3[28]=258,a5[258]=28;var l5=e3(jI,0),u5=l5[0],_M=new xc(32768);for(var Ii=0;Ii<32768;++Ii){var mc=(Ii&43690)>>>1|(Ii&21845)<<1;mc=(mc&52428)>>>2|(mc&13107)<<2,mc=(mc&61680)>>>4|(mc&3855)<<4,_M[Ii]=((mc&65280)>>>8|(mc&255)<<8)>>>1}var pg=(function(i,e,t){for(var n=i.length,r=0,s=new xc(e);r<n;++r)++s[i[r]-1];var a=new xc(e);for(r=0;r<e;++r)a[r]=a[r-1]+s[r-1]<<1;var c;if(t){c=new xc(1<<e);var d=15-e;for(r=0;r<n;++r)if(i[r])for(var p=r<<4|i[r],m=e-i[r],v=a[i[r]-1]++<<m,_=v|(1<<m)-1;v<=_;++v)c[_M[v]>>>d]=p}else for(c=new xc(n),r=0;r<n;++r)i[r]&&(c[r]=_M[a[i[r]-1]++]>>>15-i[r]);return c}),Qg=new ea(288);for(var Ii=0;Ii<144;++Ii)Qg[Ii]=8;for(var Ii=144;Ii<256;++Ii)Qg[Ii]=9;for(var Ii=256;Ii<280;++Ii)Qg[Ii]=7;for(var Ii=280;Ii<288;++Ii)Qg[Ii]=8;var i3=new ea(32);for(var Ii=0;Ii<32;++Ii)i3[Ii]=5;var c5=pg(Qg,9,1),f5=pg(i3,5,1),Ob=function(i){for(var e=i[0],t=1;t<i.length;++t)i[t]>e&&(e=i[t]);return e},wa=function(i,e,t){var n=e/8|0;return(i[n]|i[n+1]<<8)>>(e&7)&t},zb=function(i,e){var t=e/8|0;return(i[t]|i[t+1]<<8|i[t+2]<<16)>>(e&7)},d5=function(i){return(i/8|0)+(i&7&&1)},h5=function(i,e,t){(t==null||t>i.length)&&(t=i.length);var n=new(i instanceof xc?xc:i instanceof yM?yM:ea)(t-e);return n.set(i.subarray(e,t)),n},p5=function(i,e,t){var n=i.length;if(!n||t&&!t.l&&n<5)return e||new ea(0);var r=!e||t,s=!t||t.i;t||(t={}),e||(e=new ea(n*3));var a=function(ve){var Re=e.length;if(ve>Re){var ot=new ea(Math.max(Re*2,ve));ot.set(e),e=ot}},c=t.f||0,d=t.p||0,p=t.b||0,m=t.l,v=t.d,_=t.m,b=t.n,T=n*8;do{if(!m){t.f=c=wa(i,d,1);var I=wa(i,d+1,3);if(d+=3,I)if(I==1)m=c5,v=f5,_=9,b=5;else if(I==2){var U=wa(i,d,31)+257,L=wa(i,d+10,15)+4,z=U+wa(i,d+5,31)+1;d+=14;for(var B=new ea(z),k=new ea(19),G=0;G<L;++G)k[o5[G]]=wa(i,d+G*3,7);d+=L*3;for(var P=Ob(k),O=(1<<P)-1,Z=pg(k,P,1),G=0;G<z;){var ie=Z[wa(i,d,O)];d+=ie&15;var C=ie>>>4;if(C<16)B[G++]=C;else{var ee=0,re=0;for(C==16?(re=3+wa(i,d,3),d+=2,ee=B[G-1]):C==17?(re=3+wa(i,d,7),d+=3):C==18&&(re=11+wa(i,d,127),d+=7);re--;)B[G++]=ee}}var de=B.subarray(0,U),J=B.subarray(U);_=Ob(de),b=Ob(J),m=pg(de,_,1),v=pg(J,b,1)}else throw"invalid block type";else{var C=d5(d)+4,A=i[C-4]|i[C-3]<<8,D=C+A;if(D>n){if(s)throw"unexpected EOF";break}r&&a(p+A),e.set(i.subarray(C,D),p),t.b=p+=A,t.p=d=D*8;continue}if(d>T){if(s)throw"unexpected EOF";break}}r&&a(p+131072);for(var te=(1<<_)-1,ye=(1<<b)-1,Ue=d;;Ue=d){var ee=m[zb(i,d)&te],we=ee>>>4;if(d+=ee&15,d>T){if(s)throw"unexpected EOF";break}if(!ee)throw"invalid length/literal";if(we<256)e[p++]=we;else if(we==256){Ue=d,m=null;break}else{var $=we-254;if(we>264){var G=we-257,ce=QI[G];$=wa(i,d,(1<<ce)-1)+n3[G],d+=ce}var Ee=v[zb(i,d)&ye],Be=Ee>>>4;if(!Ee)throw"invalid distance";d+=Ee&15;var J=u5[Be];if(Be>3){var ce=jI[Be];J+=zb(i,d)&(1<<ce)-1,d+=ce}if(d>T){if(s)throw"unexpected EOF";break}r&&a(p+131072);for(var St=p+$;p<St;p+=4)e[p]=e[p-J],e[p+1]=e[p+1-J],e[p+2]=e[p+2-J],e[p+3]=e[p+3-J];p=St}}t.l=m,t.p=Ue,t.b=p,m&&(c=1,t.m=_,t.d=v,t.n=b)}while(!c);return p==e.length?e:h5(e,0,p)},m5=new ea(0),g5=function(i){if((i[0]&15)!=8||i[0]>>>4>7||(i[0]<<8|i[1])%31)throw"invalid zlib data";if(i[1]&32)throw"invalid zlib data: preset dictionaries not supported"};function Ny(i,e){return p5((g5(i),i.subarray(2,-4)),e)}var v5=typeof TextDecoder<"u"&&new TextDecoder,y5=0;try{v5.decode(m5,{stream:!0}),y5=1}catch{}const _5=i=>i&&i.isCubeTexture;class x5 extends Di{constructor(e,t){var n,r;const s=_5(e),c=((r=s?(n=e.image[0])==null?void 0:n.width:e.image.width)!=null?r:1024)/4,d=Math.floor(Math.log2(c)),p=Math.pow(2,d),m=3*Math.max(p,112),v=4*p,_=[s?"#define ENVMAP_TYPE_CUBE":"",`#define CUBEUV_TEXEL_WIDTH ${1/m}`,`#define CUBEUV_TEXEL_HEIGHT ${1/v}`,`#define CUBEUV_MAX_MIP ${d}.0`],b=`
        varying vec3 vWorldPosition;
        void main() 
        {
            vec4 worldPosition = ( modelMatrix * vec4( position, 1.0 ) );
            vWorldPosition = worldPosition.xyz;
            
            gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
        }
        `,T=_.join(`
`)+`
        #define ENVMAP_TYPE_CUBE_UV
        varying vec3 vWorldPosition;
        uniform float radius;
        uniform float height;
        uniform float angle;
        #ifdef ENVMAP_TYPE_CUBE
            uniform samplerCube map;
        #else
            uniform sampler2D map;
        #endif
        // From: https://www.shadertoy.com/view/4tsBD7
        float diskIntersectWithBackFaceCulling( vec3 ro, vec3 rd, vec3 c, vec3 n, float r ) 
        {
            float d = dot ( rd, n );
            
            if( d > 0.0 ) { return 1e6; }
            
            vec3  o = ro - c;
            float t = - dot( n, o ) / d;
            vec3  q = o + rd * t;
            
            return ( dot( q, q ) < r * r ) ? t : 1e6;
        }
        // From: https://www.iquilezles.org/www/articles/intersectors/intersectors.htm
        float sphereIntersect( vec3 ro, vec3 rd, vec3 ce, float ra ) 
        {
            vec3 oc = ro - ce;
            float b = dot( oc, rd );
            float c = dot( oc, oc ) - ra * ra;
            float h = b * b - c;
            
            if( h < 0.0 ) { return -1.0; }
            
            h = sqrt( h );
            
            return - b + h;
        }
        vec3 project() 
        {
            vec3 p = normalize( vWorldPosition );
            vec3 camPos = cameraPosition;
            camPos.y -= height;
            float intersection = sphereIntersect( camPos, p, vec3( 0.0 ), radius );
            if( intersection > 0.0 ) {
                
                vec3 h = vec3( 0.0, - height, 0.0 );
                float intersection2 = diskIntersectWithBackFaceCulling( camPos, p, h, vec3( 0.0, 1.0, 0.0 ), radius );
                p = ( camPos + min( intersection, intersection2 ) * p ) / radius;
            } else {
                p = vec3( 0.0, 1.0, 0.0 );
            }
            return p;
        }
        #include <common>
        #include <cube_uv_reflection_fragment>
        void main() 
        {
            vec3 projectedWorldPosition = project();
            
            #ifdef ENVMAP_TYPE_CUBE
                vec3 outcolor = textureCube( map, projectedWorldPosition ).rgb;
            #else
                vec3 direction = normalize( projectedWorldPosition );
                vec2 uv = equirectUv( direction );
                vec3 outcolor = texture2D( map, uv ).rgb;
            #endif
            gl_FragColor = vec4( outcolor, 1.0 );
            #include <tonemapping_fragment>
            #include <${Hx>=154?"colorspace_fragment":"encodings_fragment"}>
        }
        `,I={map:{value:e},height:{value:(t==null?void 0:t.height)||15},radius:{value:(t==null?void 0:t.radius)||100}},C=new Wg(1,16),A=new Ar({uniforms:I,fragmentShader:T,vertexShader:b,side:vo});super(C,A)}set radius(e){this.material.uniforms.radius.value=e}get radius(){return this.material.uniforms.radius.value}set height(e){this.material.uniforms.height.value=e}get height(){return this.material.uniforms.height.value}}const S5={uniforms:{tDiffuse:{value:null},h:{value:1/512}},vertexShader:`
      varying vec2 vUv;

      void main() {

        vUv = uv;
        gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

      }
  `,fragmentShader:`
    uniform sampler2D tDiffuse;
    uniform float h;

    varying vec2 vUv;

    void main() {

    	vec4 sum = vec4( 0.0 );

    	sum += texture2D( tDiffuse, vec2( vUv.x - 4.0 * h, vUv.y ) ) * 0.051;
    	sum += texture2D( tDiffuse, vec2( vUv.x - 3.0 * h, vUv.y ) ) * 0.0918;
    	sum += texture2D( tDiffuse, vec2( vUv.x - 2.0 * h, vUv.y ) ) * 0.12245;
    	sum += texture2D( tDiffuse, vec2( vUv.x - 1.0 * h, vUv.y ) ) * 0.1531;
    	sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;
    	sum += texture2D( tDiffuse, vec2( vUv.x + 1.0 * h, vUv.y ) ) * 0.1531;
    	sum += texture2D( tDiffuse, vec2( vUv.x + 2.0 * h, vUv.y ) ) * 0.12245;
    	sum += texture2D( tDiffuse, vec2( vUv.x + 3.0 * h, vUv.y ) ) * 0.0918;
    	sum += texture2D( tDiffuse, vec2( vUv.x + 4.0 * h, vUv.y ) ) * 0.051;

    	gl_FragColor = sum;

    }
  `},b5={uniforms:{tDiffuse:{value:null},v:{value:1/512}},vertexShader:`
    varying vec2 vUv;

    void main() {

      vUv = uv;
      gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

    }
  `,fragmentShader:`

  uniform sampler2D tDiffuse;
  uniform float v;

  varying vec2 vUv;

  void main() {

    vec4 sum = vec4( 0.0 );

    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 4.0 * v ) ) * 0.051;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 3.0 * v ) ) * 0.0918;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 2.0 * v ) ) * 0.12245;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 1.0 * v ) ) * 0.1531;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 1.0 * v ) ) * 0.1531;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 2.0 * v ) ) * 0.12245;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 3.0 * v ) ) * 0.0918;
    sum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 4.0 * v ) ) * 0.051;

    gl_FragColor = sum;

  }
  `};class M5 extends gE{constructor(e){super(e),this.type=Wi}parse(e){const a=function(G,P){switch(G){case 1:throw new Error("THREE.RGBELoader: Read Error: "+(P||""));case 2:throw new Error("THREE.RGBELoader: Write Error: "+(P||""));case 3:throw new Error("THREE.RGBELoader: Bad File Format: "+(P||""));default:case 4:throw new Error("THREE.RGBELoader: Memory Error: "+(P||""))}},v=function(G,P,O){P=P||1024;let ie=G.pos,ee=-1,re=0,de="",J=String.fromCharCode.apply(null,new Uint16Array(G.subarray(ie,ie+128)));for(;0>(ee=J.indexOf(`
`))&&re<P&&ie<G.byteLength;)de+=J,re+=J.length,ie+=128,J+=String.fromCharCode.apply(null,new Uint16Array(G.subarray(ie,ie+128)));return-1<ee?(G.pos+=re+ee+1,de+J.slice(0,ee)):!1},_=function(G){const P=/^#\?(\S+)/,O=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,Z=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,ie=/^\s*FORMAT=(\S+)\s*$/,ee=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,re={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};let de,J;for((G.pos>=G.byteLength||!(de=v(G)))&&a(1,"no header found"),(J=de.match(P))||a(3,"bad initial token"),re.valid|=1,re.programtype=J[1],re.string+=de+`
`;de=v(G),de!==!1;){if(re.string+=de+`
`,de.charAt(0)==="#"){re.comments+=de+`
`;continue}if((J=de.match(O))&&(re.gamma=parseFloat(J[1])),(J=de.match(Z))&&(re.exposure=parseFloat(J[1])),(J=de.match(ie))&&(re.valid|=2,re.format=J[1]),(J=de.match(ee))&&(re.valid|=4,re.height=parseInt(J[1],10),re.width=parseInt(J[2],10)),re.valid&2&&re.valid&4)break}return re.valid&2||a(3,"missing format specifier"),re.valid&4||a(3,"missing image size specifier"),re},b=function(G,P,O){const Z=P;if(Z<8||Z>32767||G[0]!==2||G[1]!==2||G[2]&128)return new Uint8Array(G);Z!==(G[2]<<8|G[3])&&a(3,"wrong scanline width");const ie=new Uint8Array(4*P*O);ie.length||a(4,"unable to allocate buffer space");let ee=0,re=0;const de=4*Z,J=new Uint8Array(4),te=new Uint8Array(de);let ye=O;for(;ye>0&&re<G.byteLength;){re+4>G.byteLength&&a(1),J[0]=G[re++],J[1]=G[re++],J[2]=G[re++],J[3]=G[re++],(J[0]!=2||J[1]!=2||(J[2]<<8|J[3])!=Z)&&a(3,"bad rgbe scanline format");let Ue=0,we;for(;Ue<de&&re<G.byteLength;){we=G[re++];const ce=we>128;if(ce&&(we-=128),(we===0||Ue+we>de)&&a(3,"bad scanline data"),ce){const Ee=G[re++];for(let Be=0;Be<we;Be++)te[Ue++]=Ee}else te.set(G.subarray(re,re+we),Ue),Ue+=we,re+=we}const $=Z;for(let ce=0;ce<$;ce++){let Ee=0;ie[ee]=te[ce+Ee],Ee+=Z,ie[ee+1]=te[ce+Ee],Ee+=Z,ie[ee+2]=te[ce+Ee],Ee+=Z,ie[ee+3]=te[ce+Ee],ee+=4}ye--}return ie},T=function(G,P,O,Z){const ie=G[P+3],ee=Math.pow(2,ie-128)/255;O[Z+0]=G[P+0]*ee,O[Z+1]=G[P+1]*ee,O[Z+2]=G[P+2]*ee,O[Z+3]=1},I=function(G,P,O,Z){const ie=G[P+3],ee=Math.pow(2,ie-128)/255;O[Z+0]=Ff.toHalfFloat(Math.min(G[P+0]*ee,65504)),O[Z+1]=Ff.toHalfFloat(Math.min(G[P+1]*ee,65504)),O[Z+2]=Ff.toHalfFloat(Math.min(G[P+2]*ee,65504)),O[Z+3]=Ff.toHalfFloat(1)},C=new Uint8Array(e);C.pos=0;const A=_(C),D=A.width,U=A.height,L=b(C.subarray(C.pos),D,U);let z,B,k;switch(this.type){case Ni:k=L.length/4;const G=new Float32Array(k*4);for(let O=0;O<k;O++)T(L,O*4,G,O*4);z=G,B=Ni;break;case Wi:k=L.length/4;const P=new Uint16Array(k*4);for(let O=0;O<k;O++)I(L,O*4,P,O*4);z=P,B=Wi;break;default:throw new Error("THREE.RGBELoader: Unsupported type: "+this.type)}return{width:D,height:U,data:z,header:A.string,gamma:A.gamma,exposure:A.exposure,type:B}}setDataType(e){return this.type=e,this}load(e,t,n,r){function s(a,c){switch(a.type){case Ni:case Wi:"colorSpace"in a?a.colorSpace="srgb-linear":a.encoding=3e3,a.minFilter=Bn,a.magFilter=Bn,a.generateMipmaps=!1,a.flipY=!0;break}t&&t(a,c)}return super.load(e,s,n,r)}}const Zm=Hx>=152;class E5 extends gE{constructor(e){super(e),this.type=Wi}parse(e){const P=Math.pow(2.7182818,2.2);function O(H,Y){for(var oe=0,Se=0;Se<65536;++Se)(Se==0||H[Se>>3]&1<<(Se&7))&&(Y[oe++]=Se);for(var Le=oe-1;oe<65536;)Y[oe++]=0;return Le}function Z(H){for(var Y=0;Y<16384;Y++)H[Y]={},H[Y].len=0,H[Y].lit=0,H[Y].p=null}const ie={l:0,c:0,lc:0};function ee(H,Y,oe,Se,Le){for(;oe<H;)Y=Y<<8|Nt(Se,Le),oe+=8;oe-=H,ie.l=Y>>oe&(1<<H)-1,ie.c=Y,ie.lc=oe}const re=new Array(59);function de(H){for(var Y=0;Y<=58;++Y)re[Y]=0;for(var Y=0;Y<65537;++Y)re[H[Y]]+=1;for(var oe=0,Y=58;Y>0;--Y){var Se=oe+re[Y]>>1;re[Y]=oe,oe=Se}for(var Y=0;Y<65537;++Y){var Le=H[Y];Le>0&&(H[Y]=Le|re[Le]++<<6)}}function J(H,Y,oe,Se,Le,ke,it){for(var Qe=oe,pt=0,ft=0;Le<=ke;Le++){if(Qe.value-oe.value>Se)return!1;ee(6,pt,ft,H,Qe);var yt=ie.l;if(pt=ie.c,ft=ie.lc,it[Le]=yt,yt==63){if(Qe.value-oe.value>Se)throw"Something wrong with hufUnpackEncTable";ee(8,pt,ft,H,Qe);var ct=ie.l+6;if(pt=ie.c,ft=ie.lc,Le+ct>ke+1)throw"Something wrong with hufUnpackEncTable";for(;ct--;)it[Le++]=0;Le--}else if(yt>=59){var ct=yt-59+2;if(Le+ct>ke+1)throw"Something wrong with hufUnpackEncTable";for(;ct--;)it[Le++]=0;Le--}}de(it)}function te(H){return H&63}function ye(H){return H>>6}function Ue(H,Y,oe,Se){for(;Y<=oe;Y++){var Le=ye(H[Y]),ke=te(H[Y]);if(Le>>ke)throw"Invalid table entry";if(ke>14){var it=Se[Le>>ke-14];if(it.len)throw"Invalid table entry";if(it.lit++,it.p){var Qe=it.p;it.p=new Array(it.lit);for(var pt=0;pt<it.lit-1;++pt)it.p[pt]=Qe[pt]}else it.p=new Array(1);it.p[it.lit-1]=Y}else if(ke)for(var ft=0,pt=1<<14-ke;pt>0;pt--){var it=Se[(Le<<14-ke)+ft];if(it.len||it.p)throw"Invalid table entry";it.len=ke,it.lit=Y,ft++}}return!0}const we={c:0,lc:0};function $(H,Y,oe,Se){H=H<<8|Nt(oe,Se),Y+=8,we.c=H,we.lc=Y}const ce={c:0,lc:0};function Ee(H,Y,oe,Se,Le,ke,it,Qe,pt,ft){if(H==Y){Se<8&&($(oe,Se,Le,it),oe=we.c,Se=we.lc),Se-=8;var yt=oe>>Se,yt=new Uint8Array([yt])[0];if(pt.value+yt>ft)return!1;for(var ct=Qe[pt.value-1];yt-- >0;)Qe[pt.value++]=ct}else if(pt.value<ft)Qe[pt.value++]=H;else return!1;ce.c=oe,ce.lc=Se}function Be(H){return H&65535}function St(H){var Y=Be(H);return Y>32767?Y-65536:Y}const ve={a:0,b:0};function Re(H,Y){var oe=St(H),Se=St(Y),Le=Se,ke=oe+(Le&1)+(Le>>1),it=ke,Qe=ke-Le;ve.a=it,ve.b=Qe}function ot(H,Y){var oe=Be(H),Se=Be(Y),Le=oe-(Se>>1)&65535,ke=Se+Le-32768&65535;ve.a=ke,ve.b=Le}function bt(H,Y,oe,Se,Le,ke,it){for(var Qe=it<16384,pt=oe>Le?Le:oe,ft=1,yt;ft<=pt;)ft<<=1;for(ft>>=1,yt=ft,ft>>=1;ft>=1;){for(var ct=0,q=ct+ke*(Le-yt),ne=ke*ft,he=ke*yt,ge=Se*ft,le=Se*yt,Ge,rt,Xe,Mt;ct<=q;ct+=he){for(var dt=ct,Bt=ct+Se*(oe-yt);dt<=Bt;dt+=le){var gt=dt+ge,kt=dt+ne,fn=kt+ge;Qe?(Re(H[dt+Y],H[kt+Y]),Ge=ve.a,Xe=ve.b,Re(H[gt+Y],H[fn+Y]),rt=ve.a,Mt=ve.b,Re(Ge,rt),H[dt+Y]=ve.a,H[gt+Y]=ve.b,Re(Xe,Mt),H[kt+Y]=ve.a,H[fn+Y]=ve.b):(ot(H[dt+Y],H[kt+Y]),Ge=ve.a,Xe=ve.b,ot(H[gt+Y],H[fn+Y]),rt=ve.a,Mt=ve.b,ot(Ge,rt),H[dt+Y]=ve.a,H[gt+Y]=ve.b,ot(Xe,Mt),H[kt+Y]=ve.a,H[fn+Y]=ve.b)}if(oe&ft){var kt=dt+ne;Qe?Re(H[dt+Y],H[kt+Y]):ot(H[dt+Y],H[kt+Y]),Ge=ve.a,H[kt+Y]=ve.b,H[dt+Y]=Ge}}if(Le&ft)for(var dt=ct,Bt=ct+Se*(oe-yt);dt<=Bt;dt+=le){var gt=dt+ge;Qe?Re(H[dt+Y],H[gt+Y]):ot(H[dt+Y],H[gt+Y]),Ge=ve.a,H[gt+Y]=ve.b,H[dt+Y]=Ge}yt=ft,ft>>=1}return ct}function Dt(H,Y,oe,Se,Le,ke,it,Qe,pt,ft){for(var yt=0,ct=0,q=Qe,ne=Math.trunc(Le.value+(ke+7)/8);Le.value<ne;)for($(yt,ct,oe,Le),yt=we.c,ct=we.lc;ct>=14;){var he=yt>>ct-14&16383,ge=Y[he];if(ge.len)ct-=ge.len,Ee(ge.lit,it,yt,ct,oe,Se,Le,pt,ft,q),yt=ce.c,ct=ce.lc;else{if(!ge.p)throw"hufDecode issues";var le;for(le=0;le<ge.lit;le++){for(var Ge=te(H[ge.p[le]]);ct<Ge&&Le.value<ne;)$(yt,ct,oe,Le),yt=we.c,ct=we.lc;if(ct>=Ge&&ye(H[ge.p[le]])==(yt>>ct-Ge&(1<<Ge)-1)){ct-=Ge,Ee(ge.p[le],it,yt,ct,oe,Se,Le,pt,ft,q),yt=ce.c,ct=ce.lc;break}}if(le==ge.lit)throw"hufDecode issues"}}var rt=8-ke&7;for(yt>>=rt,ct-=rt;ct>0;){var ge=Y[yt<<14-ct&16383];if(ge.len)ct-=ge.len,Ee(ge.lit,it,yt,ct,oe,Se,Le,pt,ft,q),yt=ce.c,ct=ce.lc;else throw"hufDecode issues"}return!0}function cn(H,Y,oe,Se,Le,ke){var it={value:0},Qe=oe.value,pt=Ke(Y,oe),ft=Ke(Y,oe);oe.value+=4;var yt=Ke(Y,oe);if(oe.value+=4,pt<0||pt>=65537||ft<0||ft>=65537)throw"Something wrong with HUF_ENCSIZE";var ct=new Array(65537),q=new Array(16384);Z(q);var ne=Se-(oe.value-Qe);if(J(H,Y,oe,ne,pt,ft,ct),yt>8*(Se-(oe.value-Qe)))throw"Something wrong with hufUncompress";Ue(ct,pt,ft,q),Dt(ct,q,H,Y,oe,yt,ft,ke,Le,it)}function Tn(H,Y,oe){for(var Se=0;Se<oe;++Se)Y[Se]=H[Y[Se]]}function Zt(H){for(var Y=1;Y<H.length;Y++){var oe=H[Y-1]+H[Y]-128;H[Y]=oe}}function Ve(H,Y){for(var oe=0,Se=Math.floor((H.length+1)/2),Le=0,ke=H.length-1;!(Le>ke||(Y[Le++]=H[oe++],Le>ke));)Y[Le++]=H[Se++]}function et(H){for(var Y=H.byteLength,oe=new Array,Se=0,Le=new DataView(H);Y>0;){var ke=Le.getInt8(Se++);if(ke<0){var it=-ke;Y-=it+1;for(var Qe=0;Qe<it;Qe++)oe.push(Le.getUint8(Se++))}else{var it=ke;Y-=2;for(var pt=Le.getUint8(Se++),Qe=0;Qe<it+1;Qe++)oe.push(pt)}}return oe}function qe(H,Y,oe,Se,Le,ke){var gt=new DataView(ke.buffer),it=oe[H.idx[0]].width,Qe=oe[H.idx[0]].height,pt=3,ft=Math.floor(it/8),yt=Math.ceil(it/8),ct=Math.ceil(Qe/8),q=it-(yt-1)*8,ne=Qe-(ct-1)*8,he={value:0},ge=new Array(pt),le=new Array(pt),Ge=new Array(pt),rt=new Array(pt),Xe=new Array(pt);for(let Ut=0;Ut<pt;++Ut)Xe[Ut]=Y[H.idx[Ut]],ge[Ut]=Ut<1?0:ge[Ut-1]+yt*ct,le[Ut]=new Float32Array(64),Ge[Ut]=new Uint16Array(64),rt[Ut]=new Uint16Array(yt*64);for(let Ut=0;Ut<ct;++Ut){var Mt=8;Ut==ct-1&&(Mt=ne);var dt=8;for(let qt=0;qt<yt;++qt){qt==yt-1&&(dt=q);for(let At=0;At<pt;++At)Ge[At].fill(0),Ge[At][0]=Le[ge[At]++],_t(he,Se,Ge[At]),j(Ge[At],le[At]),Ht(le[At]);Et(le);for(let At=0;At<pt;++At)Gt(le[At],rt[At],qt*64)}let lt=0;for(let qt=0;qt<pt;++qt){const At=oe[H.idx[qt]].type;for(let qn=8*Ut;qn<8*Ut+Mt;++qn){lt=Xe[qt][qn];for(let er=0;er<ft;++er){const An=er*64+(qn&7)*8;gt.setUint16(lt+0*At,rt[qt][An+0],!0),gt.setUint16(lt+2*At,rt[qt][An+1],!0),gt.setUint16(lt+4*At,rt[qt][An+2],!0),gt.setUint16(lt+6*At,rt[qt][An+3],!0),gt.setUint16(lt+8*At,rt[qt][An+4],!0),gt.setUint16(lt+10*At,rt[qt][An+5],!0),gt.setUint16(lt+12*At,rt[qt][An+6],!0),gt.setUint16(lt+14*At,rt[qt][An+7],!0),lt+=16*At}}if(ft!=yt)for(let qn=8*Ut;qn<8*Ut+Mt;++qn){const er=Xe[qt][qn]+8*ft*2*At,An=ft*64+(qn&7)*8;for(let yi=0;yi<dt;++yi)gt.setUint16(er+yi*2*At,rt[qt][An+yi],!0)}}}for(var Bt=new Uint16Array(it),gt=new DataView(ke.buffer),kt=0;kt<pt;++kt){oe[H.idx[kt]].decoded=!0;var fn=oe[H.idx[kt]].type;if(oe[kt].type==2)for(var Xn=0;Xn<Qe;++Xn){const Ut=Xe[kt][Xn];for(var yn=0;yn<it;++yn)Bt[yn]=gt.getUint16(Ut+yn*2*fn,!0);for(var yn=0;yn<it;++yn)gt.setFloat32(Ut+yn*2*fn,Ce(Bt[yn]),!0)}}}function _t(H,Y,oe){for(var Se,Le=1;Le<64;)Se=Y[H.value],Se==65280?Le=64:Se>>8==255?Le+=Se&255:(oe[Le]=Se,Le++),H.value++}function j(H,Y){Y[0]=Ce(H[0]),Y[1]=Ce(H[1]),Y[2]=Ce(H[5]),Y[3]=Ce(H[6]),Y[4]=Ce(H[14]),Y[5]=Ce(H[15]),Y[6]=Ce(H[27]),Y[7]=Ce(H[28]),Y[8]=Ce(H[2]),Y[9]=Ce(H[4]),Y[10]=Ce(H[7]),Y[11]=Ce(H[13]),Y[12]=Ce(H[16]),Y[13]=Ce(H[26]),Y[14]=Ce(H[29]),Y[15]=Ce(H[42]),Y[16]=Ce(H[3]),Y[17]=Ce(H[8]),Y[18]=Ce(H[12]),Y[19]=Ce(H[17]),Y[20]=Ce(H[25]),Y[21]=Ce(H[30]),Y[22]=Ce(H[41]),Y[23]=Ce(H[43]),Y[24]=Ce(H[9]),Y[25]=Ce(H[11]),Y[26]=Ce(H[18]),Y[27]=Ce(H[24]),Y[28]=Ce(H[31]),Y[29]=Ce(H[40]),Y[30]=Ce(H[44]),Y[31]=Ce(H[53]),Y[32]=Ce(H[10]),Y[33]=Ce(H[19]),Y[34]=Ce(H[23]),Y[35]=Ce(H[32]),Y[36]=Ce(H[39]),Y[37]=Ce(H[45]),Y[38]=Ce(H[52]),Y[39]=Ce(H[54]),Y[40]=Ce(H[20]),Y[41]=Ce(H[22]),Y[42]=Ce(H[33]),Y[43]=Ce(H[38]),Y[44]=Ce(H[46]),Y[45]=Ce(H[51]),Y[46]=Ce(H[55]),Y[47]=Ce(H[60]),Y[48]=Ce(H[21]),Y[49]=Ce(H[34]),Y[50]=Ce(H[37]),Y[51]=Ce(H[47]),Y[52]=Ce(H[50]),Y[53]=Ce(H[56]),Y[54]=Ce(H[59]),Y[55]=Ce(H[61]),Y[56]=Ce(H[35]),Y[57]=Ce(H[36]),Y[58]=Ce(H[48]),Y[59]=Ce(H[49]),Y[60]=Ce(H[57]),Y[61]=Ce(H[58]),Y[62]=Ce(H[62]),Y[63]=Ce(H[63])}function Ht(H){const Y=.5*Math.cos(.7853975),oe=.5*Math.cos(3.14159/16),Se=.5*Math.cos(3.14159/8),Le=.5*Math.cos(3*3.14159/16),ke=.5*Math.cos(5*3.14159/16),it=.5*Math.cos(3*3.14159/8),Qe=.5*Math.cos(7*3.14159/16);for(var pt=new Array(4),ft=new Array(4),yt=new Array(4),ct=new Array(4),q=0;q<8;++q){var ne=q*8;pt[0]=Se*H[ne+2],pt[1]=it*H[ne+2],pt[2]=Se*H[ne+6],pt[3]=it*H[ne+6],ft[0]=oe*H[ne+1]+Le*H[ne+3]+ke*H[ne+5]+Qe*H[ne+7],ft[1]=Le*H[ne+1]-Qe*H[ne+3]-oe*H[ne+5]-ke*H[ne+7],ft[2]=ke*H[ne+1]-oe*H[ne+3]+Qe*H[ne+5]+Le*H[ne+7],ft[3]=Qe*H[ne+1]-ke*H[ne+3]+Le*H[ne+5]-oe*H[ne+7],yt[0]=Y*(H[ne+0]+H[ne+4]),yt[3]=Y*(H[ne+0]-H[ne+4]),yt[1]=pt[0]+pt[3],yt[2]=pt[1]-pt[2],ct[0]=yt[0]+yt[1],ct[1]=yt[3]+yt[2],ct[2]=yt[3]-yt[2],ct[3]=yt[0]-yt[1],H[ne+0]=ct[0]+ft[0],H[ne+1]=ct[1]+ft[1],H[ne+2]=ct[2]+ft[2],H[ne+3]=ct[3]+ft[3],H[ne+4]=ct[3]-ft[3],H[ne+5]=ct[2]-ft[2],H[ne+6]=ct[1]-ft[1],H[ne+7]=ct[0]-ft[0]}for(var he=0;he<8;++he)pt[0]=Se*H[16+he],pt[1]=it*H[16+he],pt[2]=Se*H[48+he],pt[3]=it*H[48+he],ft[0]=oe*H[8+he]+Le*H[24+he]+ke*H[40+he]+Qe*H[56+he],ft[1]=Le*H[8+he]-Qe*H[24+he]-oe*H[40+he]-ke*H[56+he],ft[2]=ke*H[8+he]-oe*H[24+he]+Qe*H[40+he]+Le*H[56+he],ft[3]=Qe*H[8+he]-ke*H[24+he]+Le*H[40+he]-oe*H[56+he],yt[0]=Y*(H[he]+H[32+he]),yt[3]=Y*(H[he]-H[32+he]),yt[1]=pt[0]+pt[3],yt[2]=pt[1]-pt[2],ct[0]=yt[0]+yt[1],ct[1]=yt[3]+yt[2],ct[2]=yt[3]-yt[2],ct[3]=yt[0]-yt[1],H[0+he]=ct[0]+ft[0],H[8+he]=ct[1]+ft[1],H[16+he]=ct[2]+ft[2],H[24+he]=ct[3]+ft[3],H[32+he]=ct[3]-ft[3],H[40+he]=ct[2]-ft[2],H[48+he]=ct[1]-ft[1],H[56+he]=ct[0]-ft[0]}function Et(H){for(var Y=0;Y<64;++Y){var oe=H[0][Y],Se=H[1][Y],Le=H[2][Y];H[0][Y]=oe+1.5747*Le,H[1][Y]=oe-.1873*Se-.4682*Le,H[2][Y]=oe+1.8556*Se}}function Gt(H,Y,oe){for(var Se=0;Se<64;++Se)Y[oe+Se]=Ff.toHalfFloat(ut(H[Se]))}function ut(H){return H<=1?Math.sign(H)*Math.pow(Math.abs(H),2.2):Math.sign(H)*Math.pow(P,Math.abs(H)-1)}function K(H){return new DataView(H.array.buffer,H.offset.value,H.size)}function V(H){var Y=H.viewer.buffer.slice(H.offset.value,H.offset.value+H.size),oe=new Uint8Array(et(Y)),Se=new Uint8Array(oe.length);return Zt(oe),Ve(oe,Se),new DataView(Se.buffer)}function pe(H){var Y=H.array.slice(H.offset.value,H.offset.value+H.size),oe=Ny(Y),Se=new Uint8Array(oe.length);return Zt(oe),Ve(oe,Se),new DataView(Se.buffer)}function De(H){for(var Y=H.viewer,oe={value:H.offset.value},Se=new Uint16Array(H.width*H.scanlineBlockSize*(H.channels*H.type)),Le=new Uint8Array(8192),ke=0,it=new Array(H.channels),Qe=0;Qe<H.channels;Qe++)it[Qe]={},it[Qe].start=ke,it[Qe].end=it[Qe].start,it[Qe].nx=H.width,it[Qe].ny=H.lines,it[Qe].size=H.type,ke+=it[Qe].nx*it[Qe].ny*it[Qe].size;var pt=nt(Y,oe),ft=nt(Y,oe);if(ft>=8192)throw"Something is wrong with PIZ_COMPRESSION BITMAP_SIZE";if(pt<=ft)for(var Qe=0;Qe<ft-pt+1;Qe++)Le[Qe+pt]=Tt(Y,oe);var yt=new Uint16Array(65536),ct=O(Le,yt),q=Ke(Y,oe);cn(H.array,Y,oe,q,Se,ke);for(var Qe=0;Qe<H.channels;++Qe)for(var ne=it[Qe],he=0;he<it[Qe].size;++he)bt(Se,ne.start+he,ne.nx,ne.size,ne.ny,ne.nx*ne.size,ct);Tn(yt,Se,ke);for(var ge=0,le=new Uint8Array(Se.buffer.byteLength),Ge=0;Ge<H.lines;Ge++)for(var rt=0;rt<H.channels;rt++){var ne=it[rt],Xe=ne.nx*ne.size,Mt=new Uint8Array(Se.buffer,ne.end*2,Xe*2);le.set(Mt,ge),ge+=Xe*2,ne.end+=Xe}return new DataView(le.buffer)}function We(H){var Y=H.array.slice(H.offset.value,H.offset.value+H.size),oe=Ny(Y);const Se=H.lines*H.channels*H.width,Le=H.type==1?new Uint16Array(Se):new Uint32Array(Se);let ke=0,it=0;const Qe=new Array(4);for(let pt=0;pt<H.lines;pt++)for(let ft=0;ft<H.channels;ft++){let yt=0;switch(H.type){case 1:Qe[0]=ke,Qe[1]=Qe[0]+H.width,ke=Qe[1]+H.width;for(let ct=0;ct<H.width;++ct){const q=oe[Qe[0]++]<<8|oe[Qe[1]++];yt+=q,Le[it]=yt,it++}break;case 2:Qe[0]=ke,Qe[1]=Qe[0]+H.width,Qe[2]=Qe[1]+H.width,ke=Qe[2]+H.width;for(let ct=0;ct<H.width;++ct){const q=oe[Qe[0]++]<<24|oe[Qe[1]++]<<16|oe[Qe[2]++]<<8;yt+=q,Le[it]=yt,it++}break}}return new DataView(Le.buffer)}function Ne(H){var Y=H.viewer,oe={value:H.offset.value},Se=new Uint8Array(H.width*H.lines*(H.channels*H.type*2)),Le={version:at(Y,oe),unknownUncompressedSize:at(Y,oe),unknownCompressedSize:at(Y,oe),acCompressedSize:at(Y,oe),dcCompressedSize:at(Y,oe),rleCompressedSize:at(Y,oe),rleUncompressedSize:at(Y,oe),rleRawSize:at(Y,oe),totalAcUncompressedCount:at(Y,oe),totalDcUncompressedCount:at(Y,oe),acCompression:at(Y,oe)};if(Le.version<2)throw"EXRLoader.parse: "+ys.compression+" version "+Le.version+" is unsupported";for(var ke=new Array,it=nt(Y,oe)-2;it>0;){var Qe=Ct(Y.buffer,oe),pt=Tt(Y,oe),ft=pt>>2&3,yt=(pt>>4)-1,ct=new Int8Array([yt])[0],q=Tt(Y,oe);ke.push({name:Qe,index:ct,type:q,compression:ft}),it-=Qe.length+3}for(var ne=ys.channels,he=new Array(H.channels),ge=0;ge<H.channels;++ge){var le=he[ge]={},Ge=ne[ge];le.name=Ge.name,le.compression=0,le.decoded=!1,le.type=Ge.pixelType,le.pLinear=Ge.pLinear,le.width=H.width,le.height=H.lines}for(var rt={idx:new Array(3)},Xe=0;Xe<H.channels;++Xe)for(var le=he[Xe],ge=0;ge<ke.length;++ge){var Mt=ke[ge];le.name==Mt.name&&(le.compression=Mt.compression,Mt.index>=0&&(rt.idx[Mt.index]=Xe),le.offset=Xe)}if(Le.acCompressedSize>0)switch(Le.acCompression){case 0:var gt=new Uint16Array(Le.totalAcUncompressedCount);cn(H.array,Y,oe,Le.acCompressedSize,gt,Le.totalAcUncompressedCount);break;case 1:var dt=H.array.slice(oe.value,oe.value+Le.totalAcUncompressedCount),Bt=Ny(dt),gt=new Uint16Array(Bt.buffer);oe.value+=Le.totalAcUncompressedCount;break}if(Le.dcCompressedSize>0){var kt={array:H.array,offset:oe,size:Le.dcCompressedSize},fn=new Uint16Array(pe(kt).buffer);oe.value+=Le.dcCompressedSize}if(Le.rleRawSize>0){var dt=H.array.slice(oe.value,oe.value+Le.rleCompressedSize),Bt=Ny(dt),Xn=et(Bt.buffer);oe.value+=Le.rleCompressedSize}for(var yn=0,Ut=new Array(he.length),ge=0;ge<Ut.length;++ge)Ut[ge]=new Array;for(var lt=0;lt<H.lines;++lt)for(var qt=0;qt<he.length;++qt)Ut[qt].push(yn),yn+=he[qt].width*H.type*2;qe(rt,Ut,he,gt,fn,Se);for(var ge=0;ge<he.length;++ge){var le=he[ge];if(!le.decoded)switch(le.compression){case 2:for(var At=0,qn=0,lt=0;lt<H.lines;++lt){for(var er=Ut[ge][At],An=0;An<le.width;++An){for(var yi=0;yi<2*le.type;++yi)Se[er++]=Xn[qn+yi*le.width*le.height];qn++}At++}break;case 1:default:throw"EXRLoader.parse: unsupported channel compression"}}return new DataView(Se.buffer)}function Ct(H,Y){for(var oe=new Uint8Array(H),Se=0;oe[Y.value+Se]!=0;)Se+=1;var Le=new TextDecoder().decode(oe.slice(Y.value,Y.value+Se));return Y.value=Y.value+Se+1,Le}function ht(H,Y,oe){var Se=new TextDecoder().decode(new Uint8Array(H).slice(Y.value,Y.value+oe));return Y.value=Y.value+oe,Se}function Ot(H,Y){var oe=Ze(H,Y),Se=Ke(H,Y);return[oe,Se]}function $t(H,Y){var oe=Ke(H,Y),Se=Ke(H,Y);return[oe,Se]}function Ze(H,Y){var oe=H.getInt32(Y.value,!0);return Y.value=Y.value+4,oe}function Ke(H,Y){var oe=H.getUint32(Y.value,!0);return Y.value=Y.value+4,oe}function Nt(H,Y){var oe=H[Y.value];return Y.value=Y.value+1,oe}function Tt(H,Y){var oe=H.getUint8(Y.value);return Y.value=Y.value+1,oe}const at=function(H,Y){let oe;return"getBigInt64"in DataView.prototype?oe=Number(H.getBigInt64(Y.value,!0)):oe=H.getUint32(Y.value+4,!0)+Number(H.getUint32(Y.value,!0)<<32),Y.value+=8,oe};function Xt(H,Y){var oe=H.getFloat32(Y.value,!0);return Y.value+=4,oe}function me(H,Y){return Ff.toHalfFloat(Xt(H,Y))}function Ce(H){var Y=(H&31744)>>10,oe=H&1023;return(H>>15?-1:1)*(Y?Y===31?oe?NaN:1/0:Math.pow(2,Y-15)*(1+oe/1024):6103515625e-14*(oe/1024))}function nt(H,Y){var oe=H.getUint16(Y.value,!0);return Y.value+=2,oe}function wt(H,Y){return Ce(nt(H,Y))}function tt(H,Y,oe,Se){for(var Le=oe.value,ke=[];oe.value<Le+Se-1;){var it=Ct(Y,oe),Qe=Ze(H,oe),pt=Tt(H,oe);oe.value+=3;var ft=Ze(H,oe),yt=Ze(H,oe);ke.push({name:it,pixelType:Qe,pLinear:pt,xSampling:ft,ySampling:yt})}return oe.value+=1,ke}function He(H,Y){var oe=Xt(H,Y),Se=Xt(H,Y),Le=Xt(H,Y),ke=Xt(H,Y),it=Xt(H,Y),Qe=Xt(H,Y),pt=Xt(H,Y),ft=Xt(H,Y);return{redX:oe,redY:Se,greenX:Le,greenY:ke,blueX:it,blueY:Qe,whiteX:pt,whiteY:ft}}function vt(H,Y){var oe=["NO_COMPRESSION","RLE_COMPRESSION","ZIPS_COMPRESSION","ZIP_COMPRESSION","PIZ_COMPRESSION","PXR24_COMPRESSION","B44_COMPRESSION","B44A_COMPRESSION","DWAA_COMPRESSION","DWAB_COMPRESSION"],Se=Tt(H,Y);return oe[Se]}function nn(H,Y){var oe=Ke(H,Y),Se=Ke(H,Y),Le=Ke(H,Y),ke=Ke(H,Y);return{xMin:oe,yMin:Se,xMax:Le,yMax:ke}}function Nn(H,Y){var oe=["INCREASING_Y"],Se=Tt(H,Y);return oe[Se]}function Ln(H,Y){var oe=Xt(H,Y),Se=Xt(H,Y);return[oe,Se]}function ji(H,Y){var oe=Xt(H,Y),Se=Xt(H,Y),Le=Xt(H,Y);return[oe,Se,Le]}function Rr(H,Y,oe,Se,Le){if(Se==="string"||Se==="stringvector"||Se==="iccProfile")return ht(Y,oe,Le);if(Se==="chlist")return tt(H,Y,oe,Le);if(Se==="chromaticities")return He(H,oe);if(Se==="compression")return vt(H,oe);if(Se==="box2i")return nn(H,oe);if(Se==="lineOrder")return Nn(H,oe);if(Se==="float")return Xt(H,oe);if(Se==="v2f")return Ln(H,oe);if(Se==="v3f")return ji(H,oe);if(Se==="int")return Ze(H,oe);if(Se==="rational")return Ot(H,oe);if(Se==="timecode")return $t(H,oe);if(Se==="preview")return oe.value+=Le,"skipped";oe.value+=Le}function To(H,Y,oe){const Se={};if(H.getUint32(0,!0)!=20000630)throw"THREE.EXRLoader: provided file doesn't appear to be in OpenEXR format.";Se.version=H.getUint8(4);const Le=H.getUint8(5);Se.spec={singleTile:!!(Le&2),longName:!!(Le&4),deepFormat:!!(Le&8),multiPart:!!(Le&16)},oe.value=8;for(var ke=!0;ke;){var it=Ct(Y,oe);if(it==0)ke=!1;else{var Qe=Ct(Y,oe),pt=Ke(H,oe),ft=Rr(H,Y,oe,Qe,pt);ft===void 0?console.warn(`EXRLoader.parse: skipped unknown header attribute type '${Qe}'.`):Se[it]=ft}}if((Le&-5)!=0)throw console.error("EXRHeader:",Se),"THREE.EXRLoader: provided file is currently unsupported.";return Se}function Ao(H,Y,oe,Se,Le){const ke={size:0,viewer:Y,array:oe,offset:Se,width:H.dataWindow.xMax-H.dataWindow.xMin+1,height:H.dataWindow.yMax-H.dataWindow.yMin+1,channels:H.channels.length,bytesPerLine:null,lines:null,inputSize:null,type:H.channels[0].pixelType,uncompress:null,getter:null,format:null,[Zm?"colorSpace":"encoding"]:null};switch(H.compression){case"NO_COMPRESSION":ke.lines=1,ke.uncompress=K;break;case"RLE_COMPRESSION":ke.lines=1,ke.uncompress=V;break;case"ZIPS_COMPRESSION":ke.lines=1,ke.uncompress=pe;break;case"ZIP_COMPRESSION":ke.lines=16,ke.uncompress=pe;break;case"PIZ_COMPRESSION":ke.lines=32,ke.uncompress=De;break;case"PXR24_COMPRESSION":ke.lines=16,ke.uncompress=We;break;case"DWAA_COMPRESSION":ke.lines=32,ke.uncompress=Ne;break;case"DWAB_COMPRESSION":ke.lines=256,ke.uncompress=Ne;break;default:throw"EXRLoader.parse: "+H.compression+" is unsupported"}if(ke.scanlineBlockSize=ke.lines,ke.type==1)switch(Le){case Ni:ke.getter=wt,ke.inputSize=2;break;case Wi:ke.getter=nt,ke.inputSize=2;break}else if(ke.type==2)switch(Le){case Ni:ke.getter=Xt,ke.inputSize=4;break;case Wi:ke.getter=me,ke.inputSize=4}else throw"EXRLoader.parse: unsupported pixelType "+ke.type+" for "+H.compression+".";ke.blockCount=(H.dataWindow.yMax+1)/ke.scanlineBlockSize;for(var it=0;it<ke.blockCount;it++)at(Y,Se);ke.outputChannels=ke.channels==3?4:ke.channels;const Qe=ke.width*ke.height*ke.outputChannels;switch(Le){case Ni:ke.byteArray=new Float32Array(Qe),ke.channels<ke.outputChannels&&ke.byteArray.fill(1,0,Qe);break;case Wi:ke.byteArray=new Uint16Array(Qe),ke.channels<ke.outputChannels&&ke.byteArray.fill(15360,0,Qe);break;default:console.error("THREE.EXRLoader: unsupported type: ",Le);break}return ke.bytesPerLine=ke.width*ke.inputSize*ke.channels,ke.outputChannels==4?ke.format=ur:ke.format=zg,Zm?ke.colorSpace="srgb-linear":ke.encoding=3e3,ke}const Os=new DataView(e),wo=new Uint8Array(e),Br={value:0},ys=To(Os,e,Br),jt=Ao(ys,Os,wo,Br,this.type),Ir={value:0},gi={R:0,G:1,B:2,A:3,Y:0};for(let H=0;H<jt.height/jt.scanlineBlockSize;H++){const Y=Ke(Os,Br);jt.size=Ke(Os,Br),jt.lines=Y+jt.scanlineBlockSize>jt.height?jt.height-Y:jt.scanlineBlockSize;const Se=jt.size<jt.lines*jt.bytesPerLine?jt.uncompress(jt):K(jt);Br.value+=jt.size;for(let Le=0;Le<jt.scanlineBlockSize;Le++){const ke=Le+H*jt.scanlineBlockSize;if(ke>=jt.height)break;for(let it=0;it<jt.channels;it++){const Qe=gi[ys.channels[it].name];for(let pt=0;pt<jt.width;pt++){Ir.value=(Le*(jt.channels*jt.width)+it*jt.width+pt)*jt.inputSize;const ft=(jt.height-1-ke)*(jt.width*jt.outputChannels)+pt*jt.outputChannels+Qe;jt.byteArray[ft]=jt.getter(Se,Ir)}}}}return{header:ys,width:jt.width,height:jt.height,data:jt.byteArray,format:jt.format,[Zm?"colorSpace":"encoding"]:jt[Zm?"colorSpace":"encoding"],type:this.type}}setDataType(e){return this.type=e,this}load(e,t,n,r){function s(a,c){Zm?a.colorSpace=c.colorSpace:a.encoding=c.encoding,a.minFilter=Bn,a.magFilter=Bn,a.generateMipmaps=!1,a.flipY=!1,t&&t(a,c)}return super.load(e,s,n,r)}}const ZA=new Er,Dy=new Q;class PE extends _E{constructor(){super(),this.isLineSegmentsGeometry=!0,this.type="LineSegmentsGeometry";const e=[-1,2,0,1,2,0,-1,1,0,1,1,0,-1,0,0,1,0,0,-1,-1,0,1,-1,0],t=[-1,2,1,2,-1,1,1,1,-1,-1,1,-1,-1,-2,1,-2],n=[0,2,1,2,3,1,2,4,3,4,5,3,4,6,5,6,7,5];this.setIndex(n),this.setAttribute("position",new zt(e,3)),this.setAttribute("uv",new zt(t,2))}applyMatrix4(e){const t=this.attributes.instanceStart,n=this.attributes.instanceEnd;return t!==void 0&&(t.applyMatrix4(e),n.applyMatrix4(e),t.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}setPositions(e){let t;e instanceof Float32Array?t=e:Array.isArray(e)&&(t=new Float32Array(e));const n=new V_(t,6,1);return this.setAttribute("instanceStart",new _o(n,3,0)),this.setAttribute("instanceEnd",new _o(n,3,3)),this.computeBoundingBox(),this.computeBoundingSphere(),this}setColors(e,t=3){let n;e instanceof Float32Array?n=e:Array.isArray(e)&&(n=new Float32Array(e));const r=new V_(n,t*2,1);return this.setAttribute("instanceColorStart",new _o(r,t,0)),this.setAttribute("instanceColorEnd",new _o(r,t,t)),this}fromWireframeGeometry(e){return this.setPositions(e.attributes.position.array),this}fromEdgesGeometry(e){return this.setPositions(e.attributes.position.array),this}fromMesh(e){return this.fromWireframeGeometry(new uE(e.geometry)),this}fromLineSegments(e){const t=e.geometry;return this.setPositions(t.attributes.position.array),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Er);const e=this.attributes.instanceStart,t=this.attributes.instanceEnd;e!==void 0&&t!==void 0&&(this.boundingBox.setFromBufferAttribute(e),ZA.setFromBufferAttribute(t),this.boundingBox.union(ZA))}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Tr),this.boundingBox===null&&this.computeBoundingBox();const e=this.attributes.instanceStart,t=this.attributes.instanceEnd;if(e!==void 0&&t!==void 0){const n=this.boundingSphere.center;this.boundingBox.getCenter(n);let r=0;for(let s=0,a=e.count;s<a;s++)Dy.fromBufferAttribute(e,s),r=Math.max(r,n.distanceToSquared(Dy)),Dy.fromBufferAttribute(t,s),r=Math.max(r,n.distanceToSquared(Dy));this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error("THREE.LineSegmentsGeometry.computeBoundingSphere(): Computed radius is NaN. The instanced position data is likely to have NaN values.",this)}}toJSON(){}applyMatrix(e){return console.warn("THREE.LineSegmentsGeometry: applyMatrix() has been renamed to applyMatrix4()."),this.applyMatrix4(e)}}class r3 extends PE{constructor(){super(),this.isLineGeometry=!0,this.type="LineGeometry"}setPositions(e){const t=e.length-3,n=new Float32Array(2*t);for(let r=0;r<t;r+=3)n[2*r]=e[r],n[2*r+1]=e[r+1],n[2*r+2]=e[r+2],n[2*r+3]=e[r+3],n[2*r+4]=e[r+4],n[2*r+5]=e[r+5];return super.setPositions(n),this}setColors(e,t=3){const n=e.length-t,r=new Float32Array(2*n);if(t===3)for(let s=0;s<n;s+=t)r[2*s]=e[s],r[2*s+1]=e[s+1],r[2*s+2]=e[s+2],r[2*s+3]=e[s+3],r[2*s+4]=e[s+4],r[2*s+5]=e[s+5];else for(let s=0;s<n;s+=t)r[2*s]=e[s],r[2*s+1]=e[s+1],r[2*s+2]=e[s+2],r[2*s+3]=e[s+3],r[2*s+4]=e[s+4],r[2*s+5]=e[s+5],r[2*s+6]=e[s+6],r[2*s+7]=e[s+7];return super.setColors(r,t),this}fromLine(e){const t=e.geometry;return this.setPositions(t.attributes.position.array),this}}class LE extends Ar{constructor(e){super({type:"LineMaterial",uniforms:Ag.clone(Ag.merge([Rt.common,Rt.fog,{worldUnits:{value:1},linewidth:{value:1},resolution:{value:new $e(1,1)},dashOffset:{value:0},dashScale:{value:1},dashSize:{value:1},gapSize:{value:1}}])),vertexShader:`
				#include <common>
				#include <fog_pars_vertex>
				#include <logdepthbuf_pars_vertex>
				#include <clipping_planes_pars_vertex>

				uniform float linewidth;
				uniform vec2 resolution;

				attribute vec3 instanceStart;
				attribute vec3 instanceEnd;

				#ifdef USE_COLOR
					#ifdef USE_LINE_COLOR_ALPHA
						varying vec4 vLineColor;
						attribute vec4 instanceColorStart;
						attribute vec4 instanceColorEnd;
					#else
						varying vec3 vLineColor;
						attribute vec3 instanceColorStart;
						attribute vec3 instanceColorEnd;
					#endif
				#endif

				#ifdef WORLD_UNITS

					varying vec4 worldPos;
					varying vec3 worldStart;
					varying vec3 worldEnd;

					#ifdef USE_DASH

						varying vec2 vUv;

					#endif

				#else

					varying vec2 vUv;

				#endif

				#ifdef USE_DASH

					uniform float dashScale;
					attribute float instanceDistanceStart;
					attribute float instanceDistanceEnd;
					varying float vLineDistance;

				#endif

				void trimSegment( const in vec4 start, inout vec4 end ) {

					// trim end segment so it terminates between the camera plane and the near plane

					// conservative estimate of the near plane
					float a = projectionMatrix[ 2 ][ 2 ]; // 3nd entry in 3th column
					float b = projectionMatrix[ 3 ][ 2 ]; // 3nd entry in 4th column
					float nearEstimate = - 0.5 * b / a;

					float alpha = ( nearEstimate - start.z ) / ( end.z - start.z );

					end.xyz = mix( start.xyz, end.xyz, alpha );

				}

				void main() {

					#ifdef USE_COLOR

						vLineColor = ( position.y < 0.5 ) ? instanceColorStart : instanceColorEnd;

					#endif

					#ifdef USE_DASH

						vLineDistance = ( position.y < 0.5 ) ? dashScale * instanceDistanceStart : dashScale * instanceDistanceEnd;
						vUv = uv;

					#endif

					float aspect = resolution.x / resolution.y;

					// camera space
					vec4 start = modelViewMatrix * vec4( instanceStart, 1.0 );
					vec4 end = modelViewMatrix * vec4( instanceEnd, 1.0 );

					#ifdef WORLD_UNITS

						worldStart = start.xyz;
						worldEnd = end.xyz;

					#else

						vUv = uv;

					#endif

					// special case for perspective projection, and segments that terminate either in, or behind, the camera plane
					// clearly the gpu firmware has a way of addressing this issue when projecting into ndc space
					// but we need to perform ndc-space calculations in the shader, so we must address this issue directly
					// perhaps there is a more elegant solution -- WestLangley

					bool perspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 ); // 4th entry in the 3rd column

					if ( perspective ) {

						if ( start.z < 0.0 && end.z >= 0.0 ) {

							trimSegment( start, end );

						} else if ( end.z < 0.0 && start.z >= 0.0 ) {

							trimSegment( end, start );

						}

					}

					// clip space
					vec4 clipStart = projectionMatrix * start;
					vec4 clipEnd = projectionMatrix * end;

					// ndc space
					vec3 ndcStart = clipStart.xyz / clipStart.w;
					vec3 ndcEnd = clipEnd.xyz / clipEnd.w;

					// direction
					vec2 dir = ndcEnd.xy - ndcStart.xy;

					// account for clip-space aspect ratio
					dir.x *= aspect;
					dir = normalize( dir );

					#ifdef WORLD_UNITS

						// get the offset direction as perpendicular to the view vector
						vec3 worldDir = normalize( end.xyz - start.xyz );
						vec3 offset;
						if ( position.y < 0.5 ) {

							offset = normalize( cross( start.xyz, worldDir ) );

						} else {

							offset = normalize( cross( end.xyz, worldDir ) );

						}

						// sign flip
						if ( position.x < 0.0 ) offset *= - 1.0;

						float forwardOffset = dot( worldDir, vec3( 0.0, 0.0, 1.0 ) );

						// don't extend the line if we're rendering dashes because we
						// won't be rendering the endcaps
						#ifndef USE_DASH

							// extend the line bounds to encompass  endcaps
							start.xyz += - worldDir * linewidth * 0.5;
							end.xyz += worldDir * linewidth * 0.5;

							// shift the position of the quad so it hugs the forward edge of the line
							offset.xy -= dir * forwardOffset;
							offset.z += 0.5;

						#endif

						// endcaps
						if ( position.y > 1.0 || position.y < 0.0 ) {

							offset.xy += dir * 2.0 * forwardOffset;

						}

						// adjust for linewidth
						offset *= linewidth * 0.5;

						// set the world position
						worldPos = ( position.y < 0.5 ) ? start : end;
						worldPos.xyz += offset;

						// project the worldpos
						vec4 clip = projectionMatrix * worldPos;

						// shift the depth of the projected points so the line
						// segments overlap neatly
						vec3 clipPose = ( position.y < 0.5 ) ? ndcStart : ndcEnd;
						clip.z = clipPose.z * clip.w;

					#else

						vec2 offset = vec2( dir.y, - dir.x );
						// undo aspect ratio adjustment
						dir.x /= aspect;
						offset.x /= aspect;

						// sign flip
						if ( position.x < 0.0 ) offset *= - 1.0;

						// endcaps
						if ( position.y < 0.0 ) {

							offset += - dir;

						} else if ( position.y > 1.0 ) {

							offset += dir;

						}

						// adjust for linewidth
						offset *= linewidth;

						// adjust for clip-space to screen-space conversion // maybe resolution should be based on viewport ...
						offset /= resolution.y;

						// select end
						vec4 clip = ( position.y < 0.5 ) ? clipStart : clipEnd;

						// back to clip space
						offset *= clip.w;

						clip.xy += offset;

					#endif

					gl_Position = clip;

					vec4 mvPosition = ( position.y < 0.5 ) ? start : end; // this is an approximation

					#include <logdepthbuf_vertex>
					#include <clipping_planes_vertex>
					#include <fog_vertex>

				}
			`,fragmentShader:`
				uniform vec3 diffuse;
				uniform float opacity;
				uniform float linewidth;

				#ifdef USE_DASH

					uniform float dashOffset;
					uniform float dashSize;
					uniform float gapSize;

				#endif

				varying float vLineDistance;

				#ifdef WORLD_UNITS

					varying vec4 worldPos;
					varying vec3 worldStart;
					varying vec3 worldEnd;

					#ifdef USE_DASH

						varying vec2 vUv;

					#endif

				#else

					varying vec2 vUv;

				#endif

				#include <common>
				#include <fog_pars_fragment>
				#include <logdepthbuf_pars_fragment>
				#include <clipping_planes_pars_fragment>

				#ifdef USE_COLOR
					#ifdef USE_LINE_COLOR_ALPHA
						varying vec4 vLineColor;
					#else
						varying vec3 vLineColor;
					#endif
				#endif

				vec2 closestLineToLine(vec3 p1, vec3 p2, vec3 p3, vec3 p4) {

					float mua;
					float mub;

					vec3 p13 = p1 - p3;
					vec3 p43 = p4 - p3;

					vec3 p21 = p2 - p1;

					float d1343 = dot( p13, p43 );
					float d4321 = dot( p43, p21 );
					float d1321 = dot( p13, p21 );
					float d4343 = dot( p43, p43 );
					float d2121 = dot( p21, p21 );

					float denom = d2121 * d4343 - d4321 * d4321;

					float numer = d1343 * d4321 - d1321 * d4343;

					mua = numer / denom;
					mua = clamp( mua, 0.0, 1.0 );
					mub = ( d1343 + d4321 * ( mua ) ) / d4343;
					mub = clamp( mub, 0.0, 1.0 );

					return vec2( mua, mub );

				}

				void main() {

					#include <clipping_planes_fragment>

					#ifdef USE_DASH

						if ( vUv.y < - 1.0 || vUv.y > 1.0 ) discard; // discard endcaps

						if ( mod( vLineDistance + dashOffset, dashSize + gapSize ) > dashSize ) discard; // todo - FIX

					#endif

					float alpha = opacity;

					#ifdef WORLD_UNITS

						// Find the closest points on the view ray and the line segment
						vec3 rayEnd = normalize( worldPos.xyz ) * 1e5;
						vec3 lineDir = worldEnd - worldStart;
						vec2 params = closestLineToLine( worldStart, worldEnd, vec3( 0.0, 0.0, 0.0 ), rayEnd );

						vec3 p1 = worldStart + lineDir * params.x;
						vec3 p2 = rayEnd * params.y;
						vec3 delta = p1 - p2;
						float len = length( delta );
						float norm = len / linewidth;

						#ifndef USE_DASH

							#ifdef USE_ALPHA_TO_COVERAGE

								float dnorm = fwidth( norm );
								alpha = 1.0 - smoothstep( 0.5 - dnorm, 0.5 + dnorm, norm );

							#else

								if ( norm > 0.5 ) {

									discard;

								}

							#endif

						#endif

					#else

						#ifdef USE_ALPHA_TO_COVERAGE

							// artifacts appear on some hardware if a derivative is taken within a conditional
							float a = vUv.x;
							float b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;
							float len2 = a * a + b * b;
							float dlen = fwidth( len2 );

							if ( abs( vUv.y ) > 1.0 ) {

								alpha = 1.0 - smoothstep( 1.0 - dlen, 1.0 + dlen, len2 );

							}

						#else

							if ( abs( vUv.y ) > 1.0 ) {

								float a = vUv.x;
								float b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;
								float len2 = a * a + b * b;

								if ( len2 > 1.0 ) discard;

							}

						#endif

					#endif

					vec4 diffuseColor = vec4( diffuse, alpha );
					#ifdef USE_COLOR
						#ifdef USE_LINE_COLOR_ALPHA
							diffuseColor *= vLineColor;
						#else
							diffuseColor.rgb *= vLineColor;
						#endif
					#endif

					#include <logdepthbuf_fragment>

					gl_FragColor = diffuseColor;

					#include <tonemapping_fragment>
					#include <${Hx>=154?"colorspace_fragment":"encodings_fragment"}>
					#include <fog_fragment>
					#include <premultiplied_alpha_fragment>

				}
			`,clipping:!0}),this.isLineMaterial=!0,this.onBeforeCompile=function(){this.transparent?this.defines.USE_LINE_COLOR_ALPHA="1":delete this.defines.USE_LINE_COLOR_ALPHA},Object.defineProperties(this,{color:{enumerable:!0,get:function(){return this.uniforms.diffuse.value},set:function(t){this.uniforms.diffuse.value=t}},worldUnits:{enumerable:!0,get:function(){return"WORLD_UNITS"in this.defines},set:function(t){t===!0?this.defines.WORLD_UNITS="":delete this.defines.WORLD_UNITS}},linewidth:{enumerable:!0,get:function(){return this.uniforms.linewidth.value},set:function(t){this.uniforms.linewidth.value=t}},dashed:{enumerable:!0,get:function(){return"USE_DASH"in this.defines},set(t){!!t!="USE_DASH"in this.defines&&(this.needsUpdate=!0),t===!0?this.defines.USE_DASH="":delete this.defines.USE_DASH}},dashScale:{enumerable:!0,get:function(){return this.uniforms.dashScale.value},set:function(t){this.uniforms.dashScale.value=t}},dashSize:{enumerable:!0,get:function(){return this.uniforms.dashSize.value},set:function(t){this.uniforms.dashSize.value=t}},dashOffset:{enumerable:!0,get:function(){return this.uniforms.dashOffset.value},set:function(t){this.uniforms.dashOffset.value=t}},gapSize:{enumerable:!0,get:function(){return this.uniforms.gapSize.value},set:function(t){this.uniforms.gapSize.value=t}},opacity:{enumerable:!0,get:function(){return this.uniforms.opacity.value},set:function(t){this.uniforms.opacity.value=t}},resolution:{enumerable:!0,get:function(){return this.uniforms.resolution.value},set:function(t){this.uniforms.resolution.value.copy(t)}},alphaToCoverage:{enumerable:!0,get:function(){return"USE_ALPHA_TO_COVERAGE"in this.defines},set:function(t){!!t!="USE_ALPHA_TO_COVERAGE"in this.defines&&(this.needsUpdate=!0),t===!0?(this.defines.USE_ALPHA_TO_COVERAGE="",this.extensions.derivatives=!0):(delete this.defines.USE_ALPHA_TO_COVERAGE,this.extensions.derivatives=!1)}}}),this.setValues(e)}}const Bb=new $n,$A=new Q,KA=new Q,Kr=new $n,Qr=new $n,ml=new $n,Vb=new Q,Hb=new an,jr=new MI,QA=new Q,Uy=new Er,Py=new Tr,gl=new $n;let yl,Hf;function jA(i,e,t){return gl.set(0,0,-e,1).applyMatrix4(i.projectionMatrix),gl.multiplyScalar(1/gl.w),gl.x=Hf/t.width,gl.y=Hf/t.height,gl.applyMatrix4(i.projectionMatrixInverse),gl.multiplyScalar(1/gl.w),Math.abs(Math.max(gl.x,gl.y))}function T5(i,e){const t=i.matrixWorld,n=i.geometry,r=n.attributes.instanceStart,s=n.attributes.instanceEnd,a=Math.min(n.instanceCount,r.count);for(let c=0,d=a;c<d;c++){jr.start.fromBufferAttribute(r,c),jr.end.fromBufferAttribute(s,c),jr.applyMatrix4(t);const p=new Q,m=new Q;yl.distanceSqToSegment(jr.start,jr.end,m,p),m.distanceTo(p)<Hf*.5&&e.push({point:m,pointOnLine:p,distance:yl.origin.distanceTo(m),object:i,face:null,faceIndex:c,uv:null,[KI]:null})}}function A5(i,e,t){const n=e.projectionMatrix,s=i.material.resolution,a=i.matrixWorld,c=i.geometry,d=c.attributes.instanceStart,p=c.attributes.instanceEnd,m=Math.min(c.instanceCount,d.count),v=-e.near;yl.at(1,ml),ml.w=1,ml.applyMatrix4(e.matrixWorldInverse),ml.applyMatrix4(n),ml.multiplyScalar(1/ml.w),ml.x*=s.x/2,ml.y*=s.y/2,ml.z=0,Vb.copy(ml),Hb.multiplyMatrices(e.matrixWorldInverse,a);for(let _=0,b=m;_<b;_++){if(Kr.fromBufferAttribute(d,_),Qr.fromBufferAttribute(p,_),Kr.w=1,Qr.w=1,Kr.applyMatrix4(Hb),Qr.applyMatrix4(Hb),Kr.z>v&&Qr.z>v)continue;if(Kr.z>v){const U=Kr.z-Qr.z,L=(Kr.z-v)/U;Kr.lerp(Qr,L)}else if(Qr.z>v){const U=Qr.z-Kr.z,L=(Qr.z-v)/U;Qr.lerp(Kr,L)}Kr.applyMatrix4(n),Qr.applyMatrix4(n),Kr.multiplyScalar(1/Kr.w),Qr.multiplyScalar(1/Qr.w),Kr.x*=s.x/2,Kr.y*=s.y/2,Qr.x*=s.x/2,Qr.y*=s.y/2,jr.start.copy(Kr),jr.start.z=0,jr.end.copy(Qr),jr.end.z=0;const I=jr.closestPointToPointParameter(Vb,!0);jr.at(I,QA);const C=Ps.lerp(Kr.z,Qr.z,I),A=C>=-1&&C<=1,D=Vb.distanceTo(QA)<Hf*.5;if(A&&D){jr.start.fromBufferAttribute(d,_),jr.end.fromBufferAttribute(p,_),jr.start.applyMatrix4(a),jr.end.applyMatrix4(a);const U=new Q,L=new Q;yl.distanceSqToSegment(jr.start,jr.end,L,U),t.push({point:L,pointOnLine:U,distance:yl.origin.distanceTo(L),object:i,face:null,faceIndex:_,uv:null,[KI]:null})}}}class s3 extends Di{constructor(e=new PE,t=new LE({color:Math.random()*16777215})){super(e,t),this.isLineSegments2=!0,this.type="LineSegments2"}computeLineDistances(){const e=this.geometry,t=e.attributes.instanceStart,n=e.attributes.instanceEnd,r=new Float32Array(2*t.count);for(let a=0,c=0,d=t.count;a<d;a++,c+=2)$A.fromBufferAttribute(t,a),KA.fromBufferAttribute(n,a),r[c]=c===0?0:r[c-1],r[c+1]=r[c]+$A.distanceTo(KA);const s=new V_(r,2,1);return e.setAttribute("instanceDistanceStart",new _o(s,1,0)),e.setAttribute("instanceDistanceEnd",new _o(s,1,1)),this}raycast(e,t){const n=this.material.worldUnits,r=e.camera;r===null&&!n&&console.error('LineSegments2: "Raycaster.camera" needs to be set in order to raycast against LineSegments2 while worldUnits is set to false.');const s=e.params.Line2!==void 0&&e.params.Line2.threshold||0;yl=e.ray;const a=this.matrixWorld,c=this.geometry,d=this.material;Hf=d.linewidth+s,c.boundingSphere===null&&c.computeBoundingSphere(),Py.copy(c.boundingSphere).applyMatrix4(a);let p;if(n)p=Hf*.5;else{const v=Math.max(r.near,Py.distanceToPoint(yl.origin));p=jA(r,v,d.resolution)}if(Py.radius+=p,yl.intersectsSphere(Py)===!1)return;c.boundingBox===null&&c.computeBoundingBox(),Uy.copy(c.boundingBox).applyMatrix4(a);let m;if(n)m=Hf*.5;else{const v=Math.max(r.near,Uy.distanceToPoint(yl.origin));m=jA(r,v,d.resolution)}Uy.expandByScalar(m),yl.intersectsBox(Uy)!==!1&&(n?T5(this,t):A5(this,r,t))}onBeforeRender(e){const t=this.material.uniforms;t&&t.resolution&&(e.getViewport(Bb),this.material.uniforms.resolution.value.set(Bb.z,Bb.w))}}class w5 extends s3{constructor(e=new r3,t=new LE({color:Math.random()*16777215})){super(e,t),this.isLine2=!0,this.type="Line2"}}const C5=Oe.forwardRef(function({points:e,color:t=16777215,vertexColors:n,linewidth:r,lineWidth:s,segments:a,dashed:c,...d},p){var m,v;const _=bo(A=>A.size),b=Oe.useMemo(()=>a?new s3:new w5,[a]),[T]=Oe.useState(()=>new LE),I=(n==null||(m=n[0])==null?void 0:m.length)===4?4:3,C=Oe.useMemo(()=>{const A=a?new PE:new r3,D=e.map(U=>{const L=Array.isArray(U);return U instanceof Q||U instanceof $n?[U.x,U.y,U.z]:U instanceof $e?[U.x,U.y,0]:L&&U.length===3?[U[0],U[1],U[2]]:L&&U.length===2?[U[0],U[1],0]:U});if(A.setPositions(D.flat()),n){t=16777215;const U=n.map(L=>L instanceof Pt?L.toArray():L);A.setColors(U.flat(),I)}return A},[e,a,n,I]);return Oe.useLayoutEffect(()=>{b.computeLineDistances()},[e,b]),Oe.useLayoutEffect(()=>{c?T.defines.USE_DASH="":delete T.defines.USE_DASH,T.needsUpdate=!0},[c,T]),Oe.useEffect(()=>()=>{C.dispose(),T.dispose()},[C]),Oe.createElement("primitive",El({object:b,ref:p},d),Oe.createElement("primitive",{object:C,attach:"geometry"}),Oe.createElement("primitive",El({object:T,attach:"material",color:t,vertexColors:!!n,resolution:[_.width,_.height],linewidth:(v=r??s)!==null&&v!==void 0?v:1,dashed:c,transparent:I===4},d)))});function R5(i,e,t,n){var r;return r=class extends Ar{constructor(s){super({vertexShader:e,fragmentShader:t,...s});for(const a in i)this.uniforms[a]=new Ox(i[a]),Object.defineProperty(this,a,{get(){return this.uniforms[a].value},set(c){this.uniforms[a].value=c}});this.uniforms=Ag.clone(this.uniforms)}},r.key=Ps.generateUUID(),r}const I5=()=>parseInt(tp.replace(/\D+/g,"")),N5=I5();function D5(i,e,t){const n=bo(b=>b.size),r=bo(b=>b.viewport),s=typeof i=="number"?i:n.width*r.dpr,a=n.height*r.dpr,c=(typeof i=="number"?t:i)||{},{samples:d=0,depth:p,...m}=c,v=p??c.depthBuffer,_=Oe.useMemo(()=>{const b=new Or(s,a,{minFilter:Bn,magFilter:Bn,type:Wi,...m});return v&&(b.depthTexture=new Wf(s,a,Ni)),b.samples=d,b},[]);return Oe.useLayoutEffect(()=>{_.setSize(s,a),d&&(_.samples=d)},[d,_,s,a]),Oe.useEffect(()=>()=>_.dispose(),[]),_}const U5=i=>typeof i=="function",P5=Oe.forwardRef(({envMap:i,resolution:e=256,frames:t=1/0,makeDefault:n,children:r,...s},a)=>{const c=bo(({set:C})=>C),d=bo(({camera:C})=>C),p=bo(({size:C})=>C),m=Oe.useRef(null);Oe.useImperativeHandle(a,()=>m.current,[]);const v=Oe.useRef(null),_=D5(e);Oe.useLayoutEffect(()=>{s.manual||(m.current.aspect=p.width/p.height)},[p,s]),Oe.useLayoutEffect(()=>{m.current.updateProjectionMatrix()});let b=0,T=null;const I=U5(r);return Kg(C=>{I&&(t===1/0||b<t)&&(v.current.visible=!1,C.gl.setRenderTarget(_),T=C.scene.background,i&&(C.scene.background=i),C.gl.render(C.scene,m.current),C.scene.background=T,C.gl.setRenderTarget(null),v.current.visible=!0,b++)}),Oe.useLayoutEffect(()=>{if(n){const C=d;return c(()=>({camera:m.current})),()=>c(()=>({camera:C}))}},[m,n,c]),Oe.createElement(Oe.Fragment,null,Oe.createElement("perspectiveCamera",El({ref:m},s),!I&&r),Oe.createElement("group",{ref:v},I&&r(_.texture)))}),L5=R5({cellSize:.5,sectionSize:1,fadeDistance:100,fadeStrength:1,fadeFrom:1,cellThickness:.5,sectionThickness:1,cellColor:new Pt,sectionColor:new Pt,infiniteGrid:!1,followCamera:!1,worldCamProjPosition:new Q,worldPlanePosition:new Q},`
    varying vec3 localPosition;
    varying vec4 worldPosition;

    uniform vec3 worldCamProjPosition;
    uniform vec3 worldPlanePosition;
    uniform float fadeDistance;
    uniform bool infiniteGrid;
    uniform bool followCamera;

    void main() {
      localPosition = position.xzy;
      if (infiniteGrid) localPosition *= 1.0 + fadeDistance;
      
      worldPosition = modelMatrix * vec4(localPosition, 1.0);
      if (followCamera) {
        worldPosition.xyz += (worldCamProjPosition - worldPlanePosition);
        localPosition = (inverse(modelMatrix) * worldPosition).xyz;
      }

      gl_Position = projectionMatrix * viewMatrix * worldPosition;
    }
  `,`
    varying vec3 localPosition;
    varying vec4 worldPosition;

    uniform vec3 worldCamProjPosition;
    uniform float cellSize;
    uniform float sectionSize;
    uniform vec3 cellColor;
    uniform vec3 sectionColor;
    uniform float fadeDistance;
    uniform float fadeStrength;
    uniform float fadeFrom;
    uniform float cellThickness;
    uniform float sectionThickness;

    float getGrid(float size, float thickness) {
      vec2 r = localPosition.xz / size;
      vec2 grid = abs(fract(r - 0.5) - 0.5) / fwidth(r);
      float line = min(grid.x, grid.y) + 1.0 - thickness;
      return 1.0 - min(line, 1.0);
    }

    void main() {
      float g1 = getGrid(cellSize, cellThickness);
      float g2 = getGrid(sectionSize, sectionThickness);

      vec3 from = worldCamProjPosition*vec3(fadeFrom);
      float dist = distance(from, worldPosition.xyz);
      float d = 1.0 - min(dist / fadeDistance, 1.0);
      vec3 color = mix(cellColor, sectionColor, min(1.0, sectionThickness * g2));

      gl_FragColor = vec4(color, (g1 + g2) * pow(d, fadeStrength));
      gl_FragColor.a = mix(0.75 * gl_FragColor.a, gl_FragColor.a, g2);
      if (gl_FragColor.a <= 0.0) discard;

      #include <tonemapping_fragment>
      #include <${N5>=154?"colorspace_fragment":"encodings_fragment"}>
    }
  `),F5=Oe.forwardRef(({args:i,cellColor:e="#000000",sectionColor:t="#2080ff",cellSize:n=.5,sectionSize:r=1,followCamera:s=!1,infiniteGrid:a=!1,fadeDistance:c=100,fadeStrength:d=1,fadeFrom:p=1,cellThickness:m=.5,sectionThickness:v=1,side:_=gs,...b},T)=>{DE({GridMaterial:L5});const I=Oe.useRef(null);Oe.useImperativeHandle(T,()=>I.current,[]);const C=new uu,A=new Q(0,1,0),D=new Q(0,0,0);Kg(z=>{C.setFromNormalAndCoplanarPoint(A,D).applyMatrix4(I.current.matrixWorld);const B=I.current.material,k=B.uniforms.worldCamProjPosition,G=B.uniforms.worldPlanePosition;C.projectPoint(z.camera.position,k.value),G.value.set(0,0,0).applyMatrix4(I.current.matrixWorld)});const U={cellSize:n,sectionSize:r,cellColor:e,sectionColor:t,cellThickness:m,sectionThickness:v},L={fadeDistance:c,fadeStrength:d,fadeFrom:p,infiniteGrid:a,followCamera:s};return Oe.createElement("mesh",El({ref:I,frustumCulled:!1},b),Oe.createElement("gridMaterial",El({transparent:!0,"extensions-derivatives":!0,side:_},U,L)),Oe.createElement("planeGeometry",{args:i}))});function FE(i,e){const t=i+"Geometry";return Oe.forwardRef(({args:n,children:r,...s},a)=>{const c=Oe.useRef(null);return Oe.useImperativeHandle(a,()=>c.current),Oe.useLayoutEffect(()=>void(e==null?void 0:e(c.current))),Oe.createElement("mesh",El({ref:c},s),Oe.createElement(t,{attach:"geometry",args:n}),r)})}const jo=FE("box"),k5=FE("sphere"),ew=FE("ring"),o3=(i,e,t)=>{let n;switch(i){case kr:n=new Uint8ClampedArray(e*t*4);break;case Wi:n=new Uint16Array(e*t*4);break;case Mo:n=new Uint32Array(e*t*4);break;case rx:n=new Int8Array(e*t*4);break;case sx:n=new Int16Array(e*t*4);break;case Og:n=new Int32Array(e*t*4);break;case Ni:n=new Float32Array(e*t*4);break;default:throw new Error("Unsupported data type")}return n};let Ly;const O5=(i,e,t,n)=>{if(Ly!==void 0)return Ly;const r=new Or(1,1,n);e.setRenderTarget(r);const s=new Di(new gu,new mu({color:16777215}));e.render(s,t),e.setRenderTarget(null);const a=o3(i,r.width,r.height);return e.readRenderTargetPixels(r,0,0,r.width,r.height,a),r.dispose(),s.geometry.dispose(),s.material.dispose(),Ly=a[0]!==0,Ly};class kE{constructor(e){un(this,"_renderer");un(this,"_rendererIsDisposable",!1);un(this,"_material");un(this,"_scene");un(this,"_camera");un(this,"_quad");un(this,"_renderTarget");un(this,"_width");un(this,"_height");un(this,"_type");un(this,"_colorSpace");un(this,"_supportsReadPixels",!0);un(this,"render",()=>{this._renderer.setRenderTarget(this._renderTarget);try{this._renderer.render(this._scene,this._camera)}catch(e){throw this._renderer.setRenderTarget(null),e}this._renderer.setRenderTarget(null)});var n,r,s,a,c,d,p,m,v,_,b,T,I,C,A,D;this._width=e.width,this._height=e.height,this._type=e.type,this._colorSpace=e.colorSpace;const t={format:ur,depthBuffer:!1,stencilBuffer:!1,type:this._type,colorSpace:this._colorSpace,anisotropy:((n=e.renderTargetOptions)==null?void 0:n.anisotropy)!==void 0?(r=e.renderTargetOptions)==null?void 0:r.anisotropy:1,generateMipmaps:((s=e.renderTargetOptions)==null?void 0:s.generateMipmaps)!==void 0?(a=e.renderTargetOptions)==null?void 0:a.generateMipmaps:!1,magFilter:((c=e.renderTargetOptions)==null?void 0:c.magFilter)!==void 0?(d=e.renderTargetOptions)==null?void 0:d.magFilter:Bn,minFilter:((p=e.renderTargetOptions)==null?void 0:p.minFilter)!==void 0?(m=e.renderTargetOptions)==null?void 0:m.minFilter:Bn,samples:((v=e.renderTargetOptions)==null?void 0:v.samples)!==void 0?(_=e.renderTargetOptions)==null?void 0:_.samples:void 0,wrapS:((b=e.renderTargetOptions)==null?void 0:b.wrapS)!==void 0?(T=e.renderTargetOptions)==null?void 0:T.wrapS:Qi,wrapT:((I=e.renderTargetOptions)==null?void 0:I.wrapT)!==void 0?(C=e.renderTargetOptions)==null?void 0:C.wrapT:Qi};if(this._material=e.material,e.renderer?this._renderer=e.renderer:(this._renderer=kE.instantiateRenderer(),this._rendererIsDisposable=!0),this._scene=new Hg,this._camera=new jf,this._camera.position.set(0,0,10),this._camera.left=-.5,this._camera.right=.5,this._camera.top=.5,this._camera.bottom=-.5,this._camera.updateProjectionMatrix(),!O5(this._type,this._renderer,this._camera,t)){let U;switch(this._type){case Wi:U=this._renderer.extensions.has("EXT_color_buffer_float")?Ni:void 0;break}U!==void 0?(console.warn(`This browser does not support reading pixels from ${this._type} RenderTargets, switching to ${Ni}`),this._type=U):(this._supportsReadPixels=!1,console.warn("This browser dos not support toArray or toDataTexture, calls to those methods will result in an error thrown"))}this._quad=new Di(new gu,this._material),this._quad.geometry.computeBoundingBox(),this._scene.add(this._quad),this._renderTarget=new Or(this.width,this.height,t),this._renderTarget.texture.mapping=((A=e.renderTargetOptions)==null?void 0:A.mapping)!==void 0?(D=e.renderTargetOptions)==null?void 0:D.mapping:bc}static instantiateRenderer(){const e=new AE;return e.setSize(128,128),e}toArray(){if(!this._supportsReadPixels)throw new Error("Can't read pixels in this browser");const e=o3(this._type,this._width,this._height);return this._renderer.readRenderTargetPixels(this._renderTarget,0,0,this._width,this._height,e),e}toDataTexture(e){const t=new na(this.toArray(),this.width,this.height,ur,this._type,(e==null?void 0:e.mapping)||bc,(e==null?void 0:e.wrapS)||Qi,(e==null?void 0:e.wrapT)||Qi,(e==null?void 0:e.magFilter)||Bn,(e==null?void 0:e.minFilter)||Bn,(e==null?void 0:e.anisotropy)||1,Pa);return t.generateMipmaps=(e==null?void 0:e.generateMipmaps)!==void 0?e==null?void 0:e.generateMipmaps:!1,t}disposeOnDemandRenderer(){this._renderer.setRenderTarget(null),this._rendererIsDisposable&&(this._renderer.dispose(),this._renderer.forceContextLoss())}dispose(e){this.disposeOnDemandRenderer(),e&&this.renderTarget.dispose(),this.material instanceof Ar&&Object.values(this.material.uniforms).forEach(t=>{t.value instanceof hi&&t.value.dispose()}),Object.values(this.material).forEach(t=>{t instanceof hi&&t.dispose()}),this.material.dispose(),this._quad.geometry.dispose()}get width(){return this._width}set width(e){this._width=e,this._renderTarget.setSize(this._width,this._height)}get height(){return this._height}set height(e){this._height=e,this._renderTarget.setSize(this._width,this._height)}get renderer(){return this._renderer}get renderTarget(){return this._renderTarget}set renderTarget(e){this._renderTarget=e,this._width=e.width,this._height=e.height}get material(){return this._material}get type(){return this._type}get colorSpace(){return this._colorSpace}}class a3 extends Error{}class l3 extends Error{}const $m=(i,e,t)=>{const n=new RegExp(`${e}="([^"]*)"`,"i").exec(i);if(n)return n[1];const r=new RegExp(`<${e}[^>]*>([\\s\\S]*?)</${e}>`,"i").exec(i);if(r){const s=r[1].match(/<rdf:li>([^<]*)<\/rdf:li>/g);return s&&s.length===3?s.map(a=>a.replace(/<\/?rdf:li>/g,"")):r[1].trim()}if(t!==void 0)return t;throw new Error(`Can't find ${e} in gainmap metadata`)},z5=i=>{let e;typeof TextDecoder<"u"?e=new TextDecoder().decode(i):e=i.toString();let t=e.indexOf("<x:xmpmeta");for(;t!==-1;){const n=e.indexOf("x:xmpmeta>",t),r=e.slice(t,n+10);try{const s=$m(r,"hdrgm:GainMapMin","0"),a=$m(r,"hdrgm:GainMapMax"),c=$m(r,"hdrgm:Gamma","1"),d=$m(r,"hdrgm:OffsetSDR","0.015625"),p=$m(r,"hdrgm:OffsetHDR","0.015625"),m=/hdrgm:HDRCapacityMin="([^"]*)"/.exec(r),v=m?m[1]:"0",_=/hdrgm:HDRCapacityMax="([^"]*)"/.exec(r);if(!_)throw new Error("Incomplete gainmap metadata");const b=_[1];return{gainMapMin:Array.isArray(s)?s.map(T=>parseFloat(T)):[parseFloat(s),parseFloat(s),parseFloat(s)],gainMapMax:Array.isArray(a)?a.map(T=>parseFloat(T)):[parseFloat(a),parseFloat(a),parseFloat(a)],gamma:Array.isArray(c)?c.map(T=>parseFloat(T)):[parseFloat(c),parseFloat(c),parseFloat(c)],offsetSdr:Array.isArray(d)?d.map(T=>parseFloat(T)):[parseFloat(d),parseFloat(d),parseFloat(d)],offsetHdr:Array.isArray(p)?p.map(T=>parseFloat(T)):[parseFloat(p),parseFloat(p),parseFloat(p)],hdrCapacityMin:parseFloat(v),hdrCapacityMax:parseFloat(b)}}catch{}t=e.indexOf("<x:xmpmeta",n)}};class B5{constructor(e){un(this,"options");this.options={debug:e&&e.debug!==void 0?e.debug:!1,extractFII:e&&e.extractFII!==void 0?e.extractFII:!0,extractNonFII:e&&e.extractNonFII!==void 0?e.extractNonFII:!0}}extract(e){return new Promise((t,n)=>{const r=this.options.debug,s=new DataView(e.buffer);if(s.getUint16(0)!==65496){n(new Error("Not a valid jpeg"));return}const a=s.byteLength;let c=2,d=0,p;for(;c<a;){if(++d>250){n(new Error(`Found no marker after ${d} loops 😵`));return}if(s.getUint8(c)!==255){n(new Error(`Not a valid marker at offset 0x${c.toString(16)}, found: 0x${s.getUint8(c).toString(16)}`));return}if(p=s.getUint8(c+1),r&&console.log(`Marker: ${p.toString(16)}`),p===226){r&&console.log("Found APP2 marker (0xffe2)");const m=c+4;if(s.getUint32(m)===1297106432){const v=m+4;let _;if(s.getUint16(v)===18761)_=!1;else if(s.getUint16(v)===19789)_=!0;else{n(new Error("No valid endianness marker found in TIFF header"));return}if(s.getUint16(v+2,!_)!==42){n(new Error("Not valid TIFF data! (no 0x002A marker)"));return}const b=s.getUint32(v+4,!_);if(b<8){n(new Error("Not valid TIFF data! (First offset less than 8)"));return}const T=v+b,I=s.getUint16(T,!_),C=T+2;let A=0;for(let z=C;z<C+12*I;z+=12)s.getUint16(z,!_)===45057&&(A=s.getUint32(z+8,!_));const U=T+2+I*12+4,L=[];for(let z=U;z<U+A*16;z+=16){const B={MPType:s.getUint32(z,!_),size:s.getUint32(z+4,!_),dataOffset:s.getUint32(z+8,!_),dependantImages:s.getUint32(z+12,!_),start:-1,end:-1,isFII:!1};B.dataOffset?(B.start=v+B.dataOffset,B.isFII=!1):(B.start=0,B.isFII=!0),B.end=B.start+B.size,L.push(B)}if(this.options.extractNonFII&&L.length){const z=new Blob([s]),B=[];for(const k of L){if(k.isFII&&!this.options.extractFII)continue;const G=z.slice(k.start,k.end+1,"image/jpeg");B.push(G)}t(B)}}}c+=2+s.getUint16(c+2)}})}}const V5=async i=>{const e=z5(i);if(!e)throw new l3("Gain map XMP metadata not found");const n=await new B5({extractFII:!0,extractNonFII:!0}).extract(i);if(n.length!==2)throw new a3("Gain map recovery image not found");return{sdr:new Uint8Array(await n[0].arrayBuffer()),gainMap:new Uint8Array(await n[1].arrayBuffer()),metadata:e}},tw=i=>new Promise((e,t)=>{const n=document.createElement("img");n.onload=()=>{e(n)},n.onerror=r=>{t(r)},n.src=URL.createObjectURL(i)});class H5 extends ks{constructor(t,n){super(n);un(this,"_renderer");un(this,"_renderTargetOptions");un(this,"_internalLoadingManager");un(this,"_config");this._config=t,t.renderer&&(this._renderer=t.renderer),this._internalLoadingManager=new Fx}setRenderer(t){return this._renderer=t,this}setRenderTargetOptions(t){return this._renderTargetOptions=t,this}prepareQuadRenderer(){this._renderer||console.warn("WARNING: A Renderer was not passed to this Loader constructor or in setRenderer, the result of this Loader will need to be converted to a Data Texture with toDataTexture() before you can use it in your renderer.");const t=this._config.createMaterial({gainMapMax:[1,1,1],gainMapMin:[0,0,0],gamma:[1,1,1],offsetHdr:[1,1,1],offsetSdr:[1,1,1],hdrCapacityMax:1,hdrCapacityMin:0,maxDisplayBoost:1,gainMap:new hi,sdr:new hi});return this._config.createQuadRenderer({width:16,height:16,type:Wi,colorSpace:Pa,material:t,renderer:this._renderer,renderTargetOptions:this._renderTargetOptions})}async processImages(t,n,r){const s=n?new Blob([n],{type:"image/jpeg"}):void 0,a=new Blob([t],{type:"image/jpeg"});let c,d,p=!1;if(typeof createImageBitmap>"u"){const m=await Promise.all([s?tw(s):Promise.resolve(void 0),tw(a)]);d=m[0],c=m[1],p=r==="flipY"}else{const m=await Promise.all([s?createImageBitmap(s,{imageOrientation:r||"flipY"}):Promise.resolve(void 0),createImageBitmap(a,{imageOrientation:r||"flipY"})]);d=m[0],c=m[1]}return{sdrImage:c,gainMapImage:d,needsFlip:p}}createTextures(t,n,r){const s=new hi(n||new ImageData(2,2),bc,Qi,Qi,Bn,jb,ur,kr,1,Pa);s.flipY=r,s.needsUpdate=!0;const a=new hi(t,bc,Qi,Qi,Bn,jb,ur,kr,1,es);return a.flipY=r,a.needsUpdate=!0,{gainMap:s,sdr:a}}updateQuadRenderer(t,n,r,s,a){t.width=n.width,t.height=n.height,t.material.gainMap=r,t.material.sdr=s,t.material.gainMapMin=a.gainMapMin,t.material.gainMapMax=a.gainMapMax,t.material.offsetHdr=a.offsetHdr,t.material.offsetSdr=a.offsetSdr,t.material.gamma=a.gamma,t.material.hdrCapacityMin=a.hdrCapacityMin,t.material.hdrCapacityMax=a.hdrCapacityMax,t.material.maxDisplayBoost=Math.pow(2,a.hdrCapacityMax),t.material.needsUpdate=!0}}const G5=`
varying vec2 vUv;

void main() {
  vUv = uv;
  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
}
`,q5=`
// min half float value
#define HALF_FLOAT_MIN vec3( -65504, -65504, -65504 )
// max half float value
#define HALF_FLOAT_MAX vec3( 65504, 65504, 65504 )

uniform sampler2D sdr;
uniform sampler2D gainMap;
uniform vec3 gamma;
uniform vec3 offsetHdr;
uniform vec3 offsetSdr;
uniform vec3 gainMapMin;
uniform vec3 gainMapMax;
uniform float weightFactor;

varying vec2 vUv;

void main() {
  vec3 rgb = texture2D( sdr, vUv ).rgb;
  vec3 recovery = texture2D( gainMap, vUv ).rgb;
  vec3 logRecovery = pow( recovery, gamma );
  vec3 logBoost = gainMapMin * ( 1.0 - logRecovery ) + gainMapMax * logRecovery;
  vec3 hdrColor = (rgb + offsetSdr) * exp2( logBoost * weightFactor ) - offsetHdr;
  vec3 clampedHdrColor = max( HALF_FLOAT_MIN, min( HALF_FLOAT_MAX, hdrColor ));
  gl_FragColor = vec4( clampedHdrColor , 1.0 );
}
`;class W5 extends Ar{constructor({gamma:t,offsetHdr:n,offsetSdr:r,gainMapMin:s,gainMapMax:a,maxDisplayBoost:c,hdrCapacityMin:d,hdrCapacityMax:p,sdr:m,gainMap:v}){super({name:"GainMapDecoderMaterial",vertexShader:G5,fragmentShader:q5,uniforms:{sdr:{value:m},gainMap:{value:v},gamma:{value:new Q(1/t[0],1/t[1],1/t[2])},offsetHdr:{value:new Q().fromArray(n)},offsetSdr:{value:new Q().fromArray(r)},gainMapMin:{value:new Q().fromArray(s)},gainMapMax:{value:new Q().fromArray(a)},weightFactor:{value:(Math.log2(c)-d)/(p-d)}},blending:Ia,depthTest:!1,depthWrite:!1});un(this,"_maxDisplayBoost");un(this,"_hdrCapacityMin");un(this,"_hdrCapacityMax");this._maxDisplayBoost=c,this._hdrCapacityMin=d,this._hdrCapacityMax=p,this.needsUpdate=!0,this.uniformsNeedUpdate=!0}get sdr(){return this.uniforms.sdr.value}set sdr(t){this.uniforms.sdr.value=t}get gainMap(){return this.uniforms.gainMap.value}set gainMap(t){this.uniforms.gainMap.value=t}get offsetHdr(){return this.uniforms.offsetHdr.value.toArray()}set offsetHdr(t){this.uniforms.offsetHdr.value.fromArray(t)}get offsetSdr(){return this.uniforms.offsetSdr.value.toArray()}set offsetSdr(t){this.uniforms.offsetSdr.value.fromArray(t)}get gainMapMin(){return this.uniforms.gainMapMin.value.toArray()}set gainMapMin(t){this.uniforms.gainMapMin.value.fromArray(t)}get gainMapMax(){return this.uniforms.gainMapMax.value.toArray()}set gainMapMax(t){this.uniforms.gainMapMax.value.fromArray(t)}get gamma(){const t=this.uniforms.gamma.value;return[1/t.x,1/t.y,1/t.z]}set gamma(t){const n=this.uniforms.gamma.value;n.x=1/t[0],n.y=1/t[1],n.z=1/t[2]}get hdrCapacityMin(){return this._hdrCapacityMin}set hdrCapacityMin(t){this._hdrCapacityMin=t,this.calculateWeight()}get hdrCapacityMax(){return this._hdrCapacityMax}set hdrCapacityMax(t){this._hdrCapacityMax=t,this.calculateWeight()}get maxDisplayBoost(){return this._maxDisplayBoost}set maxDisplayBoost(t){this._maxDisplayBoost=Math.max(1,Math.min(65504,t)),this.calculateWeight()}calculateWeight(){const t=(Math.log2(this._maxDisplayBoost)-this._hdrCapacityMin)/(this._hdrCapacityMax-this._hdrCapacityMin);this.uniforms.weightFactor.value=Math.max(0,Math.min(1,t))}}class u3 extends H5{constructor(e,t){super({renderer:e,createMaterial:n=>new W5(n),createQuadRenderer:n=>new kE(n)},t)}async render(e,t,n,r){const{sdrImage:s,gainMapImage:a,needsFlip:c}=await this.processImages(n,r,"flipY"),{gainMap:d,sdr:p}=this.createTextures(s,a,c);this.updateQuadRenderer(e,s,d,p,t),e.render()}}class X5 extends u3{load([e,t,n],r,s,a){const c=this.prepareQuadRenderer();let d,p,m;const v=async()=>{if(d&&p&&m){try{await this.render(c,m,d,p)}catch(P){this.manager.itemError(e),this.manager.itemError(t),this.manager.itemError(n),typeof a=="function"&&a(P),c.disposeOnDemandRenderer();return}typeof r=="function"&&r(c),this.manager.itemEnd(e),this.manager.itemEnd(t),this.manager.itemEnd(n),c.disposeOnDemandRenderer()}};let _=!0,b=0,T=0,I=!0,C=0,A=0,D=!0,U=0,L=0;const z=()=>{if(typeof s=="function"){const P=b+C+U,O=T+A+L,Z=_&&I&&D;s(new ProgressEvent("progress",{lengthComputable:Z,loaded:O,total:P}))}};this.manager.itemStart(e),this.manager.itemStart(t),this.manager.itemStart(n);const B=new So(this._internalLoadingManager);B.setResponseType("arraybuffer"),B.setRequestHeader(this.requestHeader),B.setPath(this.path),B.setWithCredentials(this.withCredentials),B.load(e,async P=>{if(typeof P=="string")throw new Error("Invalid sdr buffer");d=P,await v()},P=>{_=P.lengthComputable,T=P.loaded,b=P.total,z()},P=>{this.manager.itemError(e),typeof a=="function"&&a(P)});const k=new So(this._internalLoadingManager);k.setResponseType("arraybuffer"),k.setRequestHeader(this.requestHeader),k.setPath(this.path),k.setWithCredentials(this.withCredentials),k.load(t,async P=>{if(typeof P=="string")throw new Error("Invalid gainmap buffer");p=P,await v()},P=>{I=P.lengthComputable,A=P.loaded,C=P.total,z()},P=>{this.manager.itemError(t),typeof a=="function"&&a(P)});const G=new So(this._internalLoadingManager);return G.setRequestHeader(this.requestHeader),G.setPath(this.path),G.setWithCredentials(this.withCredentials),G.load(n,async P=>{if(typeof P!="string")throw new Error("Invalid metadata string");m=JSON.parse(P),await v()},P=>{D=P.lengthComputable,L=P.loaded,U=P.total,z()},P=>{this.manager.itemError(n),typeof a=="function"&&a(P)}),c}}class Y5 extends u3{load(e,t,n,r){const s=this.prepareQuadRenderer(),a=new So(this._internalLoadingManager);return a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setPath(this.path),a.setWithCredentials(this.withCredentials),this.manager.itemStart(e),a.load(e,async c=>{if(typeof c=="string")throw new Error("Invalid buffer, received [string], was expecting [ArrayBuffer]");const d=new Uint8Array(c);let p,m,v;try{const _=await V5(d);p=_.sdr,m=_.gainMap,v=_.metadata}catch(_){if(_ instanceof l3||_ instanceof a3)console.warn(`Failure to reconstruct an HDR image from ${e}: Gain map metadata not found in the file, HDRJPGLoader will render the SDR jpeg`),v={gainMapMin:[0,0,0],gainMapMax:[1,1,1],gamma:[1,1,1],hdrCapacityMin:0,hdrCapacityMax:1,offsetHdr:[0,0,0],offsetSdr:[0,0,0]},p=d;else throw _}try{await this.render(s,v,p.buffer,m==null?void 0:m.buffer)}catch(_){this.manager.itemError(e),typeof r=="function"&&r(_),s.disposeOnDemandRenderer();return}typeof t=="function"&&t(s),this.manager.itemEnd(e),s.disposeOnDemandRenderer()},n,c=>{this.manager.itemError(e),typeof r=="function"&&r(c)}),s}}const Lg={apartment:"lebombo_1k.hdr",city:"potsdamer_platz_1k.hdr",dawn:"kiara_1_dawn_1k.hdr",forest:"forest_slope_1k.hdr",lobby:"st_fagans_interior_1k.hdr",night:"dikhololo_night_1k.hdr",park:"rooitou_park_1k.hdr",studio:"studio_small_03_1k.hdr",sunset:"venice_sunset_1k.hdr",warehouse:"empty_warehouse_01_1k.hdr"},c3="https://raw.githack.com/pmndrs/drei-assets/456060a26bbeb8fdf79326f224b6d99b8bcce736/hdri/",Bh=i=>Array.isArray(i),OE=["/px.png","/nx.png","/py.png","/ny.png","/pz.png","/nz.png"];function Gx({files:i=OE,path:e="",preset:t=void 0,colorSpace:n=void 0,extensions:r}={}){t&&(zE(t),i=Lg[t],e=c3);const s=Bh(i),{extension:a,isCubemap:c}=BE(i),d=VE(a);if(!d)throw new Error("useEnvironment: Unrecognized file extension: "+i);const p=bo(b=>b.gl);Oe.useLayoutEffect(()=>{if(a!=="webp"&&a!=="jpg"&&a!=="jpeg")return;function b(){jh.clear(d,s?[i]:i)}p.domElement.addEventListener("webglcontextlost",b,{once:!0})},[i,p.domElement]);const m=jh(d,s?[i]:i,b=>{(a==="webp"||a==="jpg"||a==="jpeg")&&b.setRenderer(p),b.setPath==null||b.setPath(e),r&&r(b)});let v=s?m[0]:m;if(a==="jpg"||a==="jpeg"||a==="webp"){var _;v=(_=v.renderTarget)==null?void 0:_.texture}return v.mapping=c?Ua:Gh,v.colorSpace=n??(c?"srgb":"srgb-linear"),v}const J5={files:OE,path:"",preset:void 0,extensions:void 0};Gx.preload=i=>{const e={...J5,...i};let{files:t,path:n=""}=e;const{preset:r,extensions:s}=e;r&&(zE(r),t=Lg[r],n=c3);const{extension:a}=BE(t);if(a==="webp"||a==="jpg"||a==="jpeg")throw new Error("useEnvironment: Preloading gainmaps is not supported");const c=VE(a);if(!c)throw new Error("useEnvironment: Unrecognized file extension: "+t);jh.preload(c,Bh(t)?[t]:t,d=>{d.setPath==null||d.setPath(n),s&&s(d)})};const Z5={files:OE,preset:void 0};Gx.clear=i=>{const e={...Z5,...i};let{files:t}=e;const{preset:n}=e;n&&(zE(n),t=Lg[n]);const{extension:r}=BE(t),s=VE(r);if(!s)throw new Error("useEnvironment: Unrecognized file extension: "+t);jh.clear(s,Bh(t)?[t]:t)};function zE(i){if(!(i in Lg))throw new Error("Preset must be one of: "+Object.keys(Lg).join(", "))}function BE(i){var e;const t=Bh(i)&&i.length===6,n=Bh(i)&&i.length===3&&i.some(a=>a.endsWith("json")),r=Bh(i)?i[0]:i;return{extension:t?"cube":n?"webp":r.startsWith("data:application/exr")?"exr":r.startsWith("data:application/hdr")?"hdr":r.startsWith("data:image/jpeg")?"jpg":(e=r.split(".").pop())==null||(e=e.split("?"))==null||(e=e.shift())==null?void 0:e.toLowerCase(),isCubemap:t,isGainmap:n}}function VE(i){return i==="cube"?cI:i==="hdr"?M5:i==="exr"?E5:i==="jpg"||i==="jpeg"?Y5:i==="webp"?X5:null}const $5=i=>i.current&&i.current.isScene,K5=i=>$5(i)?i.current:i;function HE(i,e,t,n,r={}){var s,a,c,d;r={backgroundBlurriness:0,backgroundIntensity:1,backgroundRotation:[0,0,0],environmentIntensity:1,environmentRotation:[0,0,0],...r};const p=K5(e||t),m=p.background,v=p.environment,_={backgroundBlurriness:p.backgroundBlurriness,backgroundIntensity:p.backgroundIntensity,backgroundRotation:(s=(a=p.backgroundRotation)==null||a.clone==null?void 0:a.clone())!==null&&s!==void 0?s:[0,0,0],environmentIntensity:p.environmentIntensity,environmentRotation:(c=(d=p.environmentRotation)==null||d.clone==null?void 0:d.clone())!==null&&c!==void 0?c:[0,0,0]};return i!=="only"&&(p.environment=n),i&&(p.background=n),vl(p,r),()=>{i!=="only"&&(p.environment=v),i&&(p.background=m),vl(p,_)}}function GE({scene:i,background:e=!1,map:t,...n}){const r=bo(s=>s.scene);return Oe.useLayoutEffect(()=>{if(t)return HE(e,i,r,t,n)}),null}function f3({background:i=!1,scene:e,blur:t,backgroundBlurriness:n,backgroundIntensity:r,backgroundRotation:s,environmentIntensity:a,environmentRotation:c,...d}){const p=Gx(d),m=bo(v=>v.scene);return Oe.useLayoutEffect(()=>HE(i,e,m,p,{backgroundBlurriness:t??n,backgroundIntensity:r,backgroundRotation:s,environmentIntensity:a,environmentRotation:c})),Oe.useEffect(()=>()=>{p.dispose()},[p]),null}function Q5({children:i,near:e=.1,far:t=1e3,resolution:n=256,frames:r=1,map:s,background:a=!1,blur:c,backgroundBlurriness:d,backgroundIntensity:p,backgroundRotation:m,environmentIntensity:v,environmentRotation:_,scene:b,files:T,path:I,preset:C=void 0,extensions:A}){const D=bo(G=>G.gl),U=bo(G=>G.scene),L=Oe.useRef(null),[z]=Oe.useState(()=>new Hg),B=Oe.useMemo(()=>{const G=new gx(n);return G.texture.type=Wi,G},[n]);Oe.useEffect(()=>()=>{B.dispose()},[B]),Oe.useLayoutEffect(()=>{if(r===1){const G=D.autoClear;D.autoClear=!0,L.current.update(D,z),D.autoClear=G}return HE(a,b,U,B.texture,{backgroundBlurriness:c??d,backgroundIntensity:p,backgroundRotation:m,environmentIntensity:v,environmentRotation:_})},[i,z,B.texture,b,U,a,r,D]);let k=1;return Kg(()=>{if(r===1/0||k<r){const G=D.autoClear;D.autoClear=!0,L.current.update(D,z),D.autoClear=G,k++}}),Oe.createElement(Oe.Fragment,null,Y4(Oe.createElement(Oe.Fragment,null,i,Oe.createElement("cubeCamera",{ref:L,args:[e,t,B]}),T||C?Oe.createElement(f3,{background:!0,files:T,preset:C,path:I,extensions:A}):s?Oe.createElement(GE,{background:!0,map:s,extensions:A}):null),z))}function j5(i){var e,t,n,r;const s=Gx(i),a=i.map||s;Oe.useMemo(()=>DE({GroundProjectedEnvImpl:x5}),[]),Oe.useEffect(()=>()=>{s.dispose()},[s]);const c=Oe.useMemo(()=>[a],[a]),d=(e=i.ground)==null?void 0:e.height,p=(t=i.ground)==null?void 0:t.radius,m=(n=(r=i.ground)==null?void 0:r.scale)!==null&&n!==void 0?n:1e3;return Oe.createElement(Oe.Fragment,null,Oe.createElement(GE,El({},i,{map:a})),Oe.createElement("groundProjectedEnvImpl",{args:c,scale:m,height:d,radius:p}))}function eV(i){return i.ground?Oe.createElement(j5,i):i.map?Oe.createElement(GE,i):i.children?Oe.createElement(Q5,i):Oe.createElement(f3,i)}const tV=Oe.forwardRef(({scale:i=10,frames:e=1/0,opacity:t=1,width:n=1,height:r=1,blur:s=1,near:a=0,far:c=10,resolution:d=512,smooth:p=!0,color:m="#000000",depthWrite:v=!1,renderOrder:_,...b},T)=>{const I=Oe.useRef(null),C=bo(re=>re.scene),A=bo(re=>re.gl),D=Oe.useRef(null);n=n*(Array.isArray(i)?i[0]:i||1),r=r*(Array.isArray(i)?i[1]:i||1);const[U,L,z,B,k,G,P]=Oe.useMemo(()=>{const re=new Or(d,d),de=new Or(d,d);de.texture.generateMipmaps=re.texture.generateMipmaps=!1;const J=new gu(n,r).rotateX(Math.PI/2),te=new Di(J),ye=new Lx;ye.depthTest=ye.depthWrite=!1,ye.onBeforeCompile=$=>{$.uniforms={...$.uniforms,ucolor:{value:new Pt(m)}},$.fragmentShader=$.fragmentShader.replace("void main() {",`uniform vec3 ucolor;
           void main() {
          `),$.fragmentShader=$.fragmentShader.replace("vec4( vec3( 1.0 - fragCoordZ ), opacity );","vec4( ucolor * fragCoordZ * 2.0, ( 1.0 - fragCoordZ ) * 1.0 );")};const Ue=new Ar(S5),we=new Ar(b5);return we.depthTest=Ue.depthTest=!1,[re,J,ye,te,Ue,we,de]},[d,n,r,i,m]),O=re=>{B.visible=!0,B.material=k,k.uniforms.tDiffuse.value=U.texture,k.uniforms.h.value=re*1/256,A.setRenderTarget(P),A.render(B,D.current),B.material=G,G.uniforms.tDiffuse.value=P.texture,G.uniforms.v.value=re*1/256,A.setRenderTarget(U),A.render(B,D.current),B.visible=!1};let Z=0,ie,ee;return Kg(()=>{D.current&&(e===1/0||Z<e)&&(Z++,ie=C.background,ee=C.overrideMaterial,I.current.visible=!1,C.background=null,C.overrideMaterial=z,A.setRenderTarget(U),A.render(C,D.current),O(s),p&&O(s*.4),A.setRenderTarget(null),I.current.visible=!0,C.overrideMaterial=ee,C.background=ie)}),Oe.useImperativeHandle(T,()=>I.current,[]),Oe.createElement("group",El({"rotation-x":Math.PI/2},b,{ref:I}),Oe.createElement("mesh",{renderOrder:_,geometry:L,scale:[1,-1,1],rotation:[-Math.PI/2,0,0]},Oe.createElement("meshBasicMaterial",{transparent:!0,map:U.texture,opacity:t,depthWrite:v})),Oe.createElement("orthographicCamera",{ref:D,args:[-n/2,n/2,r/2,-r/2,a,c]}))});/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nV=i=>i.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),iV=i=>i.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,n)=>n?n.toUpperCase():t.toLowerCase()),nw=i=>{const e=iV(i);return e.charAt(0).toUpperCase()+e.slice(1)},d3=(...i)=>i.filter((e,t,n)=>!!e&&e.trim()!==""&&n.indexOf(e)===t).join(" ").trim(),rV=i=>{for(const e in i)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var sV={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oV=Oe.forwardRef(({color:i="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:n,className:r="",children:s,iconNode:a,...c},d)=>Oe.createElement("svg",{ref:d,...sV,width:e,height:e,stroke:i,strokeWidth:n?Number(t)*24/Number(e):t,className:d3("lucide",r),...!s&&!rV(c)&&{"aria-hidden":"true"},...c},[...a.map(([p,m])=>Oe.createElement(p,m)),...Array.isArray(s)?s:[s]]));/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fa=(i,e)=>{const t=Oe.forwardRef(({className:n,...r},s)=>Oe.createElement(oV,{ref:s,iconNode:e,className:d3(`lucide-${nV(nw(i))}`,`lucide-${i}`,n),...r}));return t.displayName=nw(i),t};/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aV=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],lV=Fa("check",aV);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uV=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],cV=Fa("copy",uV);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fV=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],dV=Fa("download",fV);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hV=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M7 3v18",key:"bbkbws"}],["path",{d:"M3 7.5h4",key:"zfgn84"}],["path",{d:"M3 12h18",key:"1i2n21"}],["path",{d:"M3 16.5h4",key:"1230mu"}],["path",{d:"M17 3v18",key:"in4fa5"}],["path",{d:"M17 7.5h4",key:"myr1c1"}],["path",{d:"M17 16.5h4",key:"go4c1d"}]],pV=Fa("film",hV);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mV=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],Gb=Fa("image",mV);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gV=[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]],vV=Fa("key",gV);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yV=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],_V=Fa("refresh-cw",yV);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xV=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],SV=Fa("save",xV);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bV=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],MV=Fa("settings",bV);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EV=[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]],iw=Fa("video",EV);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TV=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],AV=Fa("x",TV);function qE(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}let ed=qE();function h3(i){ed=i}const p3=/[&<>"']/,wV=new RegExp(p3.source,"g"),m3=/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,CV=new RegExp(m3.source,"g"),RV={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},rw=i=>RV[i];function go(i,e){if(e){if(p3.test(i))return i.replace(wV,rw)}else if(m3.test(i))return i.replace(CV,rw);return i}const IV=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig;function NV(i){return i.replace(IV,(e,t)=>(t=t.toLowerCase(),t==="colon"?":":t.charAt(0)==="#"?t.charAt(1)==="x"?String.fromCharCode(parseInt(t.substring(2),16)):String.fromCharCode(+t.substring(1)):""))}const DV=/(^|[^\[])\^/g;function mi(i,e){let t=typeof i=="string"?i:i.source;e=e||"";const n={replace:(r,s)=>{let a=typeof s=="string"?s:s.source;return a=a.replace(DV,"$1"),t=t.replace(r,a),n},getRegex:()=>new RegExp(t,e)};return n}function sw(i){try{i=encodeURI(i).replace(/%25/g,"%")}catch{return null}return i}const mg={exec:()=>null};function ow(i,e){const t=i.replace(/\|/g,(s,a,c)=>{let d=!1,p=a;for(;--p>=0&&c[p]==="\\";)d=!d;return d?"|":" |"}),n=t.split(/ \|/);let r=0;if(n[0].trim()||n.shift(),n.length>0&&!n[n.length-1].trim()&&n.pop(),e)if(n.length>e)n.splice(e);else for(;n.length<e;)n.push("");for(;r<n.length;r++)n[r]=n[r].trim().replace(/\\\|/g,"|");return n}function Fy(i,e,t){const n=i.length;if(n===0)return"";let r=0;for(;r<n&&i.charAt(n-r-1)===e;)r++;return i.slice(0,n-r)}function UV(i,e){if(i.indexOf(e[1])===-1)return-1;let t=0;for(let n=0;n<i.length;n++)if(i[n]==="\\")n++;else if(i[n]===e[0])t++;else if(i[n]===e[1]&&(t--,t<0))return n;return-1}function aw(i,e,t,n){const r=e.href,s=e.title?go(e.title):null,a=i[1].replace(/\\([\[\]])/g,"$1");if(i[0].charAt(0)!=="!"){n.state.inLink=!0;const c={type:"link",raw:t,href:r,title:s,text:a,tokens:n.inlineTokens(a)};return n.state.inLink=!1,c}return{type:"image",raw:t,href:r,title:s,text:go(a)}}function PV(i,e){const t=i.match(/^(\s+)(?:```)/);if(t===null)return e;const n=t[1];return e.split(`
`).map(r=>{const s=r.match(/^\s+/);if(s===null)return r;const[a]=s;return a.length>=n.length?r.slice(n.length):r}).join(`
`)}class Y_{constructor(e){un(this,"options");un(this,"rules");un(this,"lexer");this.options=e||ed}space(e){const t=this.rules.block.newline.exec(e);if(t&&t[0].length>0)return{type:"space",raw:t[0]}}code(e){const t=this.rules.block.code.exec(e);if(t){const n=t[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?n:Fy(n,`
`)}}}fences(e){const t=this.rules.block.fences.exec(e);if(t){const n=t[0],r=PV(n,t[3]||"");return{type:"code",raw:n,lang:t[2]?t[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):t[2],text:r}}}heading(e){const t=this.rules.block.heading.exec(e);if(t){let n=t[2].trim();if(/#$/.test(n)){const r=Fy(n,"#");(this.options.pedantic||!r||/ $/.test(r))&&(n=r.trim())}return{type:"heading",raw:t[0],depth:t[1].length,text:n,tokens:this.lexer.inline(n)}}}hr(e){const t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:t[0]}}blockquote(e){const t=this.rules.block.blockquote.exec(e);if(t){let n=t[0].replace(/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,`
    $1`);n=Fy(n.replace(/^ *>[ \t]?/gm,""),`
`);const r=this.lexer.state.top;this.lexer.state.top=!0;const s=this.lexer.blockTokens(n);return this.lexer.state.top=r,{type:"blockquote",raw:t[0],tokens:s,text:n}}}list(e){let t=this.rules.block.list.exec(e);if(t){let n=t[1].trim();const r=n.length>1,s={type:"list",raw:"",ordered:r,start:r?+n.slice(0,-1):"",loose:!1,items:[]};n=r?`\\d{1,9}\\${n.slice(-1)}`:`\\${n}`,this.options.pedantic&&(n=r?n:"[*+-]");const a=new RegExp(`^( {0,3}${n})((?:[	 ][^\\n]*)?(?:\\n|$))`);let c="",d="",p=!1;for(;e;){let m=!1;if(!(t=a.exec(e))||this.rules.block.hr.test(e))break;c=t[0],e=e.substring(c.length);let v=t[2].split(`
`,1)[0].replace(/^\t+/,A=>" ".repeat(3*A.length)),_=e.split(`
`,1)[0],b=0;this.options.pedantic?(b=2,d=v.trimStart()):(b=t[2].search(/[^ ]/),b=b>4?1:b,d=v.slice(b),b+=t[1].length);let T=!1;if(!v&&/^ *$/.test(_)&&(c+=_+`
`,e=e.substring(_.length+1),m=!0),!m){const A=new RegExp(`^ {0,${Math.min(3,b-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),D=new RegExp(`^ {0,${Math.min(3,b-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),U=new RegExp(`^ {0,${Math.min(3,b-1)}}(?:\`\`\`|~~~)`),L=new RegExp(`^ {0,${Math.min(3,b-1)}}#`);for(;e;){const z=e.split(`
`,1)[0];if(_=z,this.options.pedantic&&(_=_.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),U.test(_)||L.test(_)||A.test(_)||D.test(e))break;if(_.search(/[^ ]/)>=b||!_.trim())d+=`
`+_.slice(b);else{if(T||v.search(/[^ ]/)>=4||U.test(v)||L.test(v)||D.test(v))break;d+=`
`+_}!T&&!_.trim()&&(T=!0),c+=z+`
`,e=e.substring(z.length+1),v=_.slice(b)}}s.loose||(p?s.loose=!0:/\n *\n *$/.test(c)&&(p=!0));let I=null,C;this.options.gfm&&(I=/^\[[ xX]\] /.exec(d),I&&(C=I[0]!=="[ ] ",d=d.replace(/^\[[ xX]\] +/,""))),s.items.push({type:"list_item",raw:c,task:!!I,checked:C,loose:!1,text:d,tokens:[]}),s.raw+=c}s.items[s.items.length-1].raw=c.trimEnd(),s.items[s.items.length-1].text=d.trimEnd(),s.raw=s.raw.trimEnd();for(let m=0;m<s.items.length;m++)if(this.lexer.state.top=!1,s.items[m].tokens=this.lexer.blockTokens(s.items[m].text,[]),!s.loose){const v=s.items[m].tokens.filter(b=>b.type==="space"),_=v.length>0&&v.some(b=>/\n.*\n/.test(b.raw));s.loose=_}if(s.loose)for(let m=0;m<s.items.length;m++)s.items[m].loose=!0;return s}}html(e){const t=this.rules.block.html.exec(e);if(t)return{type:"html",block:!0,raw:t[0],pre:t[1]==="pre"||t[1]==="script"||t[1]==="style",text:t[0]}}def(e){const t=this.rules.block.def.exec(e);if(t){const n=t[1].toLowerCase().replace(/\s+/g," "),r=t[2]?t[2].replace(/^<(.*)>$/,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",s=t[3]?t[3].substring(1,t[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):t[3];return{type:"def",tag:n,raw:t[0],href:r,title:s}}}table(e){const t=this.rules.block.table.exec(e);if(!t||!/[:|]/.test(t[2]))return;const n=ow(t[1]),r=t[2].replace(/^\||\| *$/g,"").split("|"),s=t[3]&&t[3].trim()?t[3].replace(/\n[ \t]*$/,"").split(`
`):[],a={type:"table",raw:t[0],header:[],align:[],rows:[]};if(n.length===r.length){for(const c of r)/^ *-+: *$/.test(c)?a.align.push("right"):/^ *:-+: *$/.test(c)?a.align.push("center"):/^ *:-+ *$/.test(c)?a.align.push("left"):a.align.push(null);for(const c of n)a.header.push({text:c,tokens:this.lexer.inline(c)});for(const c of s)a.rows.push(ow(c,a.header.length).map(d=>({text:d,tokens:this.lexer.inline(d)})));return a}}lheading(e){const t=this.rules.block.lheading.exec(e);if(t)return{type:"heading",raw:t[0],depth:t[2].charAt(0)==="="?1:2,text:t[1],tokens:this.lexer.inline(t[1])}}paragraph(e){const t=this.rules.block.paragraph.exec(e);if(t){const n=t[1].charAt(t[1].length-1)===`
`?t[1].slice(0,-1):t[1];return{type:"paragraph",raw:t[0],text:n,tokens:this.lexer.inline(n)}}}text(e){const t=this.rules.block.text.exec(e);if(t)return{type:"text",raw:t[0],text:t[0],tokens:this.lexer.inline(t[0])}}escape(e){const t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:go(t[1])}}tag(e){const t=this.rules.inline.tag.exec(e);if(t)return!this.lexer.state.inLink&&/^<a /i.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:t[0]}}link(e){const t=this.rules.inline.link.exec(e);if(t){const n=t[2].trim();if(!this.options.pedantic&&/^</.test(n)){if(!/>$/.test(n))return;const a=Fy(n.slice(0,-1),"\\");if((n.length-a.length)%2===0)return}else{const a=UV(t[2],"()");if(a>-1){const d=(t[0].indexOf("!")===0?5:4)+t[1].length+a;t[2]=t[2].substring(0,a),t[0]=t[0].substring(0,d).trim(),t[3]=""}}let r=t[2],s="";if(this.options.pedantic){const a=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(r);a&&(r=a[1],s=a[3])}else s=t[3]?t[3].slice(1,-1):"";return r=r.trim(),/^</.test(r)&&(this.options.pedantic&&!/>$/.test(n)?r=r.slice(1):r=r.slice(1,-1)),aw(t,{href:r&&r.replace(this.rules.inline.anyPunctuation,"$1"),title:s&&s.replace(this.rules.inline.anyPunctuation,"$1")},t[0],this.lexer)}}reflink(e,t){let n;if((n=this.rules.inline.reflink.exec(e))||(n=this.rules.inline.nolink.exec(e))){const r=(n[2]||n[1]).replace(/\s+/g," "),s=t[r.toLowerCase()];if(!s){const a=n[0].charAt(0);return{type:"text",raw:a,text:a}}return aw(n,s,n[0],this.lexer)}}emStrong(e,t,n=""){let r=this.rules.inline.emStrongLDelim.exec(e);if(!r||r[3]&&n.match(/[\p{L}\p{N}]/u))return;if(!(r[1]||r[2]||"")||!n||this.rules.inline.punctuation.exec(n)){const a=[...r[0]].length-1;let c,d,p=a,m=0;const v=r[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(v.lastIndex=0,t=t.slice(-1*e.length+a);(r=v.exec(t))!=null;){if(c=r[1]||r[2]||r[3]||r[4]||r[5]||r[6],!c)continue;if(d=[...c].length,r[3]||r[4]){p+=d;continue}else if((r[5]||r[6])&&a%3&&!((a+d)%3)){m+=d;continue}if(p-=d,p>0)continue;d=Math.min(d,d+p+m);const _=[...r[0]][0].length,b=e.slice(0,a+r.index+_+d);if(Math.min(a,d)%2){const I=b.slice(1,-1);return{type:"em",raw:b,text:I,tokens:this.lexer.inlineTokens(I)}}const T=b.slice(2,-2);return{type:"strong",raw:b,text:T,tokens:this.lexer.inlineTokens(T)}}}}codespan(e){const t=this.rules.inline.code.exec(e);if(t){let n=t[2].replace(/\n/g," ");const r=/[^ ]/.test(n),s=/^ /.test(n)&&/ $/.test(n);return r&&s&&(n=n.substring(1,n.length-1)),n=go(n,!0),{type:"codespan",raw:t[0],text:n}}}br(e){const t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}}del(e){const t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2])}}autolink(e){const t=this.rules.inline.autolink.exec(e);if(t){let n,r;return t[2]==="@"?(n=go(t[1]),r="mailto:"+n):(n=go(t[1]),r=n),{type:"link",raw:t[0],text:n,href:r,tokens:[{type:"text",raw:n,text:n}]}}}url(e){var n;let t;if(t=this.rules.inline.url.exec(e)){let r,s;if(t[2]==="@")r=go(t[0]),s="mailto:"+r;else{let a;do a=t[0],t[0]=((n=this.rules.inline._backpedal.exec(t[0]))==null?void 0:n[0])??"";while(a!==t[0]);r=go(t[0]),t[1]==="www."?s="http://"+t[0]:s=t[0]}return{type:"link",raw:t[0],text:r,href:s,tokens:[{type:"text",raw:r,text:r}]}}}inlineText(e){const t=this.rules.inline.text.exec(e);if(t){let n;return this.lexer.state.inRawBlock?n=t[0]:n=go(t[0]),{type:"text",raw:t[0],text:n}}}}const LV=/^(?: *(?:\n|$))+/,FV=/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,kV=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,jg=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,OV=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,g3=/(?:[*+-]|\d{1,9}[.)])/,v3=mi(/^(?!bull |blockCode|fences|blockquote|heading|html)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html))+?)\n {0,3}(=+|-+) *(?:\n+|$)/).replace(/bull/g,g3).replace(/blockCode/g,/ {4}/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).getRegex(),WE=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,zV=/^[^\n]+/,XE=/(?!\s*\])(?:\\.|[^\[\]\\])+/,BV=mi(/^ {0,3}\[(label)\]: *(?:\n *)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/).replace("label",XE).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),VV=mi(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,g3).getRegex(),qx="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",YE=/\x3C!--(?:-?>|[\s\S]*?(?:-->|$))/,HV=mi("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))","i").replace("comment",YE).replace("tag",qx).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),y3=mi(WE).replace("hr",jg).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",qx).getRegex(),GV=mi(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",y3).getRegex(),JE={blockquote:GV,code:FV,def:BV,fences:kV,heading:OV,hr:jg,html:HV,lheading:v3,list:VV,newline:LV,paragraph:y3,table:mg,text:zV},lw=mi("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",jg).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",qx).getRegex(),qV={...JE,table:lw,paragraph:mi(WE).replace("hr",jg).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",lw).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",qx).getRegex()},WV={...JE,html:mi(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",YE).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:mg,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:mi(WE).replace("hr",jg).replace("heading",` *#{1,6} *[^
]`).replace("lheading",v3).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},_3=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,XV=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,x3=/^( {2,}|\\)\n(?!\s*$)/,YV=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,e0="\\p{P}\\p{S}",JV=mi(/^((?![*_])[\spunctuation])/,"u").replace(/punctuation/g,e0).getRegex(),ZV=/\[[^[\]]*?\]\([^\(\)]*?\)|`[^`]*?`|<[^<>]*?>/g,$V=mi(/^(?:\*+(?:((?!\*)[punct])|[^\s*]))|^_+(?:((?!_)[punct])|([^\s_]))/,"u").replace(/punct/g,e0).getRegex(),KV=mi("^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)[punct](\\*+)(?=[\\s]|$)|[^punct\\s](\\*+)(?!\\*)(?=[punct\\s]|$)|(?!\\*)[punct\\s](\\*+)(?=[^punct\\s])|[\\s](\\*+)(?!\\*)(?=[punct])|(?!\\*)[punct](\\*+)(?!\\*)(?=[punct])|[^punct\\s](\\*+)(?=[^punct\\s])","gu").replace(/punct/g,e0).getRegex(),QV=mi("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)[punct](_+)(?=[\\s]|$)|[^punct\\s](_+)(?!_)(?=[punct\\s]|$)|(?!_)[punct\\s](_+)(?=[^punct\\s])|[\\s](_+)(?!_)(?=[punct])|(?!_)[punct](_+)(?!_)(?=[punct])","gu").replace(/punct/g,e0).getRegex(),jV=mi(/\\([punct])/,"gu").replace(/punct/g,e0).getRegex(),eH=mi(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),tH=mi(YE).replace("(?:-->|$)","-->").getRegex(),nH=mi("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",tH).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),J_=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,iH=mi(/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/).replace("label",J_).replace("href",/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),S3=mi(/^!?\[(label)\]\[(ref)\]/).replace("label",J_).replace("ref",XE).getRegex(),b3=mi(/^!?\[(ref)\](?:\[\])?/).replace("ref",XE).getRegex(),rH=mi("reflink|nolink(?!\\()","g").replace("reflink",S3).replace("nolink",b3).getRegex(),ZE={_backpedal:mg,anyPunctuation:jV,autolink:eH,blockSkip:ZV,br:x3,code:XV,del:mg,emStrongLDelim:$V,emStrongRDelimAst:KV,emStrongRDelimUnd:QV,escape:_3,link:iH,nolink:b3,punctuation:JV,reflink:S3,reflinkSearch:rH,tag:nH,text:YV,url:mg},sH={...ZE,link:mi(/^!?\[(label)\]\((.*?)\)/).replace("label",J_).getRegex(),reflink:mi(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",J_).getRegex()},xM={...ZE,escape:mi(_3).replace("])","~|])").getRegex(),url:mi(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},oH={...xM,br:mi(x3).replace("{2,}","*").getRegex(),text:mi(xM.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},ky={normal:JE,gfm:qV,pedantic:WV},Km={normal:ZE,gfm:xM,breaks:oH,pedantic:sH};class Sl{constructor(e){un(this,"tokens");un(this,"options");un(this,"state");un(this,"tokenizer");un(this,"inlineQueue");this.tokens=[],this.tokens.links=Object.create(null),this.options=e||ed,this.options.tokenizer=this.options.tokenizer||new Y_,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const t={block:ky.normal,inline:Km.normal};this.options.pedantic?(t.block=ky.pedantic,t.inline=Km.pedantic):this.options.gfm&&(t.block=ky.gfm,this.options.breaks?t.inline=Km.breaks:t.inline=Km.gfm),this.tokenizer.rules=t}static get rules(){return{block:ky,inline:Km}}static lex(e,t){return new Sl(t).lex(e)}static lexInline(e,t){return new Sl(t).inlineTokens(e)}lex(e){e=e.replace(/\r\n|\r/g,`
`),this.blockTokens(e,this.tokens);for(let t=0;t<this.inlineQueue.length;t++){const n=this.inlineQueue[t];this.inlineTokens(n.src,n.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,t=[]){this.options.pedantic?e=e.replace(/\t/g,"    ").replace(/^ +$/gm,""):e=e.replace(/^( *)(\t+)/gm,(c,d,p)=>d+"    ".repeat(p.length));let n,r,s,a;for(;e;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(c=>(n=c.call({lexer:this},e,t))?(e=e.substring(n.raw.length),t.push(n),!0):!1))){if(n=this.tokenizer.space(e)){e=e.substring(n.raw.length),n.raw.length===1&&t.length>0?t[t.length-1].raw+=`
`:t.push(n);continue}if(n=this.tokenizer.code(e)){e=e.substring(n.raw.length),r=t[t.length-1],r&&(r.type==="paragraph"||r.type==="text")?(r.raw+=`
`+n.raw,r.text+=`
`+n.text,this.inlineQueue[this.inlineQueue.length-1].src=r.text):t.push(n);continue}if(n=this.tokenizer.fences(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.heading(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.hr(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.blockquote(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.list(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.html(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.def(e)){e=e.substring(n.raw.length),r=t[t.length-1],r&&(r.type==="paragraph"||r.type==="text")?(r.raw+=`
`+n.raw,r.text+=`
`+n.raw,this.inlineQueue[this.inlineQueue.length-1].src=r.text):this.tokens.links[n.tag]||(this.tokens.links[n.tag]={href:n.href,title:n.title});continue}if(n=this.tokenizer.table(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.lheading(e)){e=e.substring(n.raw.length),t.push(n);continue}if(s=e,this.options.extensions&&this.options.extensions.startBlock){let c=1/0;const d=e.slice(1);let p;this.options.extensions.startBlock.forEach(m=>{p=m.call({lexer:this},d),typeof p=="number"&&p>=0&&(c=Math.min(c,p))}),c<1/0&&c>=0&&(s=e.substring(0,c+1))}if(this.state.top&&(n=this.tokenizer.paragraph(s))){r=t[t.length-1],a&&r.type==="paragraph"?(r.raw+=`
`+n.raw,r.text+=`
`+n.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=r.text):t.push(n),a=s.length!==e.length,e=e.substring(n.raw.length);continue}if(n=this.tokenizer.text(e)){e=e.substring(n.raw.length),r=t[t.length-1],r&&r.type==="text"?(r.raw+=`
`+n.raw,r.text+=`
`+n.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=r.text):t.push(n);continue}if(e){const c="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(c);break}else throw new Error(c)}}return this.state.top=!0,t}inline(e,t=[]){return this.inlineQueue.push({src:e,tokens:t}),t}inlineTokens(e,t=[]){let n,r,s,a=e,c,d,p;if(this.tokens.links){const m=Object.keys(this.tokens.links);if(m.length>0)for(;(c=this.tokenizer.rules.inline.reflinkSearch.exec(a))!=null;)m.includes(c[0].slice(c[0].lastIndexOf("[")+1,-1))&&(a=a.slice(0,c.index)+"["+"a".repeat(c[0].length-2)+"]"+a.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(c=this.tokenizer.rules.inline.blockSkip.exec(a))!=null;)a=a.slice(0,c.index)+"["+"a".repeat(c[0].length-2)+"]"+a.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(c=this.tokenizer.rules.inline.anyPunctuation.exec(a))!=null;)a=a.slice(0,c.index)+"++"+a.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;e;)if(d||(p=""),d=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(m=>(n=m.call({lexer:this},e,t))?(e=e.substring(n.raw.length),t.push(n),!0):!1))){if(n=this.tokenizer.escape(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.tag(e)){e=e.substring(n.raw.length),r=t[t.length-1],r&&n.type==="text"&&r.type==="text"?(r.raw+=n.raw,r.text+=n.text):t.push(n);continue}if(n=this.tokenizer.link(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(n.raw.length),r=t[t.length-1],r&&n.type==="text"&&r.type==="text"?(r.raw+=n.raw,r.text+=n.text):t.push(n);continue}if(n=this.tokenizer.emStrong(e,a,p)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.codespan(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.br(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.del(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.autolink(e)){e=e.substring(n.raw.length),t.push(n);continue}if(!this.state.inLink&&(n=this.tokenizer.url(e))){e=e.substring(n.raw.length),t.push(n);continue}if(s=e,this.options.extensions&&this.options.extensions.startInline){let m=1/0;const v=e.slice(1);let _;this.options.extensions.startInline.forEach(b=>{_=b.call({lexer:this},v),typeof _=="number"&&_>=0&&(m=Math.min(m,_))}),m<1/0&&m>=0&&(s=e.substring(0,m+1))}if(n=this.tokenizer.inlineText(s)){e=e.substring(n.raw.length),n.raw.slice(-1)!=="_"&&(p=n.raw.slice(-1)),d=!0,r=t[t.length-1],r&&r.type==="text"?(r.raw+=n.raw,r.text+=n.text):t.push(n);continue}if(e){const m="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(m);break}else throw new Error(m)}}return t}}class Z_{constructor(e){un(this,"options");this.options=e||ed}code(e,t,n){var s;const r=(s=(t||"").match(/^\S*/))==null?void 0:s[0];return e=e.replace(/\n$/,"")+`
`,r?'<pre><code class="language-'+go(r)+'">'+(n?e:go(e,!0))+`</code></pre>
`:"<pre><code>"+(n?e:go(e,!0))+`</code></pre>
`}blockquote(e){return`<blockquote>
${e}</blockquote>
`}html(e,t){return e}heading(e,t,n){return`<h${t}>${e}</h${t}>
`}hr(){return`<hr>
`}list(e,t,n){const r=t?"ol":"ul",s=t&&n!==1?' start="'+n+'"':"";return"<"+r+s+`>
`+e+"</"+r+`>
`}listitem(e,t,n){return`<li>${e}</li>
`}checkbox(e){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph(e){return`<p>${e}</p>
`}table(e,t){return t&&(t=`<tbody>${t}</tbody>`),`<table>
<thead>
`+e+`</thead>
`+t+`</table>
`}tablerow(e){return`<tr>
${e}</tr>
`}tablecell(e,t){const n=t.header?"th":"td";return(t.align?`<${n} align="${t.align}">`:`<${n}>`)+e+`</${n}>
`}strong(e){return`<strong>${e}</strong>`}em(e){return`<em>${e}</em>`}codespan(e){return`<code>${e}</code>`}br(){return"<br>"}del(e){return`<del>${e}</del>`}link(e,t,n){const r=sw(e);if(r===null)return n;e=r;let s='<a href="'+e+'"';return t&&(s+=' title="'+t+'"'),s+=">"+n+"</a>",s}image(e,t,n){const r=sw(e);if(r===null)return n;e=r;let s=`<img src="${e}" alt="${n}"`;return t&&(s+=` title="${t}"`),s+=">",s}text(e){return e}}class $E{strong(e){return e}em(e){return e}codespan(e){return e}del(e){return e}html(e){return e}text(e){return e}link(e,t,n){return""+n}image(e,t,n){return""+n}br(){return""}}class bl{constructor(e){un(this,"options");un(this,"renderer");un(this,"textRenderer");this.options=e||ed,this.options.renderer=this.options.renderer||new Z_,this.renderer=this.options.renderer,this.renderer.options=this.options,this.textRenderer=new $E}static parse(e,t){return new bl(t).parse(e)}static parseInline(e,t){return new bl(t).parseInline(e)}parse(e,t=!0){let n="";for(let r=0;r<e.length;r++){const s=e[r];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[s.type]){const a=s,c=this.options.extensions.renderers[a.type].call({parser:this},a);if(c!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(a.type)){n+=c||"";continue}}switch(s.type){case"space":continue;case"hr":{n+=this.renderer.hr();continue}case"heading":{const a=s;n+=this.renderer.heading(this.parseInline(a.tokens),a.depth,NV(this.parseInline(a.tokens,this.textRenderer)));continue}case"code":{const a=s;n+=this.renderer.code(a.text,a.lang,!!a.escaped);continue}case"table":{const a=s;let c="",d="";for(let m=0;m<a.header.length;m++)d+=this.renderer.tablecell(this.parseInline(a.header[m].tokens),{header:!0,align:a.align[m]});c+=this.renderer.tablerow(d);let p="";for(let m=0;m<a.rows.length;m++){const v=a.rows[m];d="";for(let _=0;_<v.length;_++)d+=this.renderer.tablecell(this.parseInline(v[_].tokens),{header:!1,align:a.align[_]});p+=this.renderer.tablerow(d)}n+=this.renderer.table(c,p);continue}case"blockquote":{const a=s,c=this.parse(a.tokens);n+=this.renderer.blockquote(c);continue}case"list":{const a=s,c=a.ordered,d=a.start,p=a.loose;let m="";for(let v=0;v<a.items.length;v++){const _=a.items[v],b=_.checked,T=_.task;let I="";if(_.task){const C=this.renderer.checkbox(!!b);p?_.tokens.length>0&&_.tokens[0].type==="paragraph"?(_.tokens[0].text=C+" "+_.tokens[0].text,_.tokens[0].tokens&&_.tokens[0].tokens.length>0&&_.tokens[0].tokens[0].type==="text"&&(_.tokens[0].tokens[0].text=C+" "+_.tokens[0].tokens[0].text)):_.tokens.unshift({type:"text",text:C+" "}):I+=C+" "}I+=this.parse(_.tokens,p),m+=this.renderer.listitem(I,T,!!b)}n+=this.renderer.list(m,c,d);continue}case"html":{const a=s;n+=this.renderer.html(a.text,a.block);continue}case"paragraph":{const a=s;n+=this.renderer.paragraph(this.parseInline(a.tokens));continue}case"text":{let a=s,c=a.tokens?this.parseInline(a.tokens):a.text;for(;r+1<e.length&&e[r+1].type==="text";)a=e[++r],c+=`
`+(a.tokens?this.parseInline(a.tokens):a.text);n+=t?this.renderer.paragraph(c):c;continue}default:{const a='Token with "'+s.type+'" type was not found.';if(this.options.silent)return console.error(a),"";throw new Error(a)}}}return n}parseInline(e,t){t=t||this.renderer;let n="";for(let r=0;r<e.length;r++){const s=e[r];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[s.type]){const a=this.options.extensions.renderers[s.type].call({parser:this},s);if(a!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(s.type)){n+=a||"";continue}}switch(s.type){case"escape":{const a=s;n+=t.text(a.text);break}case"html":{const a=s;n+=t.html(a.text);break}case"link":{const a=s;n+=t.link(a.href,a.title,this.parseInline(a.tokens,t));break}case"image":{const a=s;n+=t.image(a.href,a.title,a.text);break}case"strong":{const a=s;n+=t.strong(this.parseInline(a.tokens,t));break}case"em":{const a=s;n+=t.em(this.parseInline(a.tokens,t));break}case"codespan":{const a=s;n+=t.codespan(a.text);break}case"br":{n+=t.br();break}case"del":{const a=s;n+=t.del(this.parseInline(a.tokens,t));break}case"text":{const a=s;n+=t.text(a.text);break}default:{const a='Token with "'+s.type+'" type was not found.';if(this.options.silent)return console.error(a),"";throw new Error(a)}}}return n}}class gg{constructor(e){un(this,"options");this.options=e||ed}preprocess(e){return e}postprocess(e){return e}processAllTokens(e){return e}}un(gg,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens"]));var Zf,SM,M3;class aH{constructor(...e){WT(this,Zf);un(this,"defaults",qE());un(this,"options",this.setOptions);un(this,"parse",Ov(this,Zf,SM).call(this,Sl.lex,bl.parse));un(this,"parseInline",Ov(this,Zf,SM).call(this,Sl.lexInline,bl.parseInline));un(this,"Parser",bl);un(this,"Renderer",Z_);un(this,"TextRenderer",$E);un(this,"Lexer",Sl);un(this,"Tokenizer",Y_);un(this,"Hooks",gg);this.use(...e)}walkTokens(e,t){var r,s;let n=[];for(const a of e)switch(n=n.concat(t.call(this,a)),a.type){case"table":{const c=a;for(const d of c.header)n=n.concat(this.walkTokens(d.tokens,t));for(const d of c.rows)for(const p of d)n=n.concat(this.walkTokens(p.tokens,t));break}case"list":{const c=a;n=n.concat(this.walkTokens(c.items,t));break}default:{const c=a;(s=(r=this.defaults.extensions)==null?void 0:r.childTokens)!=null&&s[c.type]?this.defaults.extensions.childTokens[c.type].forEach(d=>{const p=c[d].flat(1/0);n=n.concat(this.walkTokens(p,t))}):c.tokens&&(n=n.concat(this.walkTokens(c.tokens,t)))}}return n}use(...e){const t=this.defaults.extensions||{renderers:{},childTokens:{}};return e.forEach(n=>{const r={...n};if(r.async=this.defaults.async||r.async||!1,n.extensions&&(n.extensions.forEach(s=>{if(!s.name)throw new Error("extension name required");if("renderer"in s){const a=t.renderers[s.name];a?t.renderers[s.name]=function(...c){let d=s.renderer.apply(this,c);return d===!1&&(d=a.apply(this,c)),d}:t.renderers[s.name]=s.renderer}if("tokenizer"in s){if(!s.level||s.level!=="block"&&s.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");const a=t[s.level];a?a.unshift(s.tokenizer):t[s.level]=[s.tokenizer],s.start&&(s.level==="block"?t.startBlock?t.startBlock.push(s.start):t.startBlock=[s.start]:s.level==="inline"&&(t.startInline?t.startInline.push(s.start):t.startInline=[s.start]))}"childTokens"in s&&s.childTokens&&(t.childTokens[s.name]=s.childTokens)}),r.extensions=t),n.renderer){const s=this.defaults.renderer||new Z_(this.defaults);for(const a in n.renderer){if(!(a in s))throw new Error(`renderer '${a}' does not exist`);if(a==="options")continue;const c=a,d=n.renderer[c],p=s[c];s[c]=(...m)=>{let v=d.apply(s,m);return v===!1&&(v=p.apply(s,m)),v||""}}r.renderer=s}if(n.tokenizer){const s=this.defaults.tokenizer||new Y_(this.defaults);for(const a in n.tokenizer){if(!(a in s))throw new Error(`tokenizer '${a}' does not exist`);if(["options","rules","lexer"].includes(a))continue;const c=a,d=n.tokenizer[c],p=s[c];s[c]=(...m)=>{let v=d.apply(s,m);return v===!1&&(v=p.apply(s,m)),v}}r.tokenizer=s}if(n.hooks){const s=this.defaults.hooks||new gg;for(const a in n.hooks){if(!(a in s))throw new Error(`hook '${a}' does not exist`);if(a==="options")continue;const c=a,d=n.hooks[c],p=s[c];gg.passThroughHooks.has(a)?s[c]=m=>{if(this.defaults.async)return Promise.resolve(d.call(s,m)).then(_=>p.call(s,_));const v=d.call(s,m);return p.call(s,v)}:s[c]=(...m)=>{let v=d.apply(s,m);return v===!1&&(v=p.apply(s,m)),v}}r.hooks=s}if(n.walkTokens){const s=this.defaults.walkTokens,a=n.walkTokens;r.walkTokens=function(c){let d=[];return d.push(a.call(this,c)),s&&(d=d.concat(s.call(this,c))),d}}this.defaults={...this.defaults,...r}}),this}setOptions(e){return this.defaults={...this.defaults,...e},this}lexer(e,t){return Sl.lex(e,t??this.defaults)}parser(e,t){return bl.parse(e,t??this.defaults)}}Zf=new WeakSet,SM=function(e,t){return(n,r)=>{const s={...r},a={...this.defaults,...s};this.defaults.async===!0&&s.async===!1&&(a.silent||console.warn("marked(): The async option was set to true by an extension. The async: false option sent to parse will be ignored."),a.async=!0);const c=Ov(this,Zf,M3).call(this,!!a.silent,!!a.async);if(typeof n>"u"||n===null)return c(new Error("marked(): input parameter is undefined or null"));if(typeof n!="string")return c(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(n)+", string expected"));if(a.hooks&&(a.hooks.options=a),a.async)return Promise.resolve(a.hooks?a.hooks.preprocess(n):n).then(d=>e(d,a)).then(d=>a.hooks?a.hooks.processAllTokens(d):d).then(d=>a.walkTokens?Promise.all(this.walkTokens(d,a.walkTokens)).then(()=>d):d).then(d=>t(d,a)).then(d=>a.hooks?a.hooks.postprocess(d):d).catch(c);try{a.hooks&&(n=a.hooks.preprocess(n));let d=e(n,a);a.hooks&&(d=a.hooks.processAllTokens(d)),a.walkTokens&&this.walkTokens(d,a.walkTokens);let p=t(d,a);return a.hooks&&(p=a.hooks.postprocess(p)),p}catch(d){return c(d)}}},M3=function(e,t){return n=>{if(n.message+=`
Please report this to https://github.com/markedjs/marked.`,e){const r="<p>An error occurred:</p><pre>"+go(n.message+"",!0)+"</pre>";return t?Promise.resolve(r):r}if(t)return Promise.reject(n);throw n}};const Jf=new aH;function ai(i,e){return Jf.parse(i,e)}ai.options=ai.setOptions=function(i){return Jf.setOptions(i),ai.defaults=Jf.defaults,h3(ai.defaults),ai};ai.getDefaults=qE;ai.defaults=ed;ai.use=function(...i){return Jf.use(...i),ai.defaults=Jf.defaults,h3(ai.defaults),ai};ai.walkTokens=function(i,e){return Jf.walkTokens(i,e)};ai.parseInline=Jf.parseInline;ai.Parser=bl;ai.parser=bl.parse;ai.Renderer=Z_;ai.TextRenderer=$E;ai.Lexer=Sl;ai.lexer=Sl.lex;ai.Tokenizer=Y_;ai.Hooks=gg;ai.parse=ai;ai.options;ai.setOptions;ai.use;ai.walkTokens;ai.parseInline;bl.parse;Sl.lex;const lH=({isOpen:i,onClose:e,onSave:t,initialKey:n=""})=>{const[r,s]=Oe.useState(n),[a,c]=Oe.useState("");if(Oe.useEffect(()=>{s(n)},[n]),!i)return null;const d=()=>{const p=r.trim();if(!p){c("請輸入 API Key");return}if(!p.startsWith("AIza")){c("API Key 格式似乎不正確 (應以 AIza 開頭)");return}c(""),t(p),e()};return ue.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm",children:ue.jsxs("div",{className:"w-full max-w-md bg-[#0d0d0d] border border-gray-800 rounded-3xl overflow-hidden shadow-2xl p-8 animate-in fade-in zoom-in-95 duration-300",children:[ue.jsxs("div",{className:"flex items-center justify-between mb-8",children:[ue.jsxs("div",{className:"flex items-center gap-3",children:[ue.jsx("div",{className:"p-3 bg-blue-600/10 rounded-2xl border border-blue-500/20",children:ue.jsx(vV,{className:"w-5 h-5 text-blue-500"})}),ue.jsx("h2",{className:"text-lg font-black text-white uppercase tracking-widest",children:"API Settings"})]}),ue.jsx("button",{onClick:e,className:"p-2 text-gray-500 hover:text-white transition-colors",children:ue.jsx(AV,{size:20})})]}),ue.jsxs("div",{className:"space-y-6",children:[ue.jsxs("div",{className:"space-y-2",children:[ue.jsx("label",{className:"text-[10px] font-black text-gray-500 uppercase tracking-[0.2em] ml-1",children:"Google Gemini API Key"}),ue.jsx("input",{type:"password",value:r,onChange:p=>{s(p.target.value),c("")},placeholder:"AIza...",className:"w-full bg-[#141414] border border-gray-800 rounded-xl px-4 py-3 text-sm text-gray-200 focus:outline-none focus:border-blue-500 transition-all font-mono"}),a&&ue.jsx("p",{className:"text-red-500 text-xs mt-2 ml-1",children:a}),ue.jsx("p",{className:"text-[10px] text-gray-600 ml-1 leading-relaxed",children:"您的 API Key 僅會儲存在本地瀏覽器中，用於直接與 Google Gemini 服務通訊。"})]}),ue.jsxs("button",{onClick:d,className:"w-full py-4 bg-white text-black hover:bg-gray-100 active:scale-[0.98] transition-all rounded-2xl font-black text-xs uppercase tracking-[0.2em] flex items-center justify-center gap-3",children:[ue.jsx(SV,{size:16}),"Save Configuration"]})]})]})})},qb={AZIMUTH:"#22c55e",ELEVATION:"#ec4899",DISTANCE:"#eab308"},Wb={AZIMUTH:[{range:[0,30],label:"正面"},{range:[30,60],label:"四分之三側面"},{range:[60,120],label:"側面"},{range:[120,150],label:"後側側面"},{range:[150,210],label:"背面"},{range:[210,240],label:"後側側面"},{range:[240,300],label:"側面"},{range:[300,330],label:"四分之三側面"},{range:[330,360],label:"正面"}],ELEVATION:[{threshold:45,label:"鳥瞰"},{threshold:15,label:"高角度"},{threshold:-15,label:"平視"},{threshold:-45,label:"低角度"},{threshold:-1/0,label:"蟲瞻"}],DISTANCE:[{threshold:1,label:"大特寫 (ECU)"},{threshold:2,label:"特寫 (CU)"},{threshold:3.5,label:"胸上景 (MCU)"},{threshold:4.5,label:"半身景 (MS)"},{threshold:10,label:"中景 (MLS)"},{threshold:15,label:"全景 (FS)"},{threshold:20,label:"大全景 (WS)"},{threshold:30,label:"遠景 (LS)"},{threshold:1/0,label:"大遠景 (ELS)"}]},uH={POV:"主觀視角，模擬角色的親眼所見，增強代入感。",OTS:"過肩鏡頭，越過肩膀拍攝對話或視線互動。","Dutch Angle":"荷蘭式傾斜，畫面歪斜營造不安、失衡或混亂感。",Handheld:"手持攝影，晃動感強，增加臨場真實與緊張感。","Rack Focus":"變焦轉移，焦點在前後景物間切換，引導觀眾視線。","Locked-off":"固定鏡頭，攝影機完全靜止不動，強調構圖或動作。","Tilt Up":"鏡頭上仰，由下往上掃視，展現高度、崇高或權威。","Tilt Down":"鏡頭下俯，由上往下掃視，展現全貌、渺小或壓抑。","Pan Right":"鏡頭右搖，水平向右轉動攝影機，展示環境。","Pan Left":"鏡頭左搖，水平向左轉動攝影機，展示環境。","Zoom In":"變焦推進，光學放大畫面，突出細節或製造緊張感。","Zoom Out":"變焦拉遠，光學縮小畫面，展示環境關係或孤立感。","Whip Pan":"甩鏡，極快速的水平搖攝，常林於轉場或強調動態。","Dolly In":"軌道前推，攝影機實體接近主體，背景透視隨之改變。","Dolly Out":"軌道後拉，攝影機實體遠離主體，背景透視隨之改變。","Crane In":"升降機下降，從高處降落接近場景，進入故事。","Crane Out":"升降機上升，從場景抽離升高，展現宏大或結束感。",Tracking:"橫向跟拍，與主體保持平行移動，展現行進過程。",Following:"跟隨拍攝，在主體後方跟隨移動，展現主體視角方向。","Arc Shot":"弧形運動，圍繞主體旋轉拍攝，360度展示主體與環境。","Push In + Reveal":"推進揭示，向前移動並越過遮擋物，揭示新訊息。","Boom Up":"吊臂上升，垂直改變攝影機高度，擴展垂直視野。","Reverse Follow":"倒退跟隨，在主體前方倒退拍攝，引導主體前進。",Orbit:"環繞拍攝，圍繞主體進行連續旋轉，展現全方位立體感。","Drone Shot":"空拍鏡頭，模擬無人機視角，進行高空或大範圍的自由穿梭。",Standing:"站姿，最標準的基礎姿態，適合表達穩定或一般對話。",Walking:"行走，雙腳交替移動，展現動態位移與生活感。",Running:"奔跑，肢體幅度大，展現急迫、運動或高能量動態。"},cH=({rotationY:i,pose:e})=>{let t=null,n=0;switch(e){case"Walking":t=ue.jsxs(ue.Fragment,{children:[ue.jsx("group",{position:[-.12,.85,0],rotation:[Ps.degToRad(20),0,0],children:ue.jsx(jo,{args:[.18,.85,.18],position:[0,-.425,0],children:ue.jsx("meshStandardMaterial",{color:"#222"})})}),ue.jsx("group",{position:[.12,.85,0],rotation:[Ps.degToRad(-20),0,0],children:ue.jsx(jo,{args:[.18,.85,.18],position:[0,-.425,0],children:ue.jsx("meshStandardMaterial",{color:"#222"})})})]});break;case"Running":n=-.1,t=ue.jsxs(ue.Fragment,{children:[ue.jsx("group",{position:[-.12,.85,0],rotation:[Ps.degToRad(45),0,0],children:ue.jsx(jo,{args:[.18,.85,.18],position:[0,-.425,0],children:ue.jsx("meshStandardMaterial",{color:"#222"})})}),ue.jsx("group",{position:[.12,.85,0],rotation:[Ps.degToRad(-45),0,0],children:ue.jsx(jo,{args:[.18,.85,.18],position:[0,-.425,0],children:ue.jsx("meshStandardMaterial",{color:"#222"})})})]});break;case"Standing":default:t=ue.jsxs(ue.Fragment,{children:[ue.jsx(jo,{args:[.18,.85,.18],position:[-.12,.425,0],children:ue.jsx("meshStandardMaterial",{color:"#222"})}),ue.jsx(jo,{args:[.18,.85,.18],position:[.12,.425,0],children:ue.jsx("meshStandardMaterial",{color:"#222"})})]});break}return ue.jsxs("group",{rotation:[0,Ps.degToRad(i),0],children:[t,ue.jsxs("group",{position:[0,n,0],children:[ue.jsx(jo,{args:[.45,.7,.25],position:[0,1.2,0],children:ue.jsx("meshStandardMaterial",{color:"#444"})}),ue.jsx(jo,{args:[.12,.6,.12],position:[-.3,1.15,0],children:ue.jsx("meshStandardMaterial",{color:"#333"})}),ue.jsx(jo,{args:[.12,.6,.12],position:[.3,1.15,0],children:ue.jsx("meshStandardMaterial",{color:"#333"})}),ue.jsxs("group",{position:[0,1.68,0],children:[ue.jsx(k5,{args:[.13,32,32],children:ue.jsx("meshStandardMaterial",{color:"#fbc2ab",roughness:.4})}),ue.jsx(jo,{args:[.03,.03,.03],position:[-.05,.03,-.12],children:ue.jsx("meshStandardMaterial",{color:"black"})}),ue.jsx(jo,{args:[.03,.03,.03],position:[.05,.03,-.12],children:ue.jsx("meshStandardMaterial",{color:"black"})}),ue.jsx(jo,{args:[.015,.015,.06],position:[0,0,-.14],children:ue.jsx("meshStandardMaterial",{color:"#fbc2ab"})})]})]})]})},fH=({azimuth:i,elevation:e,distance:t,pose:n})=>{const r=Oe.useRef(null);return Kg(()=>{if(r.current){let s=1.68;const a=Ps.clamp((t-2)/6,0,1),c=Ps.lerp(s,s*.6,a),d=new Q(0,c,0),p=Ps.degToRad(90-e),m=Ps.degToRad(i+180),v=t*Math.sin(p)*Math.sin(m),_=t*Math.cos(p),b=t*Math.sin(p)*Math.cos(m);r.current.position.set(v,c+_,b),r.current.lookAt(d),r.current.fov!==15&&(r.current.fov=15,r.current.updateProjectionMatrix())}}),ue.jsx(P5,{ref:r,makeDefault:!0,fov:15,far:200})},dH=({azimuth:i,elevation:e,distance:t})=>ue.jsxs("group",{position:[0,.9,0],children:[ue.jsx(ew,{args:[t-.05,t,64],rotation:[Math.PI/2,0,0],children:ue.jsx("meshBasicMaterial",{color:qb.AZIMUTH,transparent:!0,opacity:.05,side:vo})}),ue.jsx("group",{rotation:[0,Ps.degToRad(-i),0],children:ue.jsx(ew,{args:[t-.05,t,64,1,0,Math.PI],rotation:[0,Math.PI/2,0],children:ue.jsx("meshBasicMaterial",{color:qb.ELEVATION,transparent:!0,opacity:.05,side:vo})})}),ue.jsx(C5,{points:[[0,0,0],[0,0,-t]],color:qb.DISTANCE,lineWidth:.5,rotation:[Ps.degToRad(e),Ps.degToRad(-i),0]})]});function hH(i){let e=i.azimuth%360;e<0&&(e+=360);let t="正面";for(const s of Wb.AZIMUTH)if(e>=s.range[0]&&e<s.range[1]){t=s.label;break}let n="平視";for(const s of Wb.ELEVATION)if(i.elevation>=s.threshold){n=s.label;break}let r="中景 (MLS)";for(const s of Wb.DISTANCE)if(i.distance<=s.threshold){r=s.label;break}return{direction:t,angle:n,size:r}}var pH={};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let mH,gH;function vH(){return{geminiUrl:mH,vertexUrl:gH}}function yH(i,e,t,n){var r,s;if(!(i!=null&&i.baseUrl)){const a=vH();return e?(r=a.vertexUrl)!==null&&r!==void 0?r:t:(s=a.geminiUrl)!==null&&s!==void 0?s:n}return i.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class vu{}function Ft(i,e){const t=/\{([^}]+)\}/g;return i.replace(t,(n,r)=>{if(Object.prototype.hasOwnProperty.call(e,r)){const s=e[r];return s!=null?String(s):""}else throw new Error(`Key '${r}' not found in valueMap.`)})}function S(i,e,t){for(let s=0;s<e.length-1;s++){const a=e[s];if(a.endsWith("[]")){const c=a.slice(0,-2);if(!(c in i))if(Array.isArray(t))i[c]=Array.from({length:t.length},()=>({}));else throw new Error(`Value must be a list given an array path ${a}`);if(Array.isArray(i[c])){const d=i[c];if(Array.isArray(t))for(let p=0;p<d.length;p++){const m=d[p];S(m,e.slice(s+1),t[p])}else for(const p of d)S(p,e.slice(s+1),t)}return}else if(a.endsWith("[0]")){const c=a.slice(0,-3);c in i||(i[c]=[{}]);const d=i[c];S(d[0],e.slice(s+1),t);return}(!i[a]||typeof i[a]!="object")&&(i[a]={}),i=i[a]}const n=e[e.length-1],r=i[n];if(r!==void 0){if(!t||typeof t=="object"&&Object.keys(t).length===0||t===r)return;if(typeof r=="object"&&typeof t=="object"&&r!==null&&t!==null)Object.assign(r,t);else throw new Error(`Cannot set value for an existing key. Key: ${n}`)}else n==="_self"&&typeof t=="object"&&t!==null&&!Array.isArray(t)?Object.assign(i,t):i[n]=t}function x(i,e,t=void 0){try{if(e.length===1&&e[0]==="_self")return i;for(let n=0;n<e.length;n++){if(typeof i!="object"||i===null)return t;const r=e[n];if(r.endsWith("[]")){const s=r.slice(0,-2);if(s in i){const a=i[s];return Array.isArray(a)?a.map(c=>x(c,e.slice(n+1),t)):t}else return t}else i=i[r]}return i}catch(n){if(n instanceof TypeError)return t;throw n}}function _H(i,e){for(const[t,n]of Object.entries(e)){const r=t.split("."),s=n.split("."),a=new Set;let c=-1;for(let d=0;d<r.length;d++)if(r[d]==="*"){c=d;break}if(c!==-1&&s.length>c)for(let d=c;d<s.length;d++){const p=s[d];p!=="*"&&!p.endsWith("[]")&&!p.endsWith("[0]")&&a.add(p)}bM(i,r,s,0,a)}}function bM(i,e,t,n,r){if(n>=e.length||typeof i!="object"||i===null)return;const s=e[n];if(s.endsWith("[]")){const a=s.slice(0,-2),c=i;if(a in c&&Array.isArray(c[a]))for(const d of c[a])bM(d,e,t,n+1,r)}else if(s==="*"){if(typeof i=="object"&&i!==null&&!Array.isArray(i)){const a=i,c=Object.keys(a).filter(p=>!p.startsWith("_")&&!r.has(p)),d={};for(const p of c)d[p]=a[p];for(const[p,m]of Object.entries(d)){const v=[];for(const _ of t.slice(n))_==="*"?v.push(p):v.push(_);S(a,v,m)}for(const p of c)delete a[p]}}else{const a=i;s in a&&bM(a[s],e,t,n+1,r)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function KE(i){if(typeof i!="string")throw new Error("fromImageBytes must be a string");return i}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function xH(i){const e={},t=x(i,["operationName"]);t!=null&&S(e,["operationName"],t);const n=x(i,["resourceName"]);return n!=null&&S(e,["_url","resourceName"],n),e}function SH(i){const e={},t=x(i,["name"]);t!=null&&S(e,["name"],t);const n=x(i,["metadata"]);n!=null&&S(e,["metadata"],n);const r=x(i,["done"]);r!=null&&S(e,["done"],r);const s=x(i,["error"]);s!=null&&S(e,["error"],s);const a=x(i,["response","generateVideoResponse"]);return a!=null&&S(e,["response"],MH(a)),e}function bH(i){const e={},t=x(i,["name"]);t!=null&&S(e,["name"],t);const n=x(i,["metadata"]);n!=null&&S(e,["metadata"],n);const r=x(i,["done"]);r!=null&&S(e,["done"],r);const s=x(i,["error"]);s!=null&&S(e,["error"],s);const a=x(i,["response"]);return a!=null&&S(e,["response"],EH(a)),e}function MH(i){const e={},t=x(i,["generatedSamples"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(a=>TH(a))),S(e,["generatedVideos"],s)}const n=x(i,["raiMediaFilteredCount"]);n!=null&&S(e,["raiMediaFilteredCount"],n);const r=x(i,["raiMediaFilteredReasons"]);return r!=null&&S(e,["raiMediaFilteredReasons"],r),e}function EH(i){const e={},t=x(i,["videos"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(a=>AH(a))),S(e,["generatedVideos"],s)}const n=x(i,["raiMediaFilteredCount"]);n!=null&&S(e,["raiMediaFilteredCount"],n);const r=x(i,["raiMediaFilteredReasons"]);return r!=null&&S(e,["raiMediaFilteredReasons"],r),e}function TH(i){const e={},t=x(i,["video"]);return t!=null&&S(e,["video"],DH(t)),e}function AH(i){const e={},t=x(i,["_self"]);return t!=null&&S(e,["video"],UH(t)),e}function wH(i){const e={},t=x(i,["operationName"]);return t!=null&&S(e,["_url","operationName"],t),e}function CH(i){const e={},t=x(i,["operationName"]);return t!=null&&S(e,["_url","operationName"],t),e}function RH(i){const e={},t=x(i,["name"]);t!=null&&S(e,["name"],t);const n=x(i,["metadata"]);n!=null&&S(e,["metadata"],n);const r=x(i,["done"]);r!=null&&S(e,["done"],r);const s=x(i,["error"]);s!=null&&S(e,["error"],s);const a=x(i,["response"]);return a!=null&&S(e,["response"],IH(a)),e}function IH(i){const e={},t=x(i,["sdkHttpResponse"]);t!=null&&S(e,["sdkHttpResponse"],t);const n=x(i,["parent"]);n!=null&&S(e,["parent"],n);const r=x(i,["documentName"]);return r!=null&&S(e,["documentName"],r),e}function E3(i){const e={},t=x(i,["name"]);t!=null&&S(e,["name"],t);const n=x(i,["metadata"]);n!=null&&S(e,["metadata"],n);const r=x(i,["done"]);r!=null&&S(e,["done"],r);const s=x(i,["error"]);s!=null&&S(e,["error"],s);const a=x(i,["response"]);return a!=null&&S(e,["response"],NH(a)),e}function NH(i){const e={},t=x(i,["sdkHttpResponse"]);t!=null&&S(e,["sdkHttpResponse"],t);const n=x(i,["parent"]);n!=null&&S(e,["parent"],n);const r=x(i,["documentName"]);return r!=null&&S(e,["documentName"],r),e}function DH(i){const e={},t=x(i,["uri"]);t!=null&&S(e,["uri"],t);const n=x(i,["encodedVideo"]);n!=null&&S(e,["videoBytes"],KE(n));const r=x(i,["encoding"]);return r!=null&&S(e,["mimeType"],r),e}function UH(i){const e={},t=x(i,["gcsUri"]);t!=null&&S(e,["uri"],t);const n=x(i,["bytesBase64Encoded"]);n!=null&&S(e,["videoBytes"],KE(n));const r=x(i,["mimeType"]);return r!=null&&S(e,["mimeType"],r),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var uw;(function(i){i.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",i.OUTCOME_OK="OUTCOME_OK",i.OUTCOME_FAILED="OUTCOME_FAILED",i.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(uw||(uw={}));var cw;(function(i){i.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",i.PYTHON="PYTHON"})(cw||(cw={}));var fw;(function(i){i.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",i.SILENT="SILENT",i.WHEN_IDLE="WHEN_IDLE",i.INTERRUPT="INTERRUPT"})(fw||(fw={}));var Sc;(function(i){i.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",i.STRING="STRING",i.NUMBER="NUMBER",i.INTEGER="INTEGER",i.BOOLEAN="BOOLEAN",i.ARRAY="ARRAY",i.OBJECT="OBJECT",i.NULL="NULL"})(Sc||(Sc={}));var dw;(function(i){i.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",i.SIMPLE_SEARCH="SIMPLE_SEARCH",i.ELASTIC_SEARCH="ELASTIC_SEARCH"})(dw||(dw={}));var hw;(function(i){i.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",i.NO_AUTH="NO_AUTH",i.API_KEY_AUTH="API_KEY_AUTH",i.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",i.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",i.OAUTH="OAUTH",i.OIDC_AUTH="OIDC_AUTH"})(hw||(hw={}));var pw;(function(i){i.HTTP_IN_UNSPECIFIED="HTTP_IN_UNSPECIFIED",i.HTTP_IN_QUERY="HTTP_IN_QUERY",i.HTTP_IN_HEADER="HTTP_IN_HEADER",i.HTTP_IN_PATH="HTTP_IN_PATH",i.HTTP_IN_BODY="HTTP_IN_BODY",i.HTTP_IN_COOKIE="HTTP_IN_COOKIE"})(pw||(pw={}));var mw;(function(i){i.PHISH_BLOCK_THRESHOLD_UNSPECIFIED="PHISH_BLOCK_THRESHOLD_UNSPECIFIED",i.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",i.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",i.BLOCK_HIGH_AND_ABOVE="BLOCK_HIGH_AND_ABOVE",i.BLOCK_HIGHER_AND_ABOVE="BLOCK_HIGHER_AND_ABOVE",i.BLOCK_VERY_HIGH_AND_ABOVE="BLOCK_VERY_HIGH_AND_ABOVE",i.BLOCK_ONLY_EXTREMELY_HIGH="BLOCK_ONLY_EXTREMELY_HIGH"})(mw||(mw={}));var gw;(function(i){i.UNSPECIFIED="UNSPECIFIED",i.BLOCKING="BLOCKING",i.NON_BLOCKING="NON_BLOCKING"})(gw||(gw={}));var vw;(function(i){i.MODE_UNSPECIFIED="MODE_UNSPECIFIED",i.MODE_DYNAMIC="MODE_DYNAMIC"})(vw||(vw={}));var yw;(function(i){i.MODE_UNSPECIFIED="MODE_UNSPECIFIED",i.AUTO="AUTO",i.ANY="ANY",i.NONE="NONE",i.VALIDATED="VALIDATED"})(yw||(yw={}));var _w;(function(i){i.THINKING_LEVEL_UNSPECIFIED="THINKING_LEVEL_UNSPECIFIED",i.LOW="LOW",i.MEDIUM="MEDIUM",i.HIGH="HIGH",i.MINIMAL="MINIMAL"})(_w||(_w={}));var xw;(function(i){i.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",i.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",i.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",i.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",i.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",i.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",i.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",i.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",i.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",i.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",i.HARM_CATEGORY_JAILBREAK="HARM_CATEGORY_JAILBREAK"})(xw||(xw={}));var Sw;(function(i){i.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",i.SEVERITY="SEVERITY",i.PROBABILITY="PROBABILITY"})(Sw||(Sw={}));var bw;(function(i){i.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",i.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",i.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",i.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",i.BLOCK_NONE="BLOCK_NONE",i.OFF="OFF"})(bw||(bw={}));var Mw;(function(i){i.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",i.STOP="STOP",i.MAX_TOKENS="MAX_TOKENS",i.SAFETY="SAFETY",i.RECITATION="RECITATION",i.LANGUAGE="LANGUAGE",i.OTHER="OTHER",i.BLOCKLIST="BLOCKLIST",i.PROHIBITED_CONTENT="PROHIBITED_CONTENT",i.SPII="SPII",i.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",i.IMAGE_SAFETY="IMAGE_SAFETY",i.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",i.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",i.NO_IMAGE="NO_IMAGE",i.IMAGE_RECITATION="IMAGE_RECITATION",i.IMAGE_OTHER="IMAGE_OTHER"})(Mw||(Mw={}));var Ew;(function(i){i.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",i.NEGLIGIBLE="NEGLIGIBLE",i.LOW="LOW",i.MEDIUM="MEDIUM",i.HIGH="HIGH"})(Ew||(Ew={}));var Tw;(function(i){i.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",i.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",i.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",i.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",i.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(Tw||(Tw={}));var Aw;(function(i){i.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",i.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",i.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",i.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",i.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(Aw||(Aw={}));var ww;(function(i){i.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",i.SAFETY="SAFETY",i.OTHER="OTHER",i.BLOCKLIST="BLOCKLIST",i.PROHIBITED_CONTENT="PROHIBITED_CONTENT",i.IMAGE_SAFETY="IMAGE_SAFETY",i.MODEL_ARMOR="MODEL_ARMOR",i.JAILBREAK="JAILBREAK"})(ww||(ww={}));var Cw;(function(i){i.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",i.ON_DEMAND="ON_DEMAND",i.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(Cw||(Cw={}));var $_;(function(i){i.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",i.TEXT="TEXT",i.IMAGE="IMAGE",i.AUDIO="AUDIO"})($_||($_={}));var Rw;(function(i){i.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",i.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",i.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",i.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(Rw||(Rw={}));var Iw;(function(i){i.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",i.TUNING_MODE_FULL="TUNING_MODE_FULL",i.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(Iw||(Iw={}));var Nw;(function(i){i.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",i.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",i.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",i.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",i.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",i.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",i.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(Nw||(Nw={}));var MM;(function(i){i.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",i.JOB_STATE_QUEUED="JOB_STATE_QUEUED",i.JOB_STATE_PENDING="JOB_STATE_PENDING",i.JOB_STATE_RUNNING="JOB_STATE_RUNNING",i.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",i.JOB_STATE_FAILED="JOB_STATE_FAILED",i.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",i.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",i.JOB_STATE_PAUSED="JOB_STATE_PAUSED",i.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",i.JOB_STATE_UPDATING="JOB_STATE_UPDATING",i.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(MM||(MM={}));var Dw;(function(i){i.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",i.TUNING_TASK_I2V="TUNING_TASK_I2V",i.TUNING_TASK_T2V="TUNING_TASK_T2V",i.TUNING_TASK_R2V="TUNING_TASK_R2V"})(Dw||(Dw={}));var Uw;(function(i){i.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",i.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",i.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",i.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH",i.MEDIA_RESOLUTION_ULTRA_HIGH="MEDIA_RESOLUTION_ULTRA_HIGH"})(Uw||(Uw={}));var Pw;(function(i){i.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",i.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",i.BALANCED="BALANCED",i.PRIORITIZE_COST="PRIORITIZE_COST"})(Pw||(Pw={}));var Lw;(function(i){i.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",i.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(Lw||(Lw={}));var Fw;(function(i){i.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",i.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",i.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",i.BLOCK_NONE="BLOCK_NONE"})(Fw||(Fw={}));var kw;(function(i){i.DONT_ALLOW="DONT_ALLOW",i.ALLOW_ADULT="ALLOW_ADULT",i.ALLOW_ALL="ALLOW_ALL"})(kw||(kw={}));var Ow;(function(i){i.auto="auto",i.en="en",i.ja="ja",i.ko="ko",i.hi="hi",i.zh="zh",i.pt="pt",i.es="es"})(Ow||(Ow={}));var zw;(function(i){i.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",i.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",i.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",i.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",i.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(zw||(zw={}));var Bw;(function(i){i.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",i.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",i.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",i.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(Bw||(Bw={}));var Vw;(function(i){i.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",i.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",i.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",i.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(Vw||(Vw={}));var Hw;(function(i){i.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",i.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",i.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",i.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",i.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",i.EDIT_MODE_STYLE="EDIT_MODE_STYLE",i.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",i.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(Hw||(Hw={}));var Gw;(function(i){i.FOREGROUND="FOREGROUND",i.BACKGROUND="BACKGROUND",i.PROMPT="PROMPT",i.SEMANTIC="SEMANTIC",i.INTERACTIVE="INTERACTIVE"})(Gw||(Gw={}));var qw;(function(i){i.ASSET="ASSET",i.STYLE="STYLE"})(qw||(qw={}));var Ww;(function(i){i.INSERT="INSERT",i.REMOVE="REMOVE",i.REMOVE_STATIC="REMOVE_STATIC",i.OUTPAINT="OUTPAINT"})(Ww||(Ww={}));var Xw;(function(i){i.OPTIMIZED="OPTIMIZED",i.LOSSLESS="LOSSLESS"})(Xw||(Xw={}));var Yw;(function(i){i.SUPERVISED_FINE_TUNING="SUPERVISED_FINE_TUNING",i.PREFERENCE_TUNING="PREFERENCE_TUNING"})(Yw||(Yw={}));var Jw;(function(i){i.STATE_UNSPECIFIED="STATE_UNSPECIFIED",i.STATE_PENDING="STATE_PENDING",i.STATE_ACTIVE="STATE_ACTIVE",i.STATE_FAILED="STATE_FAILED"})(Jw||(Jw={}));var Zw;(function(i){i.STATE_UNSPECIFIED="STATE_UNSPECIFIED",i.PROCESSING="PROCESSING",i.ACTIVE="ACTIVE",i.FAILED="FAILED"})(Zw||(Zw={}));var $w;(function(i){i.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",i.UPLOADED="UPLOADED",i.GENERATED="GENERATED",i.REGISTERED="REGISTERED"})($w||($w={}));var Kw;(function(i){i.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",i.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",i.RESPONSE_REJECTED="RESPONSE_REJECTED",i.NEED_MORE_INPUT="NEED_MORE_INPUT"})(Kw||(Kw={}));var Qw;(function(i){i.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",i.TEXT="TEXT",i.IMAGE="IMAGE",i.VIDEO="VIDEO",i.AUDIO="AUDIO",i.DOCUMENT="DOCUMENT"})(Qw||(Qw={}));var jw;(function(i){i.VAD_SIGNAL_TYPE_UNSPECIFIED="VAD_SIGNAL_TYPE_UNSPECIFIED",i.VAD_SIGNAL_TYPE_SOS="VAD_SIGNAL_TYPE_SOS",i.VAD_SIGNAL_TYPE_EOS="VAD_SIGNAL_TYPE_EOS"})(jw||(jw={}));var eC;(function(i){i.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",i.ACTIVITY_START="ACTIVITY_START",i.ACTIVITY_END="ACTIVITY_END"})(eC||(eC={}));var tC;(function(i){i.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",i.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",i.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(tC||(tC={}));var nC;(function(i){i.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",i.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",i.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(nC||(nC={}));var iC;(function(i){i.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",i.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",i.NO_INTERRUPTION="NO_INTERRUPTION"})(iC||(iC={}));var rC;(function(i){i.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",i.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",i.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(rC||(rC={}));var sC;(function(i){i.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",i.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",i.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",i.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",i.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",i.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",i.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",i.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",i.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",i.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",i.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",i.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",i.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(sC||(sC={}));var oC;(function(i){i.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",i.QUALITY="QUALITY",i.DIVERSITY="DIVERSITY",i.VOCALIZATION="VOCALIZATION"})(oC||(oC={}));var Fh;(function(i){i.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",i.PLAY="PLAY",i.PAUSE="PAUSE",i.STOP="STOP",i.RESET_CONTEXT="RESET_CONTEXT"})(Fh||(Fh={}));class EM{constructor(e){const t={};for(const n of e.headers.entries())t[n[0]]=n[1];this.headers=t,this.responseInternal=e}json(){return this.responseInternal.json()}}class Qm{get text(){var e,t,n,r,s,a,c,d;if(((r=(n=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||n===void 0?void 0:n.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let p="",m=!1;const v=[];for(const _ of(d=(c=(a=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||a===void 0?void 0:a.content)===null||c===void 0?void 0:c.parts)!==null&&d!==void 0?d:[]){for(const[b,T]of Object.entries(_))b!=="text"&&b!=="thought"&&b!=="thoughtSignature"&&(T!==null||T!==void 0)&&v.push(b);if(typeof _.text=="string"){if(typeof _.thought=="boolean"&&_.thought)continue;m=!0,p+=_.text}}return v.length>0&&console.warn(`there are non-text parts ${v} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),m?p:void 0}get data(){var e,t,n,r,s,a,c,d;if(((r=(n=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||n===void 0?void 0:n.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let p="";const m=[];for(const v of(d=(c=(a=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||a===void 0?void 0:a.content)===null||c===void 0?void 0:c.parts)!==null&&d!==void 0?d:[]){for(const[_,b]of Object.entries(v))_!=="inlineData"&&(b!==null||b!==void 0)&&m.push(_);v.inlineData&&typeof v.inlineData.data=="string"&&(p+=atob(v.inlineData.data))}return m.length>0&&console.warn(`there are non-data parts ${m} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),p.length>0?btoa(p):void 0}get functionCalls(){var e,t,n,r,s,a,c,d;if(((r=(n=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||n===void 0?void 0:n.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const p=(d=(c=(a=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||a===void 0?void 0:a.content)===null||c===void 0?void 0:c.parts)===null||d===void 0?void 0:d.filter(m=>m.functionCall).map(m=>m.functionCall).filter(m=>m!==void 0);if((p==null?void 0:p.length)!==0)return p}get executableCode(){var e,t,n,r,s,a,c,d,p;if(((r=(n=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||n===void 0?void 0:n.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const m=(d=(c=(a=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||a===void 0?void 0:a.content)===null||c===void 0?void 0:c.parts)===null||d===void 0?void 0:d.filter(v=>v.executableCode).map(v=>v.executableCode).filter(v=>v!==void 0);if((m==null?void 0:m.length)!==0)return(p=m==null?void 0:m[0])===null||p===void 0?void 0:p.code}get codeExecutionResult(){var e,t,n,r,s,a,c,d,p;if(((r=(n=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||n===void 0?void 0:n.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const m=(d=(c=(a=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||a===void 0?void 0:a.content)===null||c===void 0?void 0:c.parts)===null||d===void 0?void 0:d.filter(v=>v.codeExecutionResult).map(v=>v.codeExecutionResult).filter(v=>v!==void 0);if((m==null?void 0:m.length)!==0)return(p=m==null?void 0:m[0])===null||p===void 0?void 0:p.output}}class aC{}class lC{}class PH{}class LH{}class FH{}class kH{}class uC{}class cC{}class fC{}class OH{}class K_{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const n=new K_;let r;const s=e;return t?r=bH(s):r=SH(s),Object.assign(n,r),n}}class dC{}class hC{}class pC{}class mC{}class zH{}class BH{}class VH{}class QE{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const n=new QE,s=RH(e);return Object.assign(n,s),n}}class HH{}class GH{}class qH{}class gC{}class WH{get text(){var e,t,n;let r="",s=!1;const a=[];for(const c of(n=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&n!==void 0?n:[]){for(const[d,p]of Object.entries(c))d!=="text"&&d!=="thought"&&p!==null&&a.push(d);if(typeof c.text=="string"){if(typeof c.thought=="boolean"&&c.thought)continue;s=!0,r+=c.text}}return a.length>0&&console.warn(`there are non-text parts ${a} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),s?r:void 0}get data(){var e,t,n;let r="";const s=[];for(const a of(n=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&n!==void 0?n:[]){for(const[c,d]of Object.entries(a))c!=="inlineData"&&d!==null&&s.push(c);a.inlineData&&typeof a.inlineData.data=="string"&&(r+=atob(a.inlineData.data))}return s.length>0&&console.warn(`there are non-data parts ${s} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),r.length>0?btoa(r):void 0}}class XH{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}class jE{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const n=new jE,s=E3(e);return Object.assign(n,s),n}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function ei(i,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(e.includes("..")||e.includes("?")||e.includes("&"))throw new Error("invalid model parameter");if(i.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const t=e.split("/",2);return`publishers/${t[0]}/models/${t[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function T3(i,e){const t=ei(i,e);return t?t.startsWith("publishers/")&&i.isVertexAI()?`projects/${i.getProject()}/locations/${i.getLocation()}/${t}`:t.startsWith("models/")&&i.isVertexAI()?`projects/${i.getProject()}/locations/${i.getLocation()}/publishers/google/${t}`:t:""}function A3(i){return Array.isArray(i)?i.map(e=>Q_(e)):[Q_(i)]}function Q_(i){if(typeof i=="object"&&i!==null)return i;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof i}`)}function w3(i){const e=Q_(i);if(e.mimeType&&e.mimeType.startsWith("image/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function C3(i){const e=Q_(i);if(e.mimeType&&e.mimeType.startsWith("audio/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function vC(i){if(i==null)throw new Error("PartUnion is required");if(typeof i=="object")return i;if(typeof i=="string")return{text:i};throw new Error(`Unsupported part type: ${typeof i}`)}function R3(i){if(i==null||Array.isArray(i)&&i.length===0)throw new Error("PartListUnion is required");return Array.isArray(i)?i.map(e=>vC(e)):[vC(i)]}function TM(i){return i!=null&&typeof i=="object"&&"parts"in i&&Array.isArray(i.parts)}function yC(i){return i!=null&&typeof i=="object"&&"functionCall"in i}function _C(i){return i!=null&&typeof i=="object"&&"functionResponse"in i}function ms(i){if(i==null)throw new Error("ContentUnion is required");return TM(i)?i:{role:"user",parts:R3(i)}}function eT(i,e){if(!e)return[];if(i.isVertexAI()&&Array.isArray(e))return e.flatMap(t=>{const n=ms(t);return n.parts&&n.parts.length>0&&n.parts[0].text!==void 0?[n.parts[0].text]:[]});if(i.isVertexAI()){const t=ms(e);return t.parts&&t.parts.length>0&&t.parts[0].text!==void 0?[t.parts[0].text]:[]}return Array.isArray(e)?e.map(t=>ms(t)):[ms(e)]}function ia(i){if(i==null||Array.isArray(i)&&i.length===0)throw new Error("contents are required");if(!Array.isArray(i)){if(yC(i)||_C(i))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[ms(i)]}const e=[],t=[],n=TM(i[0]);for(const r of i){const s=TM(r);if(s!=n)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(s)e.push(r);else{if(yC(r)||_C(r))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");t.push(r)}}return n||e.push({role:"user",parts:R3(t)}),e}function YH(i,e){i.includes("null")&&(e.nullable=!0);const t=i.filter(n=>n!=="null");if(t.length===1)e.type=Object.values(Sc).includes(t[0].toUpperCase())?t[0].toUpperCase():Sc.TYPE_UNSPECIFIED;else{e.anyOf=[];for(const n of t)e.anyOf.push({type:Object.values(Sc).includes(n.toUpperCase())?n.toUpperCase():Sc.TYPE_UNSPECIFIED})}}function Vh(i){const e={},t=["items"],n=["anyOf"],r=["properties"];if(i.type&&i.anyOf)throw new Error("type and anyOf cannot be both populated.");const s=i.anyOf;s!=null&&s.length==2&&(s[0].type==="null"?(e.nullable=!0,i=s[1]):s[1].type==="null"&&(e.nullable=!0,i=s[0])),i.type instanceof Array&&YH(i.type,e);for(const[a,c]of Object.entries(i))if(c!=null)if(a=="type"){if(c==="null")throw new Error("type: null can not be the only possible type for the field.");if(c instanceof Array)continue;e.type=Object.values(Sc).includes(c.toUpperCase())?c.toUpperCase():Sc.TYPE_UNSPECIFIED}else if(t.includes(a))e[a]=Vh(c);else if(n.includes(a)){const d=[];for(const p of c){if(p.type=="null"){e.nullable=!0;continue}d.push(Vh(p))}e[a]=d}else if(r.includes(a)){const d={};for(const[p,m]of Object.entries(c))d[p]=Vh(m);e[a]=d}else{if(a==="additionalProperties")continue;e[a]=c}return e}function tT(i){return Vh(i)}function nT(i){if(typeof i=="object")return i;if(typeof i=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:i}}};throw new Error(`Unsupported speechConfig type: ${typeof i}`)}function iT(i){if("multiSpeakerVoiceConfig"in i)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return i}function ap(i){if(i.functionDeclarations)for(const e of i.functionDeclarations)e.parameters&&(Object.keys(e.parameters).includes("$schema")?e.parametersJsonSchema||(e.parametersJsonSchema=e.parameters,delete e.parameters):e.parameters=Vh(e.parameters)),e.response&&(Object.keys(e.response).includes("$schema")?e.responseJsonSchema||(e.responseJsonSchema=e.response,delete e.response):e.response=Vh(e.response));return i}function lp(i){if(i==null)throw new Error("tools is required");if(!Array.isArray(i))throw new Error("tools is required and must be an array of Tools");const e=[];for(const t of i)e.push(t);return e}function JH(i,e,t,n=1){const r=!e.startsWith(`${t}/`)&&e.split("/").length===n;return i.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${i.getProject()}/${e}`:e.startsWith(`${t}/`)?`projects/${i.getProject()}/locations/${i.getLocation()}/${e}`:r?`projects/${i.getProject()}/locations/${i.getLocation()}/${t}/${e}`:e:r?`${t}/${e}`:e}function yu(i,e){if(typeof e!="string")throw new Error("name must be a string");return JH(i,e,"cachedContents")}function I3(i){switch(i){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return i}}function Rc(i){return KE(i)}function ZH(i){return i!=null&&typeof i=="object"&&"name"in i}function $H(i){return i!=null&&typeof i=="object"&&"video"in i}function KH(i){return i!=null&&typeof i=="object"&&"uri"in i}function N3(i){var e;let t;if(ZH(i)&&(t=i.name),!(KH(i)&&(t=i.uri,t===void 0))&&!($H(i)&&(t=(e=i.video)===null||e===void 0?void 0:e.uri,t===void 0))){if(typeof i=="string"&&(t=i),t===void 0)throw new Error("Could not extract file name from the provided input.");if(t.startsWith("https://")){const r=t.split("files/")[1].match(/[a-z0-9]+/);if(r===null)throw new Error(`Could not extract file name from URI ${t}`);t=r[0]}else t.startsWith("files/")&&(t=t.split("files/")[1]);return t}}function D3(i,e){let t;return i.isVertexAI()?t=e?"publishers/google/models":"models":t=e?"models":"tunedModels",t}function U3(i){for(const e of["models","tunedModels","publisherModels"])if(QH(i,e))return i[e];return[]}function QH(i,e){return i!==null&&typeof i=="object"&&e in i}function jH(i,e={}){const t=i,n={name:t.name,description:t.description,parametersJsonSchema:t.inputSchema};return t.outputSchema&&(n.responseJsonSchema=t.outputSchema),e.behavior&&(n.behavior=e.behavior),{functionDeclarations:[n]}}function eG(i,e={}){const t=[],n=new Set;for(const r of i){const s=r.name;if(n.has(s))throw new Error(`Duplicate function name ${s} found in MCP tools. Please ensure function names are unique.`);n.add(s);const a=jH(r,e);a.functionDeclarations&&t.push(...a.functionDeclarations)}return{functionDeclarations:t}}function P3(i,e){let t;if(typeof e=="string")if(i.isVertexAI())if(e.startsWith("gs://"))t={format:"jsonl",gcsUri:[e]};else if(e.startsWith("bq://"))t={format:"bigquery",bigqueryUri:e};else throw new Error(`Unsupported string source for Vertex AI: ${e}`);else if(e.startsWith("files/"))t={fileName:e};else throw new Error(`Unsupported string source for Gemini API: ${e}`);else if(Array.isArray(e)){if(i.isVertexAI())throw new Error("InlinedRequest[] is not supported in Vertex AI.");t={inlinedRequests:e}}else t=e;const n=[t.gcsUri,t.bigqueryUri].filter(Boolean).length,r=[t.inlinedRequests,t.fileName].filter(Boolean).length;if(i.isVertexAI()){if(r>0||n!==1)throw new Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(n>0||r!==1)throw new Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return t}function tG(i){if(typeof i!="string")return i;const e=i;if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:e};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};throw new Error(`Unsupported destination: ${e}`)}function L3(i){if(typeof i!="object"||i===null)return{};const e=i,t=e.inlinedResponses;if(typeof t!="object"||t===null)return i;const r=t.inlinedResponses;if(!Array.isArray(r)||r.length===0)return i;let s=!1;for(const a of r){if(typeof a!="object"||a===null)continue;const d=a.response;if(typeof d!="object"||d===null)continue;if(d.embedding!==void 0){s=!0;break}}return s&&(e.inlinedEmbedContentResponses=e.inlinedResponses,delete e.inlinedResponses),i}function up(i,e){const t=e;if(!i.isVertexAI()){if(/batches\/[^/]+$/.test(t))return t.split("/").pop();throw new Error(`Invalid batch job name: ${t}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(t))return t.split("/").pop();if(/^\d+$/.test(t))return t;throw new Error(`Invalid batch job name: ${t}.`)}function F3(i){const e=i;return e==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":e==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":e==="BATCH_STATE_RUNNING"?"JOB_STATE_RUNNING":e==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":e==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":e==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":e==="BATCH_STATE_EXPIRED"?"JOB_STATE_EXPIRED":e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function nG(i){const e={},t=x(i,["responsesFile"]);t!=null&&S(e,["fileName"],t);const n=x(i,["inlinedResponses","inlinedResponses"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(a=>FG(a))),S(e,["inlinedResponses"],s)}const r=x(i,["inlinedEmbedContentResponses","inlinedResponses"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(a=>a)),S(e,["inlinedEmbedContentResponses"],s)}return e}function iG(i){const e={},t=x(i,["predictionsFormat"]);t!=null&&S(e,["format"],t);const n=x(i,["gcsDestination","outputUriPrefix"]);n!=null&&S(e,["gcsUri"],n);const r=x(i,["bigqueryDestination","outputUri"]);return r!=null&&S(e,["bigqueryUri"],r),e}function rG(i){const e={},t=x(i,["format"]);t!=null&&S(e,["predictionsFormat"],t);const n=x(i,["gcsUri"]);n!=null&&S(e,["gcsDestination","outputUriPrefix"],n);const r=x(i,["bigqueryUri"]);if(r!=null&&S(e,["bigqueryDestination","outputUri"],r),x(i,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(x(i,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");if(x(i,["inlinedEmbedContentResponses"])!==void 0)throw new Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return e}function Yy(i){const e={},t=x(i,["name"]);t!=null&&S(e,["name"],t);const n=x(i,["metadata","displayName"]);n!=null&&S(e,["displayName"],n);const r=x(i,["metadata","state"]);r!=null&&S(e,["state"],F3(r));const s=x(i,["metadata","createTime"]);s!=null&&S(e,["createTime"],s);const a=x(i,["metadata","endTime"]);a!=null&&S(e,["endTime"],a);const c=x(i,["metadata","updateTime"]);c!=null&&S(e,["updateTime"],c);const d=x(i,["metadata","model"]);d!=null&&S(e,["model"],d);const p=x(i,["metadata","output"]);return p!=null&&S(e,["dest"],nG(L3(p))),e}function AM(i){const e={},t=x(i,["name"]);t!=null&&S(e,["name"],t);const n=x(i,["displayName"]);n!=null&&S(e,["displayName"],n);const r=x(i,["state"]);r!=null&&S(e,["state"],F3(r));const s=x(i,["error"]);s!=null&&S(e,["error"],s);const a=x(i,["createTime"]);a!=null&&S(e,["createTime"],a);const c=x(i,["startTime"]);c!=null&&S(e,["startTime"],c);const d=x(i,["endTime"]);d!=null&&S(e,["endTime"],d);const p=x(i,["updateTime"]);p!=null&&S(e,["updateTime"],p);const m=x(i,["model"]);m!=null&&S(e,["model"],m);const v=x(i,["inputConfig"]);v!=null&&S(e,["src"],sG(v));const _=x(i,["outputConfig"]);_!=null&&S(e,["dest"],iG(L3(_)));const b=x(i,["completionStats"]);return b!=null&&S(e,["completionStats"],b),e}function sG(i){const e={},t=x(i,["instancesFormat"]);t!=null&&S(e,["format"],t);const n=x(i,["gcsSource","uris"]);n!=null&&S(e,["gcsUri"],n);const r=x(i,["bigquerySource","inputUri"]);return r!=null&&S(e,["bigqueryUri"],r),e}function oG(i,e){const t={};if(x(e,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(x(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(x(e,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const n=x(e,["fileName"]);n!=null&&S(t,["fileName"],n);const r=x(e,["inlinedRequests"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(a=>LG(i,a))),S(t,["requests","requests"],s)}return t}function aG(i){const e={},t=x(i,["format"]);t!=null&&S(e,["instancesFormat"],t);const n=x(i,["gcsUri"]);n!=null&&S(e,["gcsSource","uris"],n);const r=x(i,["bigqueryUri"]);if(r!=null&&S(e,["bigquerySource","inputUri"],r),x(i,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(x(i,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return e}function lG(i){const e={},t=x(i,["data"]);if(t!=null&&S(e,["data"],t),x(i,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=x(i,["mimeType"]);return n!=null&&S(e,["mimeType"],n),e}function uG(i,e){const t={},n=x(e,["name"]);return n!=null&&S(t,["_url","name"],up(i,n)),t}function cG(i,e){const t={},n=x(e,["name"]);return n!=null&&S(t,["_url","name"],up(i,n)),t}function fG(i){const e={},t=x(i,["content"]);t!=null&&S(e,["content"],t);const n=x(i,["citationMetadata"]);n!=null&&S(e,["citationMetadata"],dG(n));const r=x(i,["tokenCount"]);r!=null&&S(e,["tokenCount"],r);const s=x(i,["finishReason"]);s!=null&&S(e,["finishReason"],s);const a=x(i,["avgLogprobs"]);a!=null&&S(e,["avgLogprobs"],a);const c=x(i,["groundingMetadata"]);c!=null&&S(e,["groundingMetadata"],c);const d=x(i,["index"]);d!=null&&S(e,["index"],d);const p=x(i,["logprobsResult"]);p!=null&&S(e,["logprobsResult"],p);const m=x(i,["safetyRatings"]);if(m!=null){let _=m;Array.isArray(_)&&(_=_.map(b=>b)),S(e,["safetyRatings"],_)}const v=x(i,["urlContextMetadata"]);return v!=null&&S(e,["urlContextMetadata"],v),e}function dG(i){const e={},t=x(i,["citationSources"]);if(t!=null){let n=t;Array.isArray(n)&&(n=n.map(r=>r)),S(e,["citations"],n)}return e}function k3(i){const e={},t=x(i,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(s=>GG(s))),S(e,["parts"],r)}const n=x(i,["role"]);return n!=null&&S(e,["role"],n),e}function hG(i,e){const t={},n=x(i,["displayName"]);if(e!==void 0&&n!=null&&S(e,["batch","displayName"],n),x(i,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return t}function pG(i,e){const t={},n=x(i,["displayName"]);e!==void 0&&n!=null&&S(e,["displayName"],n);const r=x(i,["dest"]);return e!==void 0&&r!=null&&S(e,["outputConfig"],rG(tG(r))),t}function xC(i,e){const t={},n=x(e,["model"]);n!=null&&S(t,["_url","model"],ei(i,n));const r=x(e,["src"]);r!=null&&S(t,["batch","inputConfig"],oG(i,P3(i,r)));const s=x(e,["config"]);return s!=null&&hG(s,t),t}function mG(i,e){const t={},n=x(e,["model"]);n!=null&&S(t,["model"],ei(i,n));const r=x(e,["src"]);r!=null&&S(t,["inputConfig"],aG(P3(i,r)));const s=x(e,["config"]);return s!=null&&pG(s,t),t}function gG(i,e){const t={},n=x(i,["displayName"]);return e!==void 0&&n!=null&&S(e,["batch","displayName"],n),t}function vG(i,e){const t={},n=x(e,["model"]);n!=null&&S(t,["_url","model"],ei(i,n));const r=x(e,["src"]);r!=null&&S(t,["batch","inputConfig"],EG(i,r));const s=x(e,["config"]);return s!=null&&gG(s,t),t}function yG(i,e){const t={},n=x(e,["name"]);return n!=null&&S(t,["_url","name"],up(i,n)),t}function _G(i,e){const t={},n=x(e,["name"]);return n!=null&&S(t,["_url","name"],up(i,n)),t}function xG(i){const e={},t=x(i,["sdkHttpResponse"]);t!=null&&S(e,["sdkHttpResponse"],t);const n=x(i,["name"]);n!=null&&S(e,["name"],n);const r=x(i,["done"]);r!=null&&S(e,["done"],r);const s=x(i,["error"]);return s!=null&&S(e,["error"],s),e}function SG(i){const e={},t=x(i,["sdkHttpResponse"]);t!=null&&S(e,["sdkHttpResponse"],t);const n=x(i,["name"]);n!=null&&S(e,["name"],n);const r=x(i,["done"]);r!=null&&S(e,["done"],r);const s=x(i,["error"]);return s!=null&&S(e,["error"],s),e}function bG(i,e){const t={},n=x(e,["contents"]);if(n!=null){let s=eT(i,n);Array.isArray(s)&&(s=s.map(a=>a)),S(t,["requests[]","request","content"],s)}const r=x(e,["config"]);return r!=null&&(S(t,["_self"],MG(r,t)),_H(t,{"requests[].*":"requests[].request.*"})),t}function MG(i,e){const t={},n=x(i,["taskType"]);e!==void 0&&n!=null&&S(e,["requests[]","taskType"],n);const r=x(i,["title"]);e!==void 0&&r!=null&&S(e,["requests[]","title"],r);const s=x(i,["outputDimensionality"]);if(e!==void 0&&s!=null&&S(e,["requests[]","outputDimensionality"],s),x(i,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(x(i,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return t}function EG(i,e){const t={},n=x(e,["fileName"]);n!=null&&S(t,["file_name"],n);const r=x(e,["inlinedRequests"]);return r!=null&&S(t,["requests"],bG(i,r)),t}function TG(i){const e={};if(x(i,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=x(i,["fileUri"]);t!=null&&S(e,["fileUri"],t);const n=x(i,["mimeType"]);return n!=null&&S(e,["mimeType"],n),e}function AG(i){const e={},t=x(i,["id"]);t!=null&&S(e,["id"],t);const n=x(i,["args"]);n!=null&&S(e,["args"],n);const r=x(i,["name"]);if(r!=null&&S(e,["name"],r),x(i,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(x(i,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function wG(i){const e={},t=x(i,["allowedFunctionNames"]);t!=null&&S(e,["allowedFunctionNames"],t);const n=x(i,["mode"]);if(n!=null&&S(e,["mode"],n),x(i,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function CG(i,e,t){const n={},r=x(e,["systemInstruction"]);t!==void 0&&r!=null&&S(t,["systemInstruction"],k3(ms(r)));const s=x(e,["temperature"]);s!=null&&S(n,["temperature"],s);const a=x(e,["topP"]);a!=null&&S(n,["topP"],a);const c=x(e,["topK"]);c!=null&&S(n,["topK"],c);const d=x(e,["candidateCount"]);d!=null&&S(n,["candidateCount"],d);const p=x(e,["maxOutputTokens"]);p!=null&&S(n,["maxOutputTokens"],p);const m=x(e,["stopSequences"]);m!=null&&S(n,["stopSequences"],m);const v=x(e,["responseLogprobs"]);v!=null&&S(n,["responseLogprobs"],v);const _=x(e,["logprobs"]);_!=null&&S(n,["logprobs"],_);const b=x(e,["presencePenalty"]);b!=null&&S(n,["presencePenalty"],b);const T=x(e,["frequencyPenalty"]);T!=null&&S(n,["frequencyPenalty"],T);const I=x(e,["seed"]);I!=null&&S(n,["seed"],I);const C=x(e,["responseMimeType"]);C!=null&&S(n,["responseMimeType"],C);const A=x(e,["responseSchema"]);A!=null&&S(n,["responseSchema"],tT(A));const D=x(e,["responseJsonSchema"]);if(D!=null&&S(n,["responseJsonSchema"],D),x(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(x(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const U=x(e,["safetySettings"]);if(t!==void 0&&U!=null){let ee=U;Array.isArray(ee)&&(ee=ee.map(re=>qG(re))),S(t,["safetySettings"],ee)}const L=x(e,["tools"]);if(t!==void 0&&L!=null){let ee=lp(L);Array.isArray(ee)&&(ee=ee.map(re=>XG(ap(re)))),S(t,["tools"],ee)}const z=x(e,["toolConfig"]);if(t!==void 0&&z!=null&&S(t,["toolConfig"],WG(z)),x(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const B=x(e,["cachedContent"]);t!==void 0&&B!=null&&S(t,["cachedContent"],yu(i,B));const k=x(e,["responseModalities"]);k!=null&&S(n,["responseModalities"],k);const G=x(e,["mediaResolution"]);G!=null&&S(n,["mediaResolution"],G);const P=x(e,["speechConfig"]);if(P!=null&&S(n,["speechConfig"],nT(P)),x(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const O=x(e,["thinkingConfig"]);O!=null&&S(n,["thinkingConfig"],O);const Z=x(e,["imageConfig"]);Z!=null&&S(n,["imageConfig"],PG(Z));const ie=x(e,["enableEnhancedCivicAnswers"]);return ie!=null&&S(n,["enableEnhancedCivicAnswers"],ie),n}function RG(i){const e={},t=x(i,["sdkHttpResponse"]);t!=null&&S(e,["sdkHttpResponse"],t);const n=x(i,["candidates"]);if(n!=null){let d=n;Array.isArray(d)&&(d=d.map(p=>fG(p))),S(e,["candidates"],d)}const r=x(i,["modelVersion"]);r!=null&&S(e,["modelVersion"],r);const s=x(i,["promptFeedback"]);s!=null&&S(e,["promptFeedback"],s);const a=x(i,["responseId"]);a!=null&&S(e,["responseId"],a);const c=x(i,["usageMetadata"]);return c!=null&&S(e,["usageMetadata"],c),e}function IG(i,e){const t={},n=x(e,["name"]);return n!=null&&S(t,["_url","name"],up(i,n)),t}function NG(i,e){const t={},n=x(e,["name"]);return n!=null&&S(t,["_url","name"],up(i,n)),t}function DG(i){const e={};if(x(i,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=x(i,["enableWidget"]);return t!=null&&S(e,["enableWidget"],t),e}function UG(i){const e={};if(x(i,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(x(i,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=x(i,["timeRangeFilter"]);return t!=null&&S(e,["timeRangeFilter"],t),e}function PG(i){const e={},t=x(i,["aspectRatio"]);t!=null&&S(e,["aspectRatio"],t);const n=x(i,["imageSize"]);if(n!=null&&S(e,["imageSize"],n),x(i,["personGeneration"])!==void 0)throw new Error("personGeneration parameter is not supported in Gemini API.");if(x(i,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(x(i,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return e}function LG(i,e){const t={},n=x(e,["model"]);n!=null&&S(t,["request","model"],ei(i,n));const r=x(e,["contents"]);if(r!=null){let c=ia(r);Array.isArray(c)&&(c=c.map(d=>k3(d))),S(t,["request","contents"],c)}const s=x(e,["metadata"]);s!=null&&S(t,["metadata"],s);const a=x(e,["config"]);return a!=null&&S(t,["request","generationConfig"],CG(i,a,x(t,["request"],{}))),t}function FG(i){const e={},t=x(i,["response"]);t!=null&&S(e,["response"],RG(t));const n=x(i,["error"]);return n!=null&&S(e,["error"],n),e}function kG(i,e){const t={},n=x(i,["pageSize"]);e!==void 0&&n!=null&&S(e,["_query","pageSize"],n);const r=x(i,["pageToken"]);if(e!==void 0&&r!=null&&S(e,["_query","pageToken"],r),x(i,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return t}function OG(i,e){const t={},n=x(i,["pageSize"]);e!==void 0&&n!=null&&S(e,["_query","pageSize"],n);const r=x(i,["pageToken"]);e!==void 0&&r!=null&&S(e,["_query","pageToken"],r);const s=x(i,["filter"]);return e!==void 0&&s!=null&&S(e,["_query","filter"],s),t}function zG(i){const e={},t=x(i,["config"]);return t!=null&&kG(t,e),e}function BG(i){const e={},t=x(i,["config"]);return t!=null&&OG(t,e),e}function VG(i){const e={},t=x(i,["sdkHttpResponse"]);t!=null&&S(e,["sdkHttpResponse"],t);const n=x(i,["nextPageToken"]);n!=null&&S(e,["nextPageToken"],n);const r=x(i,["operations"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(a=>Yy(a))),S(e,["batchJobs"],s)}return e}function HG(i){const e={},t=x(i,["sdkHttpResponse"]);t!=null&&S(e,["sdkHttpResponse"],t);const n=x(i,["nextPageToken"]);n!=null&&S(e,["nextPageToken"],n);const r=x(i,["batchPredictionJobs"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(a=>AM(a))),S(e,["batchJobs"],s)}return e}function GG(i){const e={},t=x(i,["mediaResolution"]);t!=null&&S(e,["mediaResolution"],t);const n=x(i,["codeExecutionResult"]);n!=null&&S(e,["codeExecutionResult"],n);const r=x(i,["executableCode"]);r!=null&&S(e,["executableCode"],r);const s=x(i,["fileData"]);s!=null&&S(e,["fileData"],TG(s));const a=x(i,["functionCall"]);a!=null&&S(e,["functionCall"],AG(a));const c=x(i,["functionResponse"]);c!=null&&S(e,["functionResponse"],c);const d=x(i,["inlineData"]);d!=null&&S(e,["inlineData"],lG(d));const p=x(i,["text"]);p!=null&&S(e,["text"],p);const m=x(i,["thought"]);m!=null&&S(e,["thought"],m);const v=x(i,["thoughtSignature"]);v!=null&&S(e,["thoughtSignature"],v);const _=x(i,["videoMetadata"]);return _!=null&&S(e,["videoMetadata"],_),e}function qG(i){const e={},t=x(i,["category"]);if(t!=null&&S(e,["category"],t),x(i,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const n=x(i,["threshold"]);return n!=null&&S(e,["threshold"],n),e}function WG(i){const e={},t=x(i,["retrievalConfig"]);t!=null&&S(e,["retrievalConfig"],t);const n=x(i,["functionCallingConfig"]);return n!=null&&S(e,["functionCallingConfig"],wG(n)),e}function XG(i){const e={};if(x(i,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const t=x(i,["computerUse"]);t!=null&&S(e,["computerUse"],t);const n=x(i,["fileSearch"]);n!=null&&S(e,["fileSearch"],n);const r=x(i,["codeExecution"]);if(r!=null&&S(e,["codeExecution"],r),x(i,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const s=x(i,["functionDeclarations"]);if(s!=null){let m=s;Array.isArray(m)&&(m=m.map(v=>v)),S(e,["functionDeclarations"],m)}const a=x(i,["googleMaps"]);a!=null&&S(e,["googleMaps"],DG(a));const c=x(i,["googleSearch"]);c!=null&&S(e,["googleSearch"],UG(c));const d=x(i,["googleSearchRetrieval"]);d!=null&&S(e,["googleSearchRetrieval"],d);const p=x(i,["urlContext"]);return p!=null&&S(e,["urlContext"],p),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var pu;(function(i){i.PAGED_ITEM_BATCH_JOBS="batchJobs",i.PAGED_ITEM_MODELS="models",i.PAGED_ITEM_TUNING_JOBS="tuningJobs",i.PAGED_ITEM_FILES="files",i.PAGED_ITEM_CACHED_CONTENTS="cachedContents",i.PAGED_ITEM_FILE_SEARCH_STORES="fileSearchStores",i.PAGED_ITEM_DOCUMENTS="documents"})(pu||(pu={}));class td{constructor(e,t,n,r){this.pageInternal=[],this.paramsInternal={},this.requestInternal=t,this.init(e,n,r)}init(e,t,n){var r,s;this.nameInternal=e,this.pageInternal=t[this.nameInternal]||[],this.sdkHttpResponseInternal=t==null?void 0:t.sdkHttpResponse,this.idxInternal=0;let a={config:{}};!n||Object.keys(n).length===0?a={config:{}}:typeof n=="object"?a=Object.assign({},n):a=n,a.config&&(a.config.pageToken=t.nextPageToken),this.paramsInternal=a,this.pageInternalSize=(s=(r=a.config)===null||r===void 0?void 0:r.pageSize)!==null&&s!==void 0?s:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class YG extends vu{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new td(pu.PAGED_ITEM_BATCH_JOBS,n=>this.listInternal(n),await this.listInternal(t),t),this.create=async t=>(this.apiClient.isVertexAI()&&(t.config=this.formatDestination(t.src,t.config)),this.createInternal(t)),this.createEmbeddings=async t=>{if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw new Error("Vertex AI does not support batches.createEmbeddings.");return this.createEmbeddingsInternal(t)}}createInlinedGenerateContentRequest(e){const t=xC(this.apiClient,e),n=t._url,r=Ft("{model}:batchGenerateContent",n),c=t.batch.inputConfig.requests,d=c.requests,p=[];for(const m of d){const v=Object.assign({},m);if(v.systemInstruction){const _=v.systemInstruction;delete v.systemInstruction;const b=v.request;b.systemInstruction=_,v.request=b}p.push(v)}return c.requests=p,delete t.config,delete t._url,delete t._query,{path:r,body:t}}getGcsUri(e){if(typeof e=="string")return e.startsWith("gs://")?e:void 0;if(!Array.isArray(e)&&e.gcsUri&&e.gcsUri.length>0)return e.gcsUri[0]}getBigqueryUri(e){if(typeof e=="string")return e.startsWith("bq://")?e:void 0;if(!Array.isArray(e))return e.bigqueryUri}formatDestination(e,t){const n=t?Object.assign({},t):{},r=Date.now().toString();if(n.displayName||(n.displayName=`genaiBatchJob_${r}`),n.dest===void 0){const s=this.getGcsUri(e),a=this.getBigqueryUri(e);if(s)s.endsWith(".jsonl")?n.dest=`${s.slice(0,-6)}/dest`:n.dest=`${s}_dest_${r}`;else if(a)n.dest=`${a}_dest_${r}`;else throw new Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return n}async createInternal(e){var t,n,r,s;let a,c="",d={};if(this.apiClient.isVertexAI()){const p=mG(this.apiClient,e);return c=Ft("batchPredictionJobs",p._url),d=p._query,delete p._url,delete p._query,a=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(m=>m.json()),a.then(m=>AM(m))}else{const p=xC(this.apiClient,e);return c=Ft("{model}:batchGenerateContent",p._url),d=p._query,delete p._url,delete p._query,a=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json()),a.then(m=>Yy(m))}}async createEmbeddingsInternal(e){var t,n;let r,s="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=vG(this.apiClient,e);return s=Ft("{model}:asyncBatchEmbedContent",c._url),a=c._query,delete c._url,delete c._query,r=this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),r.then(d=>Yy(d))}}async get(e){var t,n,r,s;let a,c="",d={};if(this.apiClient.isVertexAI()){const p=NG(this.apiClient,e);return c=Ft("batchPredictionJobs/{name}",p._url),d=p._query,delete p._url,delete p._query,a=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(m=>m.json()),a.then(m=>AM(m))}else{const p=IG(this.apiClient,e);return c=Ft("batches/{name}",p._url),d=p._query,delete p._url,delete p._query,a=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json()),a.then(m=>Yy(m))}}async cancel(e){var t,n,r,s;let a="",c={};if(this.apiClient.isVertexAI()){const d=cG(this.apiClient,e);a=Ft("batchPredictionJobs/{name}:cancel",d._url),c=d._query,delete d._url,delete d._query,await this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal})}else{const d=uG(this.apiClient,e);a=Ft("batches/{name}:cancel",d._url),c=d._query,delete d._url,delete d._query,await this.apiClient.request({path:a,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal})}}async listInternal(e){var t,n,r,s;let a,c="",d={};if(this.apiClient.isVertexAI()){const p=BG(e);return c=Ft("batchPredictionJobs",p._url),d=p._query,delete p._url,delete p._query,a=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(m=>m.json().then(v=>{const _=v;return _.sdkHttpResponse={headers:m.headers},_})),a.then(m=>{const v=HG(m),_=new gC;return Object.assign(_,v),_})}else{const p=zG(e);return c=Ft("batches",p._url),d=p._query,delete p._url,delete p._query,a=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json().then(v=>{const _=v;return _.sdkHttpResponse={headers:m.headers},_})),a.then(m=>{const v=VG(m),_=new gC;return Object.assign(_,v),_})}}async delete(e){var t,n,r,s;let a,c="",d={};if(this.apiClient.isVertexAI()){const p=_G(this.apiClient,e);return c=Ft("batchPredictionJobs/{name}",p._url),d=p._query,delete p._url,delete p._query,a=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(m=>m.json().then(v=>{const _=v;return _.sdkHttpResponse={headers:m.headers},_})),a.then(m=>SG(m))}else{const p=yG(this.apiClient,e);return c=Ft("batches/{name}",p._url),d=p._query,delete p._url,delete p._query,a=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json().then(v=>{const _=v;return _.sdkHttpResponse={headers:m.headers},_})),a.then(m=>xG(m))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function JG(i){const e={},t=x(i,["data"]);if(t!=null&&S(e,["data"],t),x(i,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=x(i,["mimeType"]);return n!=null&&S(e,["mimeType"],n),e}function SC(i){const e={},t=x(i,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(s=>v6(s))),S(e,["parts"],r)}const n=x(i,["role"]);return n!=null&&S(e,["role"],n),e}function ZG(i,e){const t={},n=x(i,["ttl"]);e!==void 0&&n!=null&&S(e,["ttl"],n);const r=x(i,["expireTime"]);e!==void 0&&r!=null&&S(e,["expireTime"],r);const s=x(i,["displayName"]);e!==void 0&&s!=null&&S(e,["displayName"],s);const a=x(i,["contents"]);if(e!==void 0&&a!=null){let m=ia(a);Array.isArray(m)&&(m=m.map(v=>SC(v))),S(e,["contents"],m)}const c=x(i,["systemInstruction"]);e!==void 0&&c!=null&&S(e,["systemInstruction"],SC(ms(c)));const d=x(i,["tools"]);if(e!==void 0&&d!=null){let m=d;Array.isArray(m)&&(m=m.map(v=>_6(v))),S(e,["tools"],m)}const p=x(i,["toolConfig"]);if(e!==void 0&&p!=null&&S(e,["toolConfig"],y6(p)),x(i,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return t}function $G(i,e){const t={},n=x(i,["ttl"]);e!==void 0&&n!=null&&S(e,["ttl"],n);const r=x(i,["expireTime"]);e!==void 0&&r!=null&&S(e,["expireTime"],r);const s=x(i,["displayName"]);e!==void 0&&s!=null&&S(e,["displayName"],s);const a=x(i,["contents"]);if(e!==void 0&&a!=null){let v=ia(a);Array.isArray(v)&&(v=v.map(_=>_)),S(e,["contents"],v)}const c=x(i,["systemInstruction"]);e!==void 0&&c!=null&&S(e,["systemInstruction"],ms(c));const d=x(i,["tools"]);if(e!==void 0&&d!=null){let v=d;Array.isArray(v)&&(v=v.map(_=>x6(_))),S(e,["tools"],v)}const p=x(i,["toolConfig"]);e!==void 0&&p!=null&&S(e,["toolConfig"],p);const m=x(i,["kmsKeyName"]);return e!==void 0&&m!=null&&S(e,["encryption_spec","kmsKeyName"],m),t}function KG(i,e){const t={},n=x(e,["model"]);n!=null&&S(t,["model"],T3(i,n));const r=x(e,["config"]);return r!=null&&ZG(r,t),t}function QG(i,e){const t={},n=x(e,["model"]);n!=null&&S(t,["model"],T3(i,n));const r=x(e,["config"]);return r!=null&&$G(r,t),t}function jG(i,e){const t={},n=x(e,["name"]);return n!=null&&S(t,["_url","name"],yu(i,n)),t}function e6(i,e){const t={},n=x(e,["name"]);return n!=null&&S(t,["_url","name"],yu(i,n)),t}function t6(i){const e={},t=x(i,["sdkHttpResponse"]);return t!=null&&S(e,["sdkHttpResponse"],t),e}function n6(i){const e={},t=x(i,["sdkHttpResponse"]);return t!=null&&S(e,["sdkHttpResponse"],t),e}function i6(i){const e={};if(x(i,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=x(i,["fileUri"]);t!=null&&S(e,["fileUri"],t);const n=x(i,["mimeType"]);return n!=null&&S(e,["mimeType"],n),e}function r6(i){const e={},t=x(i,["id"]);t!=null&&S(e,["id"],t);const n=x(i,["args"]);n!=null&&S(e,["args"],n);const r=x(i,["name"]);if(r!=null&&S(e,["name"],r),x(i,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(x(i,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function s6(i){const e={},t=x(i,["allowedFunctionNames"]);t!=null&&S(e,["allowedFunctionNames"],t);const n=x(i,["mode"]);if(n!=null&&S(e,["mode"],n),x(i,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function o6(i){const e={},t=x(i,["description"]);t!=null&&S(e,["description"],t);const n=x(i,["name"]);n!=null&&S(e,["name"],n);const r=x(i,["parameters"]);r!=null&&S(e,["parameters"],r);const s=x(i,["parametersJsonSchema"]);s!=null&&S(e,["parametersJsonSchema"],s);const a=x(i,["response"]);a!=null&&S(e,["response"],a);const c=x(i,["responseJsonSchema"]);if(c!=null&&S(e,["responseJsonSchema"],c),x(i,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");return e}function a6(i,e){const t={},n=x(e,["name"]);return n!=null&&S(t,["_url","name"],yu(i,n)),t}function l6(i,e){const t={},n=x(e,["name"]);return n!=null&&S(t,["_url","name"],yu(i,n)),t}function u6(i){const e={};if(x(i,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=x(i,["enableWidget"]);return t!=null&&S(e,["enableWidget"],t),e}function c6(i){const e={};if(x(i,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(x(i,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=x(i,["timeRangeFilter"]);return t!=null&&S(e,["timeRangeFilter"],t),e}function f6(i,e){const t={},n=x(i,["pageSize"]);e!==void 0&&n!=null&&S(e,["_query","pageSize"],n);const r=x(i,["pageToken"]);return e!==void 0&&r!=null&&S(e,["_query","pageToken"],r),t}function d6(i,e){const t={},n=x(i,["pageSize"]);e!==void 0&&n!=null&&S(e,["_query","pageSize"],n);const r=x(i,["pageToken"]);return e!==void 0&&r!=null&&S(e,["_query","pageToken"],r),t}function h6(i){const e={},t=x(i,["config"]);return t!=null&&f6(t,e),e}function p6(i){const e={},t=x(i,["config"]);return t!=null&&d6(t,e),e}function m6(i){const e={},t=x(i,["sdkHttpResponse"]);t!=null&&S(e,["sdkHttpResponse"],t);const n=x(i,["nextPageToken"]);n!=null&&S(e,["nextPageToken"],n);const r=x(i,["cachedContents"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(a=>a)),S(e,["cachedContents"],s)}return e}function g6(i){const e={},t=x(i,["sdkHttpResponse"]);t!=null&&S(e,["sdkHttpResponse"],t);const n=x(i,["nextPageToken"]);n!=null&&S(e,["nextPageToken"],n);const r=x(i,["cachedContents"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(a=>a)),S(e,["cachedContents"],s)}return e}function v6(i){const e={},t=x(i,["mediaResolution"]);t!=null&&S(e,["mediaResolution"],t);const n=x(i,["codeExecutionResult"]);n!=null&&S(e,["codeExecutionResult"],n);const r=x(i,["executableCode"]);r!=null&&S(e,["executableCode"],r);const s=x(i,["fileData"]);s!=null&&S(e,["fileData"],i6(s));const a=x(i,["functionCall"]);a!=null&&S(e,["functionCall"],r6(a));const c=x(i,["functionResponse"]);c!=null&&S(e,["functionResponse"],c);const d=x(i,["inlineData"]);d!=null&&S(e,["inlineData"],JG(d));const p=x(i,["text"]);p!=null&&S(e,["text"],p);const m=x(i,["thought"]);m!=null&&S(e,["thought"],m);const v=x(i,["thoughtSignature"]);v!=null&&S(e,["thoughtSignature"],v);const _=x(i,["videoMetadata"]);return _!=null&&S(e,["videoMetadata"],_),e}function y6(i){const e={},t=x(i,["retrievalConfig"]);t!=null&&S(e,["retrievalConfig"],t);const n=x(i,["functionCallingConfig"]);return n!=null&&S(e,["functionCallingConfig"],s6(n)),e}function _6(i){const e={};if(x(i,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const t=x(i,["computerUse"]);t!=null&&S(e,["computerUse"],t);const n=x(i,["fileSearch"]);n!=null&&S(e,["fileSearch"],n);const r=x(i,["codeExecution"]);if(r!=null&&S(e,["codeExecution"],r),x(i,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const s=x(i,["functionDeclarations"]);if(s!=null){let m=s;Array.isArray(m)&&(m=m.map(v=>v)),S(e,["functionDeclarations"],m)}const a=x(i,["googleMaps"]);a!=null&&S(e,["googleMaps"],u6(a));const c=x(i,["googleSearch"]);c!=null&&S(e,["googleSearch"],c6(c));const d=x(i,["googleSearchRetrieval"]);d!=null&&S(e,["googleSearchRetrieval"],d);const p=x(i,["urlContext"]);return p!=null&&S(e,["urlContext"],p),e}function x6(i){const e={},t=x(i,["retrieval"]);t!=null&&S(e,["retrieval"],t);const n=x(i,["computerUse"]);if(n!=null&&S(e,["computerUse"],n),x(i,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const r=x(i,["codeExecution"]);r!=null&&S(e,["codeExecution"],r);const s=x(i,["enterpriseWebSearch"]);s!=null&&S(e,["enterpriseWebSearch"],s);const a=x(i,["functionDeclarations"]);if(a!=null){let v=a;Array.isArray(v)&&(v=v.map(_=>o6(_))),S(e,["functionDeclarations"],v)}const c=x(i,["googleMaps"]);c!=null&&S(e,["googleMaps"],c);const d=x(i,["googleSearch"]);d!=null&&S(e,["googleSearch"],d);const p=x(i,["googleSearchRetrieval"]);p!=null&&S(e,["googleSearchRetrieval"],p);const m=x(i,["urlContext"]);return m!=null&&S(e,["urlContext"],m),e}function S6(i,e){const t={},n=x(i,["ttl"]);e!==void 0&&n!=null&&S(e,["ttl"],n);const r=x(i,["expireTime"]);return e!==void 0&&r!=null&&S(e,["expireTime"],r),t}function b6(i,e){const t={},n=x(i,["ttl"]);e!==void 0&&n!=null&&S(e,["ttl"],n);const r=x(i,["expireTime"]);return e!==void 0&&r!=null&&S(e,["expireTime"],r),t}function M6(i,e){const t={},n=x(e,["name"]);n!=null&&S(t,["_url","name"],yu(i,n));const r=x(e,["config"]);return r!=null&&S6(r,t),t}function E6(i,e){const t={},n=x(e,["name"]);n!=null&&S(t,["_url","name"],yu(i,n));const r=x(e,["config"]);return r!=null&&b6(r,t),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class T6 extends vu{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new td(pu.PAGED_ITEM_CACHED_CONTENTS,n=>this.listInternal(n),await this.listInternal(t),t)}async create(e){var t,n,r,s;let a,c="",d={};if(this.apiClient.isVertexAI()){const p=QG(this.apiClient,e);return c=Ft("cachedContents",p._url),d=p._query,delete p._url,delete p._query,a=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(m=>m.json()),a.then(m=>m)}else{const p=KG(this.apiClient,e);return c=Ft("cachedContents",p._url),d=p._query,delete p._url,delete p._query,a=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json()),a.then(m=>m)}}async get(e){var t,n,r,s;let a,c="",d={};if(this.apiClient.isVertexAI()){const p=l6(this.apiClient,e);return c=Ft("{name}",p._url),d=p._query,delete p._url,delete p._query,a=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(m=>m.json()),a.then(m=>m)}else{const p=a6(this.apiClient,e);return c=Ft("{name}",p._url),d=p._query,delete p._url,delete p._query,a=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json()),a.then(m=>m)}}async delete(e){var t,n,r,s;let a,c="",d={};if(this.apiClient.isVertexAI()){const p=e6(this.apiClient,e);return c=Ft("{name}",p._url),d=p._query,delete p._url,delete p._query,a=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(m=>m.json().then(v=>{const _=v;return _.sdkHttpResponse={headers:m.headers},_})),a.then(m=>{const v=n6(m),_=new pC;return Object.assign(_,v),_})}else{const p=jG(this.apiClient,e);return c=Ft("{name}",p._url),d=p._query,delete p._url,delete p._query,a=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json().then(v=>{const _=v;return _.sdkHttpResponse={headers:m.headers},_})),a.then(m=>{const v=t6(m),_=new pC;return Object.assign(_,v),_})}}async update(e){var t,n,r,s;let a,c="",d={};if(this.apiClient.isVertexAI()){const p=E6(this.apiClient,e);return c=Ft("{name}",p._url),d=p._query,delete p._url,delete p._query,a=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(p),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(m=>m.json()),a.then(m=>m)}else{const p=M6(this.apiClient,e);return c=Ft("{name}",p._url),d=p._query,delete p._url,delete p._query,a=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(p),httpMethod:"PATCH",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json()),a.then(m=>m)}}async listInternal(e){var t,n,r,s;let a,c="",d={};if(this.apiClient.isVertexAI()){const p=p6(e);return c=Ft("cachedContents",p._url),d=p._query,delete p._url,delete p._query,a=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(m=>m.json().then(v=>{const _=v;return _.sdkHttpResponse={headers:m.headers},_})),a.then(m=>{const v=g6(m),_=new mC;return Object.assign(_,v),_})}else{const p=h6(e);return c=Ft("cachedContents",p._url),d=p._query,delete p._url,delete p._query,a=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json().then(v=>{const _=v;return _.sdkHttpResponse={headers:m.headers},_})),a.then(m=>{const v=m6(m),_=new mC;return Object.assign(_,v),_})}}}function j_(i,e){var t={};for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&e.indexOf(n)<0&&(t[n]=i[n]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,n=Object.getOwnPropertySymbols(i);r<n.length;r++)e.indexOf(n[r])<0&&Object.prototype.propertyIsEnumerable.call(i,n[r])&&(t[n[r]]=i[n[r]]);return t}function bC(i){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&i[e],n=0;if(t)return t.call(i);if(i&&typeof i.length=="number")return{next:function(){return i&&n>=i.length&&(i=void 0),{value:i&&i[n++],done:!i}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function hn(i){return this instanceof hn?(this.v=i,this):new hn(i)}function Na(i,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t.apply(i,e||[]),r,s=[];return r=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),c("next"),c("throw"),c("return",a),r[Symbol.asyncIterator]=function(){return this},r;function a(b){return function(T){return Promise.resolve(T).then(b,v)}}function c(b,T){n[b]&&(r[b]=function(I){return new Promise(function(C,A){s.push([b,I,C,A])>1||d(b,I)})},T&&(r[b]=T(r[b])))}function d(b,T){try{p(n[b](T))}catch(I){_(s[0][3],I)}}function p(b){b.value instanceof hn?Promise.resolve(b.value.v).then(m,v):_(s[0][2],b)}function m(b){d("next",b)}function v(b){d("throw",b)}function _(b,T){b(T),s.shift(),s.length&&d(s[0][0],s[0][1])}}function Da(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=i[Symbol.asyncIterator],t;return e?e.call(i):(i=typeof bC=="function"?bC(i):i[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(s){t[s]=i[s]&&function(a){return new Promise(function(c,d){a=i[s](a),r(c,d,a.done,a.value)})}}function r(s,a,c,d){Promise.resolve(d).then(function(p){s({value:p,done:c})},a)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function A6(i){var e;if(i.candidates==null||i.candidates.length===0)return!1;const t=(e=i.candidates[0])===null||e===void 0?void 0:e.content;return t===void 0?!1:O3(t)}function O3(i){if(i.parts===void 0||i.parts.length===0)return!1;for(const e of i.parts)if(e===void 0||Object.keys(e).length===0)return!1;return!0}function w6(i){if(i.length!==0){for(const e of i)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function MC(i){if(i===void 0||i.length===0)return[];const e=[],t=i.length;let n=0;for(;n<t;)if(i[n].role==="user")e.push(i[n]),n++;else{const r=[];let s=!0;for(;n<t&&i[n].role==="model";)r.push(i[n]),s&&!O3(i[n])&&(s=!1),n++;s?e.push(...r):e.pop()}return e}class C6{constructor(e,t){this.modelsModule=e,this.apiClient=t}create(e){return new R6(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class R6{constructor(e,t,n,r={},s=[]){this.apiClient=e,this.modelsModule=t,this.model=n,this.config=r,this.history=s,this.sendPromise=Promise.resolve(),w6(s)}async sendMessage(e){var t;await this.sendPromise;const n=ms(e.message),r=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(n),config:(t=e.config)!==null&&t!==void 0?t:this.config});return this.sendPromise=(async()=>{var s,a,c;const d=await r,p=(a=(s=d.candidates)===null||s===void 0?void 0:s[0])===null||a===void 0?void 0:a.content,m=d.automaticFunctionCallingHistory,v=this.getHistory(!0).length;let _=[];m!=null&&(_=(c=m.slice(v))!==null&&c!==void 0?c:[]);const b=p?[p]:[];this.recordHistory(n,b,_)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),r}async sendMessageStream(e){var t;await this.sendPromise;const n=ms(e.message),r=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(n),config:(t=e.config)!==null&&t!==void 0?t:this.config});this.sendPromise=r.then(()=>{}).catch(()=>{});const s=await r;return this.processStreamResponse(s,n)}getHistory(e=!1){const t=e?MC(this.history):this.history;return structuredClone(t)}processStreamResponse(e,t){return Na(this,arguments,function*(){var r,s,a,c,d,p;const m=[];try{for(var v=!0,_=Da(e),b;b=yield hn(_.next()),r=b.done,!r;v=!0){c=b.value,v=!1;const T=c;if(A6(T)){const I=(p=(d=T.candidates)===null||d===void 0?void 0:d[0])===null||p===void 0?void 0:p.content;I!==void 0&&m.push(I)}yield yield hn(T)}}catch(T){s={error:T}}finally{try{!v&&!r&&(a=_.return)&&(yield hn(a.call(_)))}finally{if(s)throw s.error}}this.recordHistory(t,m)})}recordHistory(e,t,n){let r=[];t.length>0&&t.every(s=>s.role!==void 0)?r=t:r.push({role:"model",parts:[]}),n&&n.length>0?this.history.push(...MC(n)):this.history.push(e),this.history.push(...r)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Wx extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,Wx.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function I6(i){const e={},t=x(i,["file"]);return t!=null&&S(e,["file"],t),e}function N6(i){const e={},t=x(i,["sdkHttpResponse"]);return t!=null&&S(e,["sdkHttpResponse"],t),e}function D6(i){const e={},t=x(i,["name"]);return t!=null&&S(e,["_url","file"],N3(t)),e}function U6(i){const e={},t=x(i,["sdkHttpResponse"]);return t!=null&&S(e,["sdkHttpResponse"],t),e}function P6(i){const e={},t=x(i,["name"]);return t!=null&&S(e,["_url","file"],N3(t)),e}function L6(i,e){const t={},n=x(i,["pageSize"]);e!==void 0&&n!=null&&S(e,["_query","pageSize"],n);const r=x(i,["pageToken"]);return e!==void 0&&r!=null&&S(e,["_query","pageToken"],r),t}function F6(i){const e={},t=x(i,["config"]);return t!=null&&L6(t,e),e}function k6(i){const e={},t=x(i,["sdkHttpResponse"]);t!=null&&S(e,["sdkHttpResponse"],t);const n=x(i,["nextPageToken"]);n!=null&&S(e,["nextPageToken"],n);const r=x(i,["files"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(a=>a)),S(e,["files"],s)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class O6 extends vu{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new td(pu.PAGED_ITEM_FILES,n=>this.listInternal(n),await this.listInternal(t),t)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(t=>t)}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var t,n;let r,s="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=F6(e);return s=Ft("files",c._url),a=c._query,delete c._url,delete c._query,r=this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:d.headers},m})),r.then(d=>{const p=k6(d),m=new HH;return Object.assign(m,p),m})}}async createInternal(e){var t,n;let r,s="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=I6(e);return s=Ft("upload/v1beta/files",c._url),a=c._query,delete c._url,delete c._query,r=this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),r.then(d=>{const p=N6(d),m=new GH;return Object.assign(m,p),m})}}async get(e){var t,n;let r,s="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=P6(e);return s=Ft("files/{file}",c._url),a=c._query,delete c._url,delete c._query,r=this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),r.then(d=>d)}}async delete(e){var t,n;let r,s="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=D6(e);return s=Ft("files/{file}",c._url),a=c._query,delete c._url,delete c._query,r=this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(c),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:d.headers},m})),r.then(d=>{const p=U6(d),m=new qH;return Object.assign(m,p),m})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Jy(i){const e={},t=x(i,["data"]);if(t!=null&&S(e,["data"],t),x(i,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=x(i,["mimeType"]);return n!=null&&S(e,["mimeType"],n),e}function z6(i){const e={},t=x(i,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(s=>t8(s))),S(e,["parts"],r)}const n=x(i,["role"]);return n!=null&&S(e,["role"],n),e}function B6(i){const e={};if(x(i,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=x(i,["fileUri"]);t!=null&&S(e,["fileUri"],t);const n=x(i,["mimeType"]);return n!=null&&S(e,["mimeType"],n),e}function V6(i){const e={},t=x(i,["id"]);t!=null&&S(e,["id"],t);const n=x(i,["args"]);n!=null&&S(e,["args"],n);const r=x(i,["name"]);if(r!=null&&S(e,["name"],r),x(i,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(x(i,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function H6(i){const e={},t=x(i,["description"]);t!=null&&S(e,["description"],t);const n=x(i,["name"]);n!=null&&S(e,["name"],n);const r=x(i,["parameters"]);r!=null&&S(e,["parameters"],r);const s=x(i,["parametersJsonSchema"]);s!=null&&S(e,["parametersJsonSchema"],s);const a=x(i,["response"]);a!=null&&S(e,["response"],a);const c=x(i,["responseJsonSchema"]);if(c!=null&&S(e,["responseJsonSchema"],c),x(i,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");return e}function G6(i){const e={},t=x(i,["modelSelectionConfig"]);t!=null&&S(e,["modelConfig"],t);const n=x(i,["responseJsonSchema"]);n!=null&&S(e,["responseJsonSchema"],n);const r=x(i,["audioTimestamp"]);r!=null&&S(e,["audioTimestamp"],r);const s=x(i,["candidateCount"]);s!=null&&S(e,["candidateCount"],s);const a=x(i,["enableAffectiveDialog"]);a!=null&&S(e,["enableAffectiveDialog"],a);const c=x(i,["frequencyPenalty"]);c!=null&&S(e,["frequencyPenalty"],c);const d=x(i,["logprobs"]);d!=null&&S(e,["logprobs"],d);const p=x(i,["maxOutputTokens"]);p!=null&&S(e,["maxOutputTokens"],p);const m=x(i,["mediaResolution"]);m!=null&&S(e,["mediaResolution"],m);const v=x(i,["presencePenalty"]);v!=null&&S(e,["presencePenalty"],v);const _=x(i,["responseLogprobs"]);_!=null&&S(e,["responseLogprobs"],_);const b=x(i,["responseMimeType"]);b!=null&&S(e,["responseMimeType"],b);const T=x(i,["responseModalities"]);T!=null&&S(e,["responseModalities"],T);const I=x(i,["responseSchema"]);I!=null&&S(e,["responseSchema"],I);const C=x(i,["routingConfig"]);C!=null&&S(e,["routingConfig"],C);const A=x(i,["seed"]);A!=null&&S(e,["seed"],A);const D=x(i,["speechConfig"]);D!=null&&S(e,["speechConfig"],D);const U=x(i,["stopSequences"]);U!=null&&S(e,["stopSequences"],U);const L=x(i,["temperature"]);L!=null&&S(e,["temperature"],L);const z=x(i,["thinkingConfig"]);z!=null&&S(e,["thinkingConfig"],z);const B=x(i,["topK"]);B!=null&&S(e,["topK"],B);const k=x(i,["topP"]);if(k!=null&&S(e,["topP"],k),x(i,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function q6(i){const e={};if(x(i,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=x(i,["enableWidget"]);return t!=null&&S(e,["enableWidget"],t),e}function W6(i){const e={};if(x(i,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(x(i,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=x(i,["timeRangeFilter"]);return t!=null&&S(e,["timeRangeFilter"],t),e}function X6(i,e){const t={},n=x(i,["generationConfig"]);e!==void 0&&n!=null&&S(e,["setup","generationConfig"],n);const r=x(i,["responseModalities"]);e!==void 0&&r!=null&&S(e,["setup","generationConfig","responseModalities"],r);const s=x(i,["temperature"]);e!==void 0&&s!=null&&S(e,["setup","generationConfig","temperature"],s);const a=x(i,["topP"]);e!==void 0&&a!=null&&S(e,["setup","generationConfig","topP"],a);const c=x(i,["topK"]);e!==void 0&&c!=null&&S(e,["setup","generationConfig","topK"],c);const d=x(i,["maxOutputTokens"]);e!==void 0&&d!=null&&S(e,["setup","generationConfig","maxOutputTokens"],d);const p=x(i,["mediaResolution"]);e!==void 0&&p!=null&&S(e,["setup","generationConfig","mediaResolution"],p);const m=x(i,["seed"]);e!==void 0&&m!=null&&S(e,["setup","generationConfig","seed"],m);const v=x(i,["speechConfig"]);e!==void 0&&v!=null&&S(e,["setup","generationConfig","speechConfig"],iT(v));const _=x(i,["thinkingConfig"]);e!==void 0&&_!=null&&S(e,["setup","generationConfig","thinkingConfig"],_);const b=x(i,["enableAffectiveDialog"]);e!==void 0&&b!=null&&S(e,["setup","generationConfig","enableAffectiveDialog"],b);const T=x(i,["systemInstruction"]);e!==void 0&&T!=null&&S(e,["setup","systemInstruction"],z6(ms(T)));const I=x(i,["tools"]);if(e!==void 0&&I!=null){let B=lp(I);Array.isArray(B)&&(B=B.map(k=>i8(ap(k)))),S(e,["setup","tools"],B)}const C=x(i,["sessionResumption"]);e!==void 0&&C!=null&&S(e,["setup","sessionResumption"],n8(C));const A=x(i,["inputAudioTranscription"]);e!==void 0&&A!=null&&S(e,["setup","inputAudioTranscription"],A);const D=x(i,["outputAudioTranscription"]);e!==void 0&&D!=null&&S(e,["setup","outputAudioTranscription"],D);const U=x(i,["realtimeInputConfig"]);e!==void 0&&U!=null&&S(e,["setup","realtimeInputConfig"],U);const L=x(i,["contextWindowCompression"]);e!==void 0&&L!=null&&S(e,["setup","contextWindowCompression"],L);const z=x(i,["proactivity"]);if(e!==void 0&&z!=null&&S(e,["setup","proactivity"],z),x(i,["explicitVadSignal"])!==void 0)throw new Error("explicitVadSignal parameter is not supported in Gemini API.");return t}function Y6(i,e){const t={},n=x(i,["generationConfig"]);e!==void 0&&n!=null&&S(e,["setup","generationConfig"],G6(n));const r=x(i,["responseModalities"]);e!==void 0&&r!=null&&S(e,["setup","generationConfig","responseModalities"],r);const s=x(i,["temperature"]);e!==void 0&&s!=null&&S(e,["setup","generationConfig","temperature"],s);const a=x(i,["topP"]);e!==void 0&&a!=null&&S(e,["setup","generationConfig","topP"],a);const c=x(i,["topK"]);e!==void 0&&c!=null&&S(e,["setup","generationConfig","topK"],c);const d=x(i,["maxOutputTokens"]);e!==void 0&&d!=null&&S(e,["setup","generationConfig","maxOutputTokens"],d);const p=x(i,["mediaResolution"]);e!==void 0&&p!=null&&S(e,["setup","generationConfig","mediaResolution"],p);const m=x(i,["seed"]);e!==void 0&&m!=null&&S(e,["setup","generationConfig","seed"],m);const v=x(i,["speechConfig"]);e!==void 0&&v!=null&&S(e,["setup","generationConfig","speechConfig"],iT(v));const _=x(i,["thinkingConfig"]);e!==void 0&&_!=null&&S(e,["setup","generationConfig","thinkingConfig"],_);const b=x(i,["enableAffectiveDialog"]);e!==void 0&&b!=null&&S(e,["setup","generationConfig","enableAffectiveDialog"],b);const T=x(i,["systemInstruction"]);e!==void 0&&T!=null&&S(e,["setup","systemInstruction"],ms(T));const I=x(i,["tools"]);if(e!==void 0&&I!=null){let k=lp(I);Array.isArray(k)&&(k=k.map(G=>r8(ap(G)))),S(e,["setup","tools"],k)}const C=x(i,["sessionResumption"]);e!==void 0&&C!=null&&S(e,["setup","sessionResumption"],C);const A=x(i,["inputAudioTranscription"]);e!==void 0&&A!=null&&S(e,["setup","inputAudioTranscription"],A);const D=x(i,["outputAudioTranscription"]);e!==void 0&&D!=null&&S(e,["setup","outputAudioTranscription"],D);const U=x(i,["realtimeInputConfig"]);e!==void 0&&U!=null&&S(e,["setup","realtimeInputConfig"],U);const L=x(i,["contextWindowCompression"]);e!==void 0&&L!=null&&S(e,["setup","contextWindowCompression"],L);const z=x(i,["proactivity"]);e!==void 0&&z!=null&&S(e,["setup","proactivity"],z);const B=x(i,["explicitVadSignal"]);return e!==void 0&&B!=null&&S(e,["setup","explicitVadSignal"],B),t}function J6(i,e){const t={},n=x(e,["model"]);n!=null&&S(t,["setup","model"],ei(i,n));const r=x(e,["config"]);return r!=null&&S(t,["config"],X6(r,t)),t}function Z6(i,e){const t={},n=x(e,["model"]);n!=null&&S(t,["setup","model"],ei(i,n));const r=x(e,["config"]);return r!=null&&S(t,["config"],Y6(r,t)),t}function $6(i){const e={},t=x(i,["musicGenerationConfig"]);return t!=null&&S(e,["musicGenerationConfig"],t),e}function K6(i){const e={},t=x(i,["weightedPrompts"]);if(t!=null){let n=t;Array.isArray(n)&&(n=n.map(r=>r)),S(e,["weightedPrompts"],n)}return e}function Q6(i){const e={},t=x(i,["media"]);if(t!=null){let p=A3(t);Array.isArray(p)&&(p=p.map(m=>Jy(m))),S(e,["mediaChunks"],p)}const n=x(i,["audio"]);n!=null&&S(e,["audio"],Jy(C3(n)));const r=x(i,["audioStreamEnd"]);r!=null&&S(e,["audioStreamEnd"],r);const s=x(i,["video"]);s!=null&&S(e,["video"],Jy(w3(s)));const a=x(i,["text"]);a!=null&&S(e,["text"],a);const c=x(i,["activityStart"]);c!=null&&S(e,["activityStart"],c);const d=x(i,["activityEnd"]);return d!=null&&S(e,["activityEnd"],d),e}function j6(i){const e={},t=x(i,["media"]);if(t!=null){let p=A3(t);Array.isArray(p)&&(p=p.map(m=>m)),S(e,["mediaChunks"],p)}const n=x(i,["audio"]);n!=null&&S(e,["audio"],C3(n));const r=x(i,["audioStreamEnd"]);r!=null&&S(e,["audioStreamEnd"],r);const s=x(i,["video"]);s!=null&&S(e,["video"],w3(s));const a=x(i,["text"]);a!=null&&S(e,["text"],a);const c=x(i,["activityStart"]);c!=null&&S(e,["activityStart"],c);const d=x(i,["activityEnd"]);return d!=null&&S(e,["activityEnd"],d),e}function e8(i){const e={},t=x(i,["setupComplete"]);t!=null&&S(e,["setupComplete"],t);const n=x(i,["serverContent"]);n!=null&&S(e,["serverContent"],n);const r=x(i,["toolCall"]);r!=null&&S(e,["toolCall"],r);const s=x(i,["toolCallCancellation"]);s!=null&&S(e,["toolCallCancellation"],s);const a=x(i,["usageMetadata"]);a!=null&&S(e,["usageMetadata"],s8(a));const c=x(i,["goAway"]);c!=null&&S(e,["goAway"],c);const d=x(i,["sessionResumptionUpdate"]);d!=null&&S(e,["sessionResumptionUpdate"],d);const p=x(i,["voiceActivityDetectionSignal"]);p!=null&&S(e,["voiceActivityDetectionSignal"],p);const m=x(i,["voiceActivity"]);return m!=null&&S(e,["voiceActivity"],o8(m)),e}function t8(i){const e={},t=x(i,["mediaResolution"]);t!=null&&S(e,["mediaResolution"],t);const n=x(i,["codeExecutionResult"]);n!=null&&S(e,["codeExecutionResult"],n);const r=x(i,["executableCode"]);r!=null&&S(e,["executableCode"],r);const s=x(i,["fileData"]);s!=null&&S(e,["fileData"],B6(s));const a=x(i,["functionCall"]);a!=null&&S(e,["functionCall"],V6(a));const c=x(i,["functionResponse"]);c!=null&&S(e,["functionResponse"],c);const d=x(i,["inlineData"]);d!=null&&S(e,["inlineData"],Jy(d));const p=x(i,["text"]);p!=null&&S(e,["text"],p);const m=x(i,["thought"]);m!=null&&S(e,["thought"],m);const v=x(i,["thoughtSignature"]);v!=null&&S(e,["thoughtSignature"],v);const _=x(i,["videoMetadata"]);return _!=null&&S(e,["videoMetadata"],_),e}function n8(i){const e={},t=x(i,["handle"]);if(t!=null&&S(e,["handle"],t),x(i,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function i8(i){const e={};if(x(i,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const t=x(i,["computerUse"]);t!=null&&S(e,["computerUse"],t);const n=x(i,["fileSearch"]);n!=null&&S(e,["fileSearch"],n);const r=x(i,["codeExecution"]);if(r!=null&&S(e,["codeExecution"],r),x(i,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const s=x(i,["functionDeclarations"]);if(s!=null){let m=s;Array.isArray(m)&&(m=m.map(v=>v)),S(e,["functionDeclarations"],m)}const a=x(i,["googleMaps"]);a!=null&&S(e,["googleMaps"],q6(a));const c=x(i,["googleSearch"]);c!=null&&S(e,["googleSearch"],W6(c));const d=x(i,["googleSearchRetrieval"]);d!=null&&S(e,["googleSearchRetrieval"],d);const p=x(i,["urlContext"]);return p!=null&&S(e,["urlContext"],p),e}function r8(i){const e={},t=x(i,["retrieval"]);t!=null&&S(e,["retrieval"],t);const n=x(i,["computerUse"]);if(n!=null&&S(e,["computerUse"],n),x(i,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const r=x(i,["codeExecution"]);r!=null&&S(e,["codeExecution"],r);const s=x(i,["enterpriseWebSearch"]);s!=null&&S(e,["enterpriseWebSearch"],s);const a=x(i,["functionDeclarations"]);if(a!=null){let v=a;Array.isArray(v)&&(v=v.map(_=>H6(_))),S(e,["functionDeclarations"],v)}const c=x(i,["googleMaps"]);c!=null&&S(e,["googleMaps"],c);const d=x(i,["googleSearch"]);d!=null&&S(e,["googleSearch"],d);const p=x(i,["googleSearchRetrieval"]);p!=null&&S(e,["googleSearchRetrieval"],p);const m=x(i,["urlContext"]);return m!=null&&S(e,["urlContext"],m),e}function s8(i){const e={},t=x(i,["promptTokenCount"]);t!=null&&S(e,["promptTokenCount"],t);const n=x(i,["cachedContentTokenCount"]);n!=null&&S(e,["cachedContentTokenCount"],n);const r=x(i,["candidatesTokenCount"]);r!=null&&S(e,["responseTokenCount"],r);const s=x(i,["toolUsePromptTokenCount"]);s!=null&&S(e,["toolUsePromptTokenCount"],s);const a=x(i,["thoughtsTokenCount"]);a!=null&&S(e,["thoughtsTokenCount"],a);const c=x(i,["totalTokenCount"]);c!=null&&S(e,["totalTokenCount"],c);const d=x(i,["promptTokensDetails"]);if(d!=null){let b=d;Array.isArray(b)&&(b=b.map(T=>T)),S(e,["promptTokensDetails"],b)}const p=x(i,["cacheTokensDetails"]);if(p!=null){let b=p;Array.isArray(b)&&(b=b.map(T=>T)),S(e,["cacheTokensDetails"],b)}const m=x(i,["candidatesTokensDetails"]);if(m!=null){let b=m;Array.isArray(b)&&(b=b.map(T=>T)),S(e,["responseTokensDetails"],b)}const v=x(i,["toolUsePromptTokensDetails"]);if(v!=null){let b=v;Array.isArray(b)&&(b=b.map(T=>T)),S(e,["toolUsePromptTokensDetails"],b)}const _=x(i,["trafficType"]);return _!=null&&S(e,["trafficType"],_),e}function o8(i){const e={},t=x(i,["type"]);return t!=null&&S(e,["voiceActivityType"],t),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function a8(i){const e={},t=x(i,["data"]);if(t!=null&&S(e,["data"],t),x(i,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=x(i,["mimeType"]);return n!=null&&S(e,["mimeType"],n),e}function l8(i){const e={},t=x(i,["content"]);t!=null&&S(e,["content"],t);const n=x(i,["citationMetadata"]);n!=null&&S(e,["citationMetadata"],u8(n));const r=x(i,["tokenCount"]);r!=null&&S(e,["tokenCount"],r);const s=x(i,["finishReason"]);s!=null&&S(e,["finishReason"],s);const a=x(i,["avgLogprobs"]);a!=null&&S(e,["avgLogprobs"],a);const c=x(i,["groundingMetadata"]);c!=null&&S(e,["groundingMetadata"],c);const d=x(i,["index"]);d!=null&&S(e,["index"],d);const p=x(i,["logprobsResult"]);p!=null&&S(e,["logprobsResult"],p);const m=x(i,["safetyRatings"]);if(m!=null){let _=m;Array.isArray(_)&&(_=_.map(b=>b)),S(e,["safetyRatings"],_)}const v=x(i,["urlContextMetadata"]);return v!=null&&S(e,["urlContextMetadata"],v),e}function u8(i){const e={},t=x(i,["citationSources"]);if(t!=null){let n=t;Array.isArray(n)&&(n=n.map(r=>r)),S(e,["citations"],n)}return e}function c8(i,e){const t={},n=x(e,["model"]);n!=null&&S(t,["_url","model"],ei(i,n));const r=x(e,["contents"]);if(r!=null){let s=ia(r);Array.isArray(s)&&(s=s.map(a=>a)),S(t,["contents"],s)}return t}function f8(i){const e={},t=x(i,["sdkHttpResponse"]);t!=null&&S(e,["sdkHttpResponse"],t);const n=x(i,["tokensInfo"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(s=>s)),S(e,["tokensInfo"],r)}return e}function d8(i){const e={},t=x(i,["values"]);t!=null&&S(e,["values"],t);const n=x(i,["statistics"]);return n!=null&&S(e,["statistics"],h8(n)),e}function h8(i){const e={},t=x(i,["truncated"]);t!=null&&S(e,["truncated"],t);const n=x(i,["token_count"]);return n!=null&&S(e,["tokenCount"],n),e}function Xx(i){const e={},t=x(i,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(s=>b9(s))),S(e,["parts"],r)}const n=x(i,["role"]);return n!=null&&S(e,["role"],n),e}function p8(i){const e={},t=x(i,["controlType"]);t!=null&&S(e,["controlType"],t);const n=x(i,["enableControlImageComputation"]);return n!=null&&S(e,["computeControl"],n),e}function m8(i){const e={};if(x(i,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(x(i,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(x(i,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return e}function g8(i,e){const t={},n=x(i,["systemInstruction"]);e!==void 0&&n!=null&&S(e,["systemInstruction"],ms(n));const r=x(i,["tools"]);if(e!==void 0&&r!=null){let a=r;Array.isArray(a)&&(a=a.map(c=>H3(c))),S(e,["tools"],a)}const s=x(i,["generationConfig"]);return e!==void 0&&s!=null&&S(e,["generationConfig"],a9(s)),t}function v8(i,e){const t={},n=x(e,["model"]);n!=null&&S(t,["_url","model"],ei(i,n));const r=x(e,["contents"]);if(r!=null){let a=ia(r);Array.isArray(a)&&(a=a.map(c=>Xx(c))),S(t,["contents"],a)}const s=x(e,["config"]);return s!=null&&m8(s),t}function y8(i,e){const t={},n=x(e,["model"]);n!=null&&S(t,["_url","model"],ei(i,n));const r=x(e,["contents"]);if(r!=null){let a=ia(r);Array.isArray(a)&&(a=a.map(c=>c)),S(t,["contents"],a)}const s=x(e,["config"]);return s!=null&&g8(s,t),t}function _8(i){const e={},t=x(i,["sdkHttpResponse"]);t!=null&&S(e,["sdkHttpResponse"],t);const n=x(i,["totalTokens"]);n!=null&&S(e,["totalTokens"],n);const r=x(i,["cachedContentTokenCount"]);return r!=null&&S(e,["cachedContentTokenCount"],r),e}function x8(i){const e={},t=x(i,["sdkHttpResponse"]);t!=null&&S(e,["sdkHttpResponse"],t);const n=x(i,["totalTokens"]);return n!=null&&S(e,["totalTokens"],n),e}function S8(i,e){const t={},n=x(e,["model"]);return n!=null&&S(t,["_url","name"],ei(i,n)),t}function b8(i,e){const t={},n=x(e,["model"]);return n!=null&&S(t,["_url","name"],ei(i,n)),t}function M8(i){const e={},t=x(i,["sdkHttpResponse"]);return t!=null&&S(e,["sdkHttpResponse"],t),e}function E8(i){const e={},t=x(i,["sdkHttpResponse"]);return t!=null&&S(e,["sdkHttpResponse"],t),e}function T8(i,e){const t={},n=x(i,["outputGcsUri"]);e!==void 0&&n!=null&&S(e,["parameters","storageUri"],n);const r=x(i,["negativePrompt"]);e!==void 0&&r!=null&&S(e,["parameters","negativePrompt"],r);const s=x(i,["numberOfImages"]);e!==void 0&&s!=null&&S(e,["parameters","sampleCount"],s);const a=x(i,["aspectRatio"]);e!==void 0&&a!=null&&S(e,["parameters","aspectRatio"],a);const c=x(i,["guidanceScale"]);e!==void 0&&c!=null&&S(e,["parameters","guidanceScale"],c);const d=x(i,["seed"]);e!==void 0&&d!=null&&S(e,["parameters","seed"],d);const p=x(i,["safetyFilterLevel"]);e!==void 0&&p!=null&&S(e,["parameters","safetySetting"],p);const m=x(i,["personGeneration"]);e!==void 0&&m!=null&&S(e,["parameters","personGeneration"],m);const v=x(i,["includeSafetyAttributes"]);e!==void 0&&v!=null&&S(e,["parameters","includeSafetyAttributes"],v);const _=x(i,["includeRaiReason"]);e!==void 0&&_!=null&&S(e,["parameters","includeRaiReason"],_);const b=x(i,["language"]);e!==void 0&&b!=null&&S(e,["parameters","language"],b);const T=x(i,["outputMimeType"]);e!==void 0&&T!=null&&S(e,["parameters","outputOptions","mimeType"],T);const I=x(i,["outputCompressionQuality"]);e!==void 0&&I!=null&&S(e,["parameters","outputOptions","compressionQuality"],I);const C=x(i,["addWatermark"]);e!==void 0&&C!=null&&S(e,["parameters","addWatermark"],C);const A=x(i,["labels"]);e!==void 0&&A!=null&&S(e,["labels"],A);const D=x(i,["editMode"]);e!==void 0&&D!=null&&S(e,["parameters","editMode"],D);const U=x(i,["baseSteps"]);return e!==void 0&&U!=null&&S(e,["parameters","editConfig","baseSteps"],U),t}function A8(i,e){const t={},n=x(e,["model"]);n!=null&&S(t,["_url","model"],ei(i,n));const r=x(e,["prompt"]);r!=null&&S(t,["instances[0]","prompt"],r);const s=x(e,["referenceImages"]);if(s!=null){let c=s;Array.isArray(c)&&(c=c.map(d=>C9(d))),S(t,["instances[0]","referenceImages"],c)}const a=x(e,["config"]);return a!=null&&T8(a,t),t}function w8(i){const e={},t=x(i,["sdkHttpResponse"]);t!=null&&S(e,["sdkHttpResponse"],t);const n=x(i,["predictions"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(s=>Yx(s))),S(e,["generatedImages"],r)}return e}function C8(i,e){const t={},n=x(i,["taskType"]);e!==void 0&&n!=null&&S(e,["requests[]","taskType"],n);const r=x(i,["title"]);e!==void 0&&r!=null&&S(e,["requests[]","title"],r);const s=x(i,["outputDimensionality"]);if(e!==void 0&&s!=null&&S(e,["requests[]","outputDimensionality"],s),x(i,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(x(i,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return t}function R8(i,e){const t={},n=x(i,["taskType"]);e!==void 0&&n!=null&&S(e,["instances[]","task_type"],n);const r=x(i,["title"]);e!==void 0&&r!=null&&S(e,["instances[]","title"],r);const s=x(i,["outputDimensionality"]);e!==void 0&&s!=null&&S(e,["parameters","outputDimensionality"],s);const a=x(i,["mimeType"]);e!==void 0&&a!=null&&S(e,["instances[]","mimeType"],a);const c=x(i,["autoTruncate"]);return e!==void 0&&c!=null&&S(e,["parameters","autoTruncate"],c),t}function I8(i,e){const t={},n=x(e,["model"]);n!=null&&S(t,["_url","model"],ei(i,n));const r=x(e,["contents"]);if(r!=null){let c=eT(i,r);Array.isArray(c)&&(c=c.map(d=>d)),S(t,["requests[]","content"],c)}const s=x(e,["config"]);s!=null&&C8(s,t);const a=x(e,["model"]);return a!==void 0&&S(t,["requests[]","model"],ei(i,a)),t}function N8(i,e){const t={},n=x(e,["model"]);n!=null&&S(t,["_url","model"],ei(i,n));const r=x(e,["contents"]);if(r!=null){let a=eT(i,r);Array.isArray(a)&&(a=a.map(c=>c)),S(t,["instances[]","content"],a)}const s=x(e,["config"]);return s!=null&&R8(s,t),t}function D8(i){const e={},t=x(i,["sdkHttpResponse"]);t!=null&&S(e,["sdkHttpResponse"],t);const n=x(i,["embeddings"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(a=>a)),S(e,["embeddings"],s)}const r=x(i,["metadata"]);return r!=null&&S(e,["metadata"],r),e}function U8(i){const e={},t=x(i,["sdkHttpResponse"]);t!=null&&S(e,["sdkHttpResponse"],t);const n=x(i,["predictions[]","embeddings"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(a=>d8(a))),S(e,["embeddings"],s)}const r=x(i,["metadata"]);return r!=null&&S(e,["metadata"],r),e}function P8(i){const e={},t=x(i,["endpoint"]);t!=null&&S(e,["name"],t);const n=x(i,["deployedModelId"]);return n!=null&&S(e,["deployedModelId"],n),e}function L8(i){const e={};if(x(i,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=x(i,["fileUri"]);t!=null&&S(e,["fileUri"],t);const n=x(i,["mimeType"]);return n!=null&&S(e,["mimeType"],n),e}function F8(i){const e={},t=x(i,["id"]);t!=null&&S(e,["id"],t);const n=x(i,["args"]);n!=null&&S(e,["args"],n);const r=x(i,["name"]);if(r!=null&&S(e,["name"],r),x(i,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(x(i,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function k8(i){const e={},t=x(i,["allowedFunctionNames"]);t!=null&&S(e,["allowedFunctionNames"],t);const n=x(i,["mode"]);if(n!=null&&S(e,["mode"],n),x(i,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function O8(i){const e={},t=x(i,["description"]);t!=null&&S(e,["description"],t);const n=x(i,["name"]);n!=null&&S(e,["name"],n);const r=x(i,["parameters"]);r!=null&&S(e,["parameters"],r);const s=x(i,["parametersJsonSchema"]);s!=null&&S(e,["parametersJsonSchema"],s);const a=x(i,["response"]);a!=null&&S(e,["response"],a);const c=x(i,["responseJsonSchema"]);if(c!=null&&S(e,["responseJsonSchema"],c),x(i,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");return e}function z8(i,e,t){const n={},r=x(e,["systemInstruction"]);t!==void 0&&r!=null&&S(t,["systemInstruction"],Xx(ms(r)));const s=x(e,["temperature"]);s!=null&&S(n,["temperature"],s);const a=x(e,["topP"]);a!=null&&S(n,["topP"],a);const c=x(e,["topK"]);c!=null&&S(n,["topK"],c);const d=x(e,["candidateCount"]);d!=null&&S(n,["candidateCount"],d);const p=x(e,["maxOutputTokens"]);p!=null&&S(n,["maxOutputTokens"],p);const m=x(e,["stopSequences"]);m!=null&&S(n,["stopSequences"],m);const v=x(e,["responseLogprobs"]);v!=null&&S(n,["responseLogprobs"],v);const _=x(e,["logprobs"]);_!=null&&S(n,["logprobs"],_);const b=x(e,["presencePenalty"]);b!=null&&S(n,["presencePenalty"],b);const T=x(e,["frequencyPenalty"]);T!=null&&S(n,["frequencyPenalty"],T);const I=x(e,["seed"]);I!=null&&S(n,["seed"],I);const C=x(e,["responseMimeType"]);C!=null&&S(n,["responseMimeType"],C);const A=x(e,["responseSchema"]);A!=null&&S(n,["responseSchema"],tT(A));const D=x(e,["responseJsonSchema"]);if(D!=null&&S(n,["responseJsonSchema"],D),x(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(x(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const U=x(e,["safetySettings"]);if(t!==void 0&&U!=null){let ee=U;Array.isArray(ee)&&(ee=ee.map(re=>R9(re))),S(t,["safetySettings"],ee)}const L=x(e,["tools"]);if(t!==void 0&&L!=null){let ee=lp(L);Array.isArray(ee)&&(ee=ee.map(re=>F9(ap(re)))),S(t,["tools"],ee)}const z=x(e,["toolConfig"]);if(t!==void 0&&z!=null&&S(t,["toolConfig"],L9(z)),x(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const B=x(e,["cachedContent"]);t!==void 0&&B!=null&&S(t,["cachedContent"],yu(i,B));const k=x(e,["responseModalities"]);k!=null&&S(n,["responseModalities"],k);const G=x(e,["mediaResolution"]);G!=null&&S(n,["mediaResolution"],G);const P=x(e,["speechConfig"]);if(P!=null&&S(n,["speechConfig"],nT(P)),x(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const O=x(e,["thinkingConfig"]);O!=null&&S(n,["thinkingConfig"],O);const Z=x(e,["imageConfig"]);Z!=null&&S(n,["imageConfig"],d9(Z));const ie=x(e,["enableEnhancedCivicAnswers"]);return ie!=null&&S(n,["enableEnhancedCivicAnswers"],ie),n}function B8(i,e,t){const n={},r=x(e,["systemInstruction"]);t!==void 0&&r!=null&&S(t,["systemInstruction"],ms(r));const s=x(e,["temperature"]);s!=null&&S(n,["temperature"],s);const a=x(e,["topP"]);a!=null&&S(n,["topP"],a);const c=x(e,["topK"]);c!=null&&S(n,["topK"],c);const d=x(e,["candidateCount"]);d!=null&&S(n,["candidateCount"],d);const p=x(e,["maxOutputTokens"]);p!=null&&S(n,["maxOutputTokens"],p);const m=x(e,["stopSequences"]);m!=null&&S(n,["stopSequences"],m);const v=x(e,["responseLogprobs"]);v!=null&&S(n,["responseLogprobs"],v);const _=x(e,["logprobs"]);_!=null&&S(n,["logprobs"],_);const b=x(e,["presencePenalty"]);b!=null&&S(n,["presencePenalty"],b);const T=x(e,["frequencyPenalty"]);T!=null&&S(n,["frequencyPenalty"],T);const I=x(e,["seed"]);I!=null&&S(n,["seed"],I);const C=x(e,["responseMimeType"]);C!=null&&S(n,["responseMimeType"],C);const A=x(e,["responseSchema"]);A!=null&&S(n,["responseSchema"],tT(A));const D=x(e,["responseJsonSchema"]);D!=null&&S(n,["responseJsonSchema"],D);const U=x(e,["routingConfig"]);U!=null&&S(n,["routingConfig"],U);const L=x(e,["modelSelectionConfig"]);L!=null&&S(n,["modelConfig"],L);const z=x(e,["safetySettings"]);if(t!==void 0&&z!=null){let J=z;Array.isArray(J)&&(J=J.map(te=>te)),S(t,["safetySettings"],J)}const B=x(e,["tools"]);if(t!==void 0&&B!=null){let J=lp(B);Array.isArray(J)&&(J=J.map(te=>H3(ap(te)))),S(t,["tools"],J)}const k=x(e,["toolConfig"]);t!==void 0&&k!=null&&S(t,["toolConfig"],k);const G=x(e,["labels"]);t!==void 0&&G!=null&&S(t,["labels"],G);const P=x(e,["cachedContent"]);t!==void 0&&P!=null&&S(t,["cachedContent"],yu(i,P));const O=x(e,["responseModalities"]);O!=null&&S(n,["responseModalities"],O);const Z=x(e,["mediaResolution"]);Z!=null&&S(n,["mediaResolution"],Z);const ie=x(e,["speechConfig"]);ie!=null&&S(n,["speechConfig"],nT(ie));const ee=x(e,["audioTimestamp"]);ee!=null&&S(n,["audioTimestamp"],ee);const re=x(e,["thinkingConfig"]);re!=null&&S(n,["thinkingConfig"],re);const de=x(e,["imageConfig"]);if(de!=null&&S(n,["imageConfig"],h9(de)),x(e,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return n}function EC(i,e){const t={},n=x(e,["model"]);n!=null&&S(t,["_url","model"],ei(i,n));const r=x(e,["contents"]);if(r!=null){let a=ia(r);Array.isArray(a)&&(a=a.map(c=>Xx(c))),S(t,["contents"],a)}const s=x(e,["config"]);return s!=null&&S(t,["generationConfig"],z8(i,s,t)),t}function TC(i,e){const t={},n=x(e,["model"]);n!=null&&S(t,["_url","model"],ei(i,n));const r=x(e,["contents"]);if(r!=null){let a=ia(r);Array.isArray(a)&&(a=a.map(c=>c)),S(t,["contents"],a)}const s=x(e,["config"]);return s!=null&&S(t,["generationConfig"],B8(i,s,t)),t}function AC(i){const e={},t=x(i,["sdkHttpResponse"]);t!=null&&S(e,["sdkHttpResponse"],t);const n=x(i,["candidates"]);if(n!=null){let d=n;Array.isArray(d)&&(d=d.map(p=>l8(p))),S(e,["candidates"],d)}const r=x(i,["modelVersion"]);r!=null&&S(e,["modelVersion"],r);const s=x(i,["promptFeedback"]);s!=null&&S(e,["promptFeedback"],s);const a=x(i,["responseId"]);a!=null&&S(e,["responseId"],a);const c=x(i,["usageMetadata"]);return c!=null&&S(e,["usageMetadata"],c),e}function wC(i){const e={},t=x(i,["sdkHttpResponse"]);t!=null&&S(e,["sdkHttpResponse"],t);const n=x(i,["candidates"]);if(n!=null){let p=n;Array.isArray(p)&&(p=p.map(m=>m)),S(e,["candidates"],p)}const r=x(i,["createTime"]);r!=null&&S(e,["createTime"],r);const s=x(i,["modelVersion"]);s!=null&&S(e,["modelVersion"],s);const a=x(i,["promptFeedback"]);a!=null&&S(e,["promptFeedback"],a);const c=x(i,["responseId"]);c!=null&&S(e,["responseId"],c);const d=x(i,["usageMetadata"]);return d!=null&&S(e,["usageMetadata"],d),e}function V8(i,e){const t={};if(x(i,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(x(i,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const n=x(i,["numberOfImages"]);e!==void 0&&n!=null&&S(e,["parameters","sampleCount"],n);const r=x(i,["aspectRatio"]);e!==void 0&&r!=null&&S(e,["parameters","aspectRatio"],r);const s=x(i,["guidanceScale"]);if(e!==void 0&&s!=null&&S(e,["parameters","guidanceScale"],s),x(i,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const a=x(i,["safetyFilterLevel"]);e!==void 0&&a!=null&&S(e,["parameters","safetySetting"],a);const c=x(i,["personGeneration"]);e!==void 0&&c!=null&&S(e,["parameters","personGeneration"],c);const d=x(i,["includeSafetyAttributes"]);e!==void 0&&d!=null&&S(e,["parameters","includeSafetyAttributes"],d);const p=x(i,["includeRaiReason"]);e!==void 0&&p!=null&&S(e,["parameters","includeRaiReason"],p);const m=x(i,["language"]);e!==void 0&&m!=null&&S(e,["parameters","language"],m);const v=x(i,["outputMimeType"]);e!==void 0&&v!=null&&S(e,["parameters","outputOptions","mimeType"],v);const _=x(i,["outputCompressionQuality"]);if(e!==void 0&&_!=null&&S(e,["parameters","outputOptions","compressionQuality"],_),x(i,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(x(i,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const b=x(i,["imageSize"]);if(e!==void 0&&b!=null&&S(e,["parameters","sampleImageSize"],b),x(i,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return t}function H8(i,e){const t={},n=x(i,["outputGcsUri"]);e!==void 0&&n!=null&&S(e,["parameters","storageUri"],n);const r=x(i,["negativePrompt"]);e!==void 0&&r!=null&&S(e,["parameters","negativePrompt"],r);const s=x(i,["numberOfImages"]);e!==void 0&&s!=null&&S(e,["parameters","sampleCount"],s);const a=x(i,["aspectRatio"]);e!==void 0&&a!=null&&S(e,["parameters","aspectRatio"],a);const c=x(i,["guidanceScale"]);e!==void 0&&c!=null&&S(e,["parameters","guidanceScale"],c);const d=x(i,["seed"]);e!==void 0&&d!=null&&S(e,["parameters","seed"],d);const p=x(i,["safetyFilterLevel"]);e!==void 0&&p!=null&&S(e,["parameters","safetySetting"],p);const m=x(i,["personGeneration"]);e!==void 0&&m!=null&&S(e,["parameters","personGeneration"],m);const v=x(i,["includeSafetyAttributes"]);e!==void 0&&v!=null&&S(e,["parameters","includeSafetyAttributes"],v);const _=x(i,["includeRaiReason"]);e!==void 0&&_!=null&&S(e,["parameters","includeRaiReason"],_);const b=x(i,["language"]);e!==void 0&&b!=null&&S(e,["parameters","language"],b);const T=x(i,["outputMimeType"]);e!==void 0&&T!=null&&S(e,["parameters","outputOptions","mimeType"],T);const I=x(i,["outputCompressionQuality"]);e!==void 0&&I!=null&&S(e,["parameters","outputOptions","compressionQuality"],I);const C=x(i,["addWatermark"]);e!==void 0&&C!=null&&S(e,["parameters","addWatermark"],C);const A=x(i,["labels"]);e!==void 0&&A!=null&&S(e,["labels"],A);const D=x(i,["imageSize"]);e!==void 0&&D!=null&&S(e,["parameters","sampleImageSize"],D);const U=x(i,["enhancePrompt"]);return e!==void 0&&U!=null&&S(e,["parameters","enhancePrompt"],U),t}function G8(i,e){const t={},n=x(e,["model"]);n!=null&&S(t,["_url","model"],ei(i,n));const r=x(e,["prompt"]);r!=null&&S(t,["instances[0]","prompt"],r);const s=x(e,["config"]);return s!=null&&V8(s,t),t}function q8(i,e){const t={},n=x(e,["model"]);n!=null&&S(t,["_url","model"],ei(i,n));const r=x(e,["prompt"]);r!=null&&S(t,["instances[0]","prompt"],r);const s=x(e,["config"]);return s!=null&&H8(s,t),t}function W8(i){const e={},t=x(i,["sdkHttpResponse"]);t!=null&&S(e,["sdkHttpResponse"],t);const n=x(i,["predictions"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(a=>i9(a))),S(e,["generatedImages"],s)}const r=x(i,["positivePromptSafetyAttributes"]);return r!=null&&S(e,["positivePromptSafetyAttributes"],B3(r)),e}function X8(i){const e={},t=x(i,["sdkHttpResponse"]);t!=null&&S(e,["sdkHttpResponse"],t);const n=x(i,["predictions"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(a=>Yx(a))),S(e,["generatedImages"],s)}const r=x(i,["positivePromptSafetyAttributes"]);return r!=null&&S(e,["positivePromptSafetyAttributes"],V3(r)),e}function Y8(i,e){const t={},n=x(i,["numberOfVideos"]);if(e!==void 0&&n!=null&&S(e,["parameters","sampleCount"],n),x(i,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(x(i,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const r=x(i,["durationSeconds"]);if(e!==void 0&&r!=null&&S(e,["parameters","durationSeconds"],r),x(i,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const s=x(i,["aspectRatio"]);e!==void 0&&s!=null&&S(e,["parameters","aspectRatio"],s);const a=x(i,["resolution"]);e!==void 0&&a!=null&&S(e,["parameters","resolution"],a);const c=x(i,["personGeneration"]);if(e!==void 0&&c!=null&&S(e,["parameters","personGeneration"],c),x(i,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const d=x(i,["negativePrompt"]);e!==void 0&&d!=null&&S(e,["parameters","negativePrompt"],d);const p=x(i,["enhancePrompt"]);if(e!==void 0&&p!=null&&S(e,["parameters","enhancePrompt"],p),x(i,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");const m=x(i,["lastFrame"]);e!==void 0&&m!=null&&S(e,["instances[0]","lastFrame"],Jx(m));const v=x(i,["referenceImages"]);if(e!==void 0&&v!=null){let _=v;Array.isArray(_)&&(_=_.map(b=>Z9(b))),S(e,["instances[0]","referenceImages"],_)}if(x(i,["mask"])!==void 0)throw new Error("mask parameter is not supported in Gemini API.");if(x(i,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return t}function J8(i,e){const t={},n=x(i,["numberOfVideos"]);e!==void 0&&n!=null&&S(e,["parameters","sampleCount"],n);const r=x(i,["outputGcsUri"]);e!==void 0&&r!=null&&S(e,["parameters","storageUri"],r);const s=x(i,["fps"]);e!==void 0&&s!=null&&S(e,["parameters","fps"],s);const a=x(i,["durationSeconds"]);e!==void 0&&a!=null&&S(e,["parameters","durationSeconds"],a);const c=x(i,["seed"]);e!==void 0&&c!=null&&S(e,["parameters","seed"],c);const d=x(i,["aspectRatio"]);e!==void 0&&d!=null&&S(e,["parameters","aspectRatio"],d);const p=x(i,["resolution"]);e!==void 0&&p!=null&&S(e,["parameters","resolution"],p);const m=x(i,["personGeneration"]);e!==void 0&&m!=null&&S(e,["parameters","personGeneration"],m);const v=x(i,["pubsubTopic"]);e!==void 0&&v!=null&&S(e,["parameters","pubsubTopic"],v);const _=x(i,["negativePrompt"]);e!==void 0&&_!=null&&S(e,["parameters","negativePrompt"],_);const b=x(i,["enhancePrompt"]);e!==void 0&&b!=null&&S(e,["parameters","enhancePrompt"],b);const T=x(i,["generateAudio"]);e!==void 0&&T!=null&&S(e,["parameters","generateAudio"],T);const I=x(i,["lastFrame"]);e!==void 0&&I!=null&&S(e,["instances[0]","lastFrame"],ka(I));const C=x(i,["referenceImages"]);if(e!==void 0&&C!=null){let U=C;Array.isArray(U)&&(U=U.map(L=>$9(L))),S(e,["instances[0]","referenceImages"],U)}const A=x(i,["mask"]);e!==void 0&&A!=null&&S(e,["instances[0]","mask"],J9(A));const D=x(i,["compressionQuality"]);return e!==void 0&&D!=null&&S(e,["parameters","compressionQuality"],D),t}function Z8(i){const e={},t=x(i,["name"]);t!=null&&S(e,["name"],t);const n=x(i,["metadata"]);n!=null&&S(e,["metadata"],n);const r=x(i,["done"]);r!=null&&S(e,["done"],r);const s=x(i,["error"]);s!=null&&S(e,["error"],s);const a=x(i,["response","generateVideoResponse"]);return a!=null&&S(e,["response"],j8(a)),e}function $8(i){const e={},t=x(i,["name"]);t!=null&&S(e,["name"],t);const n=x(i,["metadata"]);n!=null&&S(e,["metadata"],n);const r=x(i,["done"]);r!=null&&S(e,["done"],r);const s=x(i,["error"]);s!=null&&S(e,["error"],s);const a=x(i,["response"]);return a!=null&&S(e,["response"],e9(a)),e}function K8(i,e){const t={},n=x(e,["model"]);n!=null&&S(t,["_url","model"],ei(i,n));const r=x(e,["prompt"]);r!=null&&S(t,["instances[0]","prompt"],r);const s=x(e,["image"]);s!=null&&S(t,["instances[0]","image"],Jx(s));const a=x(e,["video"]);a!=null&&S(t,["instances[0]","video"],G3(a));const c=x(e,["source"]);c!=null&&t9(c,t);const d=x(e,["config"]);return d!=null&&Y8(d,t),t}function Q8(i,e){const t={},n=x(e,["model"]);n!=null&&S(t,["_url","model"],ei(i,n));const r=x(e,["prompt"]);r!=null&&S(t,["instances[0]","prompt"],r);const s=x(e,["image"]);s!=null&&S(t,["instances[0]","image"],ka(s));const a=x(e,["video"]);a!=null&&S(t,["instances[0]","video"],q3(a));const c=x(e,["source"]);c!=null&&n9(c,t);const d=x(e,["config"]);return d!=null&&J8(d,t),t}function j8(i){const e={},t=x(i,["generatedSamples"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(a=>s9(a))),S(e,["generatedVideos"],s)}const n=x(i,["raiMediaFilteredCount"]);n!=null&&S(e,["raiMediaFilteredCount"],n);const r=x(i,["raiMediaFilteredReasons"]);return r!=null&&S(e,["raiMediaFilteredReasons"],r),e}function e9(i){const e={},t=x(i,["videos"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(a=>o9(a))),S(e,["generatedVideos"],s)}const n=x(i,["raiMediaFilteredCount"]);n!=null&&S(e,["raiMediaFilteredCount"],n);const r=x(i,["raiMediaFilteredReasons"]);return r!=null&&S(e,["raiMediaFilteredReasons"],r),e}function t9(i,e){const t={},n=x(i,["prompt"]);e!==void 0&&n!=null&&S(e,["instances[0]","prompt"],n);const r=x(i,["image"]);e!==void 0&&r!=null&&S(e,["instances[0]","image"],Jx(r));const s=x(i,["video"]);return e!==void 0&&s!=null&&S(e,["instances[0]","video"],G3(s)),t}function n9(i,e){const t={},n=x(i,["prompt"]);e!==void 0&&n!=null&&S(e,["instances[0]","prompt"],n);const r=x(i,["image"]);e!==void 0&&r!=null&&S(e,["instances[0]","image"],ka(r));const s=x(i,["video"]);return e!==void 0&&s!=null&&S(e,["instances[0]","video"],q3(s)),t}function i9(i){const e={},t=x(i,["_self"]);t!=null&&S(e,["image"],p9(t));const n=x(i,["raiFilteredReason"]);n!=null&&S(e,["raiFilteredReason"],n);const r=x(i,["_self"]);return r!=null&&S(e,["safetyAttributes"],B3(r)),e}function Yx(i){const e={},t=x(i,["_self"]);t!=null&&S(e,["image"],z3(t));const n=x(i,["raiFilteredReason"]);n!=null&&S(e,["raiFilteredReason"],n);const r=x(i,["_self"]);r!=null&&S(e,["safetyAttributes"],V3(r));const s=x(i,["prompt"]);return s!=null&&S(e,["enhancedPrompt"],s),e}function r9(i){const e={},t=x(i,["_self"]);t!=null&&S(e,["mask"],z3(t));const n=x(i,["labels"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(s=>s)),S(e,["labels"],r)}return e}function s9(i){const e={},t=x(i,["video"]);return t!=null&&S(e,["video"],X9(t)),e}function o9(i){const e={},t=x(i,["_self"]);return t!=null&&S(e,["video"],Y9(t)),e}function a9(i){const e={},t=x(i,["modelSelectionConfig"]);t!=null&&S(e,["modelConfig"],t);const n=x(i,["responseJsonSchema"]);n!=null&&S(e,["responseJsonSchema"],n);const r=x(i,["audioTimestamp"]);r!=null&&S(e,["audioTimestamp"],r);const s=x(i,["candidateCount"]);s!=null&&S(e,["candidateCount"],s);const a=x(i,["enableAffectiveDialog"]);a!=null&&S(e,["enableAffectiveDialog"],a);const c=x(i,["frequencyPenalty"]);c!=null&&S(e,["frequencyPenalty"],c);const d=x(i,["logprobs"]);d!=null&&S(e,["logprobs"],d);const p=x(i,["maxOutputTokens"]);p!=null&&S(e,["maxOutputTokens"],p);const m=x(i,["mediaResolution"]);m!=null&&S(e,["mediaResolution"],m);const v=x(i,["presencePenalty"]);v!=null&&S(e,["presencePenalty"],v);const _=x(i,["responseLogprobs"]);_!=null&&S(e,["responseLogprobs"],_);const b=x(i,["responseMimeType"]);b!=null&&S(e,["responseMimeType"],b);const T=x(i,["responseModalities"]);T!=null&&S(e,["responseModalities"],T);const I=x(i,["responseSchema"]);I!=null&&S(e,["responseSchema"],I);const C=x(i,["routingConfig"]);C!=null&&S(e,["routingConfig"],C);const A=x(i,["seed"]);A!=null&&S(e,["seed"],A);const D=x(i,["speechConfig"]);D!=null&&S(e,["speechConfig"],D);const U=x(i,["stopSequences"]);U!=null&&S(e,["stopSequences"],U);const L=x(i,["temperature"]);L!=null&&S(e,["temperature"],L);const z=x(i,["thinkingConfig"]);z!=null&&S(e,["thinkingConfig"],z);const B=x(i,["topK"]);B!=null&&S(e,["topK"],B);const k=x(i,["topP"]);if(k!=null&&S(e,["topP"],k),x(i,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function l9(i,e){const t={},n=x(e,["model"]);return n!=null&&S(t,["_url","name"],ei(i,n)),t}function u9(i,e){const t={},n=x(e,["model"]);return n!=null&&S(t,["_url","name"],ei(i,n)),t}function c9(i){const e={};if(x(i,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=x(i,["enableWidget"]);return t!=null&&S(e,["enableWidget"],t),e}function f9(i){const e={};if(x(i,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(x(i,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=x(i,["timeRangeFilter"]);return t!=null&&S(e,["timeRangeFilter"],t),e}function d9(i){const e={},t=x(i,["aspectRatio"]);t!=null&&S(e,["aspectRatio"],t);const n=x(i,["imageSize"]);if(n!=null&&S(e,["imageSize"],n),x(i,["personGeneration"])!==void 0)throw new Error("personGeneration parameter is not supported in Gemini API.");if(x(i,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(x(i,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return e}function h9(i){const e={},t=x(i,["aspectRatio"]);t!=null&&S(e,["aspectRatio"],t);const n=x(i,["imageSize"]);n!=null&&S(e,["imageSize"],n);const r=x(i,["personGeneration"]);r!=null&&S(e,["personGeneration"],r);const s=x(i,["outputMimeType"]);s!=null&&S(e,["imageOutputOptions","mimeType"],s);const a=x(i,["outputCompressionQuality"]);return a!=null&&S(e,["imageOutputOptions","compressionQuality"],a),e}function p9(i){const e={},t=x(i,["bytesBase64Encoded"]);t!=null&&S(e,["imageBytes"],Rc(t));const n=x(i,["mimeType"]);return n!=null&&S(e,["mimeType"],n),e}function z3(i){const e={},t=x(i,["gcsUri"]);t!=null&&S(e,["gcsUri"],t);const n=x(i,["bytesBase64Encoded"]);n!=null&&S(e,["imageBytes"],Rc(n));const r=x(i,["mimeType"]);return r!=null&&S(e,["mimeType"],r),e}function Jx(i){const e={};if(x(i,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const t=x(i,["imageBytes"]);t!=null&&S(e,["bytesBase64Encoded"],Rc(t));const n=x(i,["mimeType"]);return n!=null&&S(e,["mimeType"],n),e}function ka(i){const e={},t=x(i,["gcsUri"]);t!=null&&S(e,["gcsUri"],t);const n=x(i,["imageBytes"]);n!=null&&S(e,["bytesBase64Encoded"],Rc(n));const r=x(i,["mimeType"]);return r!=null&&S(e,["mimeType"],r),e}function m9(i,e,t){const n={},r=x(e,["pageSize"]);t!==void 0&&r!=null&&S(t,["_query","pageSize"],r);const s=x(e,["pageToken"]);t!==void 0&&s!=null&&S(t,["_query","pageToken"],s);const a=x(e,["filter"]);t!==void 0&&a!=null&&S(t,["_query","filter"],a);const c=x(e,["queryBase"]);return t!==void 0&&c!=null&&S(t,["_url","models_url"],D3(i,c)),n}function g9(i,e,t){const n={},r=x(e,["pageSize"]);t!==void 0&&r!=null&&S(t,["_query","pageSize"],r);const s=x(e,["pageToken"]);t!==void 0&&s!=null&&S(t,["_query","pageToken"],s);const a=x(e,["filter"]);t!==void 0&&a!=null&&S(t,["_query","filter"],a);const c=x(e,["queryBase"]);return t!==void 0&&c!=null&&S(t,["_url","models_url"],D3(i,c)),n}function v9(i,e){const t={},n=x(e,["config"]);return n!=null&&m9(i,n,t),t}function y9(i,e){const t={},n=x(e,["config"]);return n!=null&&g9(i,n,t),t}function _9(i){const e={},t=x(i,["sdkHttpResponse"]);t!=null&&S(e,["sdkHttpResponse"],t);const n=x(i,["nextPageToken"]);n!=null&&S(e,["nextPageToken"],n);const r=x(i,["_self"]);if(r!=null){let s=U3(r);Array.isArray(s)&&(s=s.map(a=>wM(a))),S(e,["models"],s)}return e}function x9(i){const e={},t=x(i,["sdkHttpResponse"]);t!=null&&S(e,["sdkHttpResponse"],t);const n=x(i,["nextPageToken"]);n!=null&&S(e,["nextPageToken"],n);const r=x(i,["_self"]);if(r!=null){let s=U3(r);Array.isArray(s)&&(s=s.map(a=>CM(a))),S(e,["models"],s)}return e}function S9(i){const e={},t=x(i,["maskMode"]);t!=null&&S(e,["maskMode"],t);const n=x(i,["segmentationClasses"]);n!=null&&S(e,["maskClasses"],n);const r=x(i,["maskDilation"]);return r!=null&&S(e,["dilation"],r),e}function wM(i){const e={},t=x(i,["name"]);t!=null&&S(e,["name"],t);const n=x(i,["displayName"]);n!=null&&S(e,["displayName"],n);const r=x(i,["description"]);r!=null&&S(e,["description"],r);const s=x(i,["version"]);s!=null&&S(e,["version"],s);const a=x(i,["_self"]);a!=null&&S(e,["tunedModelInfo"],k9(a));const c=x(i,["inputTokenLimit"]);c!=null&&S(e,["inputTokenLimit"],c);const d=x(i,["outputTokenLimit"]);d!=null&&S(e,["outputTokenLimit"],d);const p=x(i,["supportedGenerationMethods"]);p!=null&&S(e,["supportedActions"],p);const m=x(i,["temperature"]);m!=null&&S(e,["temperature"],m);const v=x(i,["maxTemperature"]);v!=null&&S(e,["maxTemperature"],v);const _=x(i,["topP"]);_!=null&&S(e,["topP"],_);const b=x(i,["topK"]);b!=null&&S(e,["topK"],b);const T=x(i,["thinking"]);return T!=null&&S(e,["thinking"],T),e}function CM(i){const e={},t=x(i,["name"]);t!=null&&S(e,["name"],t);const n=x(i,["displayName"]);n!=null&&S(e,["displayName"],n);const r=x(i,["description"]);r!=null&&S(e,["description"],r);const s=x(i,["versionId"]);s!=null&&S(e,["version"],s);const a=x(i,["deployedModels"]);if(a!=null){let v=a;Array.isArray(v)&&(v=v.map(_=>P8(_))),S(e,["endpoints"],v)}const c=x(i,["labels"]);c!=null&&S(e,["labels"],c);const d=x(i,["_self"]);d!=null&&S(e,["tunedModelInfo"],O9(d));const p=x(i,["defaultCheckpointId"]);p!=null&&S(e,["defaultCheckpointId"],p);const m=x(i,["checkpoints"]);if(m!=null){let v=m;Array.isArray(v)&&(v=v.map(_=>_)),S(e,["checkpoints"],v)}return e}function b9(i){const e={},t=x(i,["mediaResolution"]);t!=null&&S(e,["mediaResolution"],t);const n=x(i,["codeExecutionResult"]);n!=null&&S(e,["codeExecutionResult"],n);const r=x(i,["executableCode"]);r!=null&&S(e,["executableCode"],r);const s=x(i,["fileData"]);s!=null&&S(e,["fileData"],L8(s));const a=x(i,["functionCall"]);a!=null&&S(e,["functionCall"],F8(a));const c=x(i,["functionResponse"]);c!=null&&S(e,["functionResponse"],c);const d=x(i,["inlineData"]);d!=null&&S(e,["inlineData"],a8(d));const p=x(i,["text"]);p!=null&&S(e,["text"],p);const m=x(i,["thought"]);m!=null&&S(e,["thought"],m);const v=x(i,["thoughtSignature"]);v!=null&&S(e,["thoughtSignature"],v);const _=x(i,["videoMetadata"]);return _!=null&&S(e,["videoMetadata"],_),e}function M9(i){const e={},t=x(i,["productImage"]);return t!=null&&S(e,["image"],ka(t)),e}function E9(i,e){const t={},n=x(i,["numberOfImages"]);e!==void 0&&n!=null&&S(e,["parameters","sampleCount"],n);const r=x(i,["baseSteps"]);e!==void 0&&r!=null&&S(e,["parameters","baseSteps"],r);const s=x(i,["outputGcsUri"]);e!==void 0&&s!=null&&S(e,["parameters","storageUri"],s);const a=x(i,["seed"]);e!==void 0&&a!=null&&S(e,["parameters","seed"],a);const c=x(i,["safetyFilterLevel"]);e!==void 0&&c!=null&&S(e,["parameters","safetySetting"],c);const d=x(i,["personGeneration"]);e!==void 0&&d!=null&&S(e,["parameters","personGeneration"],d);const p=x(i,["addWatermark"]);e!==void 0&&p!=null&&S(e,["parameters","addWatermark"],p);const m=x(i,["outputMimeType"]);e!==void 0&&m!=null&&S(e,["parameters","outputOptions","mimeType"],m);const v=x(i,["outputCompressionQuality"]);e!==void 0&&v!=null&&S(e,["parameters","outputOptions","compressionQuality"],v);const _=x(i,["enhancePrompt"]);e!==void 0&&_!=null&&S(e,["parameters","enhancePrompt"],_);const b=x(i,["labels"]);return e!==void 0&&b!=null&&S(e,["labels"],b),t}function T9(i,e){const t={},n=x(e,["model"]);n!=null&&S(t,["_url","model"],ei(i,n));const r=x(e,["source"]);r!=null&&w9(r,t);const s=x(e,["config"]);return s!=null&&E9(s,t),t}function A9(i){const e={},t=x(i,["predictions"]);if(t!=null){let n=t;Array.isArray(n)&&(n=n.map(r=>Yx(r))),S(e,["generatedImages"],n)}return e}function w9(i,e){const t={},n=x(i,["prompt"]);e!==void 0&&n!=null&&S(e,["instances[0]","prompt"],n);const r=x(i,["personImage"]);e!==void 0&&r!=null&&S(e,["instances[0]","personImage","image"],ka(r));const s=x(i,["productImages"]);if(e!==void 0&&s!=null){let a=s;Array.isArray(a)&&(a=a.map(c=>M9(c))),S(e,["instances[0]","productImages"],a)}return t}function C9(i){const e={},t=x(i,["referenceImage"]);t!=null&&S(e,["referenceImage"],ka(t));const n=x(i,["referenceId"]);n!=null&&S(e,["referenceId"],n);const r=x(i,["referenceType"]);r!=null&&S(e,["referenceType"],r);const s=x(i,["maskImageConfig"]);s!=null&&S(e,["maskImageConfig"],S9(s));const a=x(i,["controlImageConfig"]);a!=null&&S(e,["controlImageConfig"],p8(a));const c=x(i,["styleImageConfig"]);c!=null&&S(e,["styleImageConfig"],c);const d=x(i,["subjectImageConfig"]);return d!=null&&S(e,["subjectImageConfig"],d),e}function B3(i){const e={},t=x(i,["safetyAttributes","categories"]);t!=null&&S(e,["categories"],t);const n=x(i,["safetyAttributes","scores"]);n!=null&&S(e,["scores"],n);const r=x(i,["contentType"]);return r!=null&&S(e,["contentType"],r),e}function V3(i){const e={},t=x(i,["safetyAttributes","categories"]);t!=null&&S(e,["categories"],t);const n=x(i,["safetyAttributes","scores"]);n!=null&&S(e,["scores"],n);const r=x(i,["contentType"]);return r!=null&&S(e,["contentType"],r),e}function R9(i){const e={},t=x(i,["category"]);if(t!=null&&S(e,["category"],t),x(i,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const n=x(i,["threshold"]);return n!=null&&S(e,["threshold"],n),e}function I9(i){const e={},t=x(i,["image"]);return t!=null&&S(e,["image"],ka(t)),e}function N9(i,e){const t={},n=x(i,["mode"]);e!==void 0&&n!=null&&S(e,["parameters","mode"],n);const r=x(i,["maxPredictions"]);e!==void 0&&r!=null&&S(e,["parameters","maxPredictions"],r);const s=x(i,["confidenceThreshold"]);e!==void 0&&s!=null&&S(e,["parameters","confidenceThreshold"],s);const a=x(i,["maskDilation"]);e!==void 0&&a!=null&&S(e,["parameters","maskDilation"],a);const c=x(i,["binaryColorThreshold"]);e!==void 0&&c!=null&&S(e,["parameters","binaryColorThreshold"],c);const d=x(i,["labels"]);return e!==void 0&&d!=null&&S(e,["labels"],d),t}function D9(i,e){const t={},n=x(e,["model"]);n!=null&&S(t,["_url","model"],ei(i,n));const r=x(e,["source"]);r!=null&&P9(r,t);const s=x(e,["config"]);return s!=null&&N9(s,t),t}function U9(i){const e={},t=x(i,["predictions"]);if(t!=null){let n=t;Array.isArray(n)&&(n=n.map(r=>r9(r))),S(e,["generatedMasks"],n)}return e}function P9(i,e){const t={},n=x(i,["prompt"]);e!==void 0&&n!=null&&S(e,["instances[0]","prompt"],n);const r=x(i,["image"]);e!==void 0&&r!=null&&S(e,["instances[0]","image"],ka(r));const s=x(i,["scribbleImage"]);return e!==void 0&&s!=null&&S(e,["instances[0]","scribble"],I9(s)),t}function L9(i){const e={},t=x(i,["retrievalConfig"]);t!=null&&S(e,["retrievalConfig"],t);const n=x(i,["functionCallingConfig"]);return n!=null&&S(e,["functionCallingConfig"],k8(n)),e}function F9(i){const e={};if(x(i,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const t=x(i,["computerUse"]);t!=null&&S(e,["computerUse"],t);const n=x(i,["fileSearch"]);n!=null&&S(e,["fileSearch"],n);const r=x(i,["codeExecution"]);if(r!=null&&S(e,["codeExecution"],r),x(i,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const s=x(i,["functionDeclarations"]);if(s!=null){let m=s;Array.isArray(m)&&(m=m.map(v=>v)),S(e,["functionDeclarations"],m)}const a=x(i,["googleMaps"]);a!=null&&S(e,["googleMaps"],c9(a));const c=x(i,["googleSearch"]);c!=null&&S(e,["googleSearch"],f9(c));const d=x(i,["googleSearchRetrieval"]);d!=null&&S(e,["googleSearchRetrieval"],d);const p=x(i,["urlContext"]);return p!=null&&S(e,["urlContext"],p),e}function H3(i){const e={},t=x(i,["retrieval"]);t!=null&&S(e,["retrieval"],t);const n=x(i,["computerUse"]);if(n!=null&&S(e,["computerUse"],n),x(i,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const r=x(i,["codeExecution"]);r!=null&&S(e,["codeExecution"],r);const s=x(i,["enterpriseWebSearch"]);s!=null&&S(e,["enterpriseWebSearch"],s);const a=x(i,["functionDeclarations"]);if(a!=null){let v=a;Array.isArray(v)&&(v=v.map(_=>O8(_))),S(e,["functionDeclarations"],v)}const c=x(i,["googleMaps"]);c!=null&&S(e,["googleMaps"],c);const d=x(i,["googleSearch"]);d!=null&&S(e,["googleSearch"],d);const p=x(i,["googleSearchRetrieval"]);p!=null&&S(e,["googleSearchRetrieval"],p);const m=x(i,["urlContext"]);return m!=null&&S(e,["urlContext"],m),e}function k9(i){const e={},t=x(i,["baseModel"]);t!=null&&S(e,["baseModel"],t);const n=x(i,["createTime"]);n!=null&&S(e,["createTime"],n);const r=x(i,["updateTime"]);return r!=null&&S(e,["updateTime"],r),e}function O9(i){const e={},t=x(i,["labels","google-vertex-llm-tuning-base-model-id"]);t!=null&&S(e,["baseModel"],t);const n=x(i,["createTime"]);n!=null&&S(e,["createTime"],n);const r=x(i,["updateTime"]);return r!=null&&S(e,["updateTime"],r),e}function z9(i,e){const t={},n=x(i,["displayName"]);e!==void 0&&n!=null&&S(e,["displayName"],n);const r=x(i,["description"]);e!==void 0&&r!=null&&S(e,["description"],r);const s=x(i,["defaultCheckpointId"]);return e!==void 0&&s!=null&&S(e,["defaultCheckpointId"],s),t}function B9(i,e){const t={},n=x(i,["displayName"]);e!==void 0&&n!=null&&S(e,["displayName"],n);const r=x(i,["description"]);e!==void 0&&r!=null&&S(e,["description"],r);const s=x(i,["defaultCheckpointId"]);return e!==void 0&&s!=null&&S(e,["defaultCheckpointId"],s),t}function V9(i,e){const t={},n=x(e,["model"]);n!=null&&S(t,["_url","name"],ei(i,n));const r=x(e,["config"]);return r!=null&&z9(r,t),t}function H9(i,e){const t={},n=x(e,["model"]);n!=null&&S(t,["_url","model"],ei(i,n));const r=x(e,["config"]);return r!=null&&B9(r,t),t}function G9(i,e){const t={},n=x(i,["outputGcsUri"]);e!==void 0&&n!=null&&S(e,["parameters","storageUri"],n);const r=x(i,["safetyFilterLevel"]);e!==void 0&&r!=null&&S(e,["parameters","safetySetting"],r);const s=x(i,["personGeneration"]);e!==void 0&&s!=null&&S(e,["parameters","personGeneration"],s);const a=x(i,["includeRaiReason"]);e!==void 0&&a!=null&&S(e,["parameters","includeRaiReason"],a);const c=x(i,["outputMimeType"]);e!==void 0&&c!=null&&S(e,["parameters","outputOptions","mimeType"],c);const d=x(i,["outputCompressionQuality"]);e!==void 0&&d!=null&&S(e,["parameters","outputOptions","compressionQuality"],d);const p=x(i,["enhanceInputImage"]);e!==void 0&&p!=null&&S(e,["parameters","upscaleConfig","enhanceInputImage"],p);const m=x(i,["imagePreservationFactor"]);e!==void 0&&m!=null&&S(e,["parameters","upscaleConfig","imagePreservationFactor"],m);const v=x(i,["labels"]);e!==void 0&&v!=null&&S(e,["labels"],v);const _=x(i,["numberOfImages"]);e!==void 0&&_!=null&&S(e,["parameters","sampleCount"],_);const b=x(i,["mode"]);return e!==void 0&&b!=null&&S(e,["parameters","mode"],b),t}function q9(i,e){const t={},n=x(e,["model"]);n!=null&&S(t,["_url","model"],ei(i,n));const r=x(e,["image"]);r!=null&&S(t,["instances[0]","image"],ka(r));const s=x(e,["upscaleFactor"]);s!=null&&S(t,["parameters","upscaleConfig","upscaleFactor"],s);const a=x(e,["config"]);return a!=null&&G9(a,t),t}function W9(i){const e={},t=x(i,["sdkHttpResponse"]);t!=null&&S(e,["sdkHttpResponse"],t);const n=x(i,["predictions"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(s=>Yx(s))),S(e,["generatedImages"],r)}return e}function X9(i){const e={},t=x(i,["uri"]);t!=null&&S(e,["uri"],t);const n=x(i,["encodedVideo"]);n!=null&&S(e,["videoBytes"],Rc(n));const r=x(i,["encoding"]);return r!=null&&S(e,["mimeType"],r),e}function Y9(i){const e={},t=x(i,["gcsUri"]);t!=null&&S(e,["uri"],t);const n=x(i,["bytesBase64Encoded"]);n!=null&&S(e,["videoBytes"],Rc(n));const r=x(i,["mimeType"]);return r!=null&&S(e,["mimeType"],r),e}function J9(i){const e={},t=x(i,["image"]);t!=null&&S(e,["_self"],ka(t));const n=x(i,["maskMode"]);return n!=null&&S(e,["maskMode"],n),e}function Z9(i){const e={},t=x(i,["image"]);t!=null&&S(e,["image"],Jx(t));const n=x(i,["referenceType"]);return n!=null&&S(e,["referenceType"],n),e}function $9(i){const e={},t=x(i,["image"]);t!=null&&S(e,["image"],ka(t));const n=x(i,["referenceType"]);return n!=null&&S(e,["referenceType"],n),e}function G3(i){const e={},t=x(i,["uri"]);t!=null&&S(e,["uri"],t);const n=x(i,["videoBytes"]);n!=null&&S(e,["encodedVideo"],Rc(n));const r=x(i,["mimeType"]);return r!=null&&S(e,["encoding"],r),e}function q3(i){const e={},t=x(i,["uri"]);t!=null&&S(e,["gcsUri"],t);const n=x(i,["videoBytes"]);n!=null&&S(e,["bytesBase64Encoded"],Rc(n));const r=x(i,["mimeType"]);return r!=null&&S(e,["mimeType"],r),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function K9(i,e){const t={},n=x(i,["displayName"]);return e!==void 0&&n!=null&&S(e,["displayName"],n),t}function Q9(i){const e={},t=x(i,["config"]);return t!=null&&K9(t,e),e}function j9(i,e){const t={},n=x(i,["force"]);return e!==void 0&&n!=null&&S(e,["_query","force"],n),t}function eq(i){const e={},t=x(i,["name"]);t!=null&&S(e,["_url","name"],t);const n=x(i,["config"]);return n!=null&&j9(n,e),e}function tq(i){const e={},t=x(i,["name"]);return t!=null&&S(e,["_url","name"],t),e}function nq(i,e){const t={},n=x(i,["customMetadata"]);if(e!==void 0&&n!=null){let s=n;Array.isArray(s)&&(s=s.map(a=>a)),S(e,["customMetadata"],s)}const r=x(i,["chunkingConfig"]);return e!==void 0&&r!=null&&S(e,["chunkingConfig"],r),t}function iq(i){const e={},t=x(i,["name"]);t!=null&&S(e,["name"],t);const n=x(i,["metadata"]);n!=null&&S(e,["metadata"],n);const r=x(i,["done"]);r!=null&&S(e,["done"],r);const s=x(i,["error"]);s!=null&&S(e,["error"],s);const a=x(i,["response"]);return a!=null&&S(e,["response"],sq(a)),e}function rq(i){const e={},t=x(i,["fileSearchStoreName"]);t!=null&&S(e,["_url","file_search_store_name"],t);const n=x(i,["fileName"]);n!=null&&S(e,["fileName"],n);const r=x(i,["config"]);return r!=null&&nq(r,e),e}function sq(i){const e={},t=x(i,["sdkHttpResponse"]);t!=null&&S(e,["sdkHttpResponse"],t);const n=x(i,["parent"]);n!=null&&S(e,["parent"],n);const r=x(i,["documentName"]);return r!=null&&S(e,["documentName"],r),e}function oq(i,e){const t={},n=x(i,["pageSize"]);e!==void 0&&n!=null&&S(e,["_query","pageSize"],n);const r=x(i,["pageToken"]);return e!==void 0&&r!=null&&S(e,["_query","pageToken"],r),t}function aq(i){const e={},t=x(i,["config"]);return t!=null&&oq(t,e),e}function lq(i){const e={},t=x(i,["sdkHttpResponse"]);t!=null&&S(e,["sdkHttpResponse"],t);const n=x(i,["nextPageToken"]);n!=null&&S(e,["nextPageToken"],n);const r=x(i,["fileSearchStores"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(a=>a)),S(e,["fileSearchStores"],s)}return e}function W3(i,e){const t={},n=x(i,["mimeType"]);e!==void 0&&n!=null&&S(e,["mimeType"],n);const r=x(i,["displayName"]);e!==void 0&&r!=null&&S(e,["displayName"],r);const s=x(i,["customMetadata"]);if(e!==void 0&&s!=null){let c=s;Array.isArray(c)&&(c=c.map(d=>d)),S(e,["customMetadata"],c)}const a=x(i,["chunkingConfig"]);return e!==void 0&&a!=null&&S(e,["chunkingConfig"],a),t}function uq(i){const e={},t=x(i,["fileSearchStoreName"]);t!=null&&S(e,["_url","file_search_store_name"],t);const n=x(i,["config"]);return n!=null&&W3(n,e),e}function cq(i){const e={},t=x(i,["sdkHttpResponse"]);return t!=null&&S(e,["sdkHttpResponse"],t),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const fq="Content-Type",dq="X-Server-Timeout",hq="User-Agent",RM="x-goog-api-client",pq="1.37.0",mq=`google-genai-sdk/${pq}`,gq="v1beta1",vq="v1beta";class yq{constructor(e){var t,n;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const r={};this.clientOptions.vertexai?(r.apiVersion=(t=this.clientOptions.apiVersion)!==null&&t!==void 0?t:gq,r.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(r.apiVersion=(n=this.clientOptions.apiVersion)!==null&&n!==void 0?n:vq,r.baseUrl="https://generativelanguage.googleapis.com/"),r.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=r,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(r,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}async getAuthHeaders(){const e=new Headers;return await this.clientOptions.auth.addAuthHeaders(e),e}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const n=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&n.push(e.apiVersion),n.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),t=new URL(e);return t.protocol=t.protocol=="http:"?"ws":"wss",t.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,t,n){const r=[this.getRequestUrlInternal(t)];return n&&r.push(this.getBaseResourcePath()),e!==""&&r.push(e),new URL(`${r.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const n=this.shouldPrependVertexProjectPath(e),r=this.constructUrl(e.path,t,n);if(e.queryParams)for(const[a,c]of Object.entries(e.queryParams))r.searchParams.append(a,String(c));let s={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else s.body=e.body;return s=await this.includeExtraHttpOptionsToRequestInit(s,t,r.toString(),e.abortSignal),this.unaryApiCall(r,s,e.httpMethod)}patchHttpOptions(e,t){const n=JSON.parse(JSON.stringify(e));for(const[r,s]of Object.entries(t))typeof s=="object"?n[r]=Object.assign(Object.assign({},n[r]),s):s!==void 0&&(n[r]=s);return n}async requestStream(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const n=this.shouldPrependVertexProjectPath(e),r=this.constructUrl(e.path,t,n);(!r.searchParams.has("alt")||r.searchParams.get("alt")!=="sse")&&r.searchParams.set("alt","sse");let s={};return s.body=e.body,s=await this.includeExtraHttpOptionsToRequestInit(s,t,r.toString(),e.abortSignal),this.streamApiCall(r,s,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,t,n,r){if(t&&t.timeout||r){const s=new AbortController,a=s.signal;if(t.timeout&&(t==null?void 0:t.timeout)>0){const c=setTimeout(()=>s.abort(),t.timeout);c&&typeof c.unref=="function"&&c.unref()}r&&r.addEventListener("abort",()=>{s.abort()}),e.signal=a}return t&&t.extraBody!==null&&_q(e,t.extraBody),e.headers=await this.getHeadersInternal(t,n),e}async unaryApiCall(e,t,n){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:n})).then(async r=>(await CC(r),new EM(r))).catch(r=>{throw r instanceof Error?r:new Error(JSON.stringify(r))})}async streamApiCall(e,t,n){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:n})).then(async r=>(await CC(r),this.processStreamResponse(r))).catch(r=>{throw r instanceof Error?r:new Error(JSON.stringify(r))})}processStreamResponse(e){return Na(this,arguments,function*(){var n;const r=(n=e==null?void 0:e.body)===null||n===void 0?void 0:n.getReader(),s=new TextDecoder("utf-8");if(!r)throw new Error("Response body is empty");try{let a="";const c="data:",d=[`

`,"\r\r",`\r
\r
`];for(;;){const{done:p,value:m}=yield hn(r.read());if(p){if(a.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const v=s.decode(m,{stream:!0});try{const T=JSON.parse(v);if("error"in T){const I=JSON.parse(JSON.stringify(T.error)),C=I.status,A=I.code,D=`got status: ${C}. ${JSON.stringify(T)}`;if(A>=400&&A<600)throw new Wx({message:D,status:A})}}catch(T){if(T.name==="ApiError")throw T}a+=v;let _=-1,b=0;for(;;){_=-1,b=0;for(const C of d){const A=a.indexOf(C);A!==-1&&(_===-1||A<_)&&(_=A,b=C.length)}if(_===-1)break;const T=a.substring(0,_);a=a.substring(_+b);const I=T.trim();if(I.startsWith(c)){const C=I.substring(c.length).trim();try{const A=new Response(C,{headers:e==null?void 0:e.headers,status:e==null?void 0:e.status,statusText:e==null?void 0:e.statusText});yield yield hn(new EM(A))}catch(A){throw new Error(`exception parsing stream chunk ${C}. ${A}`)}}}}}finally{r.releaseLock()}})}async apiCall(e,t){return fetch(e,t).catch(n=>{throw new Error(`exception ${n} sending request`)})}getDefaultHeaders(){const e={},t=mq+" "+this.clientOptions.userAgentExtra;return e[hq]=t,e[RM]=t,e[fq]="application/json",e}async getHeadersInternal(e,t){const n=new Headers;if(e&&e.headers){for(const[r,s]of Object.entries(e.headers))n.append(r,s);e.timeout&&e.timeout>0&&n.append(dq,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(n,t),n}getFileName(e){var t;let n="";return typeof e=="string"&&(n=e.replace(/[/\\]+$/,""),n=(t=n.split(/[/\\]/).pop())!==null&&t!==void 0?t:""),n}async uploadFile(e,t){var n;const r={};t!=null&&(r.mimeType=t.mimeType,r.name=t.name,r.displayName=t.displayName),r.name&&!r.name.startsWith("files/")&&(r.name=`files/${r.name}`);const s=this.clientOptions.uploader,a=await s.stat(e);r.sizeBytes=String(a.size);const c=(n=t==null?void 0:t.mimeType)!==null&&n!==void 0?n:a.type;if(c===void 0||c==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");r.mimeType=c;const d={file:r},p=this.getFileName(e),m=Ft("upload/v1beta/files",d._url),v=await this.fetchUploadUrl(m,r.sizeBytes,r.mimeType,p,d,t==null?void 0:t.httpOptions);return s.upload(e,v,this)}async uploadFileToFileSearchStore(e,t,n){var r;const s=this.clientOptions.uploader,a=await s.stat(t),c=String(a.size),d=(r=n==null?void 0:n.mimeType)!==null&&r!==void 0?r:a.type;if(d===void 0||d==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");const p=`upload/v1beta/${e}:uploadToFileSearchStore`,m=this.getFileName(t),v={};n!=null&&W3(n,v);const _=await this.fetchUploadUrl(p,c,d,m,v,n==null?void 0:n.httpOptions);return s.uploadToFileSearchStore(t,_,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,t,n,r,s,a){var c;let d={};a?d=a:d={apiVersion:"",headers:Object.assign({"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${t}`,"X-Goog-Upload-Header-Content-Type":`${n}`},r?{"X-Goog-Upload-File-Name":r}:{})};const p=await this.request({path:e,body:JSON.stringify(s),httpMethod:"POST",httpOptions:d});if(!p||!(p!=null&&p.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const m=(c=p==null?void 0:p.headers)===null||c===void 0?void 0:c["x-goog-upload-url"];if(m===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return m}}async function CC(i){var e;if(i===void 0)throw new Error("response is undefined");if(!i.ok){const t=i.status;let n;!((e=i.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?n=await i.json():n={error:{message:await i.text(),code:i.status,status:i.statusText}};const r=JSON.stringify(n);throw t>=400&&t<600?new Wx({message:r,status:t}):new Error(r)}}function _q(i,e){if(!e||Object.keys(e).length===0)return;if(i.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let t={};if(typeof i.body=="string"&&i.body.length>0)try{const s=JSON.parse(i.body);if(typeof s=="object"&&s!==null&&!Array.isArray(s))t=s;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function n(s,a){const c=Object.assign({},s);for(const d in a)if(Object.prototype.hasOwnProperty.call(a,d)){const p=a[d],m=c[d];p&&typeof p=="object"&&!Array.isArray(p)&&m&&typeof m=="object"&&!Array.isArray(m)?c[d]=n(m,p):(m&&p&&typeof m!=typeof p&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${d}". Original type: ${typeof m}, New type: ${typeof p}. Overwriting.`),c[d]=p)}return c}const r=n(t,e);i.body=JSON.stringify(r)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const xq="mcp_used/unknown";let Sq=!1;function X3(i){for(const e of i)if(bq(e)||typeof e=="object"&&"inputSchema"in e)return!0;return Sq}function Y3(i){var e;const t=(e=i[RM])!==null&&e!==void 0?e:"";i[RM]=(t+` ${xq}`).trimStart()}function bq(i){return i!==null&&typeof i=="object"&&i instanceof rT}function Mq(i){return Na(this,arguments,function*(t,n=100){let r,s=0;for(;s<n;){const a=yield hn(t.listTools({cursor:r}));for(const c of a.tools)yield yield hn(c),s++;if(!a.nextCursor)break;r=a.nextCursor}})}class rT{constructor(e=[],t){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=t}static create(e,t){return new rT(e,t)}async initialize(){var e,t,n,r;if(this.mcpTools.length>0)return;const s={},a=[];for(const m of this.mcpClients)try{for(var c=!0,d=(t=void 0,Da(Mq(m))),p;p=await d.next(),e=p.done,!e;c=!0){r=p.value,c=!1;const v=r;a.push(v);const _=v.name;if(s[_])throw new Error(`Duplicate function name ${_} found in MCP tools. Please ensure function names are unique.`);s[_]=m}}catch(v){t={error:v}}finally{try{!c&&!e&&(n=d.return)&&await n.call(d)}finally{if(t)throw t.error}}this.mcpTools=a,this.functionNameToMcpClient=s}async tool(){return await this.initialize(),eG(this.mcpTools,this.config)}async callTool(e){await this.initialize();const t=[];for(const n of e)if(n.name in this.functionNameToMcpClient){const r=this.functionNameToMcpClient[n.name];let s;this.config.timeout&&(s={timeout:this.config.timeout});const a=await r.callTool({name:n.name,arguments:n.args},void 0,s);t.push({functionResponse:{name:n.name,response:a.isError?{error:a}:a}})}return t}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function Eq(i,e,t){const n=new XH;let r;t.data instanceof Blob?r=JSON.parse(await t.data.text()):r=JSON.parse(t.data),Object.assign(n,r),e(n)}class Tq{constructor(e,t,n){this.apiClient=e,this.auth=t,this.webSocketFactory=n}async connect(e){var t,n;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const r=this.apiClient.getWebsocketBaseUrl(),s=this.apiClient.getApiVersion(),a=Cq(this.apiClient.getDefaultHeaders()),c=this.apiClient.getApiKey(),d=`${r}/ws/google.ai.generativelanguage.${s}.GenerativeService.BidiGenerateMusic?key=${c}`;let p=()=>{};const m=new Promise(U=>{p=U}),v=e.callbacks,_=function(){p({})},b=this.apiClient,T={onopen:_,onmessage:U=>{Eq(b,v.onmessage,U)},onerror:(t=v==null?void 0:v.onerror)!==null&&t!==void 0?t:function(U){},onclose:(n=v==null?void 0:v.onclose)!==null&&n!==void 0?n:function(U){}},I=this.webSocketFactory.create(d,wq(a),T);I.connect(),await m;const D={setup:{model:ei(this.apiClient,e.model)}};return I.send(JSON.stringify(D)),new Aq(I,this.apiClient)}}class Aq{constructor(e,t){this.conn=e,this.apiClient=t}async setWeightedPrompts(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const t=K6(e);this.conn.send(JSON.stringify({clientContent:t}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const t=$6(e);this.conn.send(JSON.stringify(t))}sendPlaybackControl(e){const t={playbackControl:e};this.conn.send(JSON.stringify(t))}play(){this.sendPlaybackControl(Fh.PLAY)}pause(){this.sendPlaybackControl(Fh.PAUSE)}stop(){this.sendPlaybackControl(Fh.STOP)}resetContext(){this.sendPlaybackControl(Fh.RESET_CONTEXT)}close(){this.conn.close()}}function wq(i){const e={};return i.forEach((t,n)=>{e[n]=t}),e}function Cq(i){const e=new Headers;for(const[t,n]of Object.entries(i))e.append(t,n);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Rq="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function Iq(i,e,t){const n=new WH;let r;t.data instanceof Blob?r=await t.data.text():t.data instanceof ArrayBuffer?r=new TextDecoder().decode(t.data):r=t.data;const s=JSON.parse(r);if(i.isVertexAI()){const a=e8(s);Object.assign(n,a)}else Object.assign(n,s);e(n)}class Nq{constructor(e,t,n){this.apiClient=e,this.auth=t,this.webSocketFactory=n,this.music=new Tq(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var t,n,r,s,a,c;if(e.config&&e.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const d=this.apiClient.getWebsocketBaseUrl(),p=this.apiClient.getApiVersion();let m;const v=this.apiClient.getHeaders();e.config&&e.config.tools&&X3(e.config.tools)&&Y3(v);const _=Lq(v);if(this.apiClient.isVertexAI())m=`${d}/ws/google.cloud.aiplatform.${p}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(_,m);else{const P=this.apiClient.getApiKey();let O="BidiGenerateContent",Z="key";P!=null&&P.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),p!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),O="BidiGenerateContentConstrained",Z="access_token"),m=`${d}/ws/google.ai.generativelanguage.${p}.GenerativeService.${O}?${Z}=${P}`}let b=()=>{};const T=new Promise(P=>{b=P}),I=e.callbacks,C=function(){var P;(P=I==null?void 0:I.onopen)===null||P===void 0||P.call(I),b({})},A=this.apiClient,D={onopen:C,onmessage:P=>{Iq(A,I.onmessage,P)},onerror:(t=I==null?void 0:I.onerror)!==null&&t!==void 0?t:function(P){},onclose:(n=I==null?void 0:I.onclose)!==null&&n!==void 0?n:function(P){}},U=this.webSocketFactory.create(m,Pq(_),D);U.connect(),await T;let L=ei(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&L.startsWith("publishers/")){const P=this.apiClient.getProject(),O=this.apiClient.getLocation();L=`projects/${P}/locations/${O}/`+L}let z={};this.apiClient.isVertexAI()&&((r=e.config)===null||r===void 0?void 0:r.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[$_.AUDIO]}:e.config.responseModalities=[$_.AUDIO]),!((s=e.config)===null||s===void 0)&&s.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const B=(c=(a=e.config)===null||a===void 0?void 0:a.tools)!==null&&c!==void 0?c:[],k=[];for(const P of B)if(this.isCallableTool(P)){const O=P;k.push(await O.tool())}else k.push(P);k.length>0&&(e.config.tools=k);const G={model:L,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?z=Z6(this.apiClient,G):z=J6(this.apiClient,G),delete z.config,U.send(JSON.stringify(z)),new Uq(U,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}}const Dq={turnComplete:!0};class Uq{constructor(e,t){this.conn=e,this.apiClient=t}tLiveClientContent(e,t){if(t.turns!==null&&t.turns!==void 0){let n=[];try{n=ia(t.turns),e.isVertexAI()||(n=n.map(r=>Xx(r)))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof t.turns}'`)}return{clientContent:{turns:n,turnComplete:t.turnComplete}}}return{clientContent:{turnComplete:t.turnComplete}}}tLiveClienttToolResponse(e,t){let n=[];if(t.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(t.functionResponses)?n=t.functionResponses:n=[t.functionResponses],n.length===0)throw new Error("functionResponses is required.");for(const s of n){if(typeof s!="object"||s===null||!("name"in s)||!("response"in s))throw new Error(`Could not parse function response, type '${typeof s}'.`);if(!e.isVertexAI()&&!("id"in s))throw new Error(Rq)}return{toolResponse:{functionResponses:n}}}sendClientContent(e){e=Object.assign(Object.assign({},Dq),e);const t=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(t))}sendRealtimeInput(e){let t={};this.apiClient.isVertexAI()?t={realtimeInput:j6(e)}:t={realtimeInput:Q6(e)},this.conn.send(JSON.stringify(t))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const t=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(t))}close(){this.conn.close()}}function Pq(i){const e={};return i.forEach((t,n)=>{e[n]=t}),e}function Lq(i){const e=new Headers;for(const[t,n]of Object.entries(i))e.append(t,n);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const RC=10;function IC(i){var e,t,n;if(!((e=i==null?void 0:i.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let r=!1;for(const a of(t=i==null?void 0:i.tools)!==null&&t!==void 0?t:[])if(Hh(a)){r=!0;break}if(!r)return!0;const s=(n=i==null?void 0:i.automaticFunctionCalling)===null||n===void 0?void 0:n.maximumRemoteCalls;return s&&(s<0||!Number.isInteger(s))||s==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",s),!0):!1}function Hh(i){return"callTool"in i&&typeof i.callTool=="function"}function Fq(i){var e,t,n;return(n=(t=(e=i.config)===null||e===void 0?void 0:e.tools)===null||t===void 0?void 0:t.some(r=>Hh(r)))!==null&&n!==void 0?n:!1}function NC(i){var e;const t=[];return!((e=i==null?void 0:i.config)===null||e===void 0)&&e.tools&&i.config.tools.forEach((n,r)=>{if(Hh(n))return;const s=n;s.functionDeclarations&&s.functionDeclarations.length>0&&t.push(r)}),t}function DC(i){var e;return!(!((e=i==null?void 0:i.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class kq extends vu{constructor(e){super(),this.apiClient=e,this.generateContent=async t=>{var n,r,s,a,c;const d=await this.processParamsMaybeAddMcpUsage(t);if(this.maybeMoveToResponseJsonSchem(t),!Fq(t)||IC(t.config))return await this.generateContentInternal(d);const p=NC(t);if(p.length>0){const I=p.map(C=>`tools[${C}]`).join(", ");throw new Error(`Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations is not yet supported. Incompatible tools found at ${I}.`)}let m,v;const _=ia(d.contents),b=(s=(r=(n=d.config)===null||n===void 0?void 0:n.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls)!==null&&s!==void 0?s:RC;let T=0;for(;T<b&&(m=await this.generateContentInternal(d),!(!m.functionCalls||m.functionCalls.length===0));){const I=m.candidates[0].content,C=[];for(const A of(c=(a=t.config)===null||a===void 0?void 0:a.tools)!==null&&c!==void 0?c:[])if(Hh(A)){const U=await A.callTool(m.functionCalls);C.push(...U)}T++,v={role:"user",parts:C},d.contents=ia(d.contents),d.contents.push(I),d.contents.push(v),DC(d.config)&&(_.push(I),_.push(v))}return DC(d.config)&&(m.automaticFunctionCallingHistory=_),m},this.generateContentStream=async t=>{var n,r,s,a,c;if(this.maybeMoveToResponseJsonSchem(t),IC(t.config)){const v=await this.processParamsMaybeAddMcpUsage(t);return await this.generateContentStreamInternal(v)}const d=NC(t);if(d.length>0){const v=d.map(_=>`tools[${_}]`).join(", ");throw new Error(`Incompatible tools found at ${v}. Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations" is not yet supported.`)}const p=(s=(r=(n=t==null?void 0:t.config)===null||n===void 0?void 0:n.toolConfig)===null||r===void 0?void 0:r.functionCallingConfig)===null||s===void 0?void 0:s.streamFunctionCallArguments,m=(c=(a=t==null?void 0:t.config)===null||a===void 0?void 0:a.automaticFunctionCalling)===null||c===void 0?void 0:c.disable;if(p&&!m)throw new Error("Running in streaming mode with 'streamFunctionCallArguments' enabled, this feature is not compatible with automatic function calling (AFC). Please set 'config.automaticFunctionCalling.disable' to true to disable AFC or leave 'config.toolConfig.functionCallingConfig.streamFunctionCallArguments' to be undefined or set to false to disable streaming function call arguments feature.");return await this.processAfcStream(t)},this.generateImages=async t=>await this.generateImagesInternal(t).then(n=>{var r;let s;const a=[];if(n!=null&&n.generatedImages)for(const d of n.generatedImages)d&&(d!=null&&d.safetyAttributes)&&((r=d==null?void 0:d.safetyAttributes)===null||r===void 0?void 0:r.contentType)==="Positive Prompt"?s=d==null?void 0:d.safetyAttributes:a.push(d);let c;return s?c={generatedImages:a,positivePromptSafetyAttributes:s,sdkHttpResponse:n.sdkHttpResponse}:c={generatedImages:a,sdkHttpResponse:n.sdkHttpResponse},c}),this.list=async t=>{var n;const a={config:Object.assign(Object.assign({},{queryBase:!0}),t==null?void 0:t.config)};if(this.apiClient.isVertexAI()&&!a.config.queryBase){if(!((n=a.config)===null||n===void 0)&&n.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");a.config.filter="labels.tune-type:*"}return new td(pu.PAGED_ITEM_MODELS,c=>this.listInternal(c),await this.listInternal(a),a)},this.editImage=async t=>{const n={model:t.model,prompt:t.prompt,referenceImages:[],config:t.config};return t.referenceImages&&t.referenceImages&&(n.referenceImages=t.referenceImages.map(r=>r.toReferenceImageAPI())),await this.editImageInternal(n)},this.upscaleImage=async t=>{let n={numberOfImages:1,mode:"upscale"};t.config&&(n=Object.assign(Object.assign({},n),t.config));const r={model:t.model,image:t.image,upscaleFactor:t.upscaleFactor,config:n};return await this.upscaleImageInternal(r)},this.generateVideos=async t=>{var n,r,s,a,c,d;if((t.prompt||t.image||t.video)&&t.source)throw new Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return this.apiClient.isVertexAI()||(!((n=t.video)===null||n===void 0)&&n.uri&&(!((r=t.video)===null||r===void 0)&&r.videoBytes)?t.video={uri:t.video.uri,mimeType:t.video.mimeType}:!((a=(s=t.source)===null||s===void 0?void 0:s.video)===null||a===void 0)&&a.uri&&(!((d=(c=t.source)===null||c===void 0?void 0:c.video)===null||d===void 0)&&d.videoBytes)&&(t.source.video={uri:t.source.video.uri,mimeType:t.source.video.mimeType})),await this.generateVideosInternal(t)}}maybeMoveToResponseJsonSchem(e){e.config&&e.config.responseSchema&&(e.config.responseJsonSchema||Object.keys(e.config.responseSchema).includes("$schema")&&(e.config.responseJsonSchema=e.config.responseSchema,delete e.config.responseSchema))}async processParamsMaybeAddMcpUsage(e){var t,n,r;const s=(t=e.config)===null||t===void 0?void 0:t.tools;if(!s)return e;const a=await Promise.all(s.map(async d=>Hh(d)?await d.tool():d)),c={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:a})};if(c.config.tools=a,e.config&&e.config.tools&&X3(e.config.tools)){const d=(r=(n=e.config.httpOptions)===null||n===void 0?void 0:n.headers)!==null&&r!==void 0?r:{};let p=Object.assign({},d);Object.keys(p).length===0&&(p=this.apiClient.getDefaultHeaders()),Y3(p),c.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:p})}return c}async initAfcToolsMap(e){var t,n,r;const s=new Map;for(const a of(n=(t=e.config)===null||t===void 0?void 0:t.tools)!==null&&n!==void 0?n:[])if(Hh(a)){const c=a,d=await c.tool();for(const p of(r=d.functionDeclarations)!==null&&r!==void 0?r:[]){if(!p.name)throw new Error("Function declaration name is required.");if(s.has(p.name))throw new Error(`Duplicate tool declaration name: ${p.name}`);s.set(p.name,c)}}return s}async processAfcStream(e){var t,n,r;const s=(r=(n=(t=e.config)===null||t===void 0?void 0:t.automaticFunctionCalling)===null||n===void 0?void 0:n.maximumRemoteCalls)!==null&&r!==void 0?r:RC;let a=!1,c=0;const d=await this.initAfcToolsMap(e);return(function(p,m,v){return Na(this,arguments,function*(){for(var _,b,T,I,C,A;c<s;){a&&(c++,a=!1);const z=yield hn(p.processParamsMaybeAddMcpUsage(v)),B=yield hn(p.generateContentStreamInternal(z)),k=[],G=[];try{for(var D=!0,U=(b=void 0,Da(B)),L;L=yield hn(U.next()),_=L.done,!_;D=!0){I=L.value,D=!1;const P=I;if(yield yield hn(P),P.candidates&&(!((C=P.candidates[0])===null||C===void 0)&&C.content)){G.push(P.candidates[0].content);for(const O of(A=P.candidates[0].content.parts)!==null&&A!==void 0?A:[])if(c<s&&O.functionCall){if(!O.functionCall.name)throw new Error("Function call name was not returned by the model.");if(m.has(O.functionCall.name)){const Z=yield hn(m.get(O.functionCall.name).callTool([O.functionCall]));k.push(...Z)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${m.keys()}, mising tool: ${O.functionCall.name}`)}}}}catch(P){b={error:P}}finally{try{!D&&!_&&(T=U.return)&&(yield hn(T.call(U)))}finally{if(b)throw b.error}}if(k.length>0){a=!0;const P=new Qm;P.candidates=[{content:{role:"user",parts:k}}],yield yield hn(P);const O=[];O.push(...G),O.push({role:"user",parts:k});const Z=ia(v.contents).concat(O);v.contents=Z}else break}})})(this,d,e)}async generateContentInternal(e){var t,n,r,s;let a,c="",d={};if(this.apiClient.isVertexAI()){const p=TC(this.apiClient,e);return c=Ft("{model}:generateContent",p._url),d=p._query,delete p._url,delete p._query,a=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(m=>m.json().then(v=>{const _=v;return _.sdkHttpResponse={headers:m.headers},_})),a.then(m=>{const v=wC(m),_=new Qm;return Object.assign(_,v),_})}else{const p=EC(this.apiClient,e);return c=Ft("{model}:generateContent",p._url),d=p._query,delete p._url,delete p._query,a=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json().then(v=>{const _=v;return _.sdkHttpResponse={headers:m.headers},_})),a.then(m=>{const v=AC(m),_=new Qm;return Object.assign(_,v),_})}}async generateContentStreamInternal(e){var t,n,r,s;let a,c="",d={};if(this.apiClient.isVertexAI()){const p=TC(this.apiClient,e);return c=Ft("{model}:streamGenerateContent?alt=sse",p._url),d=p._query,delete p._url,delete p._query,a=this.apiClient.requestStream({path:c,queryParams:d,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}),a.then(function(v){return Na(this,arguments,function*(){var _,b,T,I;try{for(var C=!0,A=Da(v),D;D=yield hn(A.next()),_=D.done,!_;C=!0){I=D.value,C=!1;const U=I,L=wC(yield hn(U.json()));L.sdkHttpResponse={headers:U.headers};const z=new Qm;Object.assign(z,L),yield yield hn(z)}}catch(U){b={error:U}}finally{try{!C&&!_&&(T=A.return)&&(yield hn(T.call(A)))}finally{if(b)throw b.error}}})})}else{const p=EC(this.apiClient,e);return c=Ft("{model}:streamGenerateContent?alt=sse",p._url),d=p._query,delete p._url,delete p._query,a=this.apiClient.requestStream({path:c,queryParams:d,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}),a.then(function(v){return Na(this,arguments,function*(){var _,b,T,I;try{for(var C=!0,A=Da(v),D;D=yield hn(A.next()),_=D.done,!_;C=!0){I=D.value,C=!1;const U=I,L=AC(yield hn(U.json()));L.sdkHttpResponse={headers:U.headers};const z=new Qm;Object.assign(z,L),yield yield hn(z)}}catch(U){b={error:U}}finally{try{!C&&!_&&(T=A.return)&&(yield hn(T.call(A)))}finally{if(b)throw b.error}}})})}}async embedContent(e){var t,n,r,s;let a,c="",d={};if(this.apiClient.isVertexAI()){const p=N8(this.apiClient,e);return c=Ft("{model}:predict",p._url),d=p._query,delete p._url,delete p._query,a=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(m=>m.json().then(v=>{const _=v;return _.sdkHttpResponse={headers:m.headers},_})),a.then(m=>{const v=U8(m),_=new aC;return Object.assign(_,v),_})}else{const p=I8(this.apiClient,e);return c=Ft("{model}:batchEmbedContents",p._url),d=p._query,delete p._url,delete p._query,a=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json().then(v=>{const _=v;return _.sdkHttpResponse={headers:m.headers},_})),a.then(m=>{const v=D8(m),_=new aC;return Object.assign(_,v),_})}}async generateImagesInternal(e){var t,n,r,s;let a,c="",d={};if(this.apiClient.isVertexAI()){const p=q8(this.apiClient,e);return c=Ft("{model}:predict",p._url),d=p._query,delete p._url,delete p._query,a=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(m=>m.json().then(v=>{const _=v;return _.sdkHttpResponse={headers:m.headers},_})),a.then(m=>{const v=X8(m),_=new lC;return Object.assign(_,v),_})}else{const p=G8(this.apiClient,e);return c=Ft("{model}:predict",p._url),d=p._query,delete p._url,delete p._query,a=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json().then(v=>{const _=v;return _.sdkHttpResponse={headers:m.headers},_})),a.then(m=>{const v=W8(m),_=new lC;return Object.assign(_,v),_})}}async editImageInternal(e){var t,n;let r,s="",a={};if(this.apiClient.isVertexAI()){const c=A8(this.apiClient,e);return s=Ft("{model}:predict",c._url),a=c._query,delete c._url,delete c._query,r=this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:d.headers},m})),r.then(d=>{const p=w8(d),m=new PH;return Object.assign(m,p),m})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var t,n;let r,s="",a={};if(this.apiClient.isVertexAI()){const c=q9(this.apiClient,e);return s=Ft("{model}:predict",c._url),a=c._query,delete c._url,delete c._query,r=this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:d.headers},m})),r.then(d=>{const p=W9(d),m=new LH;return Object.assign(m,p),m})}else throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(e){var t,n;let r,s="",a={};if(this.apiClient.isVertexAI()){const c=T9(this.apiClient,e);return s=Ft("{model}:predict",c._url),a=c._query,delete c._url,delete c._query,r=this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),r.then(d=>{const p=A9(d),m=new FH;return Object.assign(m,p),m})}else throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(e){var t,n;let r,s="",a={};if(this.apiClient.isVertexAI()){const c=D9(this.apiClient,e);return s=Ft("{model}:predict",c._url),a=c._query,delete c._url,delete c._query,r=this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),r.then(d=>{const p=U9(d),m=new kH;return Object.assign(m,p),m})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var t,n,r,s;let a,c="",d={};if(this.apiClient.isVertexAI()){const p=u9(this.apiClient,e);return c=Ft("{name}",p._url),d=p._query,delete p._url,delete p._query,a=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(m=>m.json()),a.then(m=>CM(m))}else{const p=l9(this.apiClient,e);return c=Ft("{name}",p._url),d=p._query,delete p._url,delete p._query,a=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json()),a.then(m=>wM(m))}}async listInternal(e){var t,n,r,s;let a,c="",d={};if(this.apiClient.isVertexAI()){const p=y9(this.apiClient,e);return c=Ft("{models_url}",p._url),d=p._query,delete p._url,delete p._query,a=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(m=>m.json().then(v=>{const _=v;return _.sdkHttpResponse={headers:m.headers},_})),a.then(m=>{const v=x9(m),_=new uC;return Object.assign(_,v),_})}else{const p=v9(this.apiClient,e);return c=Ft("{models_url}",p._url),d=p._query,delete p._url,delete p._query,a=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json().then(v=>{const _=v;return _.sdkHttpResponse={headers:m.headers},_})),a.then(m=>{const v=_9(m),_=new uC;return Object.assign(_,v),_})}}async update(e){var t,n,r,s;let a,c="",d={};if(this.apiClient.isVertexAI()){const p=H9(this.apiClient,e);return c=Ft("{model}",p._url),d=p._query,delete p._url,delete p._query,a=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(p),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(m=>m.json()),a.then(m=>CM(m))}else{const p=V9(this.apiClient,e);return c=Ft("{name}",p._url),d=p._query,delete p._url,delete p._query,a=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(p),httpMethod:"PATCH",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json()),a.then(m=>wM(m))}}async delete(e){var t,n,r,s;let a,c="",d={};if(this.apiClient.isVertexAI()){const p=b8(this.apiClient,e);return c=Ft("{name}",p._url),d=p._query,delete p._url,delete p._query,a=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(m=>m.json().then(v=>{const _=v;return _.sdkHttpResponse={headers:m.headers},_})),a.then(m=>{const v=E8(m),_=new cC;return Object.assign(_,v),_})}else{const p=S8(this.apiClient,e);return c=Ft("{name}",p._url),d=p._query,delete p._url,delete p._query,a=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(p),httpMethod:"DELETE",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json().then(v=>{const _=v;return _.sdkHttpResponse={headers:m.headers},_})),a.then(m=>{const v=M8(m),_=new cC;return Object.assign(_,v),_})}}async countTokens(e){var t,n,r,s;let a,c="",d={};if(this.apiClient.isVertexAI()){const p=y8(this.apiClient,e);return c=Ft("{model}:countTokens",p._url),d=p._query,delete p._url,delete p._query,a=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(m=>m.json().then(v=>{const _=v;return _.sdkHttpResponse={headers:m.headers},_})),a.then(m=>{const v=x8(m),_=new fC;return Object.assign(_,v),_})}else{const p=v8(this.apiClient,e);return c=Ft("{model}:countTokens",p._url),d=p._query,delete p._url,delete p._query,a=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json().then(v=>{const _=v;return _.sdkHttpResponse={headers:m.headers},_})),a.then(m=>{const v=_8(m),_=new fC;return Object.assign(_,v),_})}}async computeTokens(e){var t,n;let r,s="",a={};if(this.apiClient.isVertexAI()){const c=c8(this.apiClient,e);return s=Ft("{model}:computeTokens",c._url),a=c._query,delete c._url,delete c._query,r=this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:d.headers},m})),r.then(d=>{const p=f8(d),m=new OH;return Object.assign(m,p),m})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(e){var t,n,r,s;let a,c="",d={};if(this.apiClient.isVertexAI()){const p=Q8(this.apiClient,e);return c=Ft("{model}:predictLongRunning",p._url),d=p._query,delete p._url,delete p._query,a=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(m=>m.json()),a.then(m=>{const v=$8(m),_=new K_;return Object.assign(_,v),_})}else{const p=K8(this.apiClient,e);return c=Ft("{model}:predictLongRunning",p._url),d=p._query,delete p._url,delete p._query,a=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json()),a.then(m=>{const v=Z8(m),_=new K_;return Object.assign(_,v),_})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Oq extends vu{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const t=e.operation,n=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const r=t.name.split("/operations/")[0];let s;n&&"httpOptions"in n&&(s=n.httpOptions);const a=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:r,config:{httpOptions:s}});return t._fromAPIResponse({apiResponse:a,_isVertexAI:!0})}else{const r=await this.getVideosOperationInternal({operationName:t.name,config:n});return t._fromAPIResponse({apiResponse:r,_isVertexAI:!1})}}async get(e){const t=e.operation,n=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const r=t.name.split("/operations/")[0];let s;n&&"httpOptions"in n&&(s=n.httpOptions);const a=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:r,config:{httpOptions:s}});return t._fromAPIResponse({apiResponse:a,_isVertexAI:!0})}else{const r=await this.getVideosOperationInternal({operationName:t.name,config:n});return t._fromAPIResponse({apiResponse:r,_isVertexAI:!1})}}async getVideosOperationInternal(e){var t,n,r,s;let a,c="",d={};if(this.apiClient.isVertexAI()){const p=CH(e);return c=Ft("{operationName}",p._url),d=p._query,delete p._url,delete p._query,a=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(m=>m.json()),a}else{const p=wH(e);return c=Ft("{operationName}",p._url),d=p._query,delete p._url,delete p._query,a=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json()),a}}async fetchPredictVideosOperationInternal(e){var t,n;let r,s="",a={};if(this.apiClient.isVertexAI()){const c=xH(e);return s=Ft("{resourceName}:fetchPredictOperation",c._url),a=c._query,delete c._url,delete c._query,r=this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),r}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function zq(i){const e={},t=x(i,["data"]);if(t!=null&&S(e,["data"],t),x(i,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=x(i,["mimeType"]);return n!=null&&S(e,["mimeType"],n),e}function Bq(i){const e={},t=x(i,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(s=>Zq(s))),S(e,["parts"],r)}const n=x(i,["role"]);return n!=null&&S(e,["role"],n),e}function Vq(i,e,t){const n={},r=x(e,["expireTime"]);t!==void 0&&r!=null&&S(t,["expireTime"],r);const s=x(e,["newSessionExpireTime"]);t!==void 0&&s!=null&&S(t,["newSessionExpireTime"],s);const a=x(e,["uses"]);t!==void 0&&a!=null&&S(t,["uses"],a);const c=x(e,["liveConnectConstraints"]);t!==void 0&&c!=null&&S(t,["bidiGenerateContentSetup"],Jq(i,c));const d=x(e,["lockAdditionalFields"]);return t!==void 0&&d!=null&&S(t,["fieldMask"],d),n}function Hq(i,e){const t={},n=x(e,["config"]);return n!=null&&S(t,["config"],Vq(i,n,t)),t}function Gq(i){const e={};if(x(i,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=x(i,["fileUri"]);t!=null&&S(e,["fileUri"],t);const n=x(i,["mimeType"]);return n!=null&&S(e,["mimeType"],n),e}function qq(i){const e={},t=x(i,["id"]);t!=null&&S(e,["id"],t);const n=x(i,["args"]);n!=null&&S(e,["args"],n);const r=x(i,["name"]);if(r!=null&&S(e,["name"],r),x(i,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(x(i,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function Wq(i){const e={};if(x(i,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=x(i,["enableWidget"]);return t!=null&&S(e,["enableWidget"],t),e}function Xq(i){const e={};if(x(i,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(x(i,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=x(i,["timeRangeFilter"]);return t!=null&&S(e,["timeRangeFilter"],t),e}function Yq(i,e){const t={},n=x(i,["generationConfig"]);e!==void 0&&n!=null&&S(e,["setup","generationConfig"],n);const r=x(i,["responseModalities"]);e!==void 0&&r!=null&&S(e,["setup","generationConfig","responseModalities"],r);const s=x(i,["temperature"]);e!==void 0&&s!=null&&S(e,["setup","generationConfig","temperature"],s);const a=x(i,["topP"]);e!==void 0&&a!=null&&S(e,["setup","generationConfig","topP"],a);const c=x(i,["topK"]);e!==void 0&&c!=null&&S(e,["setup","generationConfig","topK"],c);const d=x(i,["maxOutputTokens"]);e!==void 0&&d!=null&&S(e,["setup","generationConfig","maxOutputTokens"],d);const p=x(i,["mediaResolution"]);e!==void 0&&p!=null&&S(e,["setup","generationConfig","mediaResolution"],p);const m=x(i,["seed"]);e!==void 0&&m!=null&&S(e,["setup","generationConfig","seed"],m);const v=x(i,["speechConfig"]);e!==void 0&&v!=null&&S(e,["setup","generationConfig","speechConfig"],iT(v));const _=x(i,["thinkingConfig"]);e!==void 0&&_!=null&&S(e,["setup","generationConfig","thinkingConfig"],_);const b=x(i,["enableAffectiveDialog"]);e!==void 0&&b!=null&&S(e,["setup","generationConfig","enableAffectiveDialog"],b);const T=x(i,["systemInstruction"]);e!==void 0&&T!=null&&S(e,["setup","systemInstruction"],Bq(ms(T)));const I=x(i,["tools"]);if(e!==void 0&&I!=null){let B=lp(I);Array.isArray(B)&&(B=B.map(k=>Kq(ap(k)))),S(e,["setup","tools"],B)}const C=x(i,["sessionResumption"]);e!==void 0&&C!=null&&S(e,["setup","sessionResumption"],$q(C));const A=x(i,["inputAudioTranscription"]);e!==void 0&&A!=null&&S(e,["setup","inputAudioTranscription"],A);const D=x(i,["outputAudioTranscription"]);e!==void 0&&D!=null&&S(e,["setup","outputAudioTranscription"],D);const U=x(i,["realtimeInputConfig"]);e!==void 0&&U!=null&&S(e,["setup","realtimeInputConfig"],U);const L=x(i,["contextWindowCompression"]);e!==void 0&&L!=null&&S(e,["setup","contextWindowCompression"],L);const z=x(i,["proactivity"]);if(e!==void 0&&z!=null&&S(e,["setup","proactivity"],z),x(i,["explicitVadSignal"])!==void 0)throw new Error("explicitVadSignal parameter is not supported in Gemini API.");return t}function Jq(i,e){const t={},n=x(e,["model"]);n!=null&&S(t,["setup","model"],ei(i,n));const r=x(e,["config"]);return r!=null&&S(t,["config"],Yq(r,t)),t}function Zq(i){const e={},t=x(i,["mediaResolution"]);t!=null&&S(e,["mediaResolution"],t);const n=x(i,["codeExecutionResult"]);n!=null&&S(e,["codeExecutionResult"],n);const r=x(i,["executableCode"]);r!=null&&S(e,["executableCode"],r);const s=x(i,["fileData"]);s!=null&&S(e,["fileData"],Gq(s));const a=x(i,["functionCall"]);a!=null&&S(e,["functionCall"],qq(a));const c=x(i,["functionResponse"]);c!=null&&S(e,["functionResponse"],c);const d=x(i,["inlineData"]);d!=null&&S(e,["inlineData"],zq(d));const p=x(i,["text"]);p!=null&&S(e,["text"],p);const m=x(i,["thought"]);m!=null&&S(e,["thought"],m);const v=x(i,["thoughtSignature"]);v!=null&&S(e,["thoughtSignature"],v);const _=x(i,["videoMetadata"]);return _!=null&&S(e,["videoMetadata"],_),e}function $q(i){const e={},t=x(i,["handle"]);if(t!=null&&S(e,["handle"],t),x(i,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function Kq(i){const e={};if(x(i,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const t=x(i,["computerUse"]);t!=null&&S(e,["computerUse"],t);const n=x(i,["fileSearch"]);n!=null&&S(e,["fileSearch"],n);const r=x(i,["codeExecution"]);if(r!=null&&S(e,["codeExecution"],r),x(i,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const s=x(i,["functionDeclarations"]);if(s!=null){let m=s;Array.isArray(m)&&(m=m.map(v=>v)),S(e,["functionDeclarations"],m)}const a=x(i,["googleMaps"]);a!=null&&S(e,["googleMaps"],Wq(a));const c=x(i,["googleSearch"]);c!=null&&S(e,["googleSearch"],Xq(c));const d=x(i,["googleSearchRetrieval"]);d!=null&&S(e,["googleSearchRetrieval"],d);const p=x(i,["urlContext"]);return p!=null&&S(e,["urlContext"],p),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Qq(i){const e=[];for(const t in i)if(Object.prototype.hasOwnProperty.call(i,t)){const n=i[t];if(typeof n=="object"&&n!=null&&Object.keys(n).length>0){const r=Object.keys(n).map(s=>`${t}.${s}`);e.push(...r)}else e.push(t)}return e.join(",")}function jq(i,e){let t=null;const n=i.bidiGenerateContentSetup;if(typeof n=="object"&&n!==null&&"setup"in n){const s=n.setup;typeof s=="object"&&s!==null?(i.bidiGenerateContentSetup=s,t=s):delete i.bidiGenerateContentSetup}else n!==void 0&&delete i.bidiGenerateContentSetup;const r=i.fieldMask;if(t){const s=Qq(t);if(Array.isArray(e==null?void 0:e.lockAdditionalFields)&&(e==null?void 0:e.lockAdditionalFields.length)===0)s?i.fieldMask=s:delete i.fieldMask;else if(e!=null&&e.lockAdditionalFields&&e.lockAdditionalFields.length>0&&r!==null&&Array.isArray(r)&&r.length>0){const a=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let c=[];r.length>0&&(c=r.map(p=>a.includes(p)?`generationConfig.${p}`:p));const d=[];s&&d.push(s),c.length>0&&d.push(...c),d.length>0?i.fieldMask=d.join(","):delete i.fieldMask}else delete i.fieldMask}else r!==null&&Array.isArray(r)&&r.length>0?i.fieldMask=r.join(","):delete i.fieldMask;return i}class e7 extends vu{constructor(e){super(),this.apiClient=e}async create(e){var t,n;let r,s="",a={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const c=Hq(this.apiClient,e);s=Ft("auth_tokens",c._url),a=c._query,delete c.config,delete c._url,delete c._query;const d=jq(c,e.config);return r=this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(p=>p.json()),r.then(p=>p)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function t7(i,e){const t={},n=x(i,["force"]);return e!==void 0&&n!=null&&S(e,["_query","force"],n),t}function n7(i){const e={},t=x(i,["name"]);t!=null&&S(e,["_url","name"],t);const n=x(i,["config"]);return n!=null&&t7(n,e),e}function i7(i){const e={},t=x(i,["name"]);return t!=null&&S(e,["_url","name"],t),e}function r7(i,e){const t={},n=x(i,["pageSize"]);e!==void 0&&n!=null&&S(e,["_query","pageSize"],n);const r=x(i,["pageToken"]);return e!==void 0&&r!=null&&S(e,["_query","pageToken"],r),t}function s7(i){const e={},t=x(i,["parent"]);t!=null&&S(e,["_url","parent"],t);const n=x(i,["config"]);return n!=null&&r7(n,e),e}function o7(i){const e={},t=x(i,["sdkHttpResponse"]);t!=null&&S(e,["sdkHttpResponse"],t);const n=x(i,["nextPageToken"]);n!=null&&S(e,["nextPageToken"],n);const r=x(i,["documents"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(a=>a)),S(e,["documents"],s)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class a7 extends vu{constructor(e){super(),this.apiClient=e,this.list=async t=>new td(pu.PAGED_ITEM_DOCUMENTS,n=>this.listInternal({parent:t.parent,config:n.config}),await this.listInternal(t),t)}async get(e){var t,n;let r,s="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=i7(e);return s=Ft("{name}",c._url),a=c._query,delete c._url,delete c._query,r=this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),r.then(d=>d)}}async delete(e){var t,n;let r="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=n7(e);r=Ft("{name}",a._url),s=a._query,delete a._url,delete a._query,await this.apiClient.request({path:r,queryParams:s,body:JSON.stringify(a),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal})}}async listInternal(e){var t,n;let r,s="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=s7(e);return s=Ft("{parent}/documents",c._url),a=c._query,delete c._url,delete c._query,r=this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),r.then(d=>{const p=o7(d),m=new zH;return Object.assign(m,p),m})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class l7 extends vu{constructor(e,t=new a7(e)){super(),this.apiClient=e,this.documents=t,this.list=async(n={})=>new td(pu.PAGED_ITEM_FILE_SEARCH_STORES,r=>this.listInternal(r),await this.listInternal(n),n)}async uploadToFileSearchStore(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files to a file search store.");return this.apiClient.uploadFileToFileSearchStore(e.fileSearchStoreName,e.file,e.config)}async create(e){var t,n;let r,s="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=Q9(e);return s=Ft("fileSearchStores",c._url),a=c._query,delete c._url,delete c._query,r=this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),r.then(d=>d)}}async get(e){var t,n;let r,s="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=tq(e);return s=Ft("{name}",c._url),a=c._query,delete c._url,delete c._query,r=this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),r.then(d=>d)}}async delete(e){var t,n;let r="",s={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=eq(e);r=Ft("{name}",a._url),s=a._query,delete a._url,delete a._query,await this.apiClient.request({path:r,queryParams:s,body:JSON.stringify(a),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal})}}async listInternal(e){var t,n;let r,s="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=aq(e);return s=Ft("fileSearchStores",c._url),a=c._query,delete c._url,delete c._query,r=this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(c),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),r.then(d=>{const p=lq(d),m=new BH;return Object.assign(m,p),m})}}async uploadToFileSearchStoreInternal(e){var t,n;let r,s="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=uq(e);return s=Ft("upload/v1beta/{file_search_store_name}:uploadToFileSearchStore",c._url),a=c._query,delete c._url,delete c._query,r=this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),r.then(d=>{const p=cq(d),m=new VH;return Object.assign(m,p),m})}}async importFile(e){var t,n;let r,s="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=rq(e);return s=Ft("{file_search_store_name}:importFile",c._url),a=c._query,delete c._url,delete c._query,r=this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json()),r.then(d=>{const p=iq(d),m=new QE;return Object.assign(m,p),m})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let J3=function(){const{crypto:i}=globalThis;if(i!=null&&i.randomUUID)return J3=i.randomUUID.bind(i),i.randomUUID();const e=new Uint8Array(1),t=i?()=>i.getRandomValues(e)[0]:()=>Math.random()*255&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,n=>(+n^t()&15>>+n/4).toString(16))};const u7=()=>J3();/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function IM(i){return typeof i=="object"&&i!==null&&("name"in i&&i.name==="AbortError"||"message"in i&&String(i.message).includes("FetchRequestCanceledException"))}const NM=i=>{if(i instanceof Error)return i;if(typeof i=="object"&&i!==null){try{if(Object.prototype.toString.call(i)==="[object Error]"){const e=new Error(i.message,i.cause?{cause:i.cause}:{});return i.stack&&(e.stack=i.stack),i.cause&&!e.cause&&(e.cause=i.cause),i.name&&(e.name=i.name),e}}catch{}try{return new Error(JSON.stringify(i))}catch{}}return new Error(i)};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class ra extends Error{}class Ls extends ra{constructor(e,t,n,r){super(`${Ls.makeMessage(e,t,n)}`),this.status=e,this.headers=r,this.error=t}static makeMessage(e,t,n){const r=t!=null&&t.message?typeof t.message=="string"?t.message:JSON.stringify(t.message):t?JSON.stringify(t):n;return e&&r?`${e} ${r}`:e?`${e} status code (no body)`:r||"(no status code or body)"}static generate(e,t,n,r){if(!e||!r)return new Zx({message:n,cause:NM(t)});const s=t;return e===400?new $3(e,s,n,r):e===401?new K3(e,s,n,r):e===403?new Q3(e,s,n,r):e===404?new j3(e,s,n,r):e===409?new eN(e,s,n,r):e===422?new tN(e,s,n,r):e===429?new nN(e,s,n,r):e>=500?new iN(e,s,n,r):new Ls(e,s,n,r)}}class DM extends Ls{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}}class Zx extends Ls{constructor({message:e,cause:t}){super(void 0,void 0,e||"Connection error.",void 0),t&&(this.cause=t)}}class Z3 extends Zx{constructor({message:e}={}){super({message:e??"Request timed out."})}}class $3 extends Ls{}class K3 extends Ls{}class Q3 extends Ls{}class j3 extends Ls{}class eN extends Ls{}class tN extends Ls{}class nN extends Ls{}class iN extends Ls{}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const c7=/^[a-z][a-z0-9+.-]*:/i,f7=i=>c7.test(i);let UM=i=>(UM=Array.isArray,UM(i));const d7=UM;let h7=d7;const UC=h7;function p7(i){if(!i)return!0;for(const e in i)return!1;return!0}function m7(i,e){return Object.prototype.hasOwnProperty.call(i,e)}const g7=(i,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new ra(`${i} must be an integer`);if(e<0)throw new ra(`${i} must be a positive integer`);return e},v7=i=>{try{return JSON.parse(i)}catch{return}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const y7=i=>new Promise(e=>setTimeout(e,i));/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Dh="0.0.1";/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function _7(){return typeof Deno<"u"&&Deno.build!=null?"deno":typeof EdgeRuntime<"u"?"edge":Object.prototype.toString.call(typeof globalThis.process<"u"?globalThis.process:0)==="[object process]"?"node":"unknown"}const x7=()=>{var i,e,t,n,r;const s=_7();if(s==="deno")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Dh,"X-Stainless-OS":LC(Deno.build.os),"X-Stainless-Arch":PC(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:(e=(i=Deno.version)===null||i===void 0?void 0:i.deno)!==null&&e!==void 0?e:"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Dh,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if(s==="node")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Dh,"X-Stainless-OS":LC((t=globalThis.process.platform)!==null&&t!==void 0?t:"unknown"),"X-Stainless-Arch":PC((n=globalThis.process.arch)!==null&&n!==void 0?n:"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":(r=globalThis.process.version)!==null&&r!==void 0?r:"unknown"};const a=S7();return a?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Dh,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${a.browser}`,"X-Stainless-Runtime-Version":a.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Dh,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function S7(){if(typeof navigator>"u"||!navigator)return null;const i=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:t}of i){const n=t.exec(navigator.userAgent);if(n){const r=n[1]||0,s=n[2]||0,a=n[3]||0;return{browser:e,version:`${r}.${s}.${a}`}}}return null}const PC=i=>i==="x32"?"x32":i==="x86_64"||i==="x64"?"x64":i==="arm"?"arm":i==="aarch64"||i==="arm64"?"arm64":i?`other:${i}`:"unknown",LC=i=>(i=i.toLowerCase(),i.includes("ios")?"iOS":i==="android"?"Android":i==="darwin"?"MacOS":i==="win32"?"Windows":i==="freebsd"?"FreeBSD":i==="openbsd"?"OpenBSD":i==="linux"?"Linux":i?`Other:${i}`:"Unknown");let Oy;const b7=()=>Oy??(Oy=x7());/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function M7(){if(typeof fetch<"u")return fetch;throw new Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new GeminiNextGenAPIClient({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}function rN(...i){const e=globalThis.ReadableStream;if(typeof e>"u")throw new Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new e(...i)}function E7(i){let e=Symbol.asyncIterator in i?i[Symbol.asyncIterator]():i[Symbol.iterator]();return rN({start(){},async pull(t){const{done:n,value:r}=await e.next();n?t.close():t.enqueue(r)},async cancel(){var t;await((t=e.return)===null||t===void 0?void 0:t.call(e))}})}function sN(i){if(i[Symbol.asyncIterator])return i;const e=i.getReader();return{async next(){try{const t=await e.read();return t!=null&&t.done&&e.releaseLock(),t}catch(t){throw e.releaseLock(),t}},async return(){const t=e.cancel();return e.releaseLock(),await t,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}async function T7(i){var e,t;if(i===null||typeof i!="object")return;if(i[Symbol.asyncIterator]){await((t=(e=i[Symbol.asyncIterator]()).return)===null||t===void 0?void 0:t.call(e));return}const n=i.getReader(),r=n.cancel();n.releaseLock(),await r}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const A7=({headers:i,body:e})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(e)});/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const oN=()=>{var i;if(typeof File>"u"){const{process:e}=globalThis,t=typeof((i=e==null?void 0:e.versions)===null||i===void 0?void 0:i.node)=="string"&&parseInt(e.versions.node.split("."))<20;throw new Error("`File` is not defined as a global, which is required for file uploads."+(t?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function Xb(i,e,t){return oN(),new File(i,e??"unknown_file",t)}function w7(i){return(typeof i=="object"&&i!==null&&("name"in i&&i.name&&String(i.name)||"url"in i&&i.url&&String(i.url)||"filename"in i&&i.filename&&String(i.filename)||"path"in i&&i.path&&String(i.path))||"").split(/[\\/]/).pop()||void 0}const C7=i=>i!=null&&typeof i=="object"&&typeof i[Symbol.asyncIterator]=="function";/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const aN=i=>i!=null&&typeof i=="object"&&typeof i.size=="number"&&typeof i.type=="string"&&typeof i.text=="function"&&typeof i.slice=="function"&&typeof i.arrayBuffer=="function",R7=i=>i!=null&&typeof i=="object"&&typeof i.name=="string"&&typeof i.lastModified=="number"&&aN(i),I7=i=>i!=null&&typeof i=="object"&&typeof i.url=="string"&&typeof i.blob=="function";async function N7(i,e,t){if(oN(),i=await i,R7(i))return i instanceof File?i:Xb([await i.arrayBuffer()],i.name);if(I7(i)){const r=await i.blob();return e||(e=new URL(i.url).pathname.split(/[\\/]/).pop()),Xb(await PM(r),e,t)}const n=await PM(i);if(e||(e=w7(i)),!(t!=null&&t.type)){const r=n.find(s=>typeof s=="object"&&"type"in s&&s.type);typeof r=="string"&&(t=Object.assign(Object.assign({},t),{type:r}))}return Xb(n,e,t)}async function PM(i){var e,t,n,r,s;let a=[];if(typeof i=="string"||ArrayBuffer.isView(i)||i instanceof ArrayBuffer)a.push(i);else if(aN(i))a.push(i instanceof Blob?i:await i.arrayBuffer());else if(C7(i))try{for(var c=!0,d=Da(i),p;p=await d.next(),e=p.done,!e;c=!0){r=p.value,c=!1;const m=r;a.push(...await PM(m))}}catch(m){t={error:m}}finally{try{!c&&!e&&(n=d.return)&&await n.call(d)}finally{if(t)throw t.error}}else{const m=(s=i==null?void 0:i.constructor)===null||s===void 0?void 0:s.name;throw new Error(`Unexpected data type: ${typeof i}${m?`; constructor: ${m}`:""}${D7(i)}`)}return a}function D7(i){return typeof i!="object"||i===null?"":`; props: [${Object.getOwnPropertyNames(i).map(t=>`"${t}"`).join(", ")}]`}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class lN{constructor(e){this._client=e}}lN._key=[];/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function uN(i){return i.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}const FC=Object.freeze(Object.create(null)),U7=(i=uN)=>(function(t,...n){if(t.length===1)return t[0];let r=!1;const s=[],a=t.reduce((m,v,_)=>{var b,T,I;/[?#]/.test(v)&&(r=!0);const C=n[_];let A=(r?encodeURIComponent:i)(""+C);return _!==n.length&&(C==null||typeof C=="object"&&C.toString===((I=Object.getPrototypeOf((T=Object.getPrototypeOf((b=C.hasOwnProperty)!==null&&b!==void 0?b:FC))!==null&&T!==void 0?T:FC))===null||I===void 0?void 0:I.toString))&&(A=C+"",s.push({start:m.length+v.length,length:A.length,error:`Value of type ${Object.prototype.toString.call(C).slice(8,-1)} is not a valid path parameter`})),m+v+(_===n.length?"":A)},""),c=a.split(/[?#]/,1)[0],d=new RegExp("(?<=^|\\/)(?:\\.|%2e){1,2}(?=\\/|$)","gi");let p;for(;(p=d.exec(c))!==null;)s.push({start:p.index,length:p[0].length,error:`Value "${p[0]}" can't be safely passed as a path parameter`});if(s.sort((m,v)=>m.start-v.start),s.length>0){let m=0;const v=s.reduce((_,b)=>{const T=" ".repeat(b.start-m),I="^".repeat(b.length);return m=b.start+b.length,_+T+I},"");throw new ra(`Path parameters result in path with invalid segments:
${s.map(_=>_.error).join(`
`)}
${a}
${v}`)}return a}),zy=U7(uN);/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class cN extends lN{create(e,t){var n;const{api_version:r=this._client.apiVersion}=e,s=j_(e,["api_version"]);if("model"in s&&"agent_config"in s)throw new ra("Invalid request: specified `model` and `agent_config`. If specifying `model`, use `generation_config`.");if("agent"in s&&"generation_config"in s)throw new ra("Invalid request: specified `agent` and `generation_config`. If specifying `agent`, use `agent_config`.");return this._client.post(zy`/${r}/interactions`,Object.assign(Object.assign({body:s},t),{stream:(n=e.stream)!==null&&n!==void 0?n:!1}))}delete(e,t={},n){const{api_version:r=this._client.apiVersion}=t??{};return this._client.delete(zy`/${r}/interactions/${e}`,n)}cancel(e,t={},n){const{api_version:r=this._client.apiVersion}=t??{};return this._client.post(zy`/${r}/interactions/${e}/cancel`,n)}get(e,t={},n){var r;const s=t??{},{api_version:a=this._client.apiVersion}=s,c=j_(s,["api_version"]);return this._client.get(zy`/${a}/interactions/${e}`,Object.assign(Object.assign({query:c},n),{stream:(r=t==null?void 0:t.stream)!==null&&r!==void 0?r:!1}))}}cN._key=Object.freeze(["interactions"]);class fN extends cN{}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function P7(i){let e=0;for(const r of i)e+=r.length;const t=new Uint8Array(e);let n=0;for(const r of i)t.set(r,n),n+=r.length;return t}let By;function sT(i){let e;return(By??(e=new globalThis.TextEncoder,By=e.encode.bind(e)))(i)}let Vy;function kC(i){let e;return(Vy??(e=new globalThis.TextDecoder,Vy=e.decode.bind(e)))(i)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class $x{constructor(){this.buffer=new Uint8Array,this.carriageReturnIndex=null}decode(e){if(e==null)return[];const t=e instanceof ArrayBuffer?new Uint8Array(e):typeof e=="string"?sT(e):e;this.buffer=P7([this.buffer,t]);const n=[];let r;for(;(r=L7(this.buffer,this.carriageReturnIndex))!=null;){if(r.carriage&&this.carriageReturnIndex==null){this.carriageReturnIndex=r.index;continue}if(this.carriageReturnIndex!=null&&(r.index!==this.carriageReturnIndex+1||r.carriage)){n.push(kC(this.buffer.subarray(0,this.carriageReturnIndex-1))),this.buffer=this.buffer.subarray(this.carriageReturnIndex),this.carriageReturnIndex=null;continue}const s=this.carriageReturnIndex!==null?r.preceding-1:r.preceding,a=kC(this.buffer.subarray(0,s));n.push(a),this.buffer=this.buffer.subarray(r.index),this.carriageReturnIndex=null}return n}flush(){return this.buffer.length?this.decode(`
`):[]}}$x.NEWLINE_CHARS=new Set([`
`,"\r"]);$x.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function L7(i,e){for(let r=e??0;r<i.length;r++){if(i[r]===10)return{preceding:r,index:r+1,carriage:!1};if(i[r]===13)return{preceding:r,index:r+1,carriage:!0}}return null}function F7(i){for(let n=0;n<i.length-1;n++){if(i[n]===10&&i[n+1]===10||i[n]===13&&i[n+1]===13)return n+2;if(i[n]===13&&i[n+1]===10&&n+3<i.length&&i[n+2]===13&&i[n+3]===10)return n+4}return-1}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const ex={off:0,error:200,warn:300,info:400,debug:500},OC=(i,e,t)=>{if(i){if(m7(ex,i))return i;Ns(t).warn(`${e} was set to ${JSON.stringify(i)}, expected one of ${JSON.stringify(Object.keys(ex))}`)}};function ig(){}function Hy(i,e,t){return!e||ex[i]>ex[t]?ig:e[i].bind(e)}const k7={error:ig,warn:ig,info:ig,debug:ig};let zC=new WeakMap;function Ns(i){var e;const t=i.logger,n=(e=i.logLevel)!==null&&e!==void 0?e:"off";if(!t)return k7;const r=zC.get(t);if(r&&r[0]===n)return r[1];const s={error:Hy("error",t,n),warn:Hy("warn",t,n),info:Hy("info",t,n),debug:Hy("debug",t,n)};return zC.set(t,[n,s]),s}const Nf=i=>(i.options&&(i.options=Object.assign({},i.options),delete i.options.headers),i.headers&&(i.headers=Object.fromEntries((i.headers instanceof Headers?[...i.headers]:Object.entries(i.headers)).map(([e,t])=>[e,e.toLowerCase()==="x-goog-api-key"||e.toLowerCase()==="authorization"||e.toLowerCase()==="cookie"||e.toLowerCase()==="set-cookie"?"***":t]))),"retryOfRequestLogID"in i&&(i.retryOfRequestLogID&&(i.retryOf=i.retryOfRequestLogID),delete i.retryOfRequestLogID),i);/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class kh{constructor(e,t,n){this.iterator=e,this.controller=t,this.client=n}static fromSSEResponse(e,t,n){let r=!1;const s=n?Ns(n):console;function a(){return Na(this,arguments,function*(){var d,p,m,v;if(r)throw new ra("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let _=!1;try{try{for(var b=!0,T=Da(O7(e,t)),I;I=yield hn(T.next()),d=I.done,!d;b=!0){v=I.value,b=!1;const C=v;if(!_)if(C.data.startsWith("[DONE]")){_=!0;continue}else try{yield yield hn(JSON.parse(C.data))}catch(A){throw s.error("Could not parse message into JSON:",C.data),s.error("From chunk:",C.raw),A}}}catch(C){p={error:C}}finally{try{!b&&!d&&(m=T.return)&&(yield hn(m.call(T)))}finally{if(p)throw p.error}}_=!0}catch(C){if(IM(C))return yield hn(void 0);throw C}finally{_||t.abort()}})}return new kh(a,t,n)}static fromReadableStream(e,t,n){let r=!1;function s(){return Na(this,arguments,function*(){var d,p,m,v;const _=new $x,b=sN(e);try{for(var T=!0,I=Da(b),C;C=yield hn(I.next()),d=C.done,!d;T=!0){v=C.value,T=!1;const A=v;for(const D of _.decode(A))yield yield hn(D)}}catch(A){p={error:A}}finally{try{!T&&!d&&(m=I.return)&&(yield hn(m.call(I)))}finally{if(p)throw p.error}}for(const A of _.flush())yield yield hn(A)})}function a(){return Na(this,arguments,function*(){var d,p,m,v;if(r)throw new ra("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let _=!1;try{try{for(var b=!0,T=Da(s()),I;I=yield hn(T.next()),d=I.done,!d;b=!0){v=I.value,b=!1;const C=v;_||C&&(yield yield hn(JSON.parse(C)))}}catch(C){p={error:C}}finally{try{!b&&!d&&(m=T.return)&&(yield hn(m.call(T)))}finally{if(p)throw p.error}}_=!0}catch(C){if(IM(C))return yield hn(void 0);throw C}finally{_||t.abort()}})}return new kh(a,t,n)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],t=[],n=this.iterator(),r=s=>({next:()=>{if(s.length===0){const a=n.next();e.push(a),t.push(a)}return s.shift()}});return[new kh(()=>r(e),this.controller,this.client),new kh(()=>r(t),this.controller,this.client)]}toReadableStream(){const e=this;let t;return rN({async start(){t=e[Symbol.asyncIterator]()},async pull(n){try{const{value:r,done:s}=await t.next();if(s)return n.close();const a=sT(JSON.stringify(r)+`
`);n.enqueue(a)}catch(r){n.error(r)}},async cancel(){var n;await((n=t.return)===null||n===void 0?void 0:n.call(t))}})}}function O7(i,e){return Na(this,arguments,function*(){var n,r,s,a;if(!i.body)throw e.abort(),typeof globalThis.navigator<"u"&&globalThis.navigator.product==="ReactNative"?new ra("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api"):new ra("Attempted to iterate over a response with no body");const c=new B7,d=new $x,p=sN(i.body);try{for(var m=!0,v=Da(z7(p)),_;_=yield hn(v.next()),n=_.done,!n;m=!0){a=_.value,m=!1;const b=a;for(const T of d.decode(b)){const I=c.decode(T);I&&(yield yield hn(I))}}}catch(b){r={error:b}}finally{try{!m&&!n&&(s=v.return)&&(yield hn(s.call(v)))}finally{if(r)throw r.error}}for(const b of d.flush()){const T=c.decode(b);T&&(yield yield hn(T))}})}function z7(i){return Na(this,arguments,function*(){var t,n,r,s;let a=new Uint8Array;try{for(var c=!0,d=Da(i),p;p=yield hn(d.next()),t=p.done,!t;c=!0){s=p.value,c=!1;const m=s;if(m==null)continue;const v=m instanceof ArrayBuffer?new Uint8Array(m):typeof m=="string"?sT(m):m;let _=new Uint8Array(a.length+v.length);_.set(a),_.set(v,a.length),a=_;let b;for(;(b=F7(a))!==-1;)yield yield hn(a.slice(0,b)),a=a.slice(b)}}catch(m){n={error:m}}finally{try{!c&&!t&&(r=d.return)&&(yield hn(r.call(d)))}finally{if(n)throw n.error}}a.length>0&&(yield yield hn(a))})}class B7{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const s={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],s}if(this.chunks.push(e),e.startsWith(":"))return null;let[t,n,r]=V7(e,":");return r.startsWith(" ")&&(r=r.substring(1)),t==="event"?this.event=r:t==="data"&&this.data.push(r),null}}function V7(i,e){const t=i.indexOf(e);return t!==-1?[i.substring(0,t),e,i.substring(t+e.length)]:[i,"",""]}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function H7(i,e){const{response:t,requestLogID:n,retryOfRequestLogID:r,startTime:s}=e,a=await(async()=>{var c;if(e.options.stream)return Ns(i).debug("response",t.status,t.url,t.headers,t.body),e.options.__streamClass?e.options.__streamClass.fromSSEResponse(t,e.controller,i):kh.fromSSEResponse(t,e.controller,i);if(t.status===204)return null;if(e.options.__binaryResponse)return t;const d=t.headers.get("content-type"),p=(c=d==null?void 0:d.split(";")[0])===null||c===void 0?void 0:c.trim();return(p==null?void 0:p.includes("application/json"))||(p==null?void 0:p.endsWith("+json"))?await t.json():await t.text()})();return Ns(i).debug(`[${n}] response parsed`,Nf({retryOfRequestLogID:r,url:t.url,status:t.status,body:a,durationMs:Date.now()-s})),a}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class oT extends Promise{constructor(e,t,n=H7){super(r=>{r(null)}),this.responsePromise=t,this.parseResponse=n,this.client=e}_thenUnwrap(e){return new oT(this.client,this.responsePromise,async(t,n)=>e(await this.parseResponse(t,n),n))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,t]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:t}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(e=>this.parseResponse(this.client,e))),this.parsedPromise}then(e,t){return this.parse().then(e,t)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const dN=Symbol("brand.privateNullableHeaders");function*G7(i){if(!i)return;if(dN in i){const{values:n,nulls:r}=i;yield*n.entries();for(const s of r)yield[s,null];return}let e=!1,t;i instanceof Headers?t=i.entries():UC(i)?t=i:(e=!0,t=Object.entries(i??{}));for(let n of t){const r=n[0];if(typeof r!="string")throw new TypeError("expected header name to be a string");const s=UC(n[1])?n[1]:[n[1]];let a=!1;for(const c of s)c!==void 0&&(e&&!a&&(a=!0,yield[r,null]),yield[r,c])}}const jm=i=>{const e=new Headers,t=new Set;for(const n of i){const r=new Set;for(const[s,a]of G7(n)){const c=s.toLowerCase();r.has(c)||(e.delete(s),r.add(c)),a===null?(e.delete(s),t.add(c)):(e.append(s,a),t.delete(c))}}return{[dN]:!0,values:e,nulls:t}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Yb=i=>{var e,t,n,r,s,a;if(typeof globalThis.process<"u")return(n=(t=(e=pH)===null||e===void 0?void 0:e[i])===null||t===void 0?void 0:t.trim())!==null&&n!==void 0?n:void 0;if(typeof globalThis.Deno<"u")return(a=(s=(r=globalThis.Deno.env)===null||r===void 0?void 0:r.get)===null||s===void 0?void 0:s.call(r,i))===null||a===void 0?void 0:a.trim()};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var hN;class Kx{constructor(e){var t,n,r,s,a,c,d,{baseURL:p=Yb("GEMINI_NEXT_GEN_API_BASE_URL"),apiKey:m=(t=Yb("GEMINI_API_KEY"))!==null&&t!==void 0?t:null,apiVersion:v="v1beta"}=e,_=j_(e,["baseURL","apiKey","apiVersion"]);const b=Object.assign(Object.assign({apiKey:m,apiVersion:v},_),{baseURL:p||"https://generativelanguage.googleapis.com"});this.baseURL=b.baseURL,this.timeout=(n=b.timeout)!==null&&n!==void 0?n:Kx.DEFAULT_TIMEOUT,this.logger=(r=b.logger)!==null&&r!==void 0?r:console;const T="warn";this.logLevel=T,this.logLevel=(a=(s=OC(b.logLevel,"ClientOptions.logLevel",this))!==null&&s!==void 0?s:OC(Yb("GEMINI_NEXT_GEN_API_LOG"),"process.env['GEMINI_NEXT_GEN_API_LOG']",this))!==null&&a!==void 0?a:T,this.fetchOptions=b.fetchOptions,this.maxRetries=(c=b.maxRetries)!==null&&c!==void 0?c:2,this.fetch=(d=b.fetch)!==null&&d!==void 0?d:M7(),this.encoder=A7,this._options=b,this.apiKey=m,this.apiVersion=v,this.clientAdapter=b.clientAdapter}withOptions(e){return new this.constructor(Object.assign(Object.assign(Object.assign({},this._options),{baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetch:this.fetch,fetchOptions:this.fetchOptions,apiKey:this.apiKey,apiVersion:this.apiVersion}),e))}baseURLOverridden(){return this.baseURL!=="https://generativelanguage.googleapis.com"}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:e,nulls:t}){if(!(e.has("authorization")||e.has("x-goog-api-key"))&&!(this.apiKey&&e.get("x-goog-api-key"))&&!t.has("x-goog-api-key"))throw new Error('Could not resolve authentication method. Expected the apiKey to be set. Or for the "x-goog-api-key" headers to be explicitly omitted')}async authHeaders(e){const t=jm([e.headers]);if(!(t.values.has("authorization")||t.values.has("x-goog-api-key"))){if(this.apiKey)return jm([{"x-goog-api-key":this.apiKey}]);if(this.clientAdapter.isVertexAI())return jm([await this.clientAdapter.getAuthHeaders()])}}stringifyQuery(e){return Object.entries(e).filter(([t,n])=>typeof n<"u").map(([t,n])=>{if(typeof n=="string"||typeof n=="number"||typeof n=="boolean")return`${encodeURIComponent(t)}=${encodeURIComponent(n)}`;if(n===null)return`${encodeURIComponent(t)}=`;throw new ra(`Cannot stringify type ${typeof n}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}getUserAgent(){return`${this.constructor.name}/JS ${Dh}`}defaultIdempotencyKey(){return`stainless-node-retry-${u7()}`}makeStatusError(e,t,n,r){return Ls.generate(e,t,n,r)}buildURL(e,t,n){const r=!this.baseURLOverridden()&&n||this.baseURL,s=f7(e)?new URL(e):new URL(r+(r.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),a=this.defaultQuery();return p7(a)||(t=Object.assign(Object.assign({},a),t)),typeof t=="object"&&t&&!Array.isArray(t)&&(s.search=this.stringifyQuery(t)),s.toString()}async prepareOptions(e){if(this.clientAdapter&&this.clientAdapter.isVertexAI()&&!e.path.startsWith(`/${this.apiVersion}/projects/`)){const t=e.path.slice(this.apiVersion.length+1);e.path=`/${this.apiVersion}/projects/${this.clientAdapter.getProject()}/locations/${this.clientAdapter.getLocation()}${t}`}}async prepareRequest(e,{url:t,options:n}){}get(e,t){return this.methodRequest("get",e,t)}post(e,t){return this.methodRequest("post",e,t)}patch(e,t){return this.methodRequest("patch",e,t)}put(e,t){return this.methodRequest("put",e,t)}delete(e,t){return this.methodRequest("delete",e,t)}methodRequest(e,t,n){return this.request(Promise.resolve(n).then(r=>Object.assign({method:e,path:t},r)))}request(e,t=null){return new oT(this,this.makeRequest(e,t,void 0))}async makeRequest(e,t,n){var r,s,a;const c=await e,d=(r=c.maxRetries)!==null&&r!==void 0?r:this.maxRetries;t==null&&(t=d),await this.prepareOptions(c);const{req:p,url:m,timeout:v}=await this.buildRequest(c,{retryCount:d-t});await this.prepareRequest(p,{url:m,options:c});const _="log_"+(Math.random()*(1<<24)|0).toString(16).padStart(6,"0"),b=n===void 0?"":`, retryOf: ${n}`,T=Date.now();if(Ns(this).debug(`[${_}] sending request`,Nf({retryOfRequestLogID:n,method:c.method,url:m,options:c,headers:p.headers})),!((s=c.signal)===null||s===void 0)&&s.aborted)throw new DM;const I=new AbortController,C=await this.fetchWithTimeout(m,p,v,I).catch(NM),A=Date.now();if(C instanceof globalThis.Error){const U=`retrying, ${t} attempts remaining`;if(!((a=c.signal)===null||a===void 0)&&a.aborted)throw new DM;const L=IM(C)||/timed? ?out/i.test(String(C)+("cause"in C?String(C.cause):""));if(t)return Ns(this).info(`[${_}] connection ${L?"timed out":"failed"} - ${U}`),Ns(this).debug(`[${_}] connection ${L?"timed out":"failed"} (${U})`,Nf({retryOfRequestLogID:n,url:m,durationMs:A-T,message:C.message})),this.retryRequest(c,t,n??_);throw Ns(this).info(`[${_}] connection ${L?"timed out":"failed"} - error; no more retries left`),Ns(this).debug(`[${_}] connection ${L?"timed out":"failed"} (error; no more retries left)`,Nf({retryOfRequestLogID:n,url:m,durationMs:A-T,message:C.message})),L?new Z3:new Zx({cause:C})}const D=`[${_}${b}] ${p.method} ${m} ${C.ok?"succeeded":"failed"} with status ${C.status} in ${A-T}ms`;if(!C.ok){const U=await this.shouldRetry(C);if(t&&U){const P=`retrying, ${t} attempts remaining`;return await T7(C.body),Ns(this).info(`${D} - ${P}`),Ns(this).debug(`[${_}] response error (${P})`,Nf({retryOfRequestLogID:n,url:C.url,status:C.status,headers:C.headers,durationMs:A-T})),this.retryRequest(c,t,n??_,C.headers)}const L=U?"error; no more retries left":"error; not retryable";Ns(this).info(`${D} - ${L}`);const z=await C.text().catch(P=>NM(P).message),B=v7(z),k=B?void 0:z;throw Ns(this).debug(`[${_}] response error (${L})`,Nf({retryOfRequestLogID:n,url:C.url,status:C.status,headers:C.headers,message:k,durationMs:Date.now()-T})),this.makeStatusError(C.status,B,k,C.headers)}return Ns(this).info(D),Ns(this).debug(`[${_}] response start`,Nf({retryOfRequestLogID:n,url:C.url,status:C.status,headers:C.headers,durationMs:A-T})),{response:C,options:c,controller:I,requestLogID:_,retryOfRequestLogID:n,startTime:T}}async fetchWithTimeout(e,t,n,r){const s=t||{},{signal:a,method:c}=s,d=j_(s,["signal","method"]);a&&a.addEventListener("abort",()=>r.abort());const p=setTimeout(()=>r.abort(),n),m=globalThis.ReadableStream&&d.body instanceof globalThis.ReadableStream||typeof d.body=="object"&&d.body!==null&&Symbol.asyncIterator in d.body,v=Object.assign(Object.assign(Object.assign({signal:r.signal},m?{duplex:"half"}:{}),{method:"GET"}),d);c&&(v.method=c.toUpperCase());try{return await this.fetch.call(void 0,e,v)}finally{clearTimeout(p)}}async shouldRetry(e){const t=e.headers.get("x-should-retry");return t==="true"?!0:t==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,t,n,r){var s;let a;const c=r==null?void 0:r.get("retry-after-ms");if(c){const p=parseFloat(c);Number.isNaN(p)||(a=p)}const d=r==null?void 0:r.get("retry-after");if(d&&!a){const p=parseFloat(d);Number.isNaN(p)?a=Date.parse(d)-Date.now():a=p*1e3}if(!(a&&0<=a&&a<60*1e3)){const p=(s=e.maxRetries)!==null&&s!==void 0?s:this.maxRetries;a=this.calculateDefaultRetryTimeoutMillis(t,p)}return await y7(a),this.makeRequest(e,t-1,n)}calculateDefaultRetryTimeoutMillis(e,t){const s=t-e,a=Math.min(.5*Math.pow(2,s),8),c=1-Math.random()*.25;return a*c*1e3}async buildRequest(e,{retryCount:t=0}={}){var n,r,s;const a=Object.assign({},e),{method:c,path:d,query:p,defaultBaseURL:m}=a,v=this.buildURL(d,p,m);"timeout"in a&&g7("timeout",a.timeout),a.timeout=(n=a.timeout)!==null&&n!==void 0?n:this.timeout;const{bodyHeaders:_,body:b}=this.buildBody({options:a}),T=await this.buildHeaders({options:e,method:c,bodyHeaders:_,retryCount:t});return{req:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({method:c,headers:T},a.signal&&{signal:a.signal}),globalThis.ReadableStream&&b instanceof globalThis.ReadableStream&&{duplex:"half"}),b&&{body:b}),(r=this.fetchOptions)!==null&&r!==void 0?r:{}),(s=a.fetchOptions)!==null&&s!==void 0?s:{}),url:v,timeout:a.timeout}}async buildHeaders({options:e,method:t,bodyHeaders:n,retryCount:r}){let s={};this.idempotencyHeader&&t!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),s[this.idempotencyHeader]=e.idempotencyKey);const a=await this.authHeaders(e);let c=jm([s,Object.assign(Object.assign({Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(r)},e.timeout?{"X-Stainless-Timeout":String(Math.trunc(e.timeout/1e3))}:{}),b7()),this._options.defaultHeaders,n,e.headers,a]);return this.validateHeaders(c),c.values}buildBody({options:{body:e,headers:t}}){if(!e)return{bodyHeaders:void 0,body:void 0};const n=jm([t]);return ArrayBuffer.isView(e)||e instanceof ArrayBuffer||e instanceof DataView||typeof e=="string"&&n.values.has("content-type")||globalThis.Blob&&e instanceof globalThis.Blob||e instanceof FormData||e instanceof URLSearchParams||globalThis.ReadableStream&&e instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:e}:typeof e=="object"&&(Symbol.asyncIterator in e||Symbol.iterator in e&&"next"in e&&typeof e.next=="function")?{bodyHeaders:void 0,body:E7(e)}:this.encoder({body:e,headers:n})}}Kx.DEFAULT_TIMEOUT=6e4;class zr extends Kx{constructor(){super(...arguments),this.interactions=new fN(this)}}hN=zr;zr.GeminiNextGenAPIClient=hN;zr.GeminiNextGenAPIClientError=ra;zr.APIError=Ls;zr.APIConnectionError=Zx;zr.APIConnectionTimeoutError=Z3;zr.APIUserAbortError=DM;zr.NotFoundError=j3;zr.ConflictError=eN;zr.RateLimitError=nN;zr.BadRequestError=$3;zr.AuthenticationError=K3;zr.InternalServerError=iN;zr.PermissionDeniedError=Q3;zr.UnprocessableEntityError=tN;zr.toFile=N7;zr.Interactions=fN;/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function q7(i,e){const t={},n=x(i,["name"]);return n!=null&&S(t,["_url","name"],n),t}function W7(i,e){const t={},n=x(i,["name"]);return n!=null&&S(t,["_url","name"],n),t}function X7(i,e){const t={},n=x(i,["sdkHttpResponse"]);return n!=null&&S(t,["sdkHttpResponse"],n),t}function Y7(i,e){const t={},n=x(i,["sdkHttpResponse"]);return n!=null&&S(t,["sdkHttpResponse"],n),t}function J7(i,e,t){const n={};if(x(i,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const r=x(i,["tunedModelDisplayName"]);if(e!==void 0&&r!=null&&S(e,["displayName"],r),x(i,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const s=x(i,["epochCount"]);e!==void 0&&s!=null&&S(e,["tuningTask","hyperparameters","epochCount"],s);const a=x(i,["learningRateMultiplier"]);if(a!=null&&S(n,["tuningTask","hyperparameters","learningRateMultiplier"],a),x(i,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(x(i,["preTunedModelCheckpointId"])!==void 0)throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(x(i,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const c=x(i,["batchSize"]);e!==void 0&&c!=null&&S(e,["tuningTask","hyperparameters","batchSize"],c);const d=x(i,["learningRate"]);if(e!==void 0&&d!=null&&S(e,["tuningTask","hyperparameters","learningRate"],d),x(i,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");if(x(i,["beta"])!==void 0)throw new Error("beta parameter is not supported in Gemini API.");return n}function Z7(i,e,t){const n={};let r=x(t,["config","method"]);if(r===void 0&&(r="SUPERVISED_FINE_TUNING"),r==="SUPERVISED_FINE_TUNING"){const b=x(i,["validationDataset"]);e!==void 0&&b!=null&&S(e,["supervisedTuningSpec"],BC(b))}else if(r==="PREFERENCE_TUNING"){const b=x(i,["validationDataset"]);e!==void 0&&b!=null&&S(e,["preferenceOptimizationSpec"],BC(b))}const s=x(i,["tunedModelDisplayName"]);e!==void 0&&s!=null&&S(e,["tunedModelDisplayName"],s);const a=x(i,["description"]);e!==void 0&&a!=null&&S(e,["description"],a);let c=x(t,["config","method"]);if(c===void 0&&(c="SUPERVISED_FINE_TUNING"),c==="SUPERVISED_FINE_TUNING"){const b=x(i,["epochCount"]);e!==void 0&&b!=null&&S(e,["supervisedTuningSpec","hyperParameters","epochCount"],b)}else if(c==="PREFERENCE_TUNING"){const b=x(i,["epochCount"]);e!==void 0&&b!=null&&S(e,["preferenceOptimizationSpec","hyperParameters","epochCount"],b)}let d=x(t,["config","method"]);if(d===void 0&&(d="SUPERVISED_FINE_TUNING"),d==="SUPERVISED_FINE_TUNING"){const b=x(i,["learningRateMultiplier"]);e!==void 0&&b!=null&&S(e,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],b)}else if(d==="PREFERENCE_TUNING"){const b=x(i,["learningRateMultiplier"]);e!==void 0&&b!=null&&S(e,["preferenceOptimizationSpec","hyperParameters","learningRateMultiplier"],b)}let p=x(t,["config","method"]);if(p===void 0&&(p="SUPERVISED_FINE_TUNING"),p==="SUPERVISED_FINE_TUNING"){const b=x(i,["exportLastCheckpointOnly"]);e!==void 0&&b!=null&&S(e,["supervisedTuningSpec","exportLastCheckpointOnly"],b)}else if(p==="PREFERENCE_TUNING"){const b=x(i,["exportLastCheckpointOnly"]);e!==void 0&&b!=null&&S(e,["preferenceOptimizationSpec","exportLastCheckpointOnly"],b)}let m=x(t,["config","method"]);if(m===void 0&&(m="SUPERVISED_FINE_TUNING"),m==="SUPERVISED_FINE_TUNING"){const b=x(i,["adapterSize"]);e!==void 0&&b!=null&&S(e,["supervisedTuningSpec","hyperParameters","adapterSize"],b)}else if(m==="PREFERENCE_TUNING"){const b=x(i,["adapterSize"]);e!==void 0&&b!=null&&S(e,["preferenceOptimizationSpec","hyperParameters","adapterSize"],b)}if(x(i,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(x(i,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");const v=x(i,["labels"]);e!==void 0&&v!=null&&S(e,["labels"],v);const _=x(i,["beta"]);return e!==void 0&&_!=null&&S(e,["preferenceOptimizationSpec","hyperParameters","beta"],_),n}function $7(i,e){const t={},n=x(i,["baseModel"]);n!=null&&S(t,["baseModel"],n);const r=x(i,["preTunedModel"]);r!=null&&S(t,["preTunedModel"],r);const s=x(i,["trainingDataset"]);s!=null&&a2(s);const a=x(i,["config"]);return a!=null&&J7(a,t),t}function K7(i,e){const t={},n=x(i,["baseModel"]);n!=null&&S(t,["baseModel"],n);const r=x(i,["preTunedModel"]);r!=null&&S(t,["preTunedModel"],r);const s=x(i,["trainingDataset"]);s!=null&&l2(s,t,e);const a=x(i,["config"]);return a!=null&&Z7(a,t,e),t}function Q7(i,e){const t={},n=x(i,["name"]);return n!=null&&S(t,["_url","name"],n),t}function j7(i,e){const t={},n=x(i,["name"]);return n!=null&&S(t,["_url","name"],n),t}function e2(i,e,t){const n={},r=x(i,["pageSize"]);e!==void 0&&r!=null&&S(e,["_query","pageSize"],r);const s=x(i,["pageToken"]);e!==void 0&&s!=null&&S(e,["_query","pageToken"],s);const a=x(i,["filter"]);return e!==void 0&&a!=null&&S(e,["_query","filter"],a),n}function t2(i,e,t){const n={},r=x(i,["pageSize"]);e!==void 0&&r!=null&&S(e,["_query","pageSize"],r);const s=x(i,["pageToken"]);e!==void 0&&s!=null&&S(e,["_query","pageToken"],s);const a=x(i,["filter"]);return e!==void 0&&a!=null&&S(e,["_query","filter"],a),n}function n2(i,e){const t={},n=x(i,["config"]);return n!=null&&e2(n,t),t}function i2(i,e){const t={},n=x(i,["config"]);return n!=null&&t2(n,t),t}function r2(i,e){const t={},n=x(i,["sdkHttpResponse"]);n!=null&&S(t,["sdkHttpResponse"],n);const r=x(i,["nextPageToken"]);r!=null&&S(t,["nextPageToken"],r);const s=x(i,["tunedModels"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(c=>pN(c))),S(t,["tuningJobs"],a)}return t}function s2(i,e){const t={},n=x(i,["sdkHttpResponse"]);n!=null&&S(t,["sdkHttpResponse"],n);const r=x(i,["nextPageToken"]);r!=null&&S(t,["nextPageToken"],r);const s=x(i,["tuningJobs"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(c=>LM(c))),S(t,["tuningJobs"],a)}return t}function o2(i,e){const t={},n=x(i,["name"]);n!=null&&S(t,["model"],n);const r=x(i,["name"]);return r!=null&&S(t,["endpoint"],r),t}function a2(i,e){const t={};if(x(i,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(x(i,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const n=x(i,["examples"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(s=>s)),S(t,["examples","examples"],r)}return t}function l2(i,e,t){const n={};let r=x(t,["config","method"]);if(r===void 0&&(r="SUPERVISED_FINE_TUNING"),r==="SUPERVISED_FINE_TUNING"){const a=x(i,["gcsUri"]);e!==void 0&&a!=null&&S(e,["supervisedTuningSpec","trainingDatasetUri"],a)}else if(r==="PREFERENCE_TUNING"){const a=x(i,["gcsUri"]);e!==void 0&&a!=null&&S(e,["preferenceOptimizationSpec","trainingDatasetUri"],a)}let s=x(t,["config","method"]);if(s===void 0&&(s="SUPERVISED_FINE_TUNING"),s==="SUPERVISED_FINE_TUNING"){const a=x(i,["vertexDatasetResource"]);e!==void 0&&a!=null&&S(e,["supervisedTuningSpec","trainingDatasetUri"],a)}else if(s==="PREFERENCE_TUNING"){const a=x(i,["vertexDatasetResource"]);e!==void 0&&a!=null&&S(e,["preferenceOptimizationSpec","trainingDatasetUri"],a)}if(x(i,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return n}function pN(i,e){const t={},n=x(i,["sdkHttpResponse"]);n!=null&&S(t,["sdkHttpResponse"],n);const r=x(i,["name"]);r!=null&&S(t,["name"],r);const s=x(i,["state"]);s!=null&&S(t,["state"],I3(s));const a=x(i,["createTime"]);a!=null&&S(t,["createTime"],a);const c=x(i,["tuningTask","startTime"]);c!=null&&S(t,["startTime"],c);const d=x(i,["tuningTask","completeTime"]);d!=null&&S(t,["endTime"],d);const p=x(i,["updateTime"]);p!=null&&S(t,["updateTime"],p);const m=x(i,["description"]);m!=null&&S(t,["description"],m);const v=x(i,["baseModel"]);v!=null&&S(t,["baseModel"],v);const _=x(i,["_self"]);return _!=null&&S(t,["tunedModel"],o2(_)),t}function LM(i,e){const t={},n=x(i,["sdkHttpResponse"]);n!=null&&S(t,["sdkHttpResponse"],n);const r=x(i,["name"]);r!=null&&S(t,["name"],r);const s=x(i,["state"]);s!=null&&S(t,["state"],I3(s));const a=x(i,["createTime"]);a!=null&&S(t,["createTime"],a);const c=x(i,["startTime"]);c!=null&&S(t,["startTime"],c);const d=x(i,["endTime"]);d!=null&&S(t,["endTime"],d);const p=x(i,["updateTime"]);p!=null&&S(t,["updateTime"],p);const m=x(i,["error"]);m!=null&&S(t,["error"],m);const v=x(i,["description"]);v!=null&&S(t,["description"],v);const _=x(i,["baseModel"]);_!=null&&S(t,["baseModel"],_);const b=x(i,["tunedModel"]);b!=null&&S(t,["tunedModel"],b);const T=x(i,["preTunedModel"]);T!=null&&S(t,["preTunedModel"],T);const I=x(i,["supervisedTuningSpec"]);I!=null&&S(t,["supervisedTuningSpec"],I);const C=x(i,["preferenceOptimizationSpec"]);C!=null&&S(t,["preferenceOptimizationSpec"],C);const A=x(i,["tuningDataStats"]);A!=null&&S(t,["tuningDataStats"],A);const D=x(i,["encryptionSpec"]);D!=null&&S(t,["encryptionSpec"],D);const U=x(i,["partnerModelTuningSpec"]);U!=null&&S(t,["partnerModelTuningSpec"],U);const L=x(i,["customBaseModel"]);L!=null&&S(t,["customBaseModel"],L);const z=x(i,["experiment"]);z!=null&&S(t,["experiment"],z);const B=x(i,["labels"]);B!=null&&S(t,["labels"],B);const k=x(i,["outputUri"]);k!=null&&S(t,["outputUri"],k);const G=x(i,["pipelineJob"]);G!=null&&S(t,["pipelineJob"],G);const P=x(i,["serviceAccount"]);P!=null&&S(t,["serviceAccount"],P);const O=x(i,["tunedModelDisplayName"]);O!=null&&S(t,["tunedModelDisplayName"],O);const Z=x(i,["veoTuningSpec"]);return Z!=null&&S(t,["veoTuningSpec"],Z),t}function u2(i,e){const t={},n=x(i,["sdkHttpResponse"]);n!=null&&S(t,["sdkHttpResponse"],n);const r=x(i,["name"]);r!=null&&S(t,["name"],r);const s=x(i,["metadata"]);s!=null&&S(t,["metadata"],s);const a=x(i,["done"]);a!=null&&S(t,["done"],a);const c=x(i,["error"]);return c!=null&&S(t,["error"],c),t}function BC(i,e){const t={},n=x(i,["gcsUri"]);n!=null&&S(t,["validationDatasetUri"],n);const r=x(i,["vertexDatasetResource"]);return r!=null&&S(t,["validationDatasetUri"],r),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class c2 extends vu{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new td(pu.PAGED_ITEM_TUNING_JOBS,n=>this.listInternal(n),await this.listInternal(t),t),this.get=async t=>await this.getInternal(t),this.tune=async t=>{var n;if(this.apiClient.isVertexAI())if(t.baseModel.startsWith("projects/")){const r={tunedModelName:t.baseModel};!((n=t.config)===null||n===void 0)&&n.preTunedModelCheckpointId&&(r.checkpointId=t.config.preTunedModelCheckpointId);const s=Object.assign(Object.assign({},t),{preTunedModel:r});return s.baseModel=void 0,await this.tuneInternal(s)}else{const r=Object.assign({},t);return await this.tuneInternal(r)}else{const r=Object.assign({},t),s=await this.tuneMldevInternal(r);let a="";return s.metadata!==void 0&&s.metadata.tunedModel!==void 0?a=s.metadata.tunedModel:s.name!==void 0&&s.name.includes("/operations/")&&(a=s.name.split("/operations/")[0]),{name:a,state:MM.JOB_STATE_QUEUED}}}}async getInternal(e){var t,n,r,s;let a,c="",d={};if(this.apiClient.isVertexAI()){const p=j7(e);return c=Ft("{name}",p._url),d=p._query,delete p._url,delete p._query,a=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(m=>m.json().then(v=>{const _=v;return _.sdkHttpResponse={headers:m.headers},_})),a.then(m=>LM(m))}else{const p=Q7(e);return c=Ft("{name}",p._url),d=p._query,delete p._url,delete p._query,a=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json().then(v=>{const _=v;return _.sdkHttpResponse={headers:m.headers},_})),a.then(m=>pN(m))}}async listInternal(e){var t,n,r,s;let a,c="",d={};if(this.apiClient.isVertexAI()){const p=i2(e);return c=Ft("tuningJobs",p._url),d=p._query,delete p._url,delete p._query,a=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(m=>m.json().then(v=>{const _=v;return _.sdkHttpResponse={headers:m.headers},_})),a.then(m=>{const v=s2(m),_=new dC;return Object.assign(_,v),_})}else{const p=n2(e);return c=Ft("tunedModels",p._url),d=p._query,delete p._url,delete p._query,a=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(p),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json().then(v=>{const _=v;return _.sdkHttpResponse={headers:m.headers},_})),a.then(m=>{const v=r2(m),_=new dC;return Object.assign(_,v),_})}}async cancel(e){var t,n,r,s;let a,c="",d={};if(this.apiClient.isVertexAI()){const p=W7(e);return c=Ft("{name}:cancel",p._url),d=p._query,delete p._url,delete p._query,a=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(m=>m.json().then(v=>{const _=v;return _.sdkHttpResponse={headers:m.headers},_})),a.then(m=>{const v=Y7(m),_=new hC;return Object.assign(_,v),_})}else{const p=q7(e);return c=Ft("{name}:cancel",p._url),d=p._query,delete p._url,delete p._query,a=this.apiClient.request({path:c,queryParams:d,body:JSON.stringify(p),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json().then(v=>{const _=v;return _.sdkHttpResponse={headers:m.headers},_})),a.then(m=>{const v=X7(m),_=new hC;return Object.assign(_,v),_})}}async tuneInternal(e){var t,n;let r,s="",a={};if(this.apiClient.isVertexAI()){const c=K7(e,e);return s=Ft("tuningJobs",c._url),a=c._query,delete c._url,delete c._query,r=this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:d.headers},m})),r.then(d=>LM(d))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var t,n;let r,s="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const c=$7(e);return s=Ft("tunedModels",c._url),a=c._query,delete c._url,delete c._query,r=this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(c),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(n=e.config)===null||n===void 0?void 0:n.abortSignal}).then(d=>d.json().then(p=>{const m=p;return m.sdkHttpResponse={headers:d.headers},m})),r.then(d=>u2(d))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class f2{async download(e,t){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const d2=1024*1024*8,h2=3,p2=1e3,m2=2,tx="x-goog-upload-status";async function g2(i,e,t){var n;const r=await mN(i,e,t),s=await(r==null?void 0:r.json());if(((n=r==null?void 0:r.headers)===null||n===void 0?void 0:n[tx])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return s.file}async function v2(i,e,t){var n;const r=await mN(i,e,t),s=await(r==null?void 0:r.json());if(((n=r==null?void 0:r.headers)===null||n===void 0?void 0:n[tx])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");const a=E3(s),c=new jE;return Object.assign(c,a),c}async function mN(i,e,t){var n,r;let s=0,a=0,c=new EM(new Response),d="upload";for(s=i.size;a<s;){const p=Math.min(d2,s-a),m=i.slice(a,a+p);a+p>=s&&(d+=", finalize");let v=0,_=p2;for(;v<h2&&(c=await t.request({path:"",body:m,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":d,"X-Goog-Upload-Offset":String(a),"Content-Length":String(p)}}}),!(!((n=c==null?void 0:c.headers)===null||n===void 0)&&n[tx]));)v++,await _2(_),_=_*m2;if(a+=p,((r=c==null?void 0:c.headers)===null||r===void 0?void 0:r[tx])!=="active")break;if(s<=a)throw new Error("All content has been uploaded, but the upload status is not finalized.")}return c}async function y2(i){return{size:i.size,type:i.type}}function _2(i){return new Promise(e=>setTimeout(e,i))}class x2{async upload(e,t,n){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await g2(e,t,n)}async uploadToFileSearchStore(e,t,n){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await v2(e,t,n)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await y2(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class S2{create(e,t,n){return new b2(e,t,n)}}class b2{constructor(e,t,n){this.url=e,this.headers=t,this.callbacks=n}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const VC="x-goog-api-key";class M2{constructor(e){this.apiKey=e}async addAuthHeaders(e,t){if(e.get(VC)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append(VC,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const E2="gl-node/";class T2{get interactions(){if(this._interactions!==void 0)return this._interactions;console.warn("GoogleGenAI.interactions: Interactions usage is experimental and may change in future versions.");const e=this.httpOptions;e!=null&&e.extraBody&&console.warn("GoogleGenAI.interactions: Client level httpOptions.extraBody is not supported by the interactions client and will be ignored.");const t=new zr({baseURL:this.apiClient.getBaseUrl(),apiKey:this.apiKey,apiVersion:this.apiClient.getApiVersion(),clientAdapter:this.apiClient,defaultHeaders:this.apiClient.getDefaultHeaders(),timeout:e==null?void 0:e.timeout});return this._interactions=t.interactions,this._interactions}constructor(e){var t;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(t=e.vertexai)!==null&&t!==void 0?t:!1,this.apiKey=e.apiKey;const n=yH(e.httpOptions,e.vertexai,void 0,void 0);n&&(e.httpOptions?e.httpOptions.baseUrl=n:e.httpOptions={baseUrl:n}),this.apiVersion=e.apiVersion,this.httpOptions=e.httpOptions;const r=new M2(this.apiKey);this.apiClient=new yq({auth:r,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:this.httpOptions,userAgentExtra:E2+"web",uploader:new x2,downloader:new f2}),this.models=new kq(this.apiClient),this.live=new Nq(this.apiClient,r,new S2),this.batches=new YG(this.apiClient),this.chats=new C6(this.models,this.apiClient),this.caches=new T6(this.apiClient),this.files=new O6(this.apiClient),this.operations=new Oq(this.apiClient),this.authTokens=new e7(this.apiClient),this.tunings=new c2(this.apiClient),this.fileSearchStores=new l7(this.apiClient)}}async function A2(i,e){const t=e||void 0;if(!t)return"錯誤: 未設定 API Key。請在設定中輸入您的 Google Gemini API Key。";const n=new T2({apiKey:t}),r=i.metadata.azimuth%360;let s="";r===0||r===360?s="正對鏡頭 (Frontal view)":r>0&&r<180?r===90?s="完全左側面 (Full Left Profile)":r<90?s=`前左側 (Front-Left / 3/4 Left View, ${r}°)`:s=`後左側 (Back-Left View, ${r}°)`:r===180?s="完全背面 (Full Back view)":r>180&&r<360&&(r===270?s="完全右側面 (Full Right Profile)":r<270?s=`後右側 (Back-Right View, ${r}°)`:s=`前右側 (Front-Right / 3/4 Right View, ${r}°)`);let a="",c="";i.promptMode==="video"?(a=`
    Role: High-End Video Prompt Director (Sora/Runway/KLING expert).
    Task: Transform user inputs into a lush, detailed, cinematic video generation prompt.
    
    CRITICAL RULE: OUTPUT MUST BE IN ENGLISH ONLY.

    1) Strict Output Structure (Merged Narrative):
    - **PART 1: THE SCENE (Content, Lighting, Atmosphere)**
      - Elaborate on the Subject and Environment. Don't just say "A man"; say "A weathered man in a dim, fog-filled alley...".
      - Describe lighting quality (volumetric, harsh, soft, cinematic).
      - Describe textures and material details (wet pavement, silk fabric, rough stone).
      - **Integrate Character Pose**: explicitly describe the body mechanics (Standing/Walking/Running) with detail (e.g., "striding purposefully," "standing stoically").
    
    - **PART 2: THE STARTING FRAME (Optical Boundary)**
      - strictly enforce the Optical Axis data.
      - Describe the initial composition: "Framed in a Low Angle Medium Shot from the front-left..."
      - Use professional terms: Depth of field, bokeh, lens choice.
      - **Integrate User Style**: Apply keywords from the "Style" input to lens choice and film stock (e.g. if "Cyberpunk", implies neon, anamorphic, digital grain).
    
    - **PART 3: THE MOVEMENT (Camera Motion & Dynamics)**
      - Describe the *flow* of the camera over time based on "selected_camera_language".
      - Describe how the perspective changes.
      - Use dynamic verbs: "gliding," "sweeping," "pushing in slowly," "tracking roughly."
      - If "Locked-off", describe the stillness amidst the subject's motion.

    2) Quality Guidelines:
    - **Avoid concise/dry summaries.** Write in a descriptive, evocative style (Midjourney-style richness but for video).
    - **Focus on Dynamics**: Mention wind, dust particles, light shifts, or muscle movement to enhance video realism.
    - **Consistency**: Ensure the camera motion makes sense with the chosen pose (e.g., Tracking Shot fits Walking/Running perfectly).

    3) Output Format:
    Please output using Markdown formatting.
    
    Structure:
    ### Video Prompt
    **Visuals & Action:** [Rich description of scene and character]
    **Camera & Framing:** [Optical boundary details]
    **Movement & Dynamics:** [Motion flow and pacing]
    
    **Merged Raw Prompt:**
    \`[The full single paragraph prompt here for easy copying]\`
    `,c=`
    Input Data:
    1. Content & Story: ${i.description||"A cinematic scene"}
    2. Character Pose: ${i.includePoseInPrompt?i.characterPose:"Context Dependent"}
    3. Optical Axis Data:
       - Azimuth: ${r}° (${s})
       - Elevation: ${i.metadata.elevation}°
       - Distance: ${i.metadata.distance.toFixed(1)}m
       - Computed Terms: ${i.terms.size}, ${i.terms.angle}, ${i.terms.direction}
    4. Selected Camera Language: ${i.selectedMotions.length>0?i.selectedMotions.join(", "):"None (Static/Minimal Motion)"}
    5. Style & Aesthetics: ${i.style||"High-end Cinematic"}
    
    Directives:
    - Compile a MASTERPIECE video prompt in ENGLISH.
    - Be descriptive, specific, and cinematic.
    - Include keywords: 8k resolution, photorealistic, cinematic lighting, motion blur (if moving), high fidelity.
    `):(a=`
    Role: Cinematic Image Prompt Architect.
    Task: Convert inputs into a photorealistic midjourney/flux prompt.
    
    CRITICAL RULE: OUTPUT MUST BE IN ENGLISH ONLY.

    1) Strict Output Structure (Order Matters):
    - **1. Subject & Pose**: Core subject, specific action, and the "Character Pose" (Standing/Walking/Running).
    - **2. Environment & Lighting**: Scene context, time of day, lighting style.
    - **3. Optical Composition**:
      - STRICTLY enforce the "Optical Axis" data.
      - Shot Size (Distance based), Camera Angle (Elevation based), Side View (Azimuth based).
    - **4. Technical Aesthetics**: 
      - **CRITICAL**: Shape the visual identity based on the User's "Style" input.
      - If user says "Noir", use high contrast B&W, shadow play.
      - Include Camera choice, Film stock, Color grading, Texture.

    2) Handling Inputs:
    - If "Character Pose" is provided, visual body mechanics must match (e.g., "Subject walking forward...").
    - If "Camera Language" provided (e.g. Dutch Angle), apply it as a static compositional geometric effect (e.g. "Tilted horizon").

    3) Output Format:
    A comma-separated list of high-weight tags and descriptive phrases.
    `,c=`
    Input Data:
    1. Content & Story: ${i.description||"Cinematic shot of a subject"}
    2. Character Pose: ${i.includePoseInPrompt?i.characterPose:"Context Dependent"}
    3. Optical Axis Data:
       - Azimuth: ${r}° (${s})
       - Elevation: ${i.metadata.elevation}°
       - Distance: ${i.metadata.distance.toFixed(1)}m
       - Computed Terms: ${i.terms.size}, ${i.terms.angle}, ${i.terms.direction}
    4. Selected Camera Language: ${i.selectedMotions.length>0?i.selectedMotions.join(", "):"None"} (Interpret as static composition)
    5. Style & Aesthetics: ${i.style||"Photorealistic Cinematic"}
    
    Directives:
    - Compile into a rich, detailed ENGLISH prompt.
    - Structure: Subject/Pose -> Environment -> Composition -> Technical.
    `);try{return(await n.models.generateContent({model:"gemini-3-flash-preview",contents:c,config:{systemInstruction:a,temperature:.2}})).text||"無法生成提示詞。"}catch(d){return console.error("Gemini API Error:",d),`錯誤: ${d instanceof Error?d.message:"發生未知錯誤"}`}}const w2=[{name:"Standard Shots",motions:["POV","OTS","Dutch Angle","Handheld","Rack Focus","Locked-off"]},{name:"Pan / Tilt / Zoom",motions:["Tilt Up","Tilt Down","Pan Right","Pan Left","Zoom In","Zoom Out","Whip Pan"]},{name:"Dolly / Crane / Tracking",motions:["Dolly In","Dolly Out","Crane In","Crane Out","Tracking","Following","Arc Shot","Push In + Reveal","Boom Up","Reverse Follow","Orbit","Drone Shot"]}],C2=()=>{const[i,e]=Oe.useState({metadata:{azimuth:0,elevation:0,distance:8},terms:{direction:"正面",angle:"平視",size:"中景 (MLS)"},description:"",style:"",selectedMotions:[],promptMode:"image",characterPose:"Standing",includePoseInPrompt:!1,finalPrompt:""}),[t,n]=Oe.useState(""),[r,s]=Oe.useState(!1),[a,c]=Oe.useState(!1),[d,p]=Oe.useState(null),m=Oe.useRef(null),v=Oe.useRef(null),_=(k,G)=>{const P=uH[G];if(!P)return;const O=k.currentTarget.getBoundingClientRect();p({text:P,x:O.left+O.width/2,y:O.top-8})},b=()=>{p(null)};Oe.useEffect(()=>{const k=localStorage.getItem("gemini_api_key");k&&n(k)},[]),Oe.useEffect(()=>{const k=hH(i.metadata);e(G=>({...G,terms:k}))},[i.metadata.azimuth,i.metadata.elevation,i.metadata.distance]);const T=(k,G)=>{e(P=>({...P,metadata:{...P.metadata,[k]:G}}))},I=k=>{e(G=>{const O=G.selectedMotions.includes(k)?G.selectedMotions.filter(Z=>Z!==k):[...G.selectedMotions,k];return{...G,selectedMotions:O}})},C=async()=>{c(!0);const k=await A2(i,t);e(G=>({...G,finalPrompt:k})),c(!1)},A=k=>{n(k),localStorage.setItem("gemini_api_key",k)},D=()=>{if(!m.current||!v.current)return;const k=m.current,G=v.current.getBoundingClientRect(),P=k.getBoundingClientRect(),O=k.width/P.width,Z=k.height/P.height,ie=(G.left-P.left)*O,ee=(G.top-P.top)*Z,re=G.width*O,de=G.height*Z,J=document.createElement("canvas");J.width=re,J.height=de;const te=J.getContext("2d");if(te){te.drawImage(k,ie,ee,re,de,0,0,re,de);const ye=document.createElement("a");ye.download=`cinematic-master-${Date.now()}.png`,ye.href=J.toDataURL("image/png"),ye.click()}},U=()=>{navigator.clipboard.writeText(i.finalPrompt),alert("提示詞已複製到剪貼簿！")},L="85vh",z="calc(85vh * 1.777)",B=Oe.useMemo(()=>ai.parse(i.finalPrompt),[i.finalPrompt]);return ue.jsxs("div",{className:"flex flex-col lg:flex-row h-screen w-full bg-[#0a0a0a] text-gray-100 overflow-hidden",children:[ue.jsxs("div",{className:"relative flex-1 bg-white overflow-hidden border-b lg:border-b-0 lg:border-r border-gray-800 flex items-center justify-center",children:[ue.jsx("div",{className:"absolute inset-0 z-0",children:ue.jsxs(s5,{shadows:!0,dpr:[1,2],onCreated:({gl:k})=>{m.current=k.domElement},gl:{preserveDrawingBuffer:!0,antialias:!0},children:[ue.jsx("color",{attach:"background",args:["#ffffff"]}),ue.jsx(fH,{azimuth:i.metadata.azimuth,elevation:i.metadata.elevation,distance:i.metadata.distance,pose:i.characterPose}),ue.jsx("ambientLight",{intensity:1.2}),ue.jsx("spotLight",{position:[5,15,5],intensity:2,castShadow:!0}),ue.jsx(cH,{rotationY:0,pose:i.characterPose}),ue.jsx(dH,{azimuth:i.metadata.azimuth,elevation:i.metadata.elevation,distance:i.metadata.distance}),ue.jsx(F5,{position:[0,0,0],infiniteGrid:!0,fadeDistance:100,sectionColor:"#f5f5f5",cellColor:"#fafafa",sectionSize:10,cellSize:1}),ue.jsx(tV,{position:[0,0,0],opacity:.2,scale:30,blur:3,far:10}),ue.jsx(eV,{preset:"studio"})]})}),ue.jsxs("div",{ref:v,className:"relative border-[1.5px] border-black/20 pointer-events-none z-10 shadow-[0_0_0_9999px_rgba(0,0,0,0.7)] flex items-center justify-center transition-all duration-500",style:{height:L,width:z},children:[ue.jsx("div",{className:"absolute top-0 left-0 border-t-2 border-l-2 border-white/95 w-16 h-16"}),ue.jsx("div",{className:"absolute top-0 right-0 border-t-2 border-r-2 border-white/95 w-16 h-16"}),ue.jsx("div",{className:"absolute bottom-0 left-0 border-b-2 border-l-2 border-white/95 w-16 h-16"}),ue.jsx("div",{className:"absolute bottom-0 right-0 border-b-2 border-r-2 border-white/95 w-16 h-16"}),ue.jsx("div",{className:"absolute w-12 h-[1px] bg-white/40"}),ue.jsx("div",{className:"absolute h-12 w-[1px] bg-white/40"})]}),ue.jsxs("div",{className:"absolute top-12 right-12 z-20 flex flex-col items-end gap-6 h-full pointer-events-none",children:[ue.jsxs("div",{className:"flex items-center gap-4 pointer-events-auto",children:[ue.jsx("button",{onClick:()=>s(!0),className:"group p-4 bg-black/50 hover:bg-black rounded-full text-white border border-gray-700/50 hover:border-gray-600 transition-all backdrop-blur-md shadow-2xl active:scale-95",title:"API Settings",children:ue.jsx(MV,{size:20,className:"text-gray-400 group-hover:text-white transition-colors"})}),ue.jsxs("button",{onClick:D,className:"group flex items-center gap-3 px-8 py-4 bg-black hover:bg-gray-900 rounded-full transition-all text-white border border-gray-700 shadow-2xl active:scale-95",children:[ue.jsx(dV,{size:20}),ue.jsx("span",{className:"text-xs font-black uppercase tracking-[0.2em]",children:"截圖視角"})]})]}),ue.jsxs("div",{className:"bg-black/90 backdrop-blur-xl p-5 rounded-3xl border border-gray-800 shadow-[0_20px_40px_rgba(0,0,0,0.5)] w-[240px] space-y-5 animate-in slide-in-from-right-10 duration-700 pointer-events-auto",children:[ue.jsxs("div",{className:"flex items-center justify-between border-b border-gray-800 pb-3",children:[ue.jsxs("div",{className:"flex items-center gap-2",children:[ue.jsx("div",{className:"h-4 w-1 bg-teal-500 rounded-full shadow-[0_0_10px_rgba(20,184,166,0.8)]"}),ue.jsx("span",{className:"text-[10px] font-black text-gray-400 uppercase tracking-widest",children:"Pose"})]}),ue.jsxs("div",{className:"flex items-center gap-2",children:[ue.jsx("input",{type:"checkbox",id:"includePoseOverlay",checked:i.includePoseInPrompt,onChange:k=>e(G=>({...G,includePoseInPrompt:k.target.checked})),className:"w-3 h-3 rounded bg-gray-700 border-gray-600 text-teal-500 focus:ring-teal-500 cursor-pointer"}),ue.jsx("label",{htmlFor:"includePoseOverlay",className:"text-[9px] font-bold text-gray-500 uppercase cursor-pointer hover:text-gray-300",children:"寫入指令"})]})]}),ue.jsx("div",{className:"grid grid-cols-2 gap-2",children:["Standing","Walking","Running"].map(k=>ue.jsx("button",{onClick:()=>e(G=>({...G,characterPose:k})),onMouseEnter:G=>_(G,k),onMouseLeave:b,className:`px-3 py-2 text-[10px] rounded-lg border transition-all font-bold uppercase tracking-wider text-center ${i.characterPose===k?"bg-teal-500/20 border-teal-500/50 text-teal-300 shadow-[0_0_15px_rgba(20,184,166,0.2)]":"bg-gray-800/50 border-gray-700/50 text-gray-500 hover:bg-gray-800 hover:text-gray-300"}`,children:k},k))})]})]}),ue.jsxs("div",{className:"absolute top-12 left-12 flex flex-col gap-3 pointer-events-none z-20",children:[ue.jsxs("div",{className:"bg-black/95 backdrop-blur-xl px-5 py-2.5 rounded-2xl border border-gray-800 text-[10px] font-black tracking-widest flex items-center justify-between min-w-[180px] shadow-2xl",children:[ue.jsx("span",{className:"text-gray-500",children:"AZIMUTH"}),ue.jsxs("span",{className:"text-white font-mono text-sm",children:[i.metadata.azimuth,"°"]})]}),ue.jsxs("div",{className:"bg-black/95 backdrop-blur-xl px-5 py-2.5 rounded-2xl border border-gray-800 text-[10px] font-black tracking-widest flex items-center justify-between min-w-[180px] shadow-2xl",children:[ue.jsx("span",{className:"text-gray-500",children:"ELEVATION"}),ue.jsxs("span",{className:"text-white font-mono text-sm",children:[i.metadata.elevation,"°"]})]}),ue.jsxs("div",{className:"bg-black/95 backdrop-blur-xl px-5 py-2.5 rounded-2xl border border-gray-800 text-[10px] font-black tracking-widest flex items-center justify-between min-w-[180px] shadow-2xl",children:[ue.jsx("span",{className:"text-gray-500",children:"DISTANCE"}),ue.jsxs("span",{className:"text-white font-mono text-sm",children:[i.metadata.distance.toFixed(1),"m"]})]})]}),ue.jsx("div",{className:"absolute bottom-16 inset-x-0 flex justify-center pointer-events-none z-20",children:ue.jsxs("div",{className:"bg-black/95 backdrop-blur-3xl px-16 py-5 rounded-full border border-gray-800 flex items-center gap-12 shadow-[0_30px_70px_rgba(0,0,0,0.6)]",children:[ue.jsx("span",{className:"text-[11px] font-black text-gray-500 uppercase tracking-[0.5em]",children:"Optical Profile"}),ue.jsxs("div",{className:"flex gap-12 text-sm font-black tracking-[0.3em] uppercase",children:[ue.jsx("span",{className:"text-blue-400 drop-shadow-[0_0_10px_rgba(59,130,246,0.5)]",children:i.terms.direction}),ue.jsx("span",{className:"text-pink-400 drop-shadow-[0_0_10px_rgba(236,72,153,0.5)]",children:i.terms.angle}),ue.jsx("span",{className:"text-yellow-400 drop-shadow-[0_0_10px_rgba(234,179,8,0.5)]",children:i.terms.size})]})]})}),ue.jsx("div",{className:"absolute bottom-4 w-full z-20 flex justify-center pointer-events-auto",children:ue.jsx("a",{href:"https://weisfx0705.github.io/chiawei/",target:"_blank",rel:"noopener noreferrer",className:"text-[10px] text-gray-500 font-bold tracking-widest uppercase hover:text-white transition-colors drop-shadow-lg opacity-70 hover:opacity-100",children:"義守大學電影與電視學系陳嘉暐老師設計 2026"})})]}),ue.jsxs("div",{className:"w-full lg:w-[500px] flex flex-col bg-[#0d0d0d] border-l border-gray-800 shadow-2xl z-30 overflow-y-auto scrollbar-hide",children:[ue.jsxs("div",{className:"p-8 border-b border-gray-800 flex items-center justify-between sticky top-0 bg-[#0d0d0d]/95 backdrop-blur-xl z-40",children:[ue.jsxs("div",{className:"flex items-center gap-4",children:[ue.jsx("div",{className:`p-3 rounded-2xl border shadow-inner transition-colors ${i.promptMode==="video"?"bg-blue-600/10 border-blue-500/20":"bg-orange-600/10 border-orange-500/20"}`,children:i.promptMode==="video"?ue.jsx(iw,{className:"w-6 h-6 text-blue-500"}):ue.jsx(Gb,{className:"w-6 h-6 text-orange-500"})}),ue.jsx("div",{children:ue.jsxs("h1",{className:"font-black text-xl text-white tracking-tighter uppercase",children:[i.promptMode==="video"?"Camera Patch":"Cinematic Still",ue.jsx("br",{}),ue.jsx("span",{className:"text-gray-500 text-sm",children:"Compiler"})]})})]}),ue.jsxs("div",{className:"flex bg-gray-900/50 p-1.5 rounded-xl border border-gray-800",children:[ue.jsxs("button",{onClick:()=>e(k=>({...k,promptMode:"video"})),className:`flex items-center gap-2 px-4 py-2 rounded-lg text-[10px] font-black uppercase tracking-wider transition-all ${i.promptMode==="video"?"bg-blue-600 text-white shadow-lg":"text-gray-500 hover:text-gray-300"}`,children:[ue.jsx(iw,{size:14}),ue.jsx("span",{children:"Video"})]}),ue.jsxs("button",{onClick:()=>e(k=>({...k,promptMode:"image"})),className:`flex items-center gap-2 px-4 py-2 rounded-lg text-[10px] font-black uppercase tracking-wider transition-all ${i.promptMode==="image"?"bg-orange-600 text-white shadow-lg":"text-gray-500 hover:text-gray-300"}`,children:[ue.jsx(Gb,{size:14}),ue.jsx("span",{children:"Image"})]})]})]}),ue.jsxs("div",{className:"p-10 space-y-12",children:[ue.jsxs("section",{className:"space-y-8",children:[ue.jsxs("div",{className:"flex items-center gap-3",children:[ue.jsx("div",{className:"h-5 w-1 bg-blue-500 rounded-full shadow-[0_0_15px_rgba(59,130,246,0.8)]"}),ue.jsx("h2",{className:"text-[11px] font-black text-gray-400 uppercase tracking-[0.3em]",children:"Optical Axis"})]}),ue.jsxs("div",{className:"space-y-10",children:[ue.jsxs("div",{className:"space-y-4",children:[ue.jsxs("div",{className:"flex justify-between text-[12px] font-black uppercase tracking-widest",children:[ue.jsx("label",{className:"text-gray-500",children:"Azimuth"}),ue.jsxs("span",{className:"text-white font-mono",children:[i.metadata.azimuth,"°"]})]}),ue.jsx("input",{type:"range",min:"0",max:"360",step:"1",value:i.metadata.azimuth,onChange:k=>T("azimuth",parseInt(k.target.value)),className:"w-full h-1.5 bg-gray-800 rounded-lg appearance-none cursor-pointer accent-green-500"})]}),ue.jsxs("div",{className:"space-y-4",children:[ue.jsxs("div",{className:"flex justify-between text-[12px] font-black uppercase tracking-widest",children:[ue.jsx("label",{className:"text-gray-500",children:"Elevation"}),ue.jsxs("span",{className:"text-white font-mono",children:[i.metadata.elevation,"°"]})]}),ue.jsx("input",{type:"range",min:"-80",max:"80",step:"1",value:i.metadata.elevation,onChange:k=>T("elevation",parseInt(k.target.value)),className:"w-full h-1.5 bg-gray-800 rounded-lg appearance-none cursor-pointer accent-pink-500"})]}),ue.jsxs("div",{className:"space-y-4",children:[ue.jsxs("div",{className:"flex justify-between text-[12px] font-black uppercase tracking-widest",children:[ue.jsx("label",{className:"text-gray-500",children:"Distance"}),ue.jsxs("span",{className:"text-white font-mono",children:[i.metadata.distance.toFixed(1),"m"]})]}),ue.jsx("input",{type:"range",min:"0.2",max:"40",step:"0.1",value:i.metadata.distance,onChange:k=>T("distance",parseFloat(k.target.value)),className:"w-full h-1.5 bg-gray-800 rounded-lg appearance-none cursor-pointer accent-yellow-500"})]})]})]}),ue.jsxs("section",{className:"space-y-8",children:[ue.jsxs("div",{className:"flex items-center gap-3",children:[ue.jsx("div",{className:"h-5 w-1 bg-purple-500 rounded-full shadow-[0_0_15px_rgba(168,85,247,0.8)]"}),ue.jsx("h2",{className:"text-[11px] font-black text-gray-400 uppercase tracking-[0.3em]",children:"Camera Language (26)"})]}),ue.jsx("div",{className:"space-y-8",children:w2.map(k=>i.promptMode==="image"&&(k.name==="Pan / Tilt / Zoom"||k.name==="Dolly / Crane / Tracking")?null:ue.jsxs("div",{className:"space-y-3 animate-in fade-in duration-500",children:[ue.jsx("h3",{className:"text-[10px] font-bold text-gray-600 uppercase tracking-widest",children:k.name}),ue.jsx("div",{className:"grid grid-cols-2 gap-2",children:k.motions.map(G=>{const P=i.selectedMotions.includes(G);return ue.jsxs("button",{onClick:()=>I(G),onMouseEnter:O=>_(O,G),onMouseLeave:b,className:`px-4 py-3 text-[10px] rounded-xl border transition-all text-left flex items-center justify-between font-bold uppercase tracking-tight shadow-sm ${P?"border-purple-500 bg-purple-500/10 text-purple-300 shadow-inner":"border-gray-800 bg-gray-900/30 text-gray-500 hover:border-gray-700 hover:text-gray-300"}`,children:[ue.jsx("span",{children:G}),P&&ue.jsx(lV,{size:12,className:"text-purple-500"})]},G)})})]},k.name))})]}),ue.jsxs("section",{className:"space-y-8",children:[ue.jsxs("div",{className:"flex items-center gap-3",children:[ue.jsx("div",{className:"h-5 w-1 bg-gray-600 rounded-full"}),ue.jsx("h2",{className:"text-[11px] font-black text-gray-400 uppercase tracking-[0.3em]",children:"Story Intent"})]}),ue.jsxs("div",{className:"space-y-4",children:[ue.jsx("textarea",{value:i.description,onChange:k=>e(G=>({...G,description:k.target.value})),placeholder:"請具體敘述角色、環境細節、光影氛圍... (Story & Content)",className:"w-full h-24 bg-[#141414] border border-gray-800 rounded-[1.5rem] p-5 text-[13px] text-gray-200 focus:outline-none focus:ring-1 focus:ring-blue-600/50 transition-all resize-none placeholder:text-gray-700 font-medium leading-relaxed shadow-inner"}),ue.jsxs("div",{className:"relative",children:[ue.jsx("input",{type:"text",value:i.style,onChange:k=>e(G=>({...G,style:k.target.value})),placeholder:"視覺風格 (e.g., Cyberpunk, Noir, Wes Anderson, Polaroid, 8mm)...",className:"w-full h-14 bg-[#141414] border border-gray-800 rounded-[1.5rem] px-5 text-[13px] text-gray-200 focus:outline-none focus:ring-1 focus:ring-pink-600/50 transition-all placeholder:text-gray-700 font-medium shadow-inner"}),ue.jsx("div",{className:"absolute right-5 top-1/2 -translate-y-1/2 text-[10px] uppercase font-bold text-gray-700 tracking-wider pointer-events-none",children:"Style"})]})]})]}),ue.jsxs("section",{className:"space-y-8 pb-20",children:[ue.jsxs("button",{onClick:C,disabled:a,className:"group w-full py-6 bg-white text-black hover:bg-gray-50 active:scale-[0.97] transition-all disabled:opacity-50 disabled:cursor-not-allowed rounded-[2rem] font-black text-xs uppercase tracking-[0.5em] flex items-center justify-center gap-4 shadow-[0_25px_60px_rgba(255,255,255,0.05)]",children:[a?ue.jsx(_V,{className:"animate-spin",size:20}):i.promptMode==="video"?ue.jsx(pV,{size:20,className:"group-hover:rotate-12 transition-transform"}):ue.jsx(Gb,{size:20,className:"group-hover:scale-110 transition-transform"}),a?"Compiling...":i.promptMode==="video"?"Compile Video Patch":"Generate Image Prompt"]}),i.finalPrompt&&ue.jsxs("div",{className:"relative group animate-in fade-in slide-in-from-bottom-10 duration-1000",children:[ue.jsx("div",{className:"bg-gradient-to-br from-blue-900/20 to-purple-900/20 border border-white/10 rounded-[2rem] p-8 pr-16 shadow-2xl backdrop-blur-md",children:ue.jsx("div",{className:"prose-custom text-sm leading-relaxed text-gray-300",dangerouslySetInnerHTML:{__html:B}})}),ue.jsx("button",{onClick:U,className:"absolute top-6 right-6 p-3 bg-black/50 hover:bg-black text-white rounded-xl transition-all shadow-xl active:scale-95 border border-white/10",children:ue.jsx(cV,{size:16})})]})]})]})]}),ue.jsx(lH,{isOpen:r,onClose:()=>s(!1),onSave:A,initialKey:t}),d&&ue.jsxs("div",{className:"fixed z-[100] px-4 py-3 bg-black/90 backdrop-blur-xl border border-gray-700 text-gray-100 text-[11px] rounded-xl shadow-2xl pointer-events-none max-w-[240px] leading-relaxed tracking-wide transform -translate-x-1/2 -translate-y-full",style:{left:d.x,top:d.y},children:[ue.jsx("div",{className:"absolute bottom-[-6px] left-1/2 -translate-x-1/2 w-3 h-3 bg-black/90 border-r border-b border-gray-700 transform rotate-45"}),d.text]})]})},gN=document.getElementById("root");if(!gN)throw new Error("Could not find root element to mount to");const R2=uD.createRoot(gN);R2.render(ue.jsx(FM.StrictMode,{children:ue.jsx(C2,{})}));</script>
</head>
<body>
    <div id="root"></div>
</body>
</html>
